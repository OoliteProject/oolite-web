<html>
    <head>
        <title>Expansion Manifest MFD</title>
        <link rel="stylesheet" href="../style.css">
    </head>
    <body>
        <table border="0" width="100%">
            <tr>
                <td>Back to <a href='../index.html'>Index</a></td>
                <td align="right"><small>Page generated: Oct 11, 2023, 3:16:49 PM</small></td>
            </tr>
        </table>

        <h1>Expansion Manifest MFD</h1>

        <h2>Content</h2>
        <ul>
          <li><a href="#warnings">Warnings</a></li>
          <li><a href="#manifest">Manifest</a></li>
          <li><a href="#documentation">Documentation</a></li>
          <li><a href="#equipment">1 Equipment</a></li>
          <li><a href="#ships">0 Ships</a></li>
          <li><a href="#models">0 Models</a></li>
          <li><a href="#scripts">1 Scripts</a></li>
        </ul>

          <a name="warnings">
            <h2>Warnings</h2>
            <ol>
                <li>Information URL mismatch between OXP Manifest and Expansion Manager string length at character position 0</li>
            </ol>
          </a>

        <a name="manifest">
        <h2>Manifest</h2>
            <table border="1">
                <tr>
                    <th></th>
                    <th>from Expansion Manager's OXP list</th>
                    <th>from Expansion Manifest</th>
                </tr>
                <tr>
                    <td>Description</td>
                    <td>Shows manifest information in an MFD. Great for miners, scavengers and others in constant need of cargo hold information.</td>
                    <td>Shows manifest information in an MFD. Great for miners, scavengers and others in constant need of cargo hold information.</td>
                </tr>
                <tr>
                    <td>Identifier</td>
                    <td>oolite.oxp.spara.manifest_mfd</td>
                    <td>oolite.oxp.spara.manifest_mfd</td>
                </tr>
                <tr>
                    <td>Title</td>
                    <td>Manifest MFD</td>
                    <td>Manifest MFD</td>
                </tr>
                <tr>
                    <td>Category</td>
                    <td>HUDs</td>
                    <td>HUDs</td>
                </tr>
                <tr>
                    <td>Author</td>
                    <td>spara</td>
                    <td>spara</td>
                </tr>
                <tr>
                    <td>Version</td>
                    <td>1.1.2</td>
                    <td>1.1.2</td>
                </tr>
                <tr>
                    <td>Tags</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Required Oolite Version</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Maximum Oolite Version</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Required Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Optional Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Conflict Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Information URL</td>
                    <td><a target="_blank" href=""></a></td>
                    <td><a target="_blank" href="">n/a</a></td>
                </tr>
                <tr>
                    <td>Download URL</td>
                    <td><a target="_blank" href="https://wiki.alioth.net/img_auth.php/8/89/Manifest_mfd_1.1.2.oxz">https://wiki.alioth.net/img_auth.php/8/89/Manifest_mfd_1.1.2.oxz</a></td>
                    <td><a target="_blank" href="">n/a</a></td>
                </tr>
                <tr>
                    <td>License</td>
                    <td>CC-BY-NC-SA 4.0</td>
                    <td>CC-BY-NC-SA 4.0</td>
                </tr>
                <tr>
                    <td>File Size</td>
                    <td>n/a</td>
                </tr>
                <tr>
                    <td>Upload date</td>
                    <td>1610873355</td>
                </tr>
            </table>
                </a>

        <a name="documentation">
        <h2>Documentation</h2>
        <p>Also read <a href='http://wiki.alioth.net/index.php/Manifest%20MFD'>http://wiki.alioth.net/index.php/Manifest%20MFD</a></p>
        <h3>manifest_mfd_readme_&amp;_license.txt</h3>
        <pre>Manifest MFD OXP ver 1.1.2 (3.8.2015)

Author: spara (Mika Sp√•ra)

_Overview_

Show cargo manifest information in an MFD. Great for miners, scavengers and anyone in need of quick manifest information. Equipment costs 550 credits and is available from TL5 and up stations.

_Other OXPs_

This oxp tracks the changes of used cargo space, thus catching scooping, jettisoning and destruction of cargo. It does not however note changes of cargo contents. For that an OXP changing the contents of an container in the cargo hold should notify this script by calling
notifyCargoChange().

Just add this to your script after you have changed the contents of a container:

if (worldScripts[&quot;manifest_mfd&quot;])
	worldScripts[&quot;manifest_mfd&quot;].notifyCargoChange();

_Requirements_

* Oolite 1.80 or higher

------

This work is licensed under the Creative Commons Attribution-Noncommercial-Share Alike 4.0 Unported License. To view a copy of this license, visit http://creativecommons.org/licenses/by-nc-sa/4.0/
</pre>
        </a>

        <a name="equipment">          
        <h2>Equipment</h2>
            <table>
                <tr>
                    <th>Name</th>
                    <th>Visible</th>
                    <th>Cost [deci-credits]</th>
                    <th>Tech-Level</th>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_MANIFEST_MFD.html">Manifest MFD</a></td>
                    <td>yes</td>
                    <td align="right">5500</td>
                    <td align="center">5+</td>
                </tr>
            </table>
        </a>

        <a name="ships">    
        <h2>Ships</h2>
            This expansion declares no ships. This may be related to warnings.
        </a>

        <a name="models">    
        <h2>Models</h2>
            This expansion declares no models. This may be related to warnings.
        </a>

        <a name="scripts">    
        <h2>Scripts</h2>
            <table>
                <tr>
                    <th>Path</th>
                </tr>
                <tr>
                    <td valign="top">Config/script.js</td>
                    <td><pre>&quot;use strict&quot;;

this.name               = &quot;manifest_mfd&quot;;
this.author               = &quot;spara&quot;;
this.description         = &quot;Manifest info as an MFD&quot;;

//public function to notify about content changes
this.notifyCargoChange = function() {
	this.$updateManifestMFD();
}

//tracks changes in cargo space
this.$prevCargoSpaceUsed = player.ship.cargoSpaceUsed;

//update the mfd message and start a framecallback on launch
this.shipWillLaunchFromStation = function() {
	this.$updateManifestMFD();
	if (!this.$manifestMFD) {
		this.$manifestMFD = addFrameCallback(this.$manifestMonitor.bind(this));
	}
}

//remove framecallback on docking
this.shipWillDockWithStation = function() {
	if (this.$manifestMFD) {
		removeFrameCallback(this.$manifestMFD);
		delete this.$manifestMFD;
	}
}

//monitor volume changes in cargo hold.
this.$manifestMonitor = function() {
	var currCargoSpaceUsed = player.ship.cargoSpaceUsed;
	//cargo scooped, destroyed or jettisoned
	if (currCargoSpaceUsed !== this.$prevCargoSpaceUsed) {
		this.$updateManifestMFD();
		this.$prevCargoSpaceUsed = currCargoSpaceUsed;
	}
}

//update the mfd message
this.$updateManifestMFD = function() {
	if (player.ship.equipmentStatus(&quot;EQ_MANIFEST_MFD&quot;) === &quot;EQUIPMENT_OK&quot;) {
		var message = &quot;Cargo &quot; + player.ship.cargoSpaceUsed + &quot; t (&quot; + player.ship.cargoSpaceCapacity + &quot; t):\n&quot;;
		if (manifest.list.length === 0) message = message + &quot; None.&quot;;
		else {
			var pieces = new Array();
			for (var i = 0; i &lt; manifest.list.length; i++) {
				var m = manifest.list[i];
				pieces.push(m.quantity + &quot; &quot; + String.fromCharCode(215) + &quot; &quot;+ m.displayName);
			}
			var twoColumnRows = pieces.length - 9;
			var i = 0;
			if (twoColumnRows &gt; 0) {
				var hairSpace = String.fromCharCode(31);
				var hairSpaceLength = defaultFont.measureString(hairSpace);
				for (i = 0; i &lt; twoColumnRows; i++) {
					var line = &quot; &quot; + pieces[i];
					var currentLength = global.defaultFont.measureString(line);
					var padsNeeded = Math.floor((7.5 - currentLength) / hairSpaceLength);
					if (padsNeeded &gt;= 1) {
						var pads = new Array(padsNeeded).join(hairSpace);
					}
					line = line + pads;
					message = message + line + pieces[i+9] + &quot;\n&quot;;
				}
			}
			var rows = 9;
			if (pieces.length &lt; 9) rows = pieces.length;
			for (var j = i; j &lt; rows; j++) {
				message = message + &quot; &quot; + pieces[j] + &quot;\n&quot;;
			}
		}
		player.ship.setMultiFunctionText(&quot;manifest_mfd&quot;, message);
	}
	else player.ship.setMultiFunctionText(&quot;manifest_mfd&quot;, null);
}
</pre></td>
                </tr>
            </table>
        </a>
    </body>
</html>
