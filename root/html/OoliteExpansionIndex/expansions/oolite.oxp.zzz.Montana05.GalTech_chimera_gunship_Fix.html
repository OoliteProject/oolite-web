<html>
    <head>
        <title>Expansion Chimera Gunship Fix</title>
        <link rel="stylesheet" href="../style.css">
    </head>
    <body>
        <table border="0" width="100%">
            <tr>
                <td>Back to <a href='../index.html'>Index</a></td>
                <td align="right"><small>Page generated: Oct 11, 2023, 3:16:49 PM</small></td>
            </tr>
        </table>

        <h1>Expansion Chimera Gunship Fix</h1>

        <h2>Content</h2>
        <ul>
          <li><a href="#warnings">Warnings</a></li>
          <li><a href="#manifest">Manifest</a></li>
          <li><a href="#documentation">Documentation</a></li>
          <li><a href="#equipment">0 Equipment</a></li>
          <li><a href="#ships">5 Ships</a></li>
          <li><a href="#models">0 Models</a></li>
          <li><a href="#scripts">1 Scripts</a></li>
        </ul>

          <a name="warnings">
            <h2>Warnings</h2>
            <ol>
                <li>Unknown key &#39;requires_oxp&#39; at https://wiki.alioth.net/img_auth.php/a/a0/Oolite.oxp.zzz.Montana05.GalTech_chimera_gunship_Fix.OXZ!manifest.plist</li>
            </ol>
          </a>

        <a name="manifest">
        <h2>Manifest</h2>
            <table border="1">
                <tr>
                    <th></th>
                    <th>from Expansion Manager's OXP list</th>
                    <th>from Expansion Manifest</th>
                </tr>
                <tr>
                    <td>Description</td>
                    <td>Update of the Chimera Gunship: Fixes problems and adjusts to later Oolite versions</td>
                    <td>Update of the Chimera Gunship: Fixes problems and adjusts to later Oolite versions</td>
                </tr>
                <tr>
                    <td>Identifier</td>
                    <td>oolite.oxp.zzz.Montana05.GalTech_chimera_gunship_Fix</td>
                    <td>oolite.oxp.zzz.Montana05.GalTech_chimera_gunship_Fix</td>
                </tr>
                <tr>
                    <td>Title</td>
                    <td>Chimera Gunship Fix</td>
                    <td>Chimera Gunship Fix</td>
                </tr>
                <tr>
                    <td>Category</td>
                    <td>Ships</td>
                    <td>Ships</td>
                </tr>
                <tr>
                    <td>Author</td>
                    <td>Montana05</td>
                    <td>Montana05</td>
                </tr>
                <tr>
                    <td>Version</td>
                    <td>1.12</td>
                    <td>1.12</td>
                </tr>
                <tr>
                    <td>Tags</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Required Oolite Version</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Maximum Oolite Version</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Required Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Optional Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Conflict Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Information URL</td>
                    <td><a target="_blank" href="http://aegidian.org/bb/viewtopic.php?p=272543#p272543">http://aegidian.org/bb/viewtopic.php?p=272543#p272543</a></td>
                    <td><a target="_blank" href="">n/a</a></td>
                </tr>
                <tr>
                    <td>Download URL</td>
                    <td><a target="_blank" href="https://wiki.alioth.net/img_auth.php/a/a0/Oolite.oxp.zzz.Montana05.GalTech_chimera_gunship_Fix.OXZ">https://wiki.alioth.net/img_auth.php/a/a0/Oolite.oxp.zzz.Montana05.GalTech_chimera_gunship_Fix.OXZ</a></td>
                    <td><a target="_blank" href="">n/a</a></td>
                </tr>
                <tr>
                    <td>License</td>
                    <td>CC BY-NC-SA 4.0</td>
                    <td>CC BY-NC-SA 4.0</td>
                </tr>
                <tr>
                    <td>File Size</td>
                    <td>n/a</td>
                </tr>
                <tr>
                    <td>Upload date</td>
                    <td>1610873396</td>
                </tr>
            </table>
                </a>

        <a name="documentation">
        <h2>Documentation</h2>
        <p>Also read <a href='http://wiki.alioth.net/index.php/Chimera%20Gunship%20Fix'>http://wiki.alioth.net/index.php/Chimera%20Gunship%20Fix</a></p>
        <h3>read_me.txt</h3>
        <pre>
Overview
========

This Chimera Gunship package is fixing some bugs, upgrades to features from later versions of Oolite and, inspired by Shipbuilders original
message &quot;Whilst you are free (and encouraged) to re-use any of the scripting, models or texturing in this OXP&quot;, includes some
new features, all of them to be removed if Shipbuilder disagrees.

Fixes
=====

changed &quot;cargo_type&quot; to &quot;CARGO_NOT_CARGO&quot; to prevent the ship shown as cargo (shipdata.plist)

added some flashers to support engine emission (shipdata.plist)

changed &quot;optional_equipment&quot; to correct price calculation in shipyards (shipyard.plist)

added shiplibrary.plist to replace the obsolete demoships.plist

some small modifications at the model

Upgrades
========

changed fore and rear lasers to &quot;multiply&quot; (shipdata.plist)

removed port and starboard lasers to compensate for the additional mounts (shipdata.plist)

changed &quot;death_actions&quot; to a ship-script:
The scrip is handling messages, death actions (including escape pods), and some new features

included a normal map and modified the diffuse map slightly to work better with the normal map (and to fix some problems)

included &quot;gloss&quot;

New Features
============

As mentioned above this are not part of the original OXP and will be removed if Shipbuilder disagrees:

included some additional diffuse maps

races, ranks and various descriptions for rescued crew members (script)

included &quot;explosive shrapnels&quot; and &quot;burning quirium fuel&quot; to ship explosions, both part of Montanas Resource Pack 01 OXP (script)

changed the assignment of cargo pods (script)

included an alternate (a bit tougher) version with roles escort-heavy, trader-smuggler, hunter-heavy

assigned GalTech escape pods to the ships (slightly redesigned)
 
Credits
=======

original work and escape pods: Shipbuilder
rear laser: Norby (adjustment of positions)

Dependencies
============

to work correct this pack needs to install Montanas Resource Pack 01 OXP (minimum V 0.51) as well

License
=======

This work is licensed under Creative Commons Attribution Non-Commercial Share Alike 4.0 International (CC BY-NC-SA 4.0).
To view a copy of this license visit https://creativecommons.org/licenses/by-nc-sa/4.0

Version History
===============

V 1.00
basic fix

V 1.10
fix with upgrades and new features

V 1.11:
found and corrected a missing variable in the script

V 1.12:
added &quot;ship debris&quot; to the ship explosions, part of Montanas Resource Pack 01 OXP (script)
optimization of the script
adjustment of rear laser positions (thanks to Norby)

</pre>
        </a>

        <a name="equipment">          
        <h2>Equipment</h2>
            This expansion declares no equipment. This may be related to warnings.
        </a>

        <a name="ships">    
        <h2>Ships</h2>
            <table>
                <tr>
                    <th>Name</th>
                </tr>
                <tr>
                    <td><a href="../ships/GalTech_chimera_gunship_escape_pod.html">GalTech_chimera_gunship_escape_pod</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/GalTech_chimera_gunship_escape_pod_pirate.html">GalTech_chimera_gunship_escape_pod_pirate</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/GalTech_chimera_gunship_escape_pod_police.html">GalTech_chimera_gunship_escape_pod_police</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/chimera_alt.html">chimera_alt</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/chimera_alt_team_01.html">chimera_alt_team_01</a></td>
                </tr>
            </table>
        </a>

        <a name="models">    
        <h2>Models</h2>
            This expansion declares no models. This may be related to warnings.
        </a>

        <a name="scripts">    
        <h2>Scripts</h2>
            <table>
                <tr>
                    <th>Path</th>
                </tr>
                <tr>
                    <td valign="top">Scripts/GalTech_chimera_gunship.js</td>
                    <td><pre>this.name			= &quot;GalTech_chimera_gunship&quot;;
this.author			= &quot;Montana05&quot;;
this.description	= &quot;event handler for chimera gunship OXP&quot;;
this.version		= &quot;1.12&quot;;
this.copyright		= &quot;2020 Montana05&quot;;
this.licence   		= &quot;CC BY-NC-SA 4.0&quot;;
&quot;use strict&quot;;

// new features for Chimera Gunship (will be removed if Shipbuilder disagrees):

this.shipSpawned = function(ship)
{
	this.$GalTech_shipType = this.ship.dataKey;
	var dice = 0;
	
	if(this.ship.hasRole(&quot;escape-capsule&quot;))
	{
		// neutral inits first
		var $GalTech_crewName = expandDescription(&quot;[nom]&quot;);
		var $GalTech_description = &quot;a crew member of an evacuated ship&quot;;
		var $GalTech_crewRole = &quot;hunter&quot;;  // not perfect but somewhere in the middle
		var $GalTech_crewRace = expandDescription(&quot;[GalTech_GalCop_races]&quot;);  // added a race to the crew members
		
		// now it&#39;s time to be more specific, based on an estimated crew of up to 5 person
		// every individual without insurance or bounty will be defined as a slave
		switch(this.$GalTech_shipType) 
		{
			case &quot;GalTech_chimera_gunship_escape_pod&quot;:
			
				this.$GalTech_chimera_gunship_crew_ranks_Array = 
				[&quot;Gunner&quot;, &quot;Communications Operator&quot;, &quot;Sensor Operator&quot;, &quot;Engineer&quot;, &quot;Astrogator&quot;, &quot;Pilot&quot;, &quot;Commander&quot;];
				var $GalTech_crewRanks = 
				$GalTech_chimera_gunship_crew_ranks_Array[Math.floor(Math.random() * $GalTech_chimera_gunship_crew_ranks_Array.length)];
			
				$GalTech_crewName = (&quot;the &quot; + $GalTech_crewRace + &quot; &quot; + $GalTech_crewRanks + &quot; &quot; + expandDescription(&quot;[nom]&quot;));
				$GalTech_description = &quot;a ship crew member&quot;;
				$GalTech_crewRole = &quot;trader&quot;; 	
		
				dice = this.$getRndInteger(1, 5);
		
				// added some diversity
				if(dice &gt; 2)
				{
					$GalTech_CrewRole = &quot;hunter&quot;;
				};

				// once in a while there are passengers as well
				if(dice &gt; 4)
				{
					$GalTech_crewName = &quot;the &quot; + $GalTech_crewRace + &quot; &quot; + expandDescription(&quot;[nom]&quot;);
					$GalTech_description = &quot;a interstellar passenger&quot;;
					$GalTech_crewRole = &quot;passenger&quot;;
				};
				break;
			
			case &quot;GalTech_chimera_gunship_escape_pod_police&quot;:
				
				this.$GalTech_chimera_gunship_police_ranks_Array = 
				[&quot;Ensign&quot;, &quot;Space Junior Lieutenant&quot;, &quot;Space Lieutenant&quot;, &quot;Lt. Commander&quot;];
				var $GalTech_policeRank = 
				$GalTech_chimera_gunship_police_ranks_Array[Math.floor(Math.random() * $GalTech_chimera_gunship_police_ranks_Array.length)];
			
				$GalTech_crewName = (&quot;the &quot; + $GalTech_crewRace + &quot; &quot; + $GalTech_policeRank + &quot; &quot; + expandDescription(&quot;[nom]&quot;));
				$GalTech_description = &quot;a crew member of a space police ship&quot;;
				$GalTech_crewRole = &quot;police&quot;; 		
				break;
			
			case &quot;GalTech_chimera_gunship_escape_pod_pirate&quot;:
				
				$GalTech_crewName = 
				(&quot;the &quot; + $GalTech_crewRace + &quot; &quot; + expandDescription(&quot;[GalTech_pirate_nicknames]&quot;) + expandDescription(&quot;[nom]&quot;));
				
				$GalTech_description = &quot;a criminal wanted by GalCop police&quot;;
				$GalTech_crewRole = &quot;pirate&quot;;
				break;	
			
			default: 
				break;			
		};

		this.ship.setCrew
		(
			{
				name: $GalTech_crewName,
				short_description: $GalTech_description,
				role: $GalTech_crewRole,
				species: $GalTech_crewRace
			}
		);
	}
	else
	{
		var $GalTech_shipRole = this.ship.primaryRole;
		
		// if the ship got no cargo some containers are added
		if(this.ship.cargoSpaceUsed === 0)
		{
			switch($GalTech_shipRole) 
			{
				case &quot;trader-smuggler&quot;:
				case &quot;pirate&quot;:
				// individual role of the ship, will only be called from other OXP&#39;s	
				case &quot;chimera-pirate&quot;:	
					
					this.ship.setCargoType(&quot;ILLEGAL_GOODS&quot;);
					break;
					
				case &quot;trader&quot;:
				case &quot;escort&quot;:
				case &quot;escort-heavy&quot;:
				case &quot;hunter&quot;:
				case &quot;hunter-heavy&quot;:
				// individual roles per ship, will only be called from other OXP&#39;s	
				case &quot;chimera&quot;:
				case &quot;chimera_alt&quot;:	
				case &quot;chimera_alt_team_01&quot;:
					
					dice = this.$getRndInteger(1, 2);
						
					// added some diversity
					if(dice === 1)
						this.ship.setCargoType(&quot;SCARCE_GOODS&quot;);

					if(dice === 2)
						this.ship.setCargoType(&quot;PLENTIFUL_GOODS&quot;);
					break;
					
				// police most likely will have weapons, not goods
				case &quot;police&quot;:
				case &quot;wingman&quot;:
				// individual role of the ship, will only be called from other OXP&#39;s	
				case &quot;chimera-police&quot;:	
					
					dice = this.$getRndInteger(1, 10);
					this.ship.adjustCargo(&quot;firearms&quot;, dice);
					break;

				default: 
					break;
			};
		};
	};
};

this.shipDied = function(whom, why)
{
	if(this.ship.hasRole(&quot;escape-capsule&quot;))
	{
		return;
	}
	else
	{
		// neutral inits first
		var $GalTech_podType = &quot;escape-capsule&quot;;
		var debrisCount = this.$getRndInteger(1, 3); // for pods
		var $GalTech_cargoLoad = this.ship.cargoSpaceUsed;

		this.ship.commsMessage(expandDescription(&quot;[chimera-plea]&quot;), player.ship);
		
		// time to eject the escape pods
		if(this.ship.bounty &gt; 7 || this.$GalTech_shipType == &quot;chimera-pirate&quot;)
		{
			$GalTech_podType = &quot;GalTech_chimera_gunship_escape_pod_pirate&quot;;
		}		
		else
		{
			switch(this.$GalTech_shipType) 
			{
				case &quot;chimera&quot;:
				case &quot;chimera_alt&quot;:
				case &quot;chimera_alt_team_01&quot;:	

					$GalTech_podType = &quot;GalTech_chimera_gunship_escape_pod&quot;;
					break;

				case &quot;chimera-police&quot;:
					
					$GalTech_podType = &quot;GalTech_chimera_gunship_escape_pod_police&quot;;	
					break;

				default: 
					break;
			};
		}	
				
		system.addShips($GalTech_podType, debrisCount, this.ship.position);
					
		debrisCount = this.$getRndInteger(6, 10);
		// added explosive shrapnels similar to Constitution Class Heavy Cruiser
		system.addShips(&quot;GalTech_effects_explosive_shrapnel&quot;, debrisCount, this.ship.position);
		// added various depris as a new feature
		system.addShips(&quot;GalTech_ship_debris&quot;, debrisCount, this.ship.position);
		
		// added burning fuel as a new feature
		debrisCount = (this.ship.fuel.toFixed(0)) * 2;	
		system.addShips(&quot;GalTech_effects_burningFuel&quot;, debrisCount, this.ship.position);

		// added some cargopods as a new feature
		if($GalTech_cargoLoad &gt; 0)
		{
			var cargoIndex = this.ship.cargoList;
			var cargoTotal = 0;
			var debrisCount = 0;

			// calculate all containers from ship.cargoList
			for (var i = cargoIndex.length - 1 ; i &gt;= 0 ; --i)
			{
				cargoTotal = cargoTotal + this.ship.cargoList[i].quantity;
			};

			// shouldn&#39;t happen but better save than sorry
			if(cargoTotal &gt; $GalTech_cargoLoad)
				$GalTech_cargoLoad = cargoTotal;

			debrisCount = this.$getRndInteger(1, $GalTech_cargoLoad);	
			
			// time to eject cargopods
			for(var i = cargoIndex.length - 1 ; i &gt;= 0 ; --i)
			{
				var cargoType = this.ship.cargoList[i].commodity;
				var cargoPod = (&quot;GalTech_container_&quot; + cargoType);
				var cargoCount = this.ship.cargoList[i].quantity;
				
				if(debrisCount &gt; 0 &amp;&amp; debrisCount &lt; cargoCount)
					debrisCount = cargoCount;
				
				// ejects a random number of cargopods
				// Warning: additional commodities from an OXP are not covered (exceptions: witchfire_whiskey, holy_artifacts)
				while(cargoCount &gt; 0 &amp;&amp; debrisCount &gt; 0)
				{
					this.ship.ejectSpecificItem(cargoPod);
					cargoCount = cargoCount - 1;
					debrisCount = debrisCount - 1;
				};
			};
		};
	};
};	

this.$getRndInteger = function(min, max)
{
	return Math.floor(Math.random() * (max - min + 1) ) + min;
};
</pre></td>
                </tr>
            </table>
        </a>
    </body>
</html>
