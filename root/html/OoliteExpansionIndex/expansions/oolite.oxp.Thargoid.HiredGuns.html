<html>
    <head>
        <title>Expansion Hired Guns</title>
        <link rel="stylesheet" href="../style.css">
    </head>
    <body>
        <table border="0" width="100%">
            <tr>
                <td>Back to <a href='../index.html'>Index</a></td>
                <td align="right"><small>Page generated: Oct 11, 2023, 3:16:49 PM</small></td>
            </tr>
        </table>

        <h1>Expansion Hired Guns</h1>

        <h2>Content</h2>
        <ul>
          <li><a href="#warnings">Warnings</a></li>
          <li><a href="#manifest">Manifest</a></li>
          <li><a href="#documentation">Documentation</a></li>
          <li><a href="#equipment">3 Equipment</a></li>
          <li><a href="#ships">3 Ships</a></li>
          <li><a href="#models">0 Models</a></li>
          <li><a href="#scripts">2 Scripts</a></li>
        </ul>

          <a name="warnings">
            <h2>Warnings</h2>
            <ol>
                <li>Unknown key &#39;upload_date&#39; at https://wiki.alioth.net/img_auth.php/c/ca/Oolite.oxp.Thargoid.HiredGuns.oxz!manifest.plist</li>
            </ol>
          </a>

        <a name="manifest">
        <h2>Manifest</h2>
            <table border="1">
                <tr>
                    <th></th>
                    <th>from Expansion Manager's OXP list</th>
                    <th>from Expansion Manifest</th>
                </tr>
                <tr>
                    <td>Description</td>
                    <td>A chance to agree a contract for two escort ships to accompany you on your next journey.</td>
                    <td>A chance to agree a contract for two escort ships to accompany you on your next journey.</td>
                </tr>
                <tr>
                    <td>Identifier</td>
                    <td>oolite.oxp.Thargoid.HiredGuns</td>
                    <td>oolite.oxp.Thargoid.HiredGuns</td>
                </tr>
                <tr>
                    <td>Title</td>
                    <td>Hired Guns</td>
                    <td>Hired Guns</td>
                </tr>
                <tr>
                    <td>Category</td>
                    <td>Weapons</td>
                    <td>Weapons</td>
                </tr>
                <tr>
                    <td>Author</td>
                    <td>Thargoid</td>
                    <td>Thargoid</td>
                </tr>
                <tr>
                    <td>Version</td>
                    <td>2.02</td>
                    <td>2.02</td>
                </tr>
                <tr>
                    <td>Tags</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Required Oolite Version</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Maximum Oolite Version</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Required Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Optional Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Conflict Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Information URL</td>
                    <td><a target="_blank" href="http://wiki.alioth.net/index.php/Hired_Guns_OXP">http://wiki.alioth.net/index.php/Hired_Guns_OXP</a></td>
                    <td><a target="_blank" href="">n/a</a></td>
                </tr>
                <tr>
                    <td>Download URL</td>
                    <td><a target="_blank" href="https://wiki.alioth.net/img_auth.php/c/ca/Oolite.oxp.Thargoid.HiredGuns.oxz">https://wiki.alioth.net/img_auth.php/c/ca/Oolite.oxp.Thargoid.HiredGuns.oxz</a></td>
                    <td><a target="_blank" href="http://wiki.alioth.net/img_auth.php/c/ca/Oolite.oxp.Thargoid.HiredGuns.oxz">http://wiki.alioth.net/img_auth.php/c/ca/Oolite.oxp.Thargoid.HiredGuns.oxz</a></td>
                </tr>
                <tr>
                    <td>License</td>
                    <td>Creative Commons Attribution - Non-Commercial - Share Alike 3.0 license with clauses - see readme file</td>
                    <td>Creative Commons Attribution - Non-Commercial - Share Alike 3.0 license with clauses - see readme file</td>
                </tr>
                <tr>
                    <td>File Size</td>
                    <td>n/a</td>
                </tr>
                <tr>
                    <td>Upload date</td>
                    <td>1610873473</td>
                </tr>
            </table>
                </a>

        <a name="documentation">
        <h2>Documentation</h2>
        <p>Also read <a href='http://wiki.alioth.net/index.php/Hired%20Guns'>http://wiki.alioth.net/index.php/Hired%20Guns</a></p>
        <h3>Hired Guns v2 ReadMe &amp; License.txt</h3>
        <pre>==================================================================

Hired Guns OXP by Thargoid, modified by UK_Eliter

[Nearly all of what follows in this file was written by Thargoid.]

==================================================================

A small OXP that selectively offers the player a chance to hire a pair of escort ships for a single journey (from main station in one system to the main station of another one, via whatever route). The ships will follow you through space, and will fight along side you against any alien or hostile vessels that you may encounter. 

The type of ship available as an escort will depend on the tech level of the system, and better ships command a higher hiring fee.

--------------------------------------------------------------

Conditions of the hire contract (small print):

* Escort will only be offered to commanders of a good standing and with a clean criminal record.
* This is not a babysitting service, only commanders of at least Average rank will be offered contract terms.
* Availability of escort ships for hire is not guaranteed, although the chances are better for more lawful government systems.
* This service only available at the main system station.
* Once hired, escorts will serve until you reach the station aegis of any other main station than the one you hired them from.
* Jumping into a new galaxy will void this contract, any hired escorts will not follow.
* The type of ship available as an escort will depend on the tech level of the system they are hired in.
* The escorts will work with the commander under their orders (unless they deem them to be illegal or immoral). 
* Any combat kills and bounty are transferred to the hirer, as is responsibility for any legal ramifications that may arise.

--------------------------------------------------------------

License:

This OXP is released under the Creative Commons Attribution - Non-Commercial - Share Alike 3.0 license with the following clauses:

* Whilst you are free (and encouraged) to re-use any of the scripting, models or texturing in this OXP, the usage must be distinct from that within this OXP. Unique identifiers such as (but not limited to) unique shipdata.plist entity keys, mission variables, script names (this.name), equipment identity strings (EQ_), description list arrays and entity roles must not be re-used without prior agreement. Basically if it&#39;s unique or would identify or overwrite anything in the original OXP, then you may not re-use it (for obvious compatibility reasons).
* rebundling of this OXP within another distribution is permitted as long as it is unchanged. The following derivates however are permitted and except from the above:
	* the conversion of files between XML and openStep.
	* the merging of files with other files of the same type from other OXPs.
* The license information (either as this file or merged into a larger one) must be included in the OXP.
* Even though it is not compulsory, if you are re-using any sizable or recognisable piece of this OXP, please let me know :) (where &#39;me&#39; now means: UK_Eliter).

--------------------------------------------------------------

Instructions:

Unzip the file, and then move the folder &quot;Hired Guns 1.26.oxp&quot; to the AddOns directory of your Oolite installation. Then start the game up whilst holding down the shift key (until the spinning Cobra Mk III screen appears).

--------------------------------------------------------------

Version history:

09/04/2009 - Version 1.00, Initial release.
01/09/2009 - Version 1.10, script tweak to be compatible with Oolite 1.73.
13/04/2010 - Version 1.20, script change to use 1.74 code (now incompatible with &lt;1.74) - ships are yellow on scanner.
05/07/2010 - Version 1.21, small script tweak to prevent breaking constrictor mission if escort kills it.
19/07/2010 - Version 1.22, another small adjustment to make escorts ignore derelicts (to stop salvage missile misunderstandings).
05/09/2010 - Version 1.23, added check during combat for targets ejecting. If so (if target becomes a derelict) then break off the combat.
13/02/2011 - Version 1.24, removal of upper limit, to allow running with 1.75.
19/02/2011 - Version 1.25, lollipop tweak.
29/01/2012 - Version 1.26, stop player cheating by using HG&#39;s to shoot inanimate objects.
21/09/2018 - Version 1.3: implemented attempts to reduce the frequency at which the escorts kill themselves via collision.
09/05/2019 - Version 2.0: small bug fixes; the escorts now behave more intelligently; other, miscellaneous small improvements. This version of the expansion pack requires version &gt;= 1.79 of Oolite.

--------------------------------------------------------------

Acknowledgements:

The escort AI is based on the private escort hire ship AI from UPS courier OXP, by Eric Walch.
UK_Eliter thanks phkb and rustem for the code and advice that they provided.
</pre>
        </a>

        <a name="equipment">          
        <h2>Equipment</h2>
            <table>
                <tr>
                    <th>Name</th>
                    <th>Visible</th>
                    <th>Cost [deci-credits]</th>
                    <th>Tech-Level</th>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_HIREDGUN_HIGH.html">Hire Escorts</a></td>
                    <td>yes</td>
                    <td align="right">15000</td>
                    <td align="center">4+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_HIREDGUN_LOW.html">Hire Escorts</a></td>
                    <td>yes</td>
                    <td align="right">7500</td>
                    <td align="center">4+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_HIREDGUN_MID.html">Hire Escorts</a></td>
                    <td>yes</td>
                    <td align="right">10000</td>
                    <td align="center">4+</td>
                </tr>
            </table>
        </a>

        <a name="ships">    
        <h2>Ships</h2>
            <table>
                <tr>
                    <th>Name</th>
                </tr>
                <tr>
                    <td><a href="../ships/hiredGuns_escortHigh.html">Hired Escort</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/hiredGuns_escortLow.html">Hired Escort</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/hiredGuns_escortMid.html">Hired Escort</a></td>
                </tr>
            </table>
        </a>

        <a name="models">    
        <h2>Models</h2>
            This expansion declares no models. This may be related to warnings.
        </a>

        <a name="scripts">    
        <h2>Scripts</h2>
            <table>
                <tr>
                    <th>Path</th>
                </tr>
                <tr>
                    <td valign="top">Scripts/hiredGuns_escort.js</td>
                    <td><pre>/*
=================================
HEADER
=================================
*/

this.name					= &quot;hiredGuns_escort&quot;;
this.author					= &quot;Thargoid&quot;;
this.copyright				= &quot;Creative Commons: attribution, non-commercial, sharealike.&quot;;
this.description			= &quot;AI-actions script for the escorts to the player ship&quot;;
this.version				= &quot;1.1&quot;;

/*
============================
Start of wrapper for JSHINT
============================
*/

(
	function (){


/*
============================
DIRECTIVE
============================
*/

&quot;use strict&quot;;

/*
========
GLOBALS
========
*/

this.debug = false; 					// There is a &#39;this.debug&#39; also in hiredGuns_system.js.

var consoleDebugMessages;
if (this.debug === true) {
	this.logging = true;
	consoleDebugMessages = true;
}
else {
	consoleDebugMessages = false;		// This does need setting to something, even when debugging is off.
}


/*
=========
FUNCTIONS
=========
*/

/*
--------------
Debugging
--------------
*/

this.$dbg = function(msg)
{
	log(this.name,&quot;DEBUG: &quot; + msg);
};


/*
--------------
Event handlers
--------------
*/

this.shipSpawned = function ()
{
	if (this.debug) {
		this.ship.reportAIMessages = true;
		this.$dbg(&quot;Debugging ON&quot;);
	}

	// Initialise an important global variable
	this.shipStats = {};

	// Assign &#39;sensitivity&#39; and heat insulation to the ship.
	var r = Math.random();
	if (this.ship.hasRole(&quot;hiredGuns_escortHigh&quot;)) {
		if (r &lt; 0.3) {
			this.shipPrudence = 1.25;
		}
		else if (r &lt; 0.6) {
			this.shipPrudence = 1.2;
		}
		else {
			this.shipPrudence = 1.15;
		}
		this.ship.heatInsulation = 2.5; // Speeds of the escorts mean they will get hot.
	}
	else {
		if (r &lt; 0.2) {
			this.shipPrudence = 1.2;
		}
		else if (r &lt; 0.4) {
			this.shipPrudence = 1.05;
		}
		else {
			this.shipPrudence = 1;
		}
		this.ship.heatInsulation = 2;
	}
	if (this.debug) { this.$dbg(&quot;heatInsulation = &quot; + this.ship.heatInsulation); }
	delete this.shipSpawned;
};

this.shipTargetDestroyed = function(target)
{
	// Just in case an escort kills the constrictor, let&#39;s not break the mission for the player...
	if (target.primaryRole == &quot;constrictor&quot; &amp;&amp; missionVariables.conhunt &amp;&amp; missionVariables.conhunt == &quot;STAGE_1&quot;) {
		missionVariables.conhunt = &quot;CONSTRICTOR_DESTROYED&quot;;
	}
	if (target.isRock || target.isBoulder || target.isCargo || target.isDerelict || target.isWeapon) {
		return;
	}
	player.score += 1;
	player.credits += target.bounty;
	player.consoleMessage(&quot;Escort kill - &quot; + target.name + &quot; : &quot; + target.bounty + &quot;â‚¢ awarded.&quot;, 5);
	log(&quot;Escort kill - &quot; + target.name + &quot; : &quot; + target.bounty);
};

this.shipDied = function(whom,why)
{
	if (whom &amp;&amp; whom.isValid) {
		player.commsMessage(&quot;Escort terminated.&quot;, 6);
	}
	missionVariables.hiredGuns_count -= 1;
};


/*
------------------------
Temperature AND altitude
------------------------
*/

this.$checkTemperatureOrAltitude = function ()
{
	if (this.debug) { this.$dbg(&quot;checkTemperatureOrAltitude&quot;); }
	// Anything to do?
	if (
		! this.ship || ! this.ship.isValid || (player.ship &amp;&amp; player.ship.isValid &amp;&amp; player.ship.docked === true)
		) {
		if (this.debug) { this.$dbg(&quot;Nothing to do&quot;); }
		this.ship.reactToAIMessage(&quot;PROCEED&quot;);
		return;
	}
	this.$setShipStats();
	if (Math.random() &lt; 0.5) {
		this.$checkTemperature();
	}
	else {
		this.$checkAltitude();
	}
};

/*
----------------------
Temperature
----------------------
*/

// This function or its children must tell the AI to STALL or FLEE or else PROCEED.
// Needs this.$setShipStats() to have been called already.
this.$checkTemperature = function ()
{
	if (this.debug) { this.$dbg(&quot;checkTemperature&quot;); }
	var escortTemperature = this.ship.temperature;
	if (this.debug) { this.$dbg(&quot;temperature_timed: escortTemperature = &quot; + escortTemperature); }
	if (escortTemperature &lt; 0.6) {
		if (this.debug) { this.$dbg(&quot;temperature - below threshold&quot;); }
		this.ship.reactToAIMessage(&quot;PROCEED&quot;);
		return;
	}
	if (escortTemperature &gt; 0.85) { 
		this.$temperature_veryHigh();
	}
	else { this.$temperature_high(); }
};

this.$temperature_veryHigh = function ()
{
	var isHeadingInto;

	if (this.shipStats === null) {
		isHeadingInto = false;
	}
	else {
		isHeadingInto = this.shipStats.isHeadingInto;
	}

	var r = Math.random() * this.shipPrudence;

	if (this.debug) { this.$dbg(&quot;temperature_veryHigh&quot;); }

	if (isHeadingInto === true) {
		if (this.debug) { this.$dbg(&quot;Heading is TOWARDS body; action is ..&quot;); }
		if (r &lt; 0.1) {
			if (this.debug) { this.$dbg(&quot;.. none&quot;); }
			this.ship.reactToAIMessage(&quot;PROCEED&quot;);
		} else if (r &lt; 0.35) {
			if (this.debug) { this.$dbg(&quot;.. message&quot;); }
			this.$temperature_veryHigh_messaging();
			this.ship.reactToAIMessage(&quot;PROCEED&quot;);
		}
		else if (r &lt; 0.6) {
			if (this.debug) { this.$dbg(&quot;..flee&quot;); }
			this.$flee();
		}
		else {
			if (this.debug) { this.$dbg(&quot;..message and flee&quot;); }
			this.$flee();
			this.$temperature_veryHigh_messaging();
		}
	}
	else {
		if (this.debug) { this.$dbg(&quot;Heading is AWAY from body; action is ..&quot;); }
		if (r &lt; 0.1) {
			if (this.debug) { this.$dbg(&quot;.. none&quot;); }
			this.ship.reactToAIMessage(&quot;PROCEED&quot;);
		} else if (r &lt; 0.35) {
			if (this.debug) { this.$dbg(&quot;.. message&quot;); }
			this.$temperature_veryHigh_messaging();
			this.ship.reactToAIMessage(&quot;PROCEED&quot;);
		}
		else if (r &lt; 0.6) {
			if (this.debug) { this.$dbg(&quot;..flee&quot;); }
			this.$flee();
		}
		else {
			if (this.debug) { this.$dbg(&quot;..message and flee&quot;); }
			this.$flee();
			this.$temperature_veryHigh_messaging();
		}
	}
};

this.$temperature_high = function ()
{
	var isHeadingInto;

	if (this.shipStats === null) {
		isHeadingInto = false;
	}
	else {
		isHeadingInto = this.shipStats.isHeadingInto;
	}

	var r = Math.random() * this.shipPrudence;

	if (this.debug) { this.$dbg(&quot;.. temperature_high&quot;); }

	if (isHeadingInto === true) {
		if (this.debug) { this.$dbg(&quot;Heading is TOWARDS body; action is ..&quot;); }
		if (r &lt; 0.2) {
			if (this.debug) { this.$dbg(&quot;.. none&quot;); }
			this.ship.reactToAIMessage(&quot;PROCEED&quot;);
		} else if (r &lt; 0.3) {
			// Do message only
			this.$temperature_high_messaging();
			if (this.debug) { this.$dbg(&quot;.. message&quot;); }
			this.ship.reactToAIMessage(&quot;PROCEED&quot;);
		}
		else if (r &lt; 0.45) {
			if (this.debug) { this.$dbg(&quot;.. stall&quot;); }
			this.ship.reactToAIMessage(&quot;STALL&quot;);
		}
		else {
			if (this.debug) { this.$dbg(&quot;message and stall&quot;); }
			this.$temperature_high_messaging();
			this.ship.reactToAIMessage(&quot;STALL&quot;);
		}
	}
	else {
		if (this.debug) { this.$dbg(&quot;Heading is AWAY from body; action is ..&quot;); }
		if (r &lt; 0.6) {
			if (this.debug) { this.$dbg(&quot;.. none&quot;); }
			this.ship.reactToAIMessage(&quot;PROCEED&quot;);
		} else {
			this.$temperature_high_messaging();
			if (this.debug) { this.$dbg(&quot;.. message&quot;); }
			this.ship.reactToAIMessage(&quot;PROCEED&quot;);
		}
	}
};


/*
----------------------
Altitude
----------------------
*/

// This function or its children must tell the AI to STALL or FLEE or else PROCEED.
// Needs this.$setShipStats() to have been called already (but check that variable here).
this.$checkAltitude = function ()
{
	if (this.debug) { this.$dbg(&quot;checkAltitude&quot;); }
	if (this.shipStats === null) {
		if (this.debug) { this.$dbg(&quot;.. no celestial bodies&quot;); }
		this.ship.reactToAIMessage(&quot;PROCEED&quot;);
		return;
	}
	if (this.shipStats.altitude &lt; 8150) { this.$altitude_veryLow(); }
	else if (this.shipStats.altitude &lt; 17500) { this.$altitude_low(); }
	else {
		if (this.debug) { this.$dbg(&quot;.. altitude above thresholds i.e. is OK&quot;); }
		this.ship.reactToAIMessage(&quot;PROCEED&quot;);
	}
};

this.$altitude_veryLow = function ()
{
	var isHeadingInto = this.shipStats.isHeadingInto;
	var r = Math.random() * this.shipPrudence;

	if (this.debug) { this.$dbg(&quot;.. altitude_veryLow&quot;); }
	
	if (isHeadingInto === true) {
		if (this.debug) { this.$dbg(&quot;Heading is TOWARDS body; action is ..&quot;); }
		if (r &lt; 0.06) {
			if (this.debug) { this.$dbg(&quot;.. none&quot;); }
			this.ship.reactToAIMessage(&quot;PROCEED&quot;);
		}
		else if (r &lt; 0.25) {
			this.$altitude_low_messaging();
			if (this.debug) { this.$dbg(&quot;.. send message&quot;); }
			this.ship.reactToAIMessage(&quot;PROCEED&quot;);
		}
		else if (r &lt; 0.5) {
			if (this.debug) { this.$dbg(&quot;.. stall&quot;); }
			this.ship.reactToAIMessage(&quot;STALL&quot;);
		}
		else if (r &lt; 0.85) {
			// Flee with message
			if (this.debug) { this.$dbg(&quot;.. message and flee&quot;); }
			this.$flee();
			this.$altitude_low_messaging();
		}
		else {
			// Flee without message
			if (this.debug) { this.$dbg(&quot;.. flee&quot;); }
			this.$flee();
		}
	}
	else {
		if (this.debug) { this.$dbg(&quot;Heading is NOT towards body&quot;); }
		if (r &lt; 0.15) {
			if (this.debug) { this.$dbg(&quot;.. none&quot;); }
			this.ship.reactToAIMessage(&quot;PROCEED&quot;);
		}
		else if (r &lt; 0.45) {
			this.$altitude_low_messaging();
			if (this.debug) { this.$dbg(&quot;.. send message&quot;); }
			this.ship.reactToAIMessage(&quot;PROCEED&quot;);
		}
		else if (r &lt; 0.9) {
			// Flee with message
			if (this.debug) { this.$dbg(&quot;.. message and flee&quot;); }
			this.$flee();
			this.$altitude_low_messaging();
		}
		else {
			// Flee without message
			if (this.debug) { this.$dbg(&quot;.. flee&quot;); }
			this.$flee();
		}
	}
};

this.$altitude_low = function ()
{
	var isHeadingInto = this.shipStats.isHeadingInto;
	var r = Math.random() * this.shipPrudence;

	if (this.debug) { this.$dbg(&quot;.. altitude_low&quot;); }

	// r = 1; // TEST
	if (isHeadingInto === true) {
		if (this.debug) { this.$dbg(&quot;Heading is TOWARDS body; action is ..&quot;); }
		if (r &lt; 0.15) {
			if (this.debug) { this.$dbg(&quot;.. none&quot;); }
			this.ship.reactToAIMessage(&quot;PROCEED&quot;);
			return;
		} else if (r &lt; 0.3) {
			// Do message only
			this.$altitude_low_messaging();
			if (this.debug) { this.$dbg(&quot;.. message&quot;); }
			this.ship.reactToAIMessage(&quot;PROCEED&quot;);
		}
		else if (r &lt; 0.45) {
			if (this.debug) { this.$dbg(&quot;.. stall&quot;); }
			this.ship.reactToAIMessage(&quot;STALL&quot;);
		}
		else {
			this.$altitude_low_messaging();
			if (this.debug) { this.$dbg(&quot;message and stall&quot;); }
			this.ship.reactToAIMessage(&quot;STALL&quot;);
		}
	}
	else {
		if (this.debug) { this.$dbg(&quot;Heading is NOT towards body; action is ..&quot;); }
		if (r &lt; 0.6) {
			if (this.debug) { this.$dbg(&quot;.. none&quot;); }
			this.ship.reactToAIMessage(&quot;PROCEED&quot;);
		} else {
			this.$altitude_low_messaging();
			if (this.debug) { this.$dbg(&quot;.. message&quot;); }
			this.ship.reactToAIMessage(&quot;PROCEED&quot;);
		}
	}
};


/*
----------------------
Altitude and temperature
(lower-level routines)
----------------------
*/

this.$altitudeOverPlanetaryBody = function $altitudeOverPlanetaryBody(body, ship)
{
	var shippos = ship.position;
	if (!shippos) return -1;
	return shippos.distanceTo(body) - body.radius - ship.collisionRadius;
};

// Gets:
// the escort ship&#39;s distance from nearest celestial body;
// what type of body that nearest one is;
// whether the *player* is heading into or away from the body.
this.$setShipStats = function ()
{
	var alt;
	var bodyType = null;
	var closest = null;
	var deviation = 1;
	var ent = [];
	var isHeadingInto = false;
	var ship = this.ship;
	var smallest = -1;
	var l;

	if (system.isInterstellarSpace === false &amp;&amp; system.sun) ent.push(system.sun);
	ent = ent.concat(system.planets);
	l = ent.length;
	if (l === 0) {
		this.shipStats = null;
		if (this.debug) {
			this.$dbg(&quot;Are no celestial bodies&quot;);
		}
	}
	else {
		for (var i = 0; i &lt; l; i++) {
			alt = this.$altitudeOverPlanetaryBody(ent[i], ship);
			if (smallest === -1 || (alt != -1 &amp;&amp; alt &lt; smallest)) { smallest = alt; closest = ent[i]; }
		}
		if (closest) {
			bodyType = closest.toString().substring(1, 4);
			deviation = player.ship.vectorForward.angleTo(closest.position.subtract(player.ship.position));
			if ((deviation &lt; 0.2) &amp;&amp; (player.ship.speed &gt; 0)) {
				isHeadingInto = true;
			}
		}

		// Set globals
		this.shipStats.altitude = smallest;
		this.shipStats.body = closest;
		this.shipStats.bodyType = bodyType;
		this.shipStats.isHeadingInto = isHeadingInto;

		if (this.debug) {
			this.$dbg(&quot;this.shipStats.altitude = &quot;+this.shipStats.altitude);
			this.$dbg(&quot;this.shipStats.body = &quot;+this.shipStats.body);
			this.$dbg(&quot;this.shipStats.bodyType = &quot;+this.shipStats.bodyType);
			this.$dbg(&quot;this.shipStats.isHeadingInto = &quot;+this.shipStats.isHeadingInto);
		}
	}
};


/*
----------------------
Altitude &amp; temperature
- messaging
----------------------
*/

this.$altitude_low_messaging = function ()
{
	var		msg_main;
	var		msg_salutation;
	var		msg;
	var		picker;

	msg_salutation = this.$msg_getSalutation();

	// Determine main message
	picker = Math.ceil(Math.random() * 40);
	switch (picker) {
		case 1:		msg_main = &quot;Aren&#39;t we a bit low here?&quot;; break;
		case 2:		msg_main = &quot;Are you sure about this?&quot;; break;
		case 3:		msg_main = &quot;We are quite close to the surface!&quot;; break;
		case 4:		msg_main = &quot;Pull up?&quot;; break;
		case 5:		msg_main = &quot;Altitude low!&quot;; break;
		case 6:		msg_main = &quot;Low altitude!&quot;; break;
		case 7:		msg_main = &quot;I can&#39;t land on that!&quot;; break;
		case 8:		msg_main = &quot;Too low!&quot;; break;
		case 9:		msg_main = &quot;Too low?&quot;; break;
		case 10:	msg_main = &quot;We&#39;re getting a bit low.&quot;; break;
		case 11:	msg_main = &quot;We&#39;re rather low.&quot;; break;
		case 12:	msg_main = &quot;I&#39;m worried.&quot;; break;
		case 13:	msg_main = &quot;Aren&#39;t we rather low?&quot;; break;
		case 14:	msg_main = &quot;Are you entirely sure about this?&quot;; break;
		case 15:	msg_main = &quot;I am not so sure about this.&quot;; break;
		case 16:	msg_main = &quot;I suggest pulling up.&quot;; break;
		case 17:	msg_main = &quot;Altitude low.&quot;; break;
		case 18:	msg_main = &quot;Altitude low!&quot;; break;
		case 19:	msg_main = &quot;Altitude very low!&quot;; break;
		case 20:	msg_main = &quot;Altitude low!&quot;; break;
		case 21:	msg_main = &quot;Low altitude!&quot;; break;
		case 22:	msg_main = &quot;Low altitude!&quot;; break;
		case 23:	msg_main = &quot;Do we want to make friends with the ground?&quot;; break;
		case 24:	msg_main = &quot;I can&#39;t land on that!&quot;; break;
		case 25:	msg_main = &quot;Too low!&quot;; break;
		case 26:	msg_main = &quot;Pull up!&quot;; break;
		case 27:	msg_main = &quot;I don&#39;t like this.&quot;; break;
		case 28:	msg_main = &quot;Are you trying to land?&quot;; break;
		case 29:	msg_main = &quot;I feel we are a bit close.&quot;; break;
		case 30:	msg_main = &quot;This is cutting it a bit fine.&quot;; break;
		default:	msg_main = &quot;Altitude is low!&quot;; break;
	}
	this.$msg_assembleAndIssue(msg_salutation,msg_main);
};

this.$temperature_veryHigh_messaging = function ()
{
	var		msg_main;
	var		msg_salutation;
	var		msg;
	var		picker;

	msg_salutation = this.$msg_getSalutation();

	// Determine main message
	picker = Math.ceil(Math.random() * 27);
	switch (picker) {
		case 1:		msg_main = &quot;Aren&#39;t we getting very hot?&quot;; break;
		case 2:		msg_main = &quot;Are you entirely sure about this?&quot;; break;
		case 3:		msg_main = &quot;I am not at all sure about this.&quot;; break;
		case 4:		msg_main = &quot;You could fry an egg on my ship!&quot;; break;
		case 6:		msg_main = &quot;Temperature high!&quot;; break;
		case 7:		msg_main = &quot;High temperature!&quot;; break;
		case 8:		msg_main = &quot;Too hot!&quot;; break;
		case 9:		msg_main = &quot;I am getting very hot!&quot;; break;
		case 10:	msg_main = &quot;I&#39;m getting grilled!&quot;; break;
		case 11:	msg_main = &quot;Do we want to make cook ourselves?&quot;; break;
		case 12:	msg_main = &quot;I don&#39;t have enough temperature shielding!&quot;; break;
		case 13:	msg_main = &quot;Too hot!&quot;; break;
		case 14:	msg_main = &quot;Too hot!&quot;; break;
		case 15:	msg_main = &quot;Let&#39;s get out of here!&quot;; break;
		case 16:	msg_main = &quot;I don&#39;t like this.&quot;; break;
		case 17:	msg_main = &quot;Temperature high!&quot;; break;
		case 18:	msg_main = &quot;I&#39;m going to explode!&quot;; break;
		case 19:	msg_main = &quot;I&#39;m worried.&quot;; break;
		case 20:	msg_main = &quot;This is cutting it rather fine.&quot;; break;
		default:	msg_main = &quot;Temperature very high!&quot;; break;
	}
	this.$msg_assembleAndIssue(msg_salutation,msg_main);
};

this.$temperature_high_messaging = function ()
{
	var		msg_main;
	var		msg_salutation;
	var		msg;
	var		picker;

	if (this.debug) {
		this.$dbg(&quot;temperature_high_messaging&quot;);
	}

	msg_salutation = this.$msg_getSalutation();

	// Determine main message
	picker = Math.ceil(Math.random() * 20);
	switch (picker) {
		case 1:		msg_main = &quot;Aren&#39;t we getting a bit hot here?&quot;; break;
		case 2:		msg_main = &quot;Are you sure about this?&quot;; break;
		case 3:		msg_main = &quot;This is toasty!&quot;; break;
		case 4:		msg_main = &quot;You might want to go somewhere cooler!&quot;; break;
		case 5:		msg_main = &quot;Temperature high!&quot;; break;
		case 6:		msg_main = &quot;The temperature is high!&quot;; break;
		case 7:		msg_main = &quot;My temperature shielding isn&#39;t that great.&quot;; break;
		case 8:		msg_main = &quot;Is this in the contract?&quot;; break;
		case 9:		msg_main = &quot;High temperature!&quot;; break;
		case 10:	msg_main = &quot;Are you watching the temperature?&quot;; break;
		case 11:	msg_main = &quot;Too hot?&quot;; break;
		case 12:	msg_main = &quot;Should we get out of here?&quot;; break;
		case 13:	msg_main = &quot;We&#39;re getting a bit hot.&quot;; break;
		case 14:	msg_main = &quot;Er, it&#39;s a bit hot.&quot;; break;
		case 15:	msg_main = &quot;It&#39;s hot here!&quot;; break;
		default:	msg_main = &quot;High temperature!&quot;; break;
	}
	this.$msg_assembleAndIssue(msg_salutation,msg_main);
};

/*
----------------------
Altitude &amp; temperature
- Fleeing actions
----------------------
*/

this.$flee = function ()
{
	if (! this.ship || ! this.ship.isValid) { return; }
	if (this.shipStats === null) {
		var position = new Vector3D(ps);
		var x = Math.random() * 5000; var y = Math.random() * 5000; var z = Math.random() * 5000;
		position = this.ship.position.add([x, y, z]);
		this.ship.destination = position;
	}
	else {
		this.ship.destination = this.$positionAwayFromEntity(this.ship,this.shipStats.body);
	}
	this.ship.reactToAIMessage(&quot;FLEE&quot;);
};

// This function is called by the AI.
this.$flee_stage2 = function ()
{
	if (! this.ship || ! this.ship.isValid) { return; }
	// var range = 15000 + Math.ceil(Math.random() * 10000);
	// this.ship.desiredRange = this.shipStats.body.radius + this.shipStats.altitude + range;
	// this.ship.target = null;

	// NB: desiredRange is from the point being fled *to*; see also $positionAwayFromEntity.
	if (this.shipStats.bodyType === &quot;Sun&quot;) {
		// SUN
		this.ship.desiredRange = Math.ceil(Math.random() * 10000);
		this.ship.desiredSpeed = this.ship.maxSpeed * 7;
	} else
	{
		// PLANET
		this.ship.desiredRange = 16000;
		// If fleeing planet, need not go as far away as when fleeing sun.
		// Also, if send ship too far away, it might use injectors to get back, and crash.
		if (Math.random() &lt; 0.7) {
			this.ship.desiredSpeed = this.ship.maxSpeed * 0.5;
		} else {
			this.ship.desiredSpeed = this.ship.maxSpeed;
		}
		// Less need with planet for speed and also high speed in atmosphere raises heat.
	}
	this.ship.performFlyToRangeFromDestination();
};

// returns a position that&#39;s the same distance as between the ship and the entity, but in the opposite direction
// (and with some randomisation of position). 
this.$positionAwayFromEntity = function $positionAwayFromEntity(ship, entity) {
	return Vector3D.interpolate(ship.position.add(Vector3D.random(10E3)), entity.position, -1);
};


/*
--------------
AI, Misc.
--------------
*/

this.$locatePlayer = function ()
{
	this.playerArray = system.shipsWithPrimaryRole(&quot;player&quot;);
	if (this.playerArray.length &gt; 0) {
		this.ship.target = this.playerArray[0];
		this.ship.reactToAIMessage(&quot;PLAYER_FOUND&quot;);
	}
};

this.$checkPlayerDistance = function ()
{
	if (!player.ship){ return; }
	this.playerDistance = this.ship.position.distanceTo(player.ship.position);
	// If the escort is more than 2 scanner ranges from the player, move it just off-scanner.
	if (this.playerDistance &gt; 51200) {
		var playerDirection = player.ship.position.subtract(this.ship.position).direction(); 
		var newPosition = player.ship.position.subtract(playerDirection.multiply(30000));
		this.ship.position = newPosition;
		this.ship.reactToAIMessage(&quot;PLAYER_MID&quot;);
		return;
	}

	if (this.playerDistance &lt; 25600) {
		this.ship.reactToAIMessage(&quot;PLAYER_NEAR&quot;);
	}
	else {
		if (this.playerDistance &gt; 38400 || player.ship.speed &gt; 2000) {
			this.ship.reactToAIMessage(&quot;PLAYER_FAR&quot;);
		}
		else {
			this.ship.reactToAIMessage(&quot;PLAYER_MID&quot;);
		}
	}
};

this.$combatCheck = function ()
{
	if (this.ship.target &amp;&amp; this.ship.target.isDerelict) {
		this.ship.target = null;
		this.ship.reactToAIMessage(&quot;TARGET_EJECTED&quot;);
	}
	this.playerDistance = this.ship.position.distanceTo(player.ship.position);
	// If the escort is more than 2 scanner ranges from the player, break off combat
	if (this.playerDistance &gt; 51200) {
		this.ship.AIState = &quot;LOCATE_PLAYER&quot;;
	}
	else {
		this.ship.reactToAIMessage(&quot;ENEMY_FIRE&quot;);
	}
};

this.$isHostileToPlayer = function(entity) 
{
	return (entity.isThargoid || (entity.isShip &amp;&amp; entity.target &amp;&amp; entity.target == player.ship &amp;&amp; entity.hasHostileTarget &amp;&amp; !entity.isDerelict));
};

this.$findPlayerHostiles = function ()
{
	if (this.ship.target == player.ship &amp;&amp; player.ship.target &amp;&amp; player.ship.target.bounty &gt; 2) {
		this.ship.target = player.ship.target;
		this.ship.reactToAIMessage(&quot;HOSTILE_FOUND&quot;);
	}
	else {
		var targets = system.filteredEntities(this, this.$isHostileToPlayer, this.ship, this.ship.scannerRange);
		if (targets.length &gt; 0) {
			this.ship.target = targets[0];
			this.ship.reactToAIMessage(&quot;HOSTILE_FOUND&quot;);
		}
		else {
			this.ship.reactToAIMessage(&quot;NO_HOSTILE_FOUND&quot;);
		}
	}
};

this.$fireCheck = function ()
{
	if ((this.ship.target.hasRole(&quot;hiredGuns_escort&quot;)) || (player.ship.target == this.ship &amp;&amp; this.ship.target.isPlayer)) {
		this.ship.reactToAIMessage(&quot;FRIENDLY_FIRE&quot;);
	}
	else {
		this.ship.reactToAIMessage(&quot;ENEMY_FIRE&quot;);
	}
};

this.$switchID = function ()
{
	this.ship.switchAI(&quot;route1patrolAI.plist&quot;);
	this.ship.displayName = &quot;Bounty Hunter&quot;;
	this.ship.primaryRole = &quot;hunter&quot;;
	log(&quot;Hired escort switched to bounty hunter role&quot;);
};

/*
---------------
Misc messaging
---------------
*/

this.$greetPlayer_probably = function ()
{
	if (this.debug) { this.$greetPlayer_core(); return ; }
	if (Math.random() &lt; 0.9) { this.$greetPlayer_core(); }
};

this.$greetPlayer_perhaps = function ()
{
	if (this.debug) { this.$greetPlayer_core(); return ; }
	if (Math.random() &lt; 0.6) { this.$greetPlayer_core(); }
};

this.$greetPlayer_core = function ()
{
	var chance_interstellar = 0.7;
	var chance_stellar = 0.7;
	var length;
	var	msg;
	var	msg_main;
	var	msg_salutation;
	var	picker;
	var isInterstellarSpace;

	if (system.isInterstellarSpace === true) {
		isInterstellarSpace = true;
	} else {
		isInterstellarSpace = false;
	}

	if (isInterstellarSpace === true &amp;&amp; Math.random() &lt; 0.7) {
		// *Interstellar space*

		msg_salutation = this.$msg_getSalutation();

		// Determine main message
		picker = Math.ceil(Math.random() * 20);
		switch (picker) {
			case 1:		msg_main = &quot;Er, where to?&quot;; break;
			case 2:		msg_main = &quot;Are you sure about this?&quot;; break;
			case 3:		msg_main = &quot;Er, Thargoids?&quot;; break;
			case 4:		msg_main = &quot;I don&#39;t like the look of this.&quot;; break;
			case 5:		msg_main = &quot;This could get hairy ..&quot;; break;
			case 6:		msg_main = &quot;Welcome to interstellar space!&quot;; break;
			case 7:		msg_main = &quot;So this is .. where exactly?&quot;; break;
			case 8:		msg_main = &quot;Is this in the contract?&quot;; break;
			case 9:		msg_main = &quot;This is NOT in the contract.&quot;; break;
			case 10:	msg_main = &quot;Should we get out of here?&quot;; break;
			case 11:	msg_main = &quot;Oh dear.&quot;; break;
			case 12:	msg_main = &quot;Uh oh.&quot;; break;
			case 13:	msg_main = &quot;Where you go, we follow.&quot;; break;
			case 14:	msg_main = &quot;We&#39;re in interstellar space!&quot;; break;
			case 15:	msg_main = &quot;I want to home.&quot;; break;
			case 16:	msg_main = &quot;Shall we get out of here?&quot;; break;
			default:	msg_main = &quot;Ready.&quot;; break;
		}
	}
	else {
		// *Normal* space (or just possibly interstellar)
		// Create message - using mostly Thargoids&#39;s original materials.

		msg_salutation = this.$msg_getSalutation();

		// Determine main message
		picker = Math.ceil(Math.random() * 11);
		switch (picker) {
			case 1:		msg_main = &quot;Reporting for duty.&quot;; break;
			case 2:		msg_main = &quot;Reporting for duty.&quot;; break;
			case 3:		msg_main = &quot;Forming up on your six.&quot;; break;
			case 4:		msg_main = &quot;Forming up on your six.&quot;; break;
			case 5:		msg_main = &quot;Where to?&quot;; break;
			case 6:		msg_main = &quot;Where to?&quot;; break;
			case 7:		msg_main = &quot;Ready.&quot;; break;
			case 8:		msg_main = &quot;Hello.&quot;; break;
			default:	msg_main = &quot;Greetings.&quot;; break;
		}
	}
	this.$msg_assembleAndIssue (msg_salutation,msg_main);
};


/*
--------------------
Low-level messaging
-------------------
*/

this.$str_deCapitalizeFirstLetter = function(string) {
	if (string.charAt(0) === &quot;I&quot;) {
		return string;
	}
	else {
		return string.charAt(0).toLowerCase() + string.slice(1);
	}
};

this.$str_prependSalutation = function(msg_salutation,msg_main)
{
	return msg_salutation + &quot;, &quot; + this.$str_deCapitalizeFirstLetter(msg_main);
};

this.$str_appendSalutation = function(msg_salutation,msg_main)
{
	var length = msg_main.length;
	var msg_lastCharOfMain = msg_main.charAt(length - 1);
	return msg_main.replace(/.$/,&quot;, &quot;) + msg_salutation + msg_lastCharOfMain;
};

this.$msg_getSalutation = function ()
{
	var	msg_salutation;

	var r = Math.ceil(Math.random() * 10);
	if (r &lt; 3) { msg_salutation = &quot;NONE&quot;; } else {
		switch (r) {
			case 3:		msg_salutation = &quot;Commander&quot;; break;
			case 4:		msg_salutation = &quot;Commander&quot;; break;
			case 5:		msg_salutation = &quot;Captain&quot;; break;
			case 6:		msg_salutation = &quot;Sir&quot;; break;
			case 7:		msg_salutation = &quot;Chief&quot;; break;
			case 8:		msg_salutation = &quot;Chief&quot;; break;
			default:	msg_salutation = &quot;Boss&quot;; break;
		}
	}
	return msg_salutation;
};


this.$msg_assembleAndIssue = function (msg_salutation,msg_main)
{
	var msg;

	switch (msg_salutation) {
		case &quot;NONE&quot;:
			msg = msg_main;
			break;
		default:
			if ( Math.random() &lt; 0.5 ) {
				msg = this.$str_prependSalutation(msg_salutation,msg_main);
			} else {
				msg = this.$str_appendSalutation(msg_salutation,msg_main);
			}
			break;
	}
	if (this.debug) {
		this.$dbg(&quot;msg_salutation = &quot; + msg_salutation);
		this.$dbg(&quot;msg_main = &quot; + msg_main);
		this.$dbg(&quot;msg = &quot; + msg);
	}
	// Issue message
	this.ship.commsMessage(msg, player.ship);
};

/*
=========================
End of wrapper for JSHINT
=========================
*/

}).call(this);


// EOF
</pre></td>
                </tr>
                <tr>
                    <td valign="top">Scripts/hiredGuns_system.js</td>
                    <td><pre>/*
=================================
HEADER
=================================
*/

this.name					= &quot;hiredGuns_system&quot;;
this.author					= &quot;Thargoid&quot;;
this.copyright				= &quot;Creative Commons: attribution, non-commercial, sharealike.&quot;;
this.description			= &quot;Set up the player escorts when bought&quot;;
this.version				= &quot;1.1&quot;;


/*
===========================
Start of wrapper for JSHINT 
============================
*/

(
	function(){


/*
===========================
DIRECTIVE
===========================
*/

&quot;use strict&quot;;


/*
===========================
GLOBALS
===========================
*/

this.debug = false;				// There is a &#39;this.debug&#39; also in hiredGuns_system.js.

if ( this.debug === true ) {
	this.logging = true;
}



/*
===========================
FUNCTIONS
===========================
*/

/*
--------------
Debugging
--------------
*/

this.$dbg = function(msg)
{
	log(this.name,&quot;DEBUG: &quot; + msg);
};


this.startUp = function()
{
	missionVariables.hiredGuns_chance = Math.random() + (system.government * 0.05);
	// That value above is set also in this.shipExitedWitchspace.
	if ( this.debug ) {
		this.$dbg(&quot;Debugging ON&quot;);
	}
};

this.shipWillDockWithStation = function(station)
{
	if (!station.isMainStation) {
		return;
	}

	// Have we gone anywhere?
	if (system.ID == missionVariables.hiredGuns_launchSystem) {
		return;
	}

	var escortArray = system.shipsWithRole(&quot;hiredGuns_escort&quot;);
	if (escortArray.length &gt; 0) {
		for (var i = 0; i &lt; escortArray.length; i++) {
			escortArray[i].remove();
		}
	}
};

this.shipWillEnterWitchspace = function()
{
	var escortArray = system.shipsWithRole(&quot;hiredGuns_escort&quot;);
	if (escortArray.length &gt; 0) {
		for (var i = 0; i &lt; escortArray.length; i++) {
			escortArray[i].remove();
			missionVariables.hiredGuns_count += 1;
		}
	}
};

this.alertConditionChanged = function()
{
	if (player.alertCondition == 3 &amp;&amp; player.alertHostiles &amp;&amp; missionVariables.hiredGuns_purchased) {
		var escortArray = system.shipsWithRole(&quot;hiredGuns_escort&quot;, player.ship, 35000);
		if (escortArray.length &gt; 0)
		{
			for (var i = 0; i &lt; escortArray.length; i++) { 
				escortArray[i].AIState = (&quot;FIND_PLAYER_HOSTILES&quot;);
			}
		}
	}
};

this.shipExitedWitchspace = function()
{
	if (missionVariables.hiredGuns_count &gt; 0) {
		this.escorts = system.addShips(missionVariables.hiredGuns_role, missionVariables.hiredGuns_count, player.ship.position, 20000);
		for (var i = 0; i &lt; missionVariables.hiredGuns_count; i++) {
			this.escorts[i].scannerDisplayColor1 = &quot;yellowColor&quot;;
			this.escorts[i].scannerDisplayColor2 = &quot;magentaColor&quot;;
		}
	}
	missionVariables.hiredGuns_chance = Math.random() + (system.government * 0.05);
	missionVariables.hiredGuns_launchSystem = null; // in case we jump out and back to the same system.
	if ( this.debug &amp;&amp; system.isInterstellarSpace ) {
		this.$dbg(&quot;In interstellar space.&quot;);
	}
};

this.playerEnteredNewGalaxy = function(galaxyNumber)
{
	var escortArray = system.shipsWithRole(&quot;hiredGuns_escort&quot;);
	if (escortArray.length &gt; 0) {
		for (var i = 0; i &lt; escortArray.length; i++) {
			escortArray[i].remove();
		}
	}
	missionVariables.hiredGuns_count = 0;
	missionVariables.hiredGuns_role = null;
	missionVariables.hiredGuns_purchased = null;
	missionVariables.hiredGuns_launchSystem = null;
};

this.shipWillLaunchFromStation = function(station)
{
	if (station.isMainStation &amp;&amp; system.countShipsWithRole(&quot;hiredGuns_escort&quot;) == 0 &amp;&amp; missionVariables.hiredGuns_count &gt; 0 &amp;&amp; missionVariables.hiredGuns_role) {
		this.escorts = system.addShips(missionVariables.hiredGuns_role, missionVariables.hiredGuns_count, player.ship.position, 20000);
		for (var i = 0; i &lt; missionVariables.hiredGuns_count; i++) { 
			this.escorts[i].scannerDisplayColor1 = &quot;yellowColor&quot;;
			this.escorts[i].scannerDisplayColor2 = &quot;magentaColor&quot;;
			this.escorts[i].AIState = &quot;INITIALISE_FROM_STATION&quot;;
		}
		this.removeEq();
	}
};

this.shipEnteredStationAegis = function(station)
{
	if (!this.ship || !this.ship.isValid) { return; }
	this.ship.addCollisionException(station);
	 // Only main stations have aegis, but just to be safe:
	if (!station.isMainStation) {
		return;
	}

	// Have we gone anywhere?
	if (system.ID == missionVariables.hiredGuns_launchSystem) {
		return;
	}

	if ( this.debug ) {
		this.$dbg(&quot;Mission accomplished - removing escorts.&quot;);
	}

	var escortArray = system.shipsWithRole(&quot;hiredGuns_escort&quot;);
	if (escortArray.length &gt; 0) {
		for (var i = 0; i &lt; escortArray.length; i++) { 
			escortArray[i].AIState = (&quot;MISSION_ACCOMPLISHED&quot;);
		}
	}
	missionVariables.hiredGuns_count = 0;
	missionVariables.hiredGuns_role = null;
	missionVariables.hiredGuns_purchased = null;
};

this.playerBoughtEquipment = function(equipment)
{
	switch(equipment) {
		case &quot;EQ_HIREDGUN_LOW&quot;:
		{
			missionVariables.hiredGuns_role = &quot;hiredGuns_escortLow&quot;;
			this.admin();
			player.ship.removeEquipment(&quot;EQ_HIREDGUN_LOW&quot;);
			break;
		}
		case &quot;EQ_HIREDGUN_MID&quot;:
		{
			missionVariables.hiredGuns_role = &quot;hiredGuns_escortMid&quot;;
			this.admin();
			player.ship.removeEquipment(&quot;EQ_HIREDGUN_MID&quot;);
			break;
		}
		case &quot;EQ_HIREDGUN_HIGH&quot;:
		{
			missionVariables.hiredGuns_role = &quot;hiredGuns_escortHigh&quot;;
			this.admin();
			player.ship.removeEquipment(&quot;EQ_HIREDGUN_HIGH&quot;);
			// break;
		}
	}
};

this.guiScreenChanged = function(newScreen, oldScreen)
{
	if (oldScreen == &quot;GUI_SCREEN_EQUIP_SHIP&quot;) {
		this.removeEq();
	}
};

this.removeEq = function()
{
	if (player.ship.equipmentStatus(&quot;EQ_HIREDGUN_LOW&quot;) != &quot;EQUIPMENT_UNAVAILABLE&quot;) {
		player.ship.removeEquipment(&quot;EQ_HIREDGUN_LOW&quot;);
		return;
	}
	if (player.ship.equipmentStatus(&quot;EQ_HIREDGUN_MID&quot;) != &quot;EQUIPMENT_UNAVAILABLE&quot;) {
		player.ship.removeEquipment(&quot;EQ_HIREDGUN_MID&quot;);
		return;
	}
	if (player.ship.equipmentStatus(&quot;EQ_HIREDGUN_HIGH&quot;) != &quot;EQUIPMENT_UNAVAILABLE&quot;) {
		player.ship.removeEquipment(&quot;EQ_HIREDGUN_HIGH&quot;);
		return;
	}
};

this.admin = function()
{
	missionVariables.hiredGuns_count = 2;
	missionVariables.hiredGuns_launchSystem = system.ID;
	missionVariables.hiredGuns_purchased = true;
};


/*
=========================
End of wrapper for JSHINT
=========================
*/

}).call(this);


// EOF</pre></td>
                </tr>
            </table>
        </a>
    </body>
</html>
