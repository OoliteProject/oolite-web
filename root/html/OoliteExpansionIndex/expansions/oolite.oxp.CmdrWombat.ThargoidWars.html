<html>
    <head>
        <title>Expansion Thargoid Wars</title>
        <link rel="stylesheet" href="../style.css">
    </head>
    <body>
        <table border="0" width="100%">
            <tr>
                <td>Back to <a href='../index.html'>Index</a></td>
                <td align="right"><small>Page generated: Oct 11, 2023, 3:16:48 PM</small></td>
            </tr>
        </table>

        <h1>Expansion Thargoid Wars</h1>

        <h2>Content</h2>
        <ul>
          <li><a href="#warnings">Warnings</a></li>
          <li><a href="#manifest">Manifest</a></li>
          <li><a href="#documentation">Documentation</a></li>
          <li><a href="#equipment">0 Equipment</a></li>
          <li><a href="#ships">2 Ships</a></li>
          <li><a href="#models">0 Models</a></li>
          <li><a href="#scripts">3 Scripts</a></li>
        </ul>

          <a name="warnings">
            <h2>Warnings</h2>
            <ol>
                <li>License not specified</li>
                <li>XML Manifest found</li>
                <li>Unknown key &#39;licence&#39; in XML manifest.plist</li>
            </ol>
          </a>

        <a name="manifest">
        <h2>Manifest</h2>
            <table border="1">
                <tr>
                    <th></th>
                    <th>from Expansion Manager's OXP list</th>
                    <th>from Expansion Manifest</th>
                </tr>
                <tr>
                    <td>Description</td>
                    <td>Adds several thargoid related missions in galaxy 2 and higher</td>
                    <td>Adds several thargoid related missions in galaxy 2 and higher</td>
                </tr>
                <tr>
                    <td>Identifier</td>
                    <td>oolite.oxp.CmdrWombat.ThargoidWars</td>
                    <td>oolite.oxp.CmdrWombat.ThargoidWars</td>
                </tr>
                <tr>
                    <td>Title</td>
                    <td>Thargoid Wars</td>
                    <td>Thargoid Wars</td>
                </tr>
                <tr>
                    <td>Category</td>
                    <td>Missions</td>
                    <td>Missions</td>
                </tr>
                <tr>
                    <td>Author</td>
                    <td>Cmdr. Wombat</td>
                    <td>Cmdr. Wombat</td>
                </tr>
                <tr>
                    <td>Version</td>
                    <td>4.6</td>
                    <td>4.6</td>
                </tr>
                <tr>
                    <td>Tags</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Required Oolite Version</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Maximum Oolite Version</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Required Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Optional Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Conflict Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Information URL</td>
                    <td><a target="_blank" href="http://wiki.alioth.net/index.php/Thargoid_Wars">http://wiki.alioth.net/index.php/Thargoid_Wars</a></td>
                    <td><a target="_blank" href="">n/a</a></td>
                </tr>
                <tr>
                    <td>Download URL</td>
                    <td><a target="_blank" href="https://wiki.alioth.net/img_auth.php/d/d6/ThargoidWars_4.6.oxz">https://wiki.alioth.net/img_auth.php/d/d6/ThargoidWars_4.6.oxz</a></td>
                    <td><a target="_blank" href="">n/a</a></td>
                </tr>
                <tr>
                    <td>License</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>File Size</td>
                    <td>n/a</td>
                </tr>
                <tr>
                    <td>Upload date</td>
                    <td>1610873479</td>
                </tr>
            </table>
                </a>

        <a name="documentation">
        <h2>Documentation</h2>
        <p>Also read <a href='http://wiki.alioth.net/index.php/Thargoid%20Wars'>http://wiki.alioth.net/index.php/Thargoid%20Wars</a></p>
        <h3>README.txt</h3>
        <pre>Thargoid Wars v.4.6

Written by Commander Wombat.

March, 2006 (Code patch added July 2007 &amp; January 2008 &amp; December 2008 &amp; November 2009 &amp; March 2010).
Updates after version 4.0 by Eric Walch

Description:

This expansion pack adds four types of encounters with Thargoids. The first is a Thargoid attack
on space stations. You choose whether or not to participate in the defense of the station.

The second involves encountering Thargoids when exiting witchspace. The third is a fairly deadly
encounter that you may want to have a military energy unit for. These three encounters occur randomly
with a fairly low probability. The fourth encounter involves increased efforts on the part of
the Thargoids to collect intelligence. The overall premise is that the ongoing war with the
Thargoids has intensified with the Thargoids launching attacks more frequently.

The expansion pack also adds a system of rewards from the Intergalactic Navy (pursuant to Naval
regulation 18756.23.70A) for your participation in the war with the Thargoids. The reward system
is based on the number of encounters you have with the Thargoids. Currently only the encounters
that arise from this expansion pack are included. Rewards include credits and a series of medals.

Note: I am not an artist. You will agree with that statement if / when you see the first medal.

Note that this expansion pack does not add Thargoid encounters in Galaxy 1. I did this because
you can meet up to three Thargoid battleships in a single encounter. This might be a bit much
for a novice Ooliteer.

Requirements:

Version 1.75 (or higher) of Oolite is required. This expansion pack won&#39;t work with earlier
versions since it takes advantage of some of the scripting features introduced in 1.75.

To Install:

Move the thargoid_wars.oxp file into the AddOns folder in your Oolite folder. The Oolite folder
is where the Oolite program resides. The thargoid_wars.oxp file is in the ThargoidWars folder
along with this README.txt file. DO NOT move the entire ThargoidWars folder into the AddOns
folder - you only need the thargoid_wars.oxp file. If you have the previous version of
thargoid_wars.oxp, either delete it before installing this one, or let this one overwrite the old
version.

For more information on oxp&#39;s, visit http://wiki.alioth.net/index.php/Oolite_Main_Page.
Or visit the discussion forum at: http://www.aegidian.org/bb/viewtopic.php?t=4129

Additional hint: When you want stronger thargoids to combat against, just install one or more
thargoid adding oxps like Thargorn_Threat.oxp.

Changes/Additions:

v.4.6 - (May 2014) Raised minimum Oolite to 1.75. The decoys are now random thargoid ships.

v.4.5.4 - (November 2011) Fixed a bug of not getting station attacks anymore. (Bug probably introduced in 4.5.1).

v.4.5.3 - (July 2011) Changed one code line after a rapport of a crash on the start of the station attack.
Not sure if this oxp was the cause, but better safe than sorry.

v.4.5.2 - (July 2011) Fixed a problem of continuous station attack messages.

v.4.5.1 - (January 2011) Changed a casing bug in JS that was ignored in older Oolites but would give
errors after Oolite 1.74.2

v.4.5 - (March, 2010) Raised minimum version to 1.74. Started using the new mission-page code.
Changed the way points are collected. Just being in the system together with thargoids is no
longer enough. Points are now only collected for killing them.

v.4.4 - (November, 2009) Code translated to Java Script. Will now run on Oolite 1.57 until 1.65 with
the old scripting and on Oolite 1.73 or newer with the new scripting. It won&#39;t do anything when used 
with intermediate Oolite versions.

v.4.3 - (December, 2008) Added a check for a previous mission choice being active. If it is, it will
not display the station attack message until the other oxp has cleared it. All oxp&#39;s should clear
this after reading it out. (But not all do).

v.4.2 - (January, 2008) Speed update. The original flat structure of the mission script is partitioned
into logical parts for speed optimisation during &quot;In flight&quot; conditions. In the old situation on
update-time with &quot;in flight&quot; situations, a minimum of 110 were conditions checked when there was
nothing to be done. This improved version can already after 5 checked conditions conclude that there
is nothing to be done with &quot;in flight&quot; situations. That is just 5.5% of the original evaluation time.
No functional changes.

Removed one bug where a commander who launches during a station-attack offer, without answering the
offer, would never get the offer again. Also added code that restarts this mission with old
save-files that contain this bugged data.

Removed a bug in the forced launch after a station-attack were the program tried to reset
the legal status to that before the jump. (In case the player had illegal cargo on board he
should not get punished) Because of the wrong use of &quot;expandable text&quot; it was not saving the
content of the variable but the name of the variable.
(Changes by Commander Eric Walch)

v.4.1 - (July, 2007) Code patch added to s top the Mission Clash Bug. A long standing problem with
Oolite Missions was that if two missions tried to give the player a briefing at the same time,
the player would miss one of them. For example you might be playing the Ionics Missions in
Galaxy 2 and Ionics tried to give you a briefing offering you a mission, but Thargoid Wars at
the same time decided to scramble you to defend the station against attacking Bugs. As a result
you never saw the Ionics briefing, and so although you now have a mission to do for the Ionics
Corperation, you are blissfully unaware of this fact as you never saw the message offering you
the mission!

This version of Thargoid Wars just adds a cunning code patch (devised by Commander Eric Walch).
If another OXP is giving the player a briefing, this version of Thargoid Wars will wait until
the player has seen the other briefing before displaying a Thargoid Wars briefing.

Other OXPers should take note, the fix is just to add &quot;gui_screen_string oneof GUI_SCREEN_STATUS,
GUI_SCREEN_EQUIP_SHIP, GUI_SCREEN_SHORT_RANGE_CHART&quot; as a condition to displaying
a mission briefing. That way your OXP won&#39;t put up a briefing if another OXP has
already &quot;bagged&quot; the mission screen and will wait until the player has seen the other briefing
before showing its briefing. Do use it, as then your OXP won&#39;t clash with anyone elses! 

It is important that you use this version of Thargoid Wars. As this OXP adds features to Galaxies
2 to 8, there are loads of other Missions that the old version could clash with (Assassins,
LoveCats, Ionics, Military, Nova and Thargoid Plans) to name but a few! 

v.4.0 - (March, 2006) Fixed bug where the station attacks occurred too often (thanks ArkanoiD and Rxke).
Also fixed minor bugs with other parts of the script. Added new encounter with the Thargoids.
This could be described as a &quot;furball&quot;.

v.3.0.1 - Fixed bug where a ship from the shipyard could end up displayed behind the mission
screen during a station attack. Thanks to Rxke and EAGLE 5 for identifying it, and to aegidian
for suggesting the fix.

v.3.0 - Fixed bug that led to potential changes in legal status during station attack.
Also fixed the bug (some would say feature) that awarded new commanders 1000cr. I have also
altered the placement of Thargoids during the station attack so that they will be in scanner
range more often (but certainly not always).

v.2.2 - The siren is back (as an Ogg Vorbis file) and works. In addition, I have added a delay
to the station attack alert. This is somewhat variable, although not totally random, and allows
the player a little time to trade, buy fuel etc. I have also added delays to the other encounters
to add to the &quot;realism&quot; factor.

v.2.1 - The original oxp included a mp3 file that has resulted in a bug now that Oolite has been
changed to use the Ogg Vorbis format. However, there are currently issues with the Oolite sound
code that result in an updated Ogg Vorbis version of the sound file not playing. For now I have
removed the sound file from the oxp until the sound issues can be resolved. Many thanks to
Ahruman for help with this issue and for supplying the updated sound file.

v.2.0 - This version adds two new types of encounter and decreases (a little) the number of
encounters required to gain medals (pursuant to Naval regulation 18756.23.70A addendum 17F).

Disclaimer:

Feel free to copy, share, alter, mutilate or do whatever you like with these scripts.
If there are elements you want to use in your own expansion packs, go right ahead. However,
selling or otherwise profiting from them is simply not on. Don&#39;t do it.

If you find any bugs, and there are sure to be some, please send me all the gory details in a
Private Message  to Cmdr. Wombat on the Oolite bulletin board. Alternatively, simply make a post
there detailing the problem. Note that I am in no way responsible for any clashes with existing
or future Oolite expansion packs, although this was play tested without issue on a Mac with most
of the expansion packs from Oosat (up to March 2006) installed and with Oolite version 1.63.

Updated Version playtested by LittleBear on PC 1.69.1 with all other OXPs installed (July 2007).
Should work fine!
</pre>
        </a>

        <a name="equipment">          
        <h2>Equipment</h2>
            This expansion declares no equipment. This may be related to warnings.
        </a>

        <a name="ships">    
        <h2>Ships</h2>
            <table>
                <tr>
                    <th>Name</th>
                </tr>
                <tr>
                    <td><a href="../ships/thargoid_wars_radar.html">Thargoid Satellite Radar Dish</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/thargoid_wars_satellite.html">Thargoid Spy Satellite</a></td>
                </tr>
            </table>
        </a>

        <a name="models">    
        <h2>Models</h2>
            This expansion declares no models. This may be related to warnings.
        </a>

        <a name="scripts">    
        <h2>Scripts</h2>
            <table>
                <tr>
                    <th>Path</th>
                </tr>
                <tr>
                    <td valign="top">Scripts/thargoidWars.js</td>
                    <td><pre>&quot;use strict&quot;;
this.name        = &quot;thargoid_wars&quot;; 
this.author      = &quot;eric walch&quot;; 
this.copyright   = &quot;� 2008 Murgh.&quot;; 
this.description = &quot;script that brings the war to normal space&quot;; 
this.version     = &quot;4.6&quot;; 

// N.B. Works only with 1.75+.
this.startUp = function (){
    if (!missionVariables.thargoidwars_station_attack){
        if (!missionVariables.station_attack){ // backward compatibility with old name.
            this.initialise();
        } else {
            missionVariables.thargoidwars_station_attack = missionVariables.station_attack;
        }
    }
    this.medals = [&quot;NONE&quot;, &quot;BRONZE&quot;, &quot;SILVER&quot;, &quot;GOLD&quot;, &quot;CRYSTAL&quot;];
    this.medalNumber = this.medals.indexOf(missionVariables.thargoidwars_medal); // turn into number.
};

this.initialise = function (){
        missionVariables.thargoidwars_station_attack = &quot;INITIALISE&quot; ;
        missionVariables.thargoidwars_number = 0; 
        missionVariables.thargoidwars_medal_number = 0;
        missionVariables.thargoidwars_medal = &quot;NONE&quot;;

        // Initialise unused variables for backward compatibility in case someone plays with both versions.
        missionVariables.thargoid_ambush = &quot;IMPOSSIBLE&quot;;  // unused in JS
        missionVariables.thargoidwars_timer = 0; // unused in JS
        missionVariables.thargoidwars_timer_start = &quot;NO&quot;;  // unused in JS
        missionVariables.thargoidwars_ambush_timer = -1; // unused in JS
        missionVariables.thargoidwars_ambush_timer_start = &quot;NO&quot;; // unused in JS
        missionVariables.thargoidwars_satellite_timer = -1;  // unused in JS
        missionVariables.thargoidwars_satellite_timer_start = &quot;NO&quot;;  // unused in JS
};

this.shipDockedWithStation = function (station){
        this.justDocked = true;
};

this.missionScreenOpportunity = function (){
    if (player.ship.docked) this.missionOffers();
};

this.missionOffers = function (){
    if (player.ship.dockedStation.isMainStation){
        var stationAttack = missionVariables.thargoidwars_station_attack;
        var thargoidwarsNumber = missionVariables.thargoidwars_number;
        if (stationAttack === &quot;INITIALISE&quot; &amp;&amp; (missionVariables.thargplans === &quot;MISSION_COMPLETE&quot; || galaxyNumber &gt; 0) &amp;&amp;
                system.ID !== 36 &amp;&amp; Math.random() &lt; 0.2){
            mission.runScreen({
                title: &quot;Thargoid Wars&quot;,
                messageKey: &quot;thargoidwars_station_attack_inews&quot;,
                background: &quot;thargoid_wars_iNews.png&quot;
            });
            missionVariables.thargoidwars_station_attack = &quot;IMPOSSIBLE&quot; ;
        }

        if (stationAttack === &quot;ATTACKED&quot;){
            // the check: stationAttack === &quot;ATTACKED&quot; is only added to fix old saved games containing this value.
            this.anounceStationAttack();
        }
        
        if (stationAttack === &quot;IN_PROGRESS&quot;){
            if (!this.attackedSystem || this.attackedSystem !== system.ID){ // could happens when starting from a saved game.
                missionVariables.thargoidwars_station_attack = &quot;IMPOSSIBLE&quot;;
                return;
            }
            var thargoidCount;
            if (0 &lt; oolite.compareVersion(&quot;1.75&quot;)){
                thargoidCount = system.entitiesWithScanClass(&quot;CLASS_THARGOID&quot;, player.ship.dockedStation, 20E3).length;
            } else {
                thargoidCount = system.countEntitiesWithScanClass(&quot;CLASS_THARGOID&quot;, player.ship.dockedStation, 20E3); // faster code
            }
            if (thargoidCount === 0){
                missionVariables.thargoidwars_station_attack = &quot;IMPOSSIBLE&quot;;
                if (Math.random() &lt; 0.3) stationAttack = &quot;POSSIBLE&quot;; // Random chance of 2nd wave.
                missionVariables.thargoidwars_number += this.difficulty; // bonus for getting them all.
                delete this.attackedSystem;
            } else if (this.justDocked){
                mission.runScreen({
                    title: &quot;Thargoid Wars&quot;,
                    messageKey: &quot;thargoidwars_station_attack_unfinished&quot;,
                    music: &quot;siren.ogg&quot;
                });
                if (this.difficulty &gt; 1) this.difficulty--;
                this.justDocked = false;
            }
        }
        
        if (stationAttack === &quot;POSSIBLE&quot; &amp;&amp; !this.stationWillBeAttacked){
            this.stationWillBeAttacked = true;
            this.attackTimer = new Timer(this, this.stationAttack, 15 + 45 * Math.random(), 20);
        }
        
        if (thargoidwarsNumber &gt; 5 &amp;&amp; !missionVariables.thargoid_satellite){
            mission.runScreen({
                title: &quot;Thargoid Wars&quot;,
                messageKey: &quot;thargoidwars_spy_satellite&quot;,
                background: &quot;thargoid_wars_satellite.png&quot;
            });
            missionVariables.thargoid_satellite = &quot;INFORMED&quot;;
            return;
        }
        
        if (thargoidwarsNumber &gt; 9){
            player.credits += 1000;
            missionVariables.thargoidwars_number = 0;
            if (++missionVariables.thargoidwars_medal_number &lt; 5){
                mission.runScreen({title: &quot;Thargoid Wars&quot;, messageKey: &quot;thargoidwars_reward&quot;});
            } else {
                missionVariables.thargoidwars_medal_number = 0;
                this.medalNumber++;
                switch(missionVariables.thargoidwars_medal) {
                    case &quot;NONE&quot;:    mission.runScreen({
                                        title: &quot;Thargoid Wars&quot;,
                                        messageKey: &quot;thargoidwars_bronze&quot;,
                                        background: &quot;thargoid_wars_bronze.png&quot;
                                    }); 
                                    missionVariables.thargoidwars_medal = &quot;BRONZE&quot;;
                                    break;
                    case &quot;BRONZE&quot;:  mission.runScreen({
                                        title: &quot;Thargoid Wars&quot;,
                                        messageKey: &quot;thargoidwars_silver&quot;,
                                        background: &quot;thargoid_wars_silver.png&quot;
                                    }); 
                                    missionVariables.thargoidwars_medal = &quot;SILVER&quot;;
                                    break;
                    case &quot;SILVER&quot;:  mission.runScreen({
                                        title: &quot;Thargoid Wars&quot;,
                                        messageKey: &quot;thargoidwars_gold&quot;,
                                        background: &quot;thargoid_wars_gold.png&quot;
                                    }); 
                                    missionVariables.thargoidwars_medal = &quot;GOLD&quot;;
                                    break;
                    case &quot;GOLD&quot;:    mission.runScreen({
                                        title: &quot;Thargoid Wars&quot;,
                                        messageKey: &quot;thargoidwars_crystal&quot;,
                                        background: &quot;thargoid_wars_crystal.png&quot;
                                    }); 
                                    missionVariables.thargoidwars_medal = &quot;CRYSTAL&quot;;
                                    break;
                    case &quot;CRYSTAL&quot;:
                    default:        mission.runScreen({
                                        title: &quot;Thargoid Wars&quot;,
                                        messageKey: &quot;thargoidwars_reward&quot;
                                    });
                                    break;
                }
            }
        }
    }
};

this.stationAttack = function (){  // Delayed missionoffer, called by a timer
    if (guiScreen === &quot;GUI_SCREEN_MISSION&quot; || guiScreen === &quot;GUI_SCREEN_REPORT&quot; || guiScreen === &quot;GUI_SCREEN_SAVE&quot;) return;
    this.attackTimer.stop();
    delete this.attackTimer;
    if (player.ship.docked) this.anounceStationAttack(); // docked and on a safe screen for display.
    this.stationWillBeAttacked = false;
}

this.anounceStationAttack = function (){
    this.difficulty = Math.ceil(Math.random() * 3);
    mission.runScreen({
        title: &quot;Thargoid Wars&quot;,
        messageKey: &quot;thargoidwars_station_attack&quot;,
        choicesKey: &quot;thargoidwars_station_attack_yesno&quot;,
        music: &quot;siren.ogg&quot;
    },
    function (choice){
        if (choice === &quot;NO_THARGOID&quot;) {
            missionVariables.thargoidwars_station_attack = &quot;IMPOSSIBLE&quot;;
            mission.runScreen({
                title: &quot;Thargoid Wars&quot;,
                messageKey: &quot;thargoidwars_station_attack_coward&quot;
            });
            missionVariables.thargoidwars_number--;
        } else {
            // choice === &quot;YES_THARGOID&quot; or player launched without making choice. 
            missionVariables.thargoidwars_station_attack = &quot;IN_PROGRESS&quot;;
            this.addStationAttackThargoids(this.difficulty);
            var saved_legalstatus = player.bounty;
            player.ship.launch();
            player.bounty = saved_legalstatus; // don&#39;t penalyse a ship with illigal goods when helping the station.
        }
    });
}

this.shipExitedWitchspace = function (){
    if (system.isInterstellarSpace || missionVariables.thargoidwars_station_attack === &quot;INITIALISE&quot; || system.sun.hasGoneNova) return;
    
    if (Math.random() &lt; 0.06 &amp;&amp; missionVariables.thargoidwars_station_attack === &quot;IMPOSSIBLE&quot;){ // thargoid Station Attack
        missionVariables.thargoidwars_station_attack = &quot;POSSIBLE&quot;; 
    }
    
    if (Math.random() &lt; 0.04 &amp;&amp; system.countEntitiesWithScanClass(&quot;CLASS_THARGOID&quot;) === 0){
        this.setUpRewards(system.addGroupToRoute(&quot;thargoid&quot;, 3, 0.05, &quot;wp&quot;));
    }
    
    if (Math.random() &lt; 0.05){ // thargoid Ambush
       var decoyOffset = 0.5 * Math.random();

        var decoy = system.addShipsToRoute(&quot;thargoid&quot;, 1, 0.88 - decoyOffset, &quot;pw&quot;)[0];
        decoy.setScript(&quot;wombatsThargoidWarsDecoy.js&quot;);
        decoy.switchAI(&quot;dumbAI.plist&quot;);
        if (Math.random() &lt; 5){
            this.setUpRewards(system.addGroupToRoute(&quot;thargoid&quot;, 3, 0.755 - decoyOffset, &quot;pw&quot;));
            system.addShipsToRoute(&quot;police&quot;, 3, 0.756 - decoyOffset, &quot;pw&quot;);
            system.addShipsToRoute(&quot;trader&quot;, 3, 0.754 - decoyOffset, &quot;pw&quot;);
        }
    }
    
    if (Math.random() &lt; 0.06 &amp;&amp; missionVariables.thargoid_satellite === &quot;INFORMED&quot;){  // thargoid Satellite
        system.addShips(&quot;thargoid_wars_satellite&quot;, 1, [0, 0, -20E3], 5E3);
    }
};

this.addStationAttackThargoids = function (count){
    this.attackedSystem = system.ID;
    this.setUpRewards(system.addGroup(&quot;thargoid&quot;, count, player.ship.position, 25E3));
    system.addShips(&quot;trader&quot;, 2 * count, player.ship.position, 25E3);
    if (count &gt; 1) system.addShips(&quot;police&quot;, count-1, player.ship.position, 25E3);
};

// code below is triggered by ship scripts.
this.thargoidDecoy = function (position){
    this.decoyTimer = new Timer(this, this.$addThargoids, 15 + 30 * Math.random());
    this.decoyPosition = position;
};

this.$addThargoids = function (){
    this.setUpRewards(system.addGroup(&quot;thargoid&quot;, 3, this.decoyPosition, 2000));
};

this.thargoidSatellite = function (){
    if (Math.random() &lt; 0.5) this.satelliteTimer = new Timer(this, this.$addThargoid, 15 + 30 * Math.random());
};

this.$addThargoid = function (){
    this.setUpRewards(system.addGroup(&quot;thargoid&quot;, 1, [0, 0, 20E3], 5E3));
};

this.setUpRewards = function (group){
    // Insert a counter in all groupmember death-actions.
    for (var i = 0; i &lt; group.count; i++){
        var thargoid = group.ships[i];
        if (thargoid.script.shipDied) thargoid.script.thargoidWarsOriginal = thargoid.script.shipDied;
        thargoid.script.shipDied = function (who, why){ 
            if (who &amp;&amp; who.isPlayer){
                missionVariables.thargoidwars_number++;
            }
            if (this.thargoidWarsOriginal) this.thargoidWarsOriginal(who, why);
        } 
    }
};</pre></td>
                </tr>
                <tr>
                    <td valign="top">Scripts/wombatsThargoidWarsDecoy.js</td>
                    <td><pre>&quot;use strict&quot;;
this.name      = &quot;wombatsThargoidWarsDecoy&quot;; 
this.author    = &quot;eric walch&quot;; 
this.copyright = &quot;� 2008 eric walch.&quot;; 
this.description = &quot;Code for the decoy thargoid&quot;; 
this.version   = &quot;1.01&quot;;

this.shipDied = function () { 
    this.ship.commsMessage(&quot;Meet my ancestors, zebra goat!&quot;);
    worldScripts.thargoid_wars.thargoidDecoy(this.ship.position);
    
    // add some cargo to try keeping the player nearby.
    var cargo = this.ship.spawn(&quot;cargopod&quot;, 3);
    for (var i=0; i&lt;cargo.count; i++) {
        cargo[i].setCargo(&quot;Alien Items&quot;);
    }
} 
</pre></td>
                </tr>
                <tr>
                    <td valign="top">Scripts/wombatsThargoidWarsSatellite.js</td>
                    <td><pre>&quot;use strict&quot;;
this.name      = &quot;wombatsThargoidWarsSatellite&quot;; 
this.author    = &quot;eric walch&quot;; 
this.copyright = &quot;� 2008 eric walch.&quot;; 
this.description = &quot;Code for the thargoid satelite&quot;; 
this.version   = &quot;1.10&quot;;

this.shipSpawned = function ()
{
    this.ship.orientation = [1,0,1,0];
    this.addThargoidTimer = new Timer(this, this.$addThargoids, 15 + Math.random()*25);
}

this.shipDied = function (who) 
{ 
    this.ship.commsMessage(&quot;Nee! Nee! Nee! ... Shh!&quot;);
    if (who &amp;&amp; who.isPlayer) missionVariables.thargoidwars_number++;
    worldScripts.thargoid_wars.thargoidSatellite();
} 

this.entityDestroyed = function ()
{
    if (this.addThargoidTimer) {this.addThargoidTimer.stop(); delete this.addThargoidTimer};
}

this.$addThargoids = function ()
{
	// Satellite was not killed in time.
	// Inform the thargoid flees that the player is in the system.
	var count = 2 + Math.ceil(Math.random()*3);
	worldScripts.thargoid_wars.setUpRewards(system.addGroup(&quot;thargoid&quot;, count, [0, 0, 50E3], 5E3));
	count = 1 + Math.round(Math.random()*2);
	worldScripts.thargoid_wars.setUpRewards(system.addGroup(&quot;thargoid&quot;, count, this.ship.position, 15E3));
}</pre></td>
                </tr>
            </table>
        </a>
    </body>
</html>
