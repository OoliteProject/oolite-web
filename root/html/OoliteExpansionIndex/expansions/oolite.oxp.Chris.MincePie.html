<html>
    <head>
        <title>Expansion MincePie</title>
        <link rel="stylesheet" href="../style.css">
    </head>
    <body>
        <table border="0" width="100%">
            <tr>
                <td>Back to <a href='../index.html'>Index</a></td>
                <td align="right"><small>Page generated: Oct 11, 2023, 3:16:48 PM</small></td>
            </tr>
        </table>

        <h1>Expansion MincePie</h1>

        <h2>Content</h2>
        <ul>
          <li><a href="#warnings">Warnings</a></li>
          <li><a href="#manifest">Manifest</a></li>
          <li><a href="#documentation">Documentation</a></li>
          <li><a href="#equipment">1 Equipment</a></li>
          <li><a href="#ships">2 Ships</a></li>
          <li><a href="#models">0 Models</a></li>
          <li><a href="#scripts">3 Scripts</a></li>
        </ul>

          <a name="warnings">
            <h2>Warnings</h2>
            <ol>
                <li>Found XML equipment list</li>
                <li>XML script list found</li>
                <li>Required Expansions mismatch between OXP Manifest and Expansion Manager at character position 0056 (DIGIT ZERO vs LATIN SMALL LETTER N)</li>
            </ol>
          </a>

        <a name="manifest">
        <h2>Manifest</h2>
            <table border="1">
                <tr>
                    <th></th>
                    <th>from Expansion Manager's OXP list</th>
                    <th>from Expansion Manifest</th>
                </tr>
                <tr>
                    <td>Description</td>
                    <td>Santa likes mince pies. Putting one out is a sure way to make sure he&#39;ll come to your system - though his sense of smell isn&#39;t that good, so he will have to be within range of the pie to attract him in. Sit near the pie to see Santa eat. Mince pies work like mines so you need space in your rack to buy one (using F3 for equipment). Like Santa, mince pies are time of year limited.</td>
                    <td>Santa likes mince pies. Putting one out is a sure way to make sure he&#39;ll come to your system - though his sense of smell isn&#39;t that good, so he will have to be within range of the pie to attract him in. Sit near the pie to see Santa eat. Mince pies work like mines so you need space in your rack to buy one (using F3 for equipment). Like Santa, mince pies are time of year limited.</td>
                </tr>
                <tr>
                    <td>Identifier</td>
                    <td>oolite.oxp.Chris.MincePie</td>
                    <td>oolite.oxp.Chris.MincePie</td>
                </tr>
                <tr>
                    <td>Title</td>
                    <td>MincePie</td>
                    <td>MincePie</td>
                </tr>
                <tr>
                    <td>Category</td>
                    <td>Missions</td>
                    <td>Missions</td>
                </tr>
                <tr>
                    <td>Author</td>
                    <td>Chris</td>
                    <td>Chris</td>
                </tr>
                <tr>
                    <td>Version</td>
                    <td>1.1</td>
                    <td>1.1</td>
                </tr>
                <tr>
                    <td>Tags</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Required Oolite Version</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Maximum Oolite Version</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Required Expansions</td>
                    <td>
                            <li>oolite.oxp.Griff.Santa:0</li>
                    </td>
                    <td>
                            <li>oolite.oxp.Griff.Santa:</li>
                    </td>
                </tr>
                <tr>
                    <td>Optional Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Conflict Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Information URL</td>
                    <td><a target="_blank" href="http://wiki.alioth.net/index.php/X">http://wiki.alioth.net/index.php/X</a></td>
                    <td><a target="_blank" href="">n/a</a></td>
                </tr>
                <tr>
                    <td>Download URL</td>
                    <td><a target="_blank" href="https://wiki.alioth.net/img_auth.php/2/27/MincePie_1.1.oxz">https://wiki.alioth.net/img_auth.php/2/27/MincePie_1.1.oxz</a></td>
                    <td><a target="_blank" href="">n/a</a></td>
                </tr>
                <tr>
                    <td>License</td>
                    <td>CC BY-NC-SA 4</td>
                    <td>CC BY-NC-SA 4</td>
                </tr>
                <tr>
                    <td>File Size</td>
                    <td>n/a</td>
                </tr>
                <tr>
                    <td>Upload date</td>
                    <td>1610873255</td>
                </tr>
            </table>
                </a>

        <a name="documentation">
        <h2>Documentation</h2>
        <p>Also read <a href='http://wiki.alioth.net/index.php/MincePie'>http://wiki.alioth.net/index.php/MincePie</a></p>
        <h3>readme.txt</h3>
        <pre>Name:
mincePie.oxp

License:
This work is licensed under the Creative Commons Attribution-Noncommercial-Share Alike 3.0 Unported License. To view a copy of this license, visit http://creativecommons.org/licenses/by-nc-sa/3.0/

Description:
Even dafter than santa.oxp, which this is a development for.

Installation:
Place the mincePie.oxp folder in the AddOns folder inside your oolite folder.
You must have santa.oxp installed for this to work.

Instructions:
Santa likes mince pies. Putting one out is a sure way to make sure he&#39;ll come to your system - though his sense of smell isn&#39;t that good, so he will have to be within range of the pie to attract him in. Sit near the pie to see Santa eat. Mince pies work like mines so you need space in your rack to buy one (using F3 for equipment). Like Santa, mince pies are time of year limited, though given the slightly extended date range you can attract Santa a bit earlier than he&#39;d normally come.

Currently a beta version, and not yet on the wiki - I have some slight enhancements planned, but given timescales thought I ought to get it out! This is also my first attempt at an OXP, so I&#39;m sure there are things I could do better, or tricks I&#39;m missing - feedback would be welcomed (on topic http://aegidian.org/bb/viewtopic.php?t=7237 or pm aracer http://aegidian.org/bb/privmsg.php?mode=post&amp;u=2739 on oolite bb).

Chris
</pre>
        </a>

        <a name="equipment">          
        <h2>Equipment</h2>
            <table>
                <tr>
                    <th>Name</th>
                    <th>Visible</th>
                    <th>Cost [deci-credits]</th>
                    <th>Tech-Level</th>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_MINCE_PIE_MINE.html">Mince Pie</a></td>
                    <td>yes</td>
                    <td align="right">250</td>
                    <td align="center">100+</td>
                </tr>
            </table>
        </a>

        <a name="ships">    
        <h2>Ships</h2>
            <table>
                <tr>
                    <th>Name</th>
                </tr>
                <tr>
                    <td><a href="../ships/eatenMincePie.html">Eaten Mince Pie</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/mincePie.html">Mince Pie</a></td>
                </tr>
            </table>
        </a>

        <a name="models">    
        <h2>Models</h2>
            This expansion declares no models. This may be related to warnings.
        </a>

        <a name="scripts">    
        <h2>Scripts</h2>
            <table>
                <tr>
                    <th>Path</th>
                </tr>
                <tr>
                    <td valign="top">Scripts/hungrySanta.js</td>
                    <td><pre>this.name           = &quot;hungrySanta&quot;
this.author         = &quot;Chris McSweeny&quot;
this.copyright      = &quot;Creative Commons Attribution-Noncommercial-Share Alike 3.0 Unported License.&quot;
this.description    = &quot;Hungry santa seeks mince pies&quot;;
this.version        = &quot;1.0 beta&quot;

this.seekPie = function() {
    var pies = system.shipsWithRole(&quot;EQ_MINCE_PIE_MINE&quot;, this.ship, 20000);
    if (pies.length != 0)
    {
        if (this.ship.AI != &quot;hungrySantaAI.plist&quot;) {
            this.ship.setAI(&quot;hungrySantaAI.plist&quot;);
        }
    }
    pies = system.shipsWithRole(&quot;EQ_MINCE_PIE_MINE&quot;);
    if (pies.length == 0)
    {
        this.shipTimer.stop();
        delete this.shipTimer;
        delete this.shipDied;
        delete this.playerWillEnterWitchspace;
        delete this.eatingPie;
        delete this.eatenPie;
        delete this.burp;
        delete this.seekPie;
    }
}

this.shipDied = this.playerWillEnterWitchspace = function () {
    if (this.shipTimer) {
        this.shipTimer.stop();
        delete this.shipTimer;
    }
}

this.eatingPie = function () {
    var pies = system.shipsWithRole(&quot;EQ_MINCE_PIE_MINE&quot;, this.ship, 100);
    if (pies.length != 0)
    {
        pies[0].orientation = this.ship.orientation;
    }
}

this.eatenPie = function () {
    var pies = system.shipsWithRole(&quot;EQ_MINCE_PIE_MINE&quot;, this.ship, 100);
    if (pies.length != 0)
    {
        var piePos = pies[0].position;
        var pieOrient = pies[0].orientation;
        pies[0].remove();
        system.legacy_addShipsAtPrecisely(&quot;eatenMincePie&quot;, 1, &quot;abs&quot;, piePos);
        var eatenPies = system.shipsWithRole(&quot;eatenMincePie&quot;, this.ship, 100);
        if (eatenPies.length != 0) {
            eatenPies[0].orientation = pieOrient;
        }
    }
    this.ship.commsMessage(&quot;Thanks for the pie - have a pressie from Santa&quot;);
    switch (Math.floor(Math.random()*4)) {
    case 0:
        this.ship.ejectSpecificItem(&quot;prezzie1&quot;);
        break;
    case 1:
        this.ship.ejectSpecificItem(&quot;prezzie3&quot;);
        break;
    case 2:
        this.ship.ejectSpecificItem(&quot;prezzie6&quot;);
        break;
    case 3:
        this.ship.ejectSpecificItem(&quot;prezzie7&quot;);
        break;
    default:
        break;
    }
    this.burpTimer = new Timer(this, this.burp, 6, 0);
}

this.burp = function () {
    this.ship.commsMessage(&quot;Burp&quot;);
}

// script startup - start timer
if (!this.shipTimer) {
    this.shipTimer = new Timer(this, this.seekPie, 10, 10);
}
</pre></td>
                </tr>
                <tr>
                    <td valign="top">Scripts/mincePie.js</td>
                    <td><pre>this.name           = &quot;mincePie&quot;
this.author         = &quot;Chris McSweeny&quot;
this.copyright      = &quot;Creative Commons Attribution-Noncommercial-Share Alike 3.0 Unported License.&quot;
this.description    = &quot;Mince Pie for santa&quot;;
this.version        = &quot;1.0 beta&quot;

this.shipSpawned = function() {
    // make stationary
    this.ship.desiredSpeed = 0;
    // make santa jump in if he&#39;s not already in system
    if (system.countShipsWithRole(&quot;santaclaus&quot;) == 0) {
        system.legacy_addShips(&#39;santaclaus&#39;, 1); 
    }
    // make santa search for mince pie
    var santas = system.shipsWithRole(&quot;santaclaus&quot;);
	santas.forEach(function(ship) {
	    ship.setScript(&quot;hungrySanta.js&quot;)
	});    
}
</pre></td>
                </tr>
                <tr>
                    <td valign="top">Scripts/mincePieStartup.js</td>
                    <td><pre>this.name           = &quot;mincePieStartup&quot;
this.author         = &quot;Chris McSweeny&quot;
this.copyright      = &quot;Creative Commons Attribution-Noncommercial-Share Alike 3.0 Unported License.&quot;
this.description    = &quot;Something for Santa&quot;;
this.version        = &quot;1.0 beta&quot;

// All code, plists, models, textures in MincePie.oxp created by Chris McSweeny (with a little help from Eric Walch).
// MincePie.oxp requires santa.oxp to be installed.
// This does not imply any endorsement from the authors of santa.oxp
// MincePie.oxp released under Oolite Creative Commons license.
this.startUp = this.reset = function() { 
    var today = new Date(); 
    if ((today.getMonth() == 11) &amp;&amp; (today.getDate() &lt; 26) &amp;&amp; worldScripts[&quot;santaClausMain&quot;]) { 
        var mincePieInfo = EquipmentInfo.infoForKey(&quot;EQ_MINCE_PIE_MINE&quot;); 
        mincePieInfo.effectiveTechLevel = 1; 
    } else { 
        missionVariables.TL_FOR_EQ_MINCE_PIE_MINE = null; 
    } 
} 

this.shipLaunchedFromStation = function(station) { 
    var today = new Date(); 
    if ((today.getMonth() == 11) &amp;&amp; (today.getDate() &lt; 26)) { 
    } else { 
        var mincePiesRemoved = 0; 
        while (player.ship.hasEquipment(&quot;EQ_MINCE_PIE_MINE&quot;)) { 
            player.ship.removeEquipment(&quot;EQ_MINCE_PIE_MINE&quot;); 
            mincePiesRemoved++; 
        } 
        if (mincePiesRemoved == 1) { 
            player.consoleMessage(&quot;Your mince pie was stale&quot;); 
        } else if (mincePiesRemoved &gt; 1) { 
            player.consoleMessage(&quot;Your mince pies were stale&quot;); 
        }    
    } 
    delete this.shipLaunchedFromStation; 
}

</pre></td>
                </tr>
            </table>
        </a>
    </body>
</html>
