<html>
    <head>
        <title>Expansion Ionics</title>
        <link rel="stylesheet" href="../style.css">
    </head>
    <body>
        <table border="0" width="100%">
            <tr>
                <td>Back to <a href='../index.html'>Index</a></td>
                <td align="right"><small>Page generated: Oct 11, 2023, 3:16:48 PM</small></td>
            </tr>
        </table>

        <h1>Expansion Ionics</h1>

        <h2>Content</h2>
        <ul>
          <li><a href="#warnings">Warnings</a></li>
          <li><a href="#manifest">Manifest</a></li>
          <li><a href="#documentation">Documentation</a></li>
          <li><a href="#equipment">0 Equipment</a></li>
          <li><a href="#ships">23 Ships</a></li>
          <li><a href="#models">0 Models</a></li>
          <li><a href="#scripts">6 Scripts</a></li>
        </ul>

          <a name="warnings">
            <h2>Warnings</h2>
            <ol>
                <li>License not specified</li>
                <li>XML script list found</li>
                <li>Unknown key &#39;licence&#39; at https://wiki.alioth.net/img_auth.php/f/f9/Ionics_1.3.1.oxz!manifest.plist</li>
            </ol>
          </a>

        <a name="manifest">
        <h2>Manifest</h2>
            <table border="1">
                <tr>
                    <th></th>
                    <th>from Expansion Manager's OXP list</th>
                    <th>from Expansion Manifest</th>
                </tr>
                <tr>
                    <td>Description</td>
                    <td>Ionics aims to enhance the northeast corner of Galaxy 2 with a number of interlocking missions revolving around a rich storyline.</td>
                    <td>Ionics aims to enhance the northeast corner of Galaxy 2 with a number of interlocking missions revolving around a rich storyline.</td>
                </tr>
                <tr>
                    <td>Identifier</td>
                    <td>oolite.oxp.Galileo.Ionics</td>
                    <td>oolite.oxp.Galileo.Ionics</td>
                </tr>
                <tr>
                    <td>Title</td>
                    <td>Ionics</td>
                    <td>Ionics</td>
                </tr>
                <tr>
                    <td>Category</td>
                    <td>Missions</td>
                    <td>Missions</td>
                </tr>
                <tr>
                    <td>Author</td>
                    <td>Galileo</td>
                    <td>Galileo</td>
                </tr>
                <tr>
                    <td>Version</td>
                    <td>1.3.1</td>
                    <td>1.3.1</td>
                </tr>
                <tr>
                    <td>Tags</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Required Oolite Version</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Maximum Oolite Version</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Required Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Optional Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Conflict Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Information URL</td>
                    <td><a target="_blank" href="http://wiki.alioth.net/index.php/Ionics_OXP">http://wiki.alioth.net/index.php/Ionics_OXP</a></td>
                    <td><a target="_blank" href="">n/a</a></td>
                </tr>
                <tr>
                    <td>Download URL</td>
                    <td><a target="_blank" href="https://wiki.alioth.net/img_auth.php/f/f9/Ionics_1.3.1.oxz">https://wiki.alioth.net/img_auth.php/f/f9/Ionics_1.3.1.oxz</a></td>
                    <td><a target="_blank" href="">n/a</a></td>
                </tr>
                <tr>
                    <td>License</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>File Size</td>
                    <td>n/a</td>
                </tr>
                <tr>
                    <td>Upload date</td>
                    <td>1610873518</td>
                </tr>
            </table>
                </a>

        <a name="documentation">
        <h2>Documentation</h2>
        <p>Also read <a href='http://wiki.alioth.net/index.php/Ionics'>http://wiki.alioth.net/index.php/Ionics</a></p>
        <h3>readme.txt</h3>
        <pre>The Ionics OXP
Written by Galileo
Version 1.3.1

------------
The Ionics OXP aims to enhance the northeast corner of Galaxy 2 with a number of interlocking missions revolving around a rich storyline. The OXP also contains 3 new ships available to the player: 
- The Huntsman 
- The Redback 
- The Whitetail 

The organisations featured in the OXP are: 
- The Link, a clandestine organisation that aspires to rid the known Ooniverse of oppressive regimes. 
- The Ramaza Liberation Front, a rebel group opposing the Ramazan government&#39;s reign. 
- The Ionics Corporation, an aerospace group based in Zaria.

To start the mission go to Zaria in galaxy 2.

IONICS COOPERATION
------------------
The Ionics Corporation is an aerospace manufacturer founded in [YEAR] in the Zaria system.
The companies first release was a mid-sized attack vessel named the Huntsman, marketed at traders due to it&#39;s relatively large cargo hold compared to similarly sized attack vessels. It was quite successful in the nord-east of the 2nd galaxy and second-hand vessels are still quite common in the area. Despite it&#39;s local success it is rarely found elsewhere in the ooniverse. Production of the Huntsman ceased in 3081, with the release of a new attack vessel named the Whitetail. The Whitetail featured a sleek, distinctive design, 6 missile slots, and a blistering top speed of 380 LM. It was an instant success and quickly became the vessel of choice for local pirates and bounty hunters. This brought Ionics to the attention of the Zaria government who several years earlier had embarked on a successful attempt to rid the system of criminal activity including piracy and smuggling. Under the systems harsh new piracy laws, the companies directors were arrested on charges of aiding &amp; abetting piracy. With profits from the success of the Whitetail, the company launched a reasonably successful defence to the charges and after 6 weeks of negotiations, Ionics signed an agreement that would forbid their vessels being sold to the general public. Instead the government would would let it&#39;s current contract with the [OTHER_CORP] corporation expire and Ionics would become the governments sole supplier of military vessels for a period of 10 years. This partnership turned out to be extremely profitable for Ionics, almost immediately, a new cruise vessel was designed. Named the Redback, it&#39;s primary purpose was to lead fleets of Whitetails into battle and provide a mission control centre for the fleets. It was also well equipped for fighting solo, sporting [NICE_FEATURES]
3 years after the contract was signed, war broke out between Zaria and neighbouring system Ramaza. Ionics&#39; strong financial ties to the current government encouraged them to hire weapons experts from every corner of the galaxy and develop several new additions to the Ionics military arsenal. The rapid design and production of missiles, lasers, ECM systems and a new carrier vessel, the Funnelweb, helped Zaria gain a lead in the ensuing battle and an eventual win in [YEAR]. In [YEAR], Ionics&#39; contract was renewed with little change to terms and conditions.
In the year [YEAR], Ionics was dealt a severe blow when rising public anger over the increasingly oppressive piracy laws sparked an violent uprising resulting in the overthrowing of the government and a rewrite of the constitution which excluded Ionics&#39; contract. Ionics entire range was once again released onto the market, but despite a successful marketing plan they have never seen profit margins like those enjoyed in the 14 year stint with the Zaria government.

THE RAMAZA LIBERATION FRONT
---------------------------
The Ramaza Liberation Front, or RLF, was originally formed to oppose the centuries-old dictatorship on the planet Ramaza in Galaxy 2.
The system was originally a Democracy, but devolved to a Dictatorship following a military coup. Since then, the upper echelons of Ramaza&#39;s government have been dominated by a military junta. This has lead to long decades of civil unrest as successive governments have taxed the civilian population almost to poverty, ploughing the money into military projects and maintaining immense forces of ground troops, naval assets, aircraft and, more recently, spacecraft. The overly aggressive standpoint of the Ramazaian government has meant that the Galactic Cooperative&#39;s Security Council have maintained a constant vigil on the system government&#39;s policies, fearing expansionist actions into neighbouring systems. To date, the Ramaza space navy has been restricted to a few hundred ships, supplied by the Ionics Corporation.
Currently, the RLF have made some three hundred representations to the Galactic Cooperative of Worlds for intercession into the on-going struggles between themselves and the current government of Ramaza, but due to its policy of non-intervention in any one system&#39;s political, civil or military unrest, GalCop has so far refused to offer any support to them.
Rumours abound that the Ramaza Liberation Front have been courting several outside agencies in their desperation to counter the government&#39;s increasingly daunting array of military assets, but only time will tell if these negotiations will come to anything.

THE LINK
--------
The Link is a shadowy, underground organisation that seeks to rid the eight galaxies of oppressive regimes and replace them with more equitable, but not necessarily more benign, leadership. Their origins, leadership and, indeed, the very structure of their organisation remains unknown, but what is known is that they have their own force of ships and the will to use them to further their secretive agenda.


INSTALLATION
------------
To install The Ionics OXP, unzip the package and drag it into your Oolite AddOns folder.

UPGRADING
---------
If you are upgrading to a new version of The Ionics OXP, delete the old folder when installing this one.


CHANGELOG
---------
v 1.3.1
* Added a &#39;null&#39; parameter to mission.setInstructionsKey()

v 1.3
* Translated the main legacy script to Java Script.
* The main script is no longer evaluated when the mission has ended. This avoids the waste of cpu time with useless checks after mission ending.
* Raised minimum Oolite to 1.74.1
* During the Ramazan war, ships are no longer spawned near the station, but launch from it.
* Used some new AI commands to simplify several AI scripts.

v 1.2.5
* Changed back the system name: Cevara --&gt; Cevera. The name in the text was not wrong but the oxp accidently changed the system name itself in a wrong way.
* Three systems were defined with much bigger nebula than default. No problem, but when also system_redux was installed the sky colouring was overdone because system_redux strongly increases the number of nebula. Those three systems now have the default nebula count explicit defined so the sky looks again as original intended.

v 1.2.4
* Changed old typo in system name: Cevera --&gt; Cevara.

v 1.2.3
* Changed all line endings in the script.plist. Was mac style and generated errors with Windows.

v 1.2.2
* Added mission offering compatibility. Should not longer collide with other oxp offerings.
* Added mission destinations on the galactic charts.
* Changed many internal names to less common names to avoid name conflicts. (preceded most names with: ionics)
* Changed some AI files.
* Restructured the mission code for better performance.
* Added pilots to some ships.

v 1.2.1 (Versions 1.2.1 and newer updated by Eric Walch)
* New texture for the Huntsman
* Bugfix: Don&#39;t require ACCEPT_OFFER_1 as condition at Zaria
* Make some sort of weapons platform for use in the battle (fire plasma, missiles, etc.)
* Rearranged Ramazan war and improved AI.

For more information, see http://wiki.alioth.net/index.php/Ionics_OXP


ROADMAP FOR VERSION 2.0
-----------------------
* Calculate kills by player
* Setup ranking system for The Link and award medals
* Add Link HQ at Bebege
* Write random mini-missions in sector
* Assassinate dictator mission
* War in Legeara

* Add pictures to mission screens
* Move battle to Link Base 
* Improve spacelane in Zaria etc.
* Improve Funnelweb (ballturrets, docking bay, etc.)
* Improve the Link Base (cladding, turrets, lights, warning messages, etc.)

Comment by Eric: the 2.0 roadmap was formulated in 2006 by Galileo. Galileo seams to have abandoned this oxp since, so a version 2.0 is not likely to happen unless someone else wants to write further on the story.</pre>
        </a>

        <a name="equipment">          
        <h2>Equipment</h2>
            This expansion declares no equipment. This may be related to warnings.
        </a>

        <a name="ships">    
        <h2>Ships</h2>
            <table>
                <tr>
                    <th>Name</th>
                </tr>
                <tr>
                    <td><a href="../ships/huntsman-player.html">Ionics Huntsman</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ionics_ballturret.html">Ball Turret</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ionics_funnelweb_mission.html">Ionics Funnelweb</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ionics_huntsman-pirate.html">Ionics Huntsman</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ionics_huntsman-trader.html">Ionics Huntsman</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ionics_link-vessel.html">Link Vessel</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ionics_link_base.html">The Link Base</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ionics_link_base_defender.html">ionics_link_base_defender</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ionics_redback-pirate.html">Ionics Redback</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ionics_redback-trader.html">ionics_redback-trader</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ionics_redback_mission.html">ionics_redback_mission</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ionics_rlf-vessel.html">RLF Vessel</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ionics_rlf_escort.html">RLF Fighter</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ionics_rlf_fighter.html">RLF Fighter</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ionics_rlf_leader.html">RLF Leader</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ionics_whitetail.html">Ionics Whitetail</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ionics_whitetail_mission.html">ionics_whitetail_mission</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ionics_whitetail_mission_escort.html">ionics_whitetail_mission_escort</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ionics_wplatform.html">Ionics CR150 Weapons Platform</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ramazan-government-vessel_redback.html">Ramazan Government Redback</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ramazan-government-vessel_whitetail.html">Ramazan Government Whitetail</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/redback-player.html">Ionics Redback</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/whitetail-player.html">Ionics Whitetail</a></td>
                </tr>
            </table>
        </a>

        <a name="models">    
        <h2>Models</h2>
            This expansion declares no models. This may be related to warnings.
        </a>

        <a name="scripts">    
        <h2>Scripts</h2>
            <table>
                <tr>
                    <th>Path</th>
                </tr>
                <tr>
                    <td valign="top">Scripts/ionics_RLF_vessel.js</td>
                    <td><pre>this.name      = &quot;ionics_RLF_vessel&quot;; 
this.author    = &quot;eric walch&quot;; 
this.copyright = &quot;� 2008 eric walch.&quot;; 
this.description = &quot;Ramazan_rebel-liberation-front_vessel&quot;; 
this.version   = &quot;1.0&quot;;

this.shipDied = function() {
    missionVariables.ionics_rlf_fleet_size--;
};

this.shipLaunchedEscapePod = function () {
    // change role to exclude it from the count of active ships.
    this.ship.primaryRole = &quot;derelict&quot;;
}</pre></td>
                </tr>
                <tr>
                    <td valign="top">Scripts/ionics_funnelweb.js</td>
                    <td><pre>this.name      = &quot;ionics_funnelweb&quot;; 
this.author    = &quot;eric walch&quot;; 
this.copyright = &quot;� 2008 eric walch.&quot;; 
this.description = &quot;ionics_funnelweb used in mission&quot;; 
this.version   = &quot;1.0&quot;;

this.shipDied = function() {
    missionVariables.ionics = &quot;MISSION_SUCCESSFUL&quot;;
    player.consoleMessage(expandDescription(&quot;Congratulations [commander_name]! You head back to Ramaza, we&#39;ll take it from here.&quot;), 10);
    mission.unmarkSystem(251);
    mission.markSystem(26);
    mission.setInstructionsKey(&quot;ionics_short_desc4&quot;, &quot;ionics_v_rlf&quot;)
};
</pre></td>
                </tr>
                <tr>
                    <td valign="top">Scripts/ionics_government_vessel.js</td>
                    <td><pre>this.name      = &quot;ionics_government_vessel&quot;; 
this.author    = &quot;eric walch&quot;; 
this.copyright = &quot;� 2008 eric walch.&quot;; 
this.description = &quot;Ramazan_government_vessel&quot;; 
this.version   = &quot;1.0&quot;;

this.shipDied = function (ship) {
    missionVariables.ionics_government_fleet_size--;
    if (ship.isPlayer) missionVariables.ionics_government_kills++;
};

this.shipLaunchedEscapePod = function () {
    // change role to exclude it from the count of active ships.
    this.ship.primaryRole = &quot;derelict&quot;;
    this.ship.group = null;
}</pre></td>
                </tr>
                <tr>
                    <td valign="top">Scripts/ionics_link_vessel.js</td>
                    <td><pre>this.name      = &quot;ionics_link_vessel&quot;; 
this.author    = &quot;eric walch&quot;; 
this.copyright = &quot;� 2008 eric walch.&quot;; 
this.description = &quot;Ramazan_link_vessel&quot;; 
this.version   = &quot;1.0&quot;;

this.shipDied = function() {
    missionVariables.ionics_link_fleet_size--;
};

this.shipLaunchedEscapePod = function () {
    // change role to exclude it from the count of active ships.
    this.ship.primaryRole = &quot;derelict&quot;;
    this.ship.group = null;
}</pre></td>
                </tr>
                <tr>
                    <td valign="top">Scripts/ionics_main.js</td>
                    <td><pre>this.name        = &quot;ionics_v_rlf&quot;; 
this.author      = &quot;Galileo, JS translation by Eric Walch&quot;; 
this.description = &quot;Script only used for the ionics mission.&quot;; 
this.version     = &quot;1.3.1&quot;; 

this.startUp = function() {
    var end = missionVariables.ionics;
    if (end === &quot;RAMAZA_WAR_OVER&quot; || end === &quot;MISSION_COMPLETE_2B&quot; || end === &quot;MISSION_COMPLETE_3A&quot;) {
        // mission is over, no need to evaluate any code anymore.
        delete this.missionScreenOpportunity;
        delete this.shipLaunchedFromStation;
        delete this.shipExitedWitchspace;
    }
};

this.missionScreenOpportunity = function () {
    if (galaxyNumber != 1) return;
    var ionics = missionVariables.ionics;
    if (player.ship.dockedStation.isMainStation) {
        // Side with RLF
        if (system.ID === 251 &amp;&amp; !ionics) {
            // Zaria: First visit to Zaria.
            mission.runScreen({title: &quot;Ionics&quot;, messageKey: &quot;ionics_zaria_news_1&quot;});
            missionVariables.ionics = &quot;PRE_STAGE1&quot;;
            missionVariables.ionics_ramaza_status = &quot;RLF_1&quot;;
            return;
        }
        if (system.ID === 26 &amp;&amp; ionics === &quot;PRE_STAGE1&quot;) {
            // Ramaza: First orders.
            mission.runScreen({title: &quot;Ionics&quot;, messageKey: &quot;ionics_order_1&quot;, choicesKey: &quot;ionics_question_1&quot;
            },
            function (choice) {
                if (choice === &quot;ACCEPT_OFFER_1&quot;) {
                    missionVariables.ionics = &quot;STAGE1&quot;;
                    mission.setInstructionsKey(&quot;ionics_short_desc1&quot;);
                    mission.markSystem(251);
                }
                if (choice === &quot;REJECT_OFFER_1&quot;) {
                    missionVariables.ionics = &quot;MISSION_COMPLETE_1&quot;;
                }
            });
        }
        if (system.ID === 251 &amp;&amp; ionics === &quot;STAGE1&quot;) {
            // Zaria: Collected package.
            mission.unmarkSystem(251);
            player.credits += 500;
            missionVariables.ionics = &quot;STAGE2A&quot;;
            mission.setInstructionsKey(&quot;ionics_short_desc2a&quot;);
            mission.markSystem(26);
            mission.runScreen({title: &quot;Ionics&quot;, messageKey: &quot;ionics_order_2a&quot;});
        }
        if (system.ID === 26 &amp;&amp; ionics === &quot;STAGE2A&quot;) {
            // Ramaza: Package delivered. RLF make offer to destroy fleet.
            mission.unmarkSystem(26);
            player.credits += 500;
            mission.runScreen({title: &quot;Ionics&quot;, messageKey: &quot;ionics_order_3a&quot;, choicesKey: &quot;ionics_question_3&quot;
            },
            function (choice) {
                if (choice === &quot;ACCEPT_OFFER_3A&quot;) {
                    // Ramaza: Accept offer to destroy fleet.
                    missionVariables.ionics = &quot;STAGE3A&quot;;
                    mission.setInstructionsKey(&quot;ionics_short_desc3a&quot;);
                    mission.markSystem(251);
                }
                if (choice === &quot;REJECT_OFFER_3A&quot;) {
                    // Ramaza: Rejected offer to destroy fleet. Missions end completely.
                    missionVariables.ionics = &quot;MISSION_COMPLETE_3A&quot;;
                }
            });
        }
        if (system.ID === 251 &amp;&amp; ionics === &quot;MISSION_SUCCESSFUL&quot;) {
            // Zaria: Ionics fleet destroyed, refuelling for trip back to Ramaza.
            missionVariables.ionics = &quot;ZARIA_NEWS_2&quot;;
            mission.runScreen({title: &quot;Ionics&quot;, messageKey: &quot;ionics_zaria_news_2&quot;});
            mission.setInstructionsKey(&quot;ionics_short_desc4&quot;);
        }
        if (system.ID === 26 &amp;&amp; (ionics === &quot;MISSION_SUCCESSFUL&quot; || ionics === &quot;ZARIA_NEWS_2&quot;)) {
            // Ramaza: Ionics fleet destroyed, RLF makes payment.
            missionVariables.ionics = &quot;MISSION_COMPLETE_A&quot;;
            player.credits += 15000;
            mission.unmarkSystem(26);
            mission.runScreen({title: &quot;Ionics&quot;, messageKey: &quot;ionics_order_4a&quot;});
            mission.setInstructionsKey(null);
        }
        if (system.ID === 251 &amp;&amp; ionics === &quot;MISSION_COMPLETE_A&quot;) {
            // Zaria: The Link becomes involved.
            missionVariables.ionics = &quot;ZARIA_NEWS_3&quot;;
            missionVariables.ionics_ramaza_status = &quot;RLF_2&quot;;
            mission.runScreen({title: &quot;Ionics&quot;, messageKey: &quot;ionics_zaria_news_3&quot;});
        }
        if (system.ID === 198 &amp;&amp; ionics === &quot;STAGE5&quot;) {
            // Cevera: Pick up equipment.
            missionVariables.ionics = &quot;STAGE6&quot;;
            missionVariables.ionics_ramaza_status = &quot;RLF_2&quot;;
            mission.unmarkSystem(198);
            mission.markSystem(26);
            mission.runScreen({title: &quot;Ionics&quot;, messageKey: &quot;ionics_order_6&quot;});
            mission.setInstructionsKey(&quot;ionics_short_desc6&quot;);
        }
        if (system.ID === 251 &amp;&amp; ionics === &quot;MISSION_COMPLETE_1&quot;) {
            // Zaria: Ionics makes offer.
            mission.runScreen({title: &quot;Ionics&quot;, messageKey: &quot;ionics_order_2b&quot;, choicesKey: &quot;ionics_question_2b&quot;
            },
            function (choice) {
                if (choice === &quot;ACCEPT_OFFER_2B&quot;) {
                    // Zaria: Accept Ionics offer.
                    missionVariables.ionics = &quot;STAGE2B&quot;;
                    mission.setInstructionsKey(&quot;ionics_short_desc2b&quot;);
                    mission.markSystem(26);
                }
                if (choice === &quot;REJECT_OFFER_2B&quot;) {
                    // Zaria: Rejected Ionics offer. Missions end completely.
                    missionVariables.ionics = &quot;MISSION_COMPLETE_2B&quot;;
                }
            });
        }
        if (system.ID === 26 &amp;&amp; ionics === &quot;STAGE2B&quot;) {
            // Ramaza: RLF infiltrated.
            missionVariables.ionics = &quot;STAGE3B&quot;;
            mission.unmarkSystem(26);
            mission.markSystem(251);
            mission.runScreen({title: &quot;Ionics&quot;, messageKey: &quot;ionics_order_3b&quot;});
            mission.setInstructionsKey(&quot;ionics_short_desc3b&quot;);
        }
        if (system.ID === 251 &amp;&amp; ionics === &quot;STAGE3B&quot;) {
            // Zaria: RLF infiltrated. Ionics makes payment.
            missionVariables.ionics = &quot;MISSION_COMPLETE_B&quot;;
            mission.unmarkSystem(251);
            player.credits += 1500;
            mission.runScreen({title: &quot;Ionics&quot;, messageKey: &quot;ionics_order_4b&quot;});
            mission.setInstructionsKey(null);
        }
        if (system.ID === 26 &amp;&amp; ionics === &quot;WAR_IN_RAMAZA&quot;) {
            // Ramaza: war going on.
            var display_stats = this.ionics_display_stats;
            if (display_stats === &quot;REJECT&quot;) {
                // Ramaza: war going on, launch player.*
                this.ionics_display_stats = false;
                player.ship.launch();
                return;
            }
            if (display_stats &amp;&amp; missionVariables.ionics_government_kills &gt; 25) {
                // Ramaza: war going on warn player.
                mission.runScreen({title: &quot;Ionics&quot;, messageKey: &quot;ionics_war_ramaza&quot;});
                this.ionics_display_stats = &quot;REJECT&quot;;
            }
        }
    }
    if (player.ship.dockedStation.name === &quot;The Link Base&quot;) {
        // Player docked at the link base. Always in Ramaza (system.ID = 26)
        function firstVisit(choice) {
            // Handles the choices of next check
            switch(choice) {
                case &quot;WHAT_IS_THE_LINK&quot;:{
                    // Ramaza: answer question about The Link.
                    mission.runScreen({title: &quot;Ionics&quot;, messageKey: &quot;ionics_answer_1&quot;, choicesKey: &quot;ionics_question_5&quot;}, firstVisit);
                    break;
                }
                case &quot;ACCEPT_OFFER_4&quot;: {
                    // Ramaza: accept mission.
                    missionVariables.ionics = &quot;STAGE5&quot;;
                    mission.markSystem(198);
                    mission.setInstructionsKey(&quot;ionics_short_desc5&quot;);
                    break;
                }
                case &quot;REJECT_OFFER_4&quot;: {
                    // Ramaza: reject mission. END.
                    missionVariables.ionics = &quot;MISSION_REJECTED_STAGE5&quot;;
                    break;
                }
            }
        }
        if (ionics === &quot;ZARIA_NEWS_3&quot;) {
        // Ramaza: First time docked at The Link base.
        mission.runScreen({title: &quot;Ionics&quot;, messageKey: &quot;ionics_order_5&quot;, choicesKey: &quot;ionics_question_4&quot;}, firstVisit);
        }
        if (ionics === &quot;STAGE6&quot;) {
            // Ramaza: Second docking, admitted to The Link.
            mission.runScreen({title: &quot;Ionics&quot;, messageKey: &quot;ionics_order_7&quot;});
            mission.markSystem(26);
            // Ramaza: Setup war in Ramaza.
            missionVariables.ionics = &quot;WAR_IN_RAMAZA&quot;;
            mission.setInstructionsKey(&quot;ionics_short_desc7&quot;);
            missionVariables.ionics_government_fleet_size = 200; 
            missionVariables.ionics_link_fleet_size = 100; 
            missionVariables.ionics_rlf_fleet_size = 50; 
            this.ionics_display_stats = false;
            missionVariables.ionics_ramaza_status = &quot;RLF_3&quot;;
            missionVariables.ionics_government_kills = 0;
        }
        if (ionics === &quot;WAR_IN_RAMAZA&quot; &amp;&amp; this.ionics_display_stats) {
            // Ramaza: Docked at Link Base, free refuel and display war progress.
            mission.runScreen({title: &quot;Ionics&quot;, messageKey: &quot;ionics_war_progress&quot;});
            this.ionics_display_stats = false;
            player.ship.fuel = 7;
            var emptySlots = player.ship.missileCapacity - player.ship.missiles.length;
            for (var i=0; i&lt;emptySlots; i++) {player.ship.awardEquipment(&quot;EQ_MISSILE&quot;)};
            var missileText = emptySlots ? (&quot;and &quot; + emptySlots + &quot; missile silo(s) &quot;) : &quot;&quot;;
            var legalStatus = player.bounty ? &quot; and your legal status has been cleaned&quot; : &quot;&quot;;
            player.bounty = 0;
            mission.addMessageText(&quot;Your fuel tanks &quot; + missileText + &quot;have been replenished&quot; + legalStatus + &quot;.&quot;);
            this.validatePosition(system.shipsWithPrimaryRole(&quot;ramazan_government_vessel&quot;));
        }
        if (ionics === &quot;WAR_IN_RAMAZA_VICTORY&quot;) {
            // Ramaza: Docked at Link Base, war is won.
            mission.runScreen({title: &quot;Ionics&quot;, messageKey: &quot;ionics_ramaza_victory&quot;});
            missionVariables.ionics = &quot;RAMAZA_WAR_OVER&quot;;
            missionVariables.ionics_ramaza_status = &quot;LIBERATED&quot;;
            player.bounty = 0;
            mission.unmarkSystem(26);
            mission.setInstructionsKey(null);
            // remove no longer used variables
            delete missionVariables.ionics_government_fleet_size; 
            delete missionVariables.ionics_link_fleet_size; 
            delete missionVariables.ionics_rlf_fleet_size;
            delete missionVariables.ionics_government_kills;
        }
    }
};

this.shipLaunchedFromStation = function () {
    // reset display for mission.
    if (galaxyNumber === 1 &amp;&amp; system.ID === 26 &amp;&amp; missionVariables.ionics === &quot;WAR_IN_RAMAZA&quot; &amp;&amp; !this.warTimer) {
        // this.warTimer is undefined when loading a gaved game. In all other cases we already entered through witchspace.
        this.startWar();
    }
};


this.shipExitedWitchspace = function() {
    if (galaxyNumber !== 1) return;

    var ionics = missionVariables.ionics;    
    if (system.ID === 26 &amp;&amp; ionics === &quot;STAGE2A&quot; &amp;&amp; Math.random() &lt; 0.5) {
        // Ramaza: Delivering package, Ionics assassin strikes (maybe).
        var redback = system.addShips(&quot;redback&quot;, 1, [0, 0, 1500]);
        redback[0].commsMessage(&quot;Die rebel scum!&quot;);
    }
    if (system.ID === 251 &amp;&amp; ionics === &quot;STAGE3A&quot;) {
        // Zaria: Setup Ionics fleet delivery battle.
        var funnelweb = system.addShips(&quot;funnelweb_mission&quot;, 1, [0, 0, 10000], 5E3)[0];
        var redback = system.addShips(&quot;redback_mission&quot;, 2, [0, 0, 9500], 5E3);
        var whitetail = system.addShips(&quot;whitetail_mission&quot;, 4, [0, 0, 9250], 5E3);
        system.addShips(&quot;rlf_leader&quot;, 1, [0, 0, 2000], 5E3);
        system.addGroup(&quot;rlf_fighter&quot;, 4, [0, 0, 2500], 5E3);
        if (!funnelweb.group) funnelweb.group = new ShipGroup(&quot;Weapon Transport&quot;);
        funnelweb.group.addShip(funnelweb);
        for (var i=0; i&lt;redback.length; i++) this.addToGroup(funnelweb.group, redback[i]);
        for (var i=0; i&lt;whitetail.length; i++) this.addToGroup(funnelweb.group, whitetail[i]);
        funnelweb.group.leader = funnelweb;
        // funnelweb.group.name = &quot;Weapon Transport&quot;;
        this.sendToPlanet(system.shipsWithPrimaryRole(&quot;police&quot;));
    }
    if (system.ID === 26 &amp;&amp; ionics === &quot;ZARIA_NEWS_3&quot;) {
        // Ramaza: Link sends comms message to commander.
        var message = &quot;Please dock at The Link Base, we urgently require your assistance.&quot;;
        if (player.ship.equipmentStatus(&quot;EQ_ADVANCED_COMPASS&quot;) === &quot;EQUIPMENT_OK&quot;) {
            message = message + &quot; The coordinates have been uploaded to your space compass.&quot;;
        } else {
            message = message + &quot;You need an advanced space compass for the coordinates.&quot;;
        }
        player.commsMessage(message, 10);
    }
    if ((ionics === &quot;STAGE5&quot; || ionics === &quot;STAGE6&quot;) &amp;&amp; Math.random() &lt; 0.75) {
        // Anywhere: Ramazan government attacks
        var whitetail = system.addShips(&quot;whitetail_mission&quot;, 4, [0, 0, -1000]);
        whitetail[0].commsMessage(&quot;You will pay dearly for your interference Commander!&quot;);
    }
    if (system.ID === 26 &amp;&amp; missionVariables.ionics === &quot;WAR_IN_RAMAZA&quot;) {
        this.startWar();
    }
};

this.validatePosition = function (ships) {
    /*
    This code makes sure that ships that did drift away while fighting, are put back in the battlezone when called.
    This should prevent that the player can&#39;t find any ship at all, while new ones are not added.
    */
    for (var i=0; i&lt;ships.length; i++) {
        if (this.battlezone.subtract(ships[i].position).magnitude() &gt; 50E3 &amp;&amp; ships[i].AIState == &quot;ATTACK_SHIP&quot;) {
            ships[i].position = battlezone.add(Vector3D.random(10E3));
        }
    }
};

this.sendToPlanet = function (ships) {
    /*
    This code sets all ships in the state: HEAD_FOR_PLANET when they have that state.
    This should delay the pressence of regular police that by default start with going to the 
    whichpoint.
    */
    for (var i=0; i&lt;ships.length; i++) ships[i].AIState = &quot;HEAD_FOR_PLANET&quot;;
}

this.addToGroup = function (mainGroup, ship) {
    // add ship and possible escorts to group. Main reason is to let Oolite deal with friendly fire.
    if (ship.escortGroup) {
        // there are escorts. (ship is part of escort group)
        for (var i=0; i&lt;ship.escortGroup.count; i++) {
            mainGroup.addShip(ship.escortGroup.ships[i]);
        }
    } else {
        mainGroup.addShip(ship);
    }
    ship.group = mainGroup;
};

this.startWar = function (){
    this.ionics_display_stats = true;
    this.linkStation = system.shipsWithPrimaryRole(&quot;ionics_linkbase&quot;)[0];
    if (!this.government_vessels) this.government_vessels = new ShipGroup(&quot;government vessels&quot;);
    if (!this.link_vessels) this.link_vessels = new ShipGroup(&quot;link vessels&quot;);
    this.rlf_additionPoint = Vector3D(0, 200000, 200000).toCoordinateSystem(&quot;wpm&quot;);
    this.battlezone = Vector3D(200000, 0, 0).toCoordinateSystem(&quot;pwm&quot;);
    if (this.warTimer) {
         this.warTimer.start();
    } else {
        this.warTimer = new Timer(this, this.warProgess, 5, 15);
    }
    // missionVariables.ionics_government_kills is added in 1.3.
    // Initialise here in case a player started the mission with the legacy version.
    if (!missionVariables.ionics_government_kills) missionVariables.ionics_government_kills = 0; 
};

this.setupWar = function (){
    // this code was previously in &#39;planetInfo.plist&#39; for system 26
    system.addShips(&quot;asteroid&quot;, 20, Vector3D(400E3, 0, 0).toCoordinateSystem(&quot;pwm&quot;), 20E3);
    system.addShips(&quot;ionics_RLF_vessel&quot;, 5, Vector3D(400E3, 0, 0).toCoordinateSystem(&quot;pwm&quot;), 1);
    system.addShips(&quot;ionics_link_vessel&quot;, 5, Vector3D(400E3, 0, 0).toCoordinateSystem(&quot;pwm&quot;), 1);
    system.addShips(&quot;ionics_linkbase&quot;, 1, Vector3D(400E3, 0, 0).toCoordinateSystem(&quot;pwm&quot;), 1);

}

// add the next with a timer:
this.warProgess = function() {
    if (system.ID !== 26) {this.warTimer.stop(); return}; // Player jumped out of system.

    if (system.countShipsWithPrimaryRole(&quot;ramazan_government_vessel&quot;) == 0 &amp;&amp; this.government_vessels.count == 0) {
        var fleet = missionVariables.ionics_government_fleet_size;
        if (fleet &gt; 5) fleet = 5;
        for (var i = 0; i&lt;fleet; i++) this.addToGroup(this.government_vessels, system.mainStation.launchShipWithRole(&quot;ramazan_government_vessel&quot;, true));
    }

    if (system.countShipsWithPrimaryRole(&quot;ionics_link_vessel&quot;) == 0 &amp;&amp; this.link_vessels.count == 0 &amp;&amp; this.linkStation &amp;&amp; this.linkStation.isValid) {
        var fleet = missionVariables.ionics_link_fleet_size;
        if (fleet &gt; 5) fleet = 5;
        for (var i = 0; i&lt;fleet; i++) this.addToGroup(this.link_vessels, this.linkStation.launchShipWithRole(&quot;ionics_link_vessel&quot;, true));
    }

    if (system.countShipsWithPrimaryRole(&quot;ionics_RLF_vessel&quot;) == 0) {
        var fleet = missionVariables.ionics_rlf_fleet_size;
        if (fleet &gt; 5) fleet = 5;
        if (fleet &gt; 0) system.addShips(&quot;ionics_RLF_vessel&quot;, fleet, this.rlf_additionPoint);
    }
    
    if (missionVariables.ionics_government_fleet_size &lt; 1) {
        missionVariables.ionics = &quot;WAR_IN_RAMAZA_VICTORY&quot;;
        player.commsMessage(&quot;We&#39;ve won the war!!! All vessels return to base for debriefing&quot;, 10);
        mission.setInstructionsKey(&quot;ionics_short_desc8&quot;);
        var weaponPlatforms = system.shipsWithPrimaryRole(&quot;ionics_weapons_platform&quot;);
        for (var i=0; i&lt;weaponPlatforms.length; i++) weaponPlatforms[i].switchAI(&quot;nullAI.plist&quot;);
        this.warTimer.stop();
        delete this.warTimer;
    }
};</pre></td>
                </tr>
                <tr>
                    <td valign="top">Scripts/ionics_weapons_platform.js</td>
                    <td><pre>this.name      = &quot;ionics_weapons_platform&quot;; 
this.author    = &quot;eric walch&quot;; 
this.copyright = &quot;� 2008 eric walch.&quot;; 
this.description = &quot;Ramazan_government_vessel&quot;; 
this.version   = &quot;1.0&quot;;

this.shipSpawned = function () {
    this.ship.primaryRole = &quot;ionics_weapons_platform&quot;;
};

this.shipDied = function (ship) {
    if (ship.isPlayer) missionVariables.ionics_government_kills++;
};</pre></td>
                </tr>
            </table>
        </a>
    </body>
</html>
