<html>
    <head>
        <title>Expansion Fer-de-Lance 3G</title>
        <link rel="stylesheet" href="../style.css">
    </head>
    <body>
        <table border="0" width="100%">
            <tr>
                <td>Back to <a href='../index.html'>Index</a></td>
                <td align="right"><small>Page generated: Oct 11, 2023, 3:16:49 PM</small></td>
            </tr>
        </table>

        <h1>Expansion Fer-de-Lance 3G</h1>

        <h2>Content</h2>
        <ul>
          <li><a href="#warnings">Warnings</a></li>
          <li><a href="#manifest">Manifest</a></li>
          <li><a href="#documentation">Documentation</a></li>
          <li><a href="#equipment">1 Equipment</a></li>
          <li><a href="#ships">60 Ships</a></li>
          <li><a href="#models">0 Models</a></li>
          <li><a href="#scripts">7 Scripts</a></li>
        </ul>

          <a name="warnings">
            <h2>Warnings</h2>
            <ol>
                <li>Replaced equipment &#39;EQ_F3G_ANTISWEEP_MISSILE&#39;</li>
                <li>Replaced equipment &#39;EQ_F3G_ANTISWEEP_MISSILE&#39;</li>
                <li>Tags mismatch between OXP Manifest and Expansion Manager at character position 0002 (RIGHT SQUARE BRACKET vs LATIN SMALL LETTER S)(&#39;[]&#39; vs &#39;[ships]&#39;)</li>
                <li>Conflict Expansions mismatch between OXP Manifest and Expansion Manager at character position 0068 (DIGIT ZERO vs LATIN SMALL LETTER N)</li>
                <li>Unknown key &#39;upload_date&#39; at https://wiki.alioth.net/img_auth.php/d/da/Oolite.oxp.UK_Eliter.Ferdelance_3G.oxz!manifest.plist</li>
            </ol>
          </a>

        <a name="manifest">
        <h2>Manifest</h2>
            <table border="1">
                <tr>
                    <th></th>
                    <th>from Expansion Manager's OXP list</th>
                    <th>from Expansion Manifest</th>
                </tr>
                <tr>
                    <td>Description</td>
                    <td>Adds a line of Fer-de-Lance ships. Player buyable.</td>
                    <td>Adds a line of Fer-de-Lance ships. Player buyable.</td>
                </tr>
                <tr>
                    <td>Identifier</td>
                    <td>oolite.oxp.UK_Eliter.Ferdelance_3G</td>
                    <td>oolite.oxp.UK_Eliter.Ferdelance_3G</td>
                </tr>
                <tr>
                    <td>Title</td>
                    <td>Fer-de-Lance 3G</td>
                    <td>Fer-de-Lance 3G</td>
                </tr>
                <tr>
                    <td>Category</td>
                    <td>Ships</td>
                    <td>Ships</td>
                </tr>
                <tr>
                    <td>Author</td>
                    <td>UK_Eliter</td>
                    <td>UK_Eliter</td>
                </tr>
                <tr>
                    <td>Version</td>
                    <td>6.63</td>
                    <td>6.63</td>
                </tr>
                <tr>
                    <td>Tags</td>
                    <td></td>
                    <td>ships</td>
                </tr>
                <tr>
                    <td>Required Oolite Version</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Maximum Oolite Version</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Required Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Optional Expansions</td>
                    <td>
                            <li>oolite.oxp.UK_Eliter.ExtraThargoids:6.5</li>
                            <li>oolite.oxp.UK_Eliter.InterstellarTweaks:5.1</li>
                    </td>
                    <td>
                            <li>oolite.oxp.UK_Eliter.ExtraThargoids:6.5</li>
                            <li>oolite.oxp.UK_Eliter.InterstellarTweaks:5.1</li>
                    </td>
                </tr>
                <tr>
                    <td>Conflict Expansions</td>
                    <td>
                            <li>oolite.oxp.UK_Eliter.Ferdelance_3G:0</li>
                            <li>oolite.oxp.Ferdelance_3G:0</li>
                    </td>
                    <td>
                            <li>oolite.oxp.UK_Eliter.Ferdelance_3G:</li>
                            <li>oolite.oxp.Ferdelance_3G:</li>
                    </td>
                </tr>
                <tr>
                    <td>Information URL</td>
                    <td><a target="_blank" href="http://aegidian.org/bb/viewtopic.php?f=4&amp;t=9415">http://aegidian.org/bb/viewtopic.php?f=4&amp;t=9415</a></td>
                    <td><a target="_blank" href="">n/a</a></td>
                </tr>
                <tr>
                    <td>Download URL</td>
                    <td><a target="_blank" href="https://wiki.alioth.net/img_auth.php/d/da/Oolite.oxp.UK_Eliter.Ferdelance_3G.oxz">https://wiki.alioth.net/img_auth.php/d/da/Oolite.oxp.UK_Eliter.Ferdelance_3G.oxz</a></td>
                    <td><a target="_blank" href="http://wiki.alioth.net/img_auth.php/d/da/Oolite.oxp.UK_Eliter.Ferdelance_3G.oxz">http://wiki.alioth.net/img_auth.php/d/da/Oolite.oxp.UK_Eliter.Ferdelance_3G.oxz</a></td>
                </tr>
                <tr>
                    <td>License</td>
                    <td>Creative Commons Attribution - Non-Commercial - Share Alike 4.0 license</td>
                    <td>Creative Commons Attribution - Non-Commercial - Share Alike 4.0 license</td>
                </tr>
                <tr>
                    <td>File Size</td>
                    <td>n/a</td>
                </tr>
                <tr>
                    <td>Upload date</td>
                    <td>1646067123</td>
                </tr>
            </table>
                </a>

        <a name="documentation">
        <h2>Documentation</h2>
        <p>Also read <a href='http://wiki.alioth.net/index.php/Fer-de-Lance%203G'>http://wiki.alioth.net/index.php/Fer-de-Lance%203G</a></p>
        <h3>Ferdelance3G Readme &amp; License.txt</h3>
        <pre>==========================================
&#39;Fer-de-Lance 3G&#39; OXP by (the unimaginatively named) &#39;UK_Eliter&#39;
==========================================

--------------------------
GENERAL NOTES
--------------------------

� This OXP does not depend on any other OXP. Yet, it does work better when various other OXPs are installed, including these ones: Armoury; Missiles &amp; Bombs; Nexus Missile; Thargoid Carrier.

� For details of (most of . .) the ships, please see the accompanying PDF brochure.

� This ship needs Oolite version &gt;= 1.82.


� PLEASE DELETE OLD VERSION OF THE OXP FROM YOUR ADDONS FOLDER BEFORE COPYING-IN THIS ONE.

---------------------------
ACKNOWLEDGEMENTS
---------------------------

The graphics in this OXP are adapted from the ferdelance model built into Oolite.

My thanks to the following for help with this OXP.

&#39;cim&#39;
&#39;Commander McLane&#39; (from whose Anarchies OXP I have somewhat adapted some message descriptions)
&#39;Diziet Sma&#39;
&#39;Eric Walch&#39; (who provided some javascript routines)
&#39;fronclynne&#39;
&#39;Killer Wolf&#39;
&#39;Rustem&#39;
&#39;Smivs&#39; (for help with graphics)
&#39;Svengali&#39;
&#39;Thargoid&#39; (from whose &#39;Vortex&#39; OXP the turrets in this my OXP are adapted - and adapted, indeed, mainly *by* Thargoid; I&#39;ve borrowed some material from his Aquatics and Armoury OXPs too)


---------------------------
GENERAL INFO
---------------------------

The &#39;Config&#39; folder contains a script that can be used to see - in form of non-player-characters - some of the ships contained in this OXP. See within that folder itself for further instructions.

Please see the PDF for the specifications of the &#39;3G&#39; ships.

---------------------------
LICENSE
---------------------------

This OXP is released under the Creative Commons Attribution - Non-Commercial - Share Alike 3.0 license.

This work is licensed under the Creative Commons Attribution-NonCommercial-ShareAlike License. To view a copy of this license, visit http://creativecommons.org/licenses/by-nc-sa/2.0/ or send a letter to Creative Commons, 559 Nathan Abbott Way, Stanford, California 94305, USA. 

You are free:

� to copy, distribute, display, and perform the work;
� to make derivative works. 

But only under the following conditions.

� Attribution: you must give the original author credit. 
� Non-commercial use: you may not use this work for commercial purposes. 
� Share Alike: if you alter, transform, or build upon this work, you may distribute the resulting work only under a license materially identical to this one. 

Your fair use right and other rights are in no way affected by the above.

----------------- END ----------------- 
</pre>
        </a>

        <a name="equipment">          
        <h2>Equipment</h2>
            <table>
                <tr>
                    <th>Name</th>
                    <th>Visible</th>
                    <th>Cost [deci-credits]</th>
                    <th>Tech-Level</th>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_F3G_ANTISWEEP_MISSILE.html">Sweeper-resistant navy missile</a></td>
                    <td>yes</td>
                    <td align="right">14000</td>
                    <td align="center">13+</td>
                </tr>
            </table>
        </a>

        <a name="ships">    
        <h2>Ships</h2>
            <table>
                <tr>
                    <th>Name</th>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3-player.html">ferdelance3-player</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3-playerPlusModel.html">ferdelance3-playerPlusModel</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3-playerPlusModelWithTurrets.html">ferdelance3-playerPlusModelWithTurrets</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3-playerPlusModelWithTurretsPoliceDecomissioned.html">ferdelance3-playerPlusModelWithTurretsPoliceDecomissioned</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3-playerVariant.html">ferdelance3-playerVariant</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3G_+(t)Template.html">Fer-de-Lance 3G+(t)</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3G_+(t)TemplateNPC.html">ferdelance3G_+(t)TemplateNPC</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3G_+HardPirate.html">ferdelance3G_+HardPirate</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3G_+T_HardPirate.html">ferdelance3G_+T_HardPirate</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3G_+T_HardPiratePoliceDecomissioned.html">ferdelance3G_+T_HardPiratePoliceDecomissioned</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3G_+Template.html">Fer-de-Lance 3G+</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3G_+TemplateNPC.html">ferdelance3G_+TemplateNPC</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3G_antiSweeperMissile.html">Sweeper-resistant navy missile</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3G_escort1.html">ferdelance3G_escort1</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3G_escort2.html">ferdelance3G_escort2</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3G_escort3.html">ferdelance3G_escort3</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3G_escort4.html">ferdelance3G_escort4</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3G_escort5.html">ferdelance3G_escort5</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3G_escort6.html">ferdelance3G_escort6</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3G_escort7.html">ferdelance3G_escort7</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3G_escort8.html">ferdelance3G_escort8</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3G_hardHunter.html">ferdelance3G_hardHunter</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3G_hardPirate.html">ferdelance3G_hardPirate</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3G_hardPirateAlt.html">ferdelance3G_hardPirateAlt</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3G_hardTrader.html">ferdelance3G_hardTrader</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3G_hardTrader3G+.html">ferdelance3G_hardTrader3G+</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3G_hardTrader3G+Escorted.html">ferdelance3G_hardTrader3G+Escorted</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3G_hardTrader3G+EscortedVariant.html">ferdelance3G_hardTrader3G+EscortedVariant</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3G_hardTraderEscorted.html">ferdelance3G_hardTraderEscorted</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3G_hardTraderEscortedVariant.html">ferdelance3G_hardTraderEscortedVariant</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3G_hardTraderEscortedVariant2.html">ferdelance3G_hardTraderEscortedVariant2</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3G_hardTraderVariant.html">ferdelance3G_hardTraderVariant</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3G_hardestHunter.html">ferdelance3G_hardestHunter</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3G_hardestHunterEscorted.html">ferdelance3G_hardestHunterEscorted</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3G_hardestHunterPoliceDecomissioned.html">ferdelance3G_hardestHunterPoliceDecomissioned</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3G_hunter.html">ferdelance3G_hunter</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3G_hunterVariant.html">ferdelance3G_hunterVariant</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3G_interstellar.html">Fer-de-Lance 3G+(t) (military interstellar)</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3G_interstellar2.html">Fer-de-Lance 3G+(t) (military Bugblatter)</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3G_interstellarTurret.html">ferdelance3G_interstellarTurret</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3G_interstellarTurret2.html">ferdelance3G_interstellarTurret2</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3G_pirate.html">ferdelance3G_pirate</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3G_pirateAlt.html">ferdelance3G_pirateAlt</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3G_pirateKing.html">Fer-de-Lance 3G+(t) (Pirate King)</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3G_player.html">ferdelance3G_player</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3G_playerPlusModel.html">ferdelance3G_playerPlusModel</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3G_playerPlusModelWithTurrets.html">ferdelance3G_playerPlusModelWithTurrets</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3G_playerPlusModelWithTurretsPoliceDecomissioned.html">ferdelance3G_playerPlusModelWithTurretsPoliceDecomissioned</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3G_playerTank.html">Fer-de-Lance 3G (Delux-o-Tank variant)</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3G_playerVariant.html">ferdelance3G_playerVariant</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3G_polTurret.html">ferdelance3G_polTurret</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3G_police.html">Fer-de-Lance 3G+(t) (police)</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3G_policeDecomissionedTemplate.html">Fer-de-Lance 3G+(t) (ex-police)</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3G_template.html">Fer-de-Lance 3G</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3G_templateNPC.html">ferdelance3G_templateNPC</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3G_trader.html">ferdelance3G_trader</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3G_traderVariant.html">ferdelance3G_traderVariant</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3G_turret.html">3G Turret</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3G_variantTemplate.html">Fer-de-Lance 3G</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ferdelance3G_variantTemplateNPC.html">ferdelance3G_variantTemplateNPC</a></td>
                </tr>
            </table>
        </a>

        <a name="models">    
        <h2>Models</h2>
            This expansion declares no models. This may be related to warnings.
        </a>

        <a name="scripts">    
        <h2>Scripts</h2>
            <table>
                <tr>
                    <th>Path</th>
                </tr>
                <tr>
                    <td valign="top">Scripts/ferdelance3G_antiSweeper.js</td>
                    <td><pre>/*
========================================================================
ferdelance3G_antiSweeper.js
This file is part of the &#39;Ferdelance 3G&#39; expansion pack.
Author: UK_Eliter
License: 2017 Creative Commons: attribution, non-commercial, sharealike.
========================================================================
*/


/*
====================
JSLINT: set options
====================
*/

/*jshint esversion: 6*/
/*jshint sub:true*/

this.name = &quot;ferdelance3G_antiSweeper&quot;;
this.author = &quot;UK_Eliter&quot;;
this.copyright = &quot;&quot;;
this.description = &quot;Script for anti-Sweeper missile &quot;;
this.license = &quot;CC-by-nc-sa 3.0&quot;;



/*
------------------
DEBUGGING SWITCHES
------------------
*/

// this.logging = true;
var consoleDebugMessages = false; // do NOT comment this out. Rather, to disable, set to false.


/*
------------------------
JSLINT: start of wrapper
------------------------
*/

(function() {
	&quot;use strict&quot;;


	/*
	--------------------
	ROUTINE CALLED BY AI
	The second parameter of dealEnergyDamage is the &#39;ideal range&#39;; it should match the desiredRange in the AI.
	See: http://wiki.alioth.net/index.php/Oolite_JavaScript_Reference:_Ship#dealEnergyDamage
	--------------------
	*/

	this.$_detonate = function() {
		if (this.ship.target &amp;&amp; this.ship.target.isThargoid) {
			this.ship.dealEnergyDamage(660, 35, 0.1);
		} else {
			this.ship.dealEnergyDamage(300, 35, 0.15);
		}
		this.ship.explode();
	};


	/*
	----------------------
	JSLINT: end of wrapper
	----------------------
	*/

}).call(this);


// EOF</pre></td>
                </tr>
                <tr>
                    <td valign="top">Scripts/ferdelance3G_conditions.js</td>
                    <td><pre>/*
========================================================================
ferdelance3G_conditions.js
This file is part of the &#39;Ferdelance 3G&#39; expansion pack.
Author: UK_Eliter
License: 2017 Creative Commons: attribution, non-commercial, sharealike.
========================================================================
*/


/*
====================
JSLINT: set options
====================
*/

/*jshint esversion: 6*/
/*jshint sub:true*/


this.name = &quot;ferdelance3G_conditionsScript&quot;;
this.author = &quot;UK_Eliter&quot;;
this.description = &quot;ferdelance3G_conditionsScript.js&quot;;
this.copyright = &quot;2014 Creative Commons: attribution, non-commercial, sharealike.&quot;;
this.licence = &quot;CC-NC-SA 3&quot;;


/*
====--------------
DEBUGGING SWITCHES
------------------
*/

var consoleDebugMessages = false; // do NOT comment this out. Rather, to disable, set to false.
//this.logging = true; // THIS SHOULD BE COMMENTED OUT WHEN NOT TESTING
//this.debug = false;


/*
------------------------
JSLINT: start of wrapper
------------------------
*/

(function() {
	&quot;use strict&quot;;


	/*
	------------------
	CONDITION ROUTINES
	------------------
	*/

	this.allowAwardEquipment = function(eqKey, ship, context) {
		var chance = 0;
		switch (eqKey) {
			case &quot;EQ_F3G_ANTISWEEP_MISSILE&quot;:
				if (player.ship.dockedStation === &quot;Navy SecCom Station&quot;) {
					chance = 0.87;
				} else if (system.techLevel &gt; 10) {
					chance = 0.7;
				} else {
					if (system.techLevel &gt; 8) {
						chance = 0.45;
					}
				}
		}
		if (chance === 0) {
			return;
		}
		if (Math.random() &lt; 0.9 &amp;&amp; system.scrambledPseudoRandomNumber(6921) &lt; chance) {
			return true;
		}
		if (Math.random() &lt; chance) {
			return true;
		}
		return false;
	};

	this.updateEquipmentPrice = function(eqKey, currentPrice) {
		var myPrice;
		switch (eqKey) {
			case &quot;EQ_F3G_ANTISWEEP_MISSILE&quot;:
				if (player.ship.dockedStation === &quot;Navy SecCom Station&quot;) {
					myPrice = 1000;
					return (myPrice);
				}
				// Otherwise
				if (system.techLevel &gt; 10) {
					if (Math.random() &lt; 0.95) {
						myPrice = 13000 + ((Math.ceil(system.scrambledPseudoRandomNumber(3420) * 10)) * 1000);
					} else {
						myPrice = 13000 + ((Math.ceil(Math.random() * 10)) * 1000);
					}
					return (myPrice);
				}
				// Otherwise
				if (system.techLevel &gt; 8) {
					if (Math.random() &lt; 0.95) {
						myPrice = 10000 + ((Math.ceil(system.scrambledPseudoRandomNumber(3420) * 18)) * 1000);
					} else {
						myPrice = 10000 + ((Math.ceil(Math.random() * 18)) * 1000);
					}
					return (myPrice);
				}
		}
	};


	/*
	----------------------
	JSLINT: end of wrapper
	----------------------
	*/

}).call(this);


// EOF</pre></td>
                </tr>
                <tr>
                    <td valign="top">Scripts/ferdelance3G_hunter.js</td>
                    <td><pre>/*
========================================================================
ferdelance3G_hunter.js
This file is part of the &#39;Ferdelance 3G&#39; expansion pack.
Author: UK_Eliter
License: 2017 Creative Commons: attribution, non-commercial, sharealike.
========================================================================
*/

/*
====================
JSLINT: set options
====================
*/

/*jshint esversion: 6*/
/*jshint sub:true*/

this.name = &quot;ferdelance3G_hunter&quot;;
this.author = &quot;UK_Eliter&quot;;
this.copyright = &quot;&quot;;
this.description = &quot;ferdelance3G_hunter.js (for NPCs)&quot;;
this.license = &quot;2014 CC-by-nc-sa 3.0&quot;;


/*
------------------
DEBUGGING SWITCHES
------------------
*/

// this.logging = true;
var consoleDebugMessages = false; // do NOT comment this out. Rather, to disable, set to false.
this.debug = false;

if (this.debug) {
	this.ship.reportAIMessages = true;
}


/*
------------------------
JSLINT: start of wrapper
------------------------
*/

(function() {
	&quot;use strict&quot;;

	/*
	--------------
	EVENT HANDLERS
	--------------
	*/

	this.shipSpawned = function() {
		var r = Math.random();
		if (r &gt; 0.45) {
			// ** Special ORDINANCE **
			// 1st level ordinance: possibility of some hardheads; 2nd level: more serious stuff; 3rd: q-bomb..
			var capacity;
			var chanceThirdLevelOrdinance = 0.11;
			var giveSecondLevelOrdinance = false;
			var i;
			var ordinanceAvailable;
			var ordinanceCount;

			ordinanceAvailable = [&quot;EQ_MISSILE&quot;, &quot;EQ_MISSILE&quot;, &quot;EQ_MISSILE&quot;]; // Hard-heads added to the list, below
			if (this.ship.hasRole(&quot;ferdelance3G_+T&quot;)) {
				giveSecondLevelOrdinance = true;
				chanceThirdLevelOrdinance = 0.15;
			} else if (r &gt; 0.7) {
				giveSecondLevelOrdinance = true;
			}
			if (giveSecondLevelOrdinance) {
				if (worldScripts[&quot;Missiles &amp; Bombs&quot;]) {
					ordinanceAvailable.push(&quot;EQ_RMB_FRAG_MISSILE&quot;, &quot;EQ_RMB_OVERRIDE_MISSILE&quot;, &quot;EQ_RMB_LAW_MISSILE&quot;, &quot;EQ_RMB_INTERCEPT_MISSILE&quot;, &quot;EQ_RMB_INTERCEPT_MISSILE&quot;, &quot;EQ_RMB_INTERCEPT_MISSILE&quot;);
				}
				if (EquipmentInfo.infoForKey(&quot;EQ_TORPEDO_MISSILE&quot;)) {
					ordinanceAvailable.push(&quot;EQ_TORPEDO_MISSILE&quot;);
				}
				if (EquipmentInfo.infoForKey(&quot;EQ_HARPOON_NUKE1_MISSILE&quot;)) {
					ordinanceAvailable.push(&quot;EQ_HARPOON_NUKE1_MISSILE&quot;);
				}
				if (worldScripts[&quot;armoury_trackerWorldScript.js&quot;]) {
					ordinanceAvailable.push(&quot;EQ_ARMOURY_STUNBOMB_MINE&quot;);
					if (this.ship.equipmentStatus(&quot;EQ_CLOAKING_DEVICE&quot;) != &quot;EQUIPMENT_OK&quot;) {
						ordinanceAvailable.push(&quot;EQ_KDRONE_LAUNCHER_MINE&quot;, &quot;EQ_CDRONE_LAUNCHER_MINE&quot;);
					}
				}
				if (EquipmentInfo.infoForKey(&quot;EQ_NEXUS_BUG_MISSILE&quot;)) {
					ordinanceAvailable.push(&quot;EQ_NEXUS_PREMIUM_MISSILE&quot;);
					if (r &gt; 0.9) {
						ordinanceAvailable.push(&quot;EQ_NEXUS_PREMIUM_MISSILE&quot;);
					} else {
						ordinanceAvailable.push(&quot;EQ_NEXUS_BASIC_MISSILE&quot;);
					}
				}
				capacity = this.ship.missileCapacity;
				// LEVEL THREE
				if (Math.random() &lt;= chanceThirdLevelOrdinance) {
					this.ship.awardEquipment(&quot;EQ_QC_MINE&quot;); // NB: actually award
					--capacity;
				}
			}
			ordinanceCount = ordinanceAvailable.length;
			i = ordinanceCount;
			while (i--) {
				ordinanceAvailable.push(&quot;EQ_HARDENED_MISSILE&quot;);
			} // add one of these for every existing missile in the list
			// Load ordinance to ship
			ordinanceCount = ordinanceAvailable.length; // this will have changed
			i = capacity - 1;
			do {
				this.ship.awardEquipment(ordinanceAvailable[~~(Math.random() * ordinanceCount)]);
			}
			while (i--);
		}
		/*
		**	BOUNTY **
			NB: This script is used not only for hunters but also for assassins.
		*/
		var r2 = Math.random(); // Threshold is 0.7. *Does* need to be r*2*.
		if (r2 &gt; 0.7) {
			if (r2 &lt; 0.9) {
				this.ship.bounty += (Math.ceil(r * 32));
				// sic - &#39;r&#39;, not &#39;r2&#39;.
			} else {
				this.ship.bounty += 2 + (Math.ceil(r * 120));
				// sic - &#39;r&#39;, not &#39;r2&#39;.
			}
		}
		// **CLEAN-UP **
		delete this.shipSpawned;
	};



	/*
	----------------------
	JSLINT: end of wrapper
	----------------------
	*/

}).call(this);


// EOF</pre></td>
                </tr>
                <tr>
                    <td valign="top">Scripts/ferdelance3G_milInterstellar.js</td>
                    <td><pre>/*
========================================================================
ferdelance3G_milInterstellar.js
This file is part of the &#39;Ferdelance 3G&#39; expansion pack.
Author: UK_Eliter
License: 2017 Creative Commons: attribution, non-commercial, sharealike.
========================================================================
*/


/*
====================
JSLINT: set options
====================
*/

/*jshint esversion: 6*/
/*jshint sub:true*/


this.name = &quot;ferdelance3G_milInterstellar.js&quot;;
this.author = &quot;UK_Eliter&quot;;
this.copyright = &quot;&quot;;
this.description = &quot;ferdelance3G-mainScript.js (for NPCs)&quot;;
this.license = &quot;CC-by-nc-sa 3.0&quot;;


/*
------------------
DEBUGGING SWITCHES
------------------
*/

this.debug = false;

if (this.debug) {
	this.ship.reportAIMessages = true;
}


/*
------------------------
JSLINT: start of wrapper
------------------------
*/

(function() {
	&quot;use strict&quot;;


	/*
	--------------
	EVENT HANDLERS
	--------------
	*/

	this.shipSpawned = function() {
		// Record presence/absence of some OXPs or weapons for multiple use within THIS function.

		var OXPInstalled_extraBugs;
		if (worldScripts[&quot;extraThargoids_populator.js&quot;]) {
			OXPInstalled_extraBugs = true;
		} else {
			OXPInstalled_extraBugs = false;
		}

		var OXPInstalled_missilesAndBombs;
		if (worldScripts[&quot;Missiles &amp; Bombs&quot;]) {
			OXPInstalled_missilesAndBombs = true;
		} else {
			OXPInstalled_missilesAndBombs = false;
		}

		var OXPInstalled_nexus;
		if (!EquipmentInfo.infoForKey(&quot;EQ_NEXUS_BUG_MISSILE&quot;)) {
			OXPInstalled_nexus = true;
		} else {
			OXPInstalled_nexus = false;
		}

		// Create weighted list of available ordinance - varying with ship type
		var ordinanceAvailable;
		if (this.ship.hasRole(&quot;ferdelance3Bugblatter&quot;)) {
			// BUGBLATTER
			ordinanceAvailable = [&quot;EQ_F3G_ANTISWEEP_MISSILE&quot;, &quot;EQ_F3G_ANTISWEEP_MISSILE&quot;, &quot;EQ_HARDENED_MISSILE&quot;];
			if (OXPInstalled_nexus === true) {
				ordinanceAvailable.push(&quot;EQ_NEXUS_BUG_MISSILE&quot;, &quot;EQ_NEXUS_BUG_MISSILE&quot;);
			} else if (OXPInstalled_missilesAndBombs) {
				ordinanceAvailable.push(&quot;EQ_RMB_THARGOID_MISSILE&quot;, &quot;EQ_RMB_THARGOID_MISSILE&quot;);
			}
			if (worldScripts[&quot;armoury_trackerWorldScript.js&quot;]) {
				ordinanceAvailable.push(&quot;EQ_ARMOURY_SCREAMER_MINE&quot;);
			}
			if ((worldScripts.TCAT_masterScript != undefined)) {
				ordinanceAvailable.push(&quot;EQ_TCAT_JAMMER_MINE&quot;);
			}
			if (EquipmentInfo.infoForKey(&quot;EQ_TORPEDO_MISSILE&quot;)) {
				ordinanceAvailable.push(&quot;EQ_TORPEDO_MISSILE&quot;);
			}
		} else {
			// NORMAL
			ordinanceAvailable = [&quot;EQ_F3G_ANTISWEEP_MISSILE&quot;, &quot;EQ_F3G_ANTISWEEP_MISSILE&quot;, &quot;EQ_HARDENED_MISSILE&quot;, &quot;EQ_HARDENED_MISSILE&quot;];
			if (OXPInstalled_extraBugs) {
				ordinanceAvailable.push(&quot;EQ_F3G_ANTISWEEP_MISSILE&quot;);
			}
			if (OXPInstalled_nexus === true) {
				ordinanceAvailable.push(&quot;EQ_NEXUS_BUG_MISSILE&quot;, &quot;EQ_NEXUS_BUG_MISSILE&quot;);
				if (OXPInstalled_missilesAndBombs) {
					ordinanceAvailable.push(&quot;EQ_RMB_THARGOID_MISSILE&quot;);
				}
			} else if (OXPInstalled_missilesAndBombs) {
				ordinanceAvailable.push(&quot;EQ_RMB_THARGOID_MISSILE&quot;, &quot;EQ_RMB_THARGOID_MISSILE&quot;);
			} else if (EquipmentInfo.infoForKey(&quot;EQ_MILITARY_MISSILE&quot;)) {
				ordinanceAvailable.push(&quot;EQ_MILITARY_MISSILE&quot;, &quot;EQ_MILITARY_MISSILE&quot;, &quot;EQ_MILITARY_MISSILE&quot;);
			}
		}
		var ordinance_shipSlots = this.ship.missileordinance_shipSlots;
		var ordinance_availableArray_length = ordinanceAvailable.length;
		var i = ordinance_shipSlots - 1;
		do {
			this.ship.awardEquipment(ordinanceAvailable[~~(Math.random() * ordinance_availableArray_length)]);
		}
		while (i--);
		//
		delete this.shipSpawned;
	};


	/*
	--------
	SCANNING
	--------
	*/

	this.$isSweeper = function(e) {
		return e.isShip &amp;&amp; e.isThargoid &amp;&amp; e.hasRole(&quot;extraThargoids_sweeper&quot;);
	};

	this.$isBigBug = function(e) {
		return e.isShip &amp;&amp; e.isThargoid &amp;&amp; e.mass &gt; 900000;
	};

	this.$isVeryBigBug = function(e) {
		return e.isShip &amp;&amp; e.isThargoid &amp;&amp; e.mass &gt; 4600000;
	};

	this.$scanForPrimaryTarget = function() {
		if (!this.ship || !this.ship.isPiloted) {
			return;
		}
		// if ( this.debug ) {player.consoleMessage(&quot;3G - SEEKING&quot;, 5);}
		// Look for sweepers
		var bigBugs;
		var sweepers = system.filteredEntities(this, this.$isSweeper, this.ship, 25600);
		if (sweepers.length &gt; 0) {
			// See whether target a sweeper or instead look for a big bug
			bigBugs = system.filteredEntities(this, this.$isVeryBigBug, this.ship, 75000); // note range
			if (bigBugs.length === 0) {
				// Is at least one sweeper, are no (very) big bugs - so, go for a sweeper.
				// So -if is more than one sweeper, decide which one to target.
				if (sweepers.length === 1 || Math.random() &lt; 0.65) {
					this.ship.target = sweepers[0];
				} else {
					this.ship.target = sweepers[1];
				}
				this.ship.reactToAIMessage(&quot;TARGET_FOUND&quot;);
			} else {
				// Is at least one sweeper and at least one (very) big bug. So decide which type to go for.
				var r = Math.random();
				if (r &lt; 0.85) {
					// Target a sweeper.
					if (sweepers.length === 1 || r &lt; 0.6) {
						this.ship.target = sweepers[0];
					} else {
						this.ship.target = sweepers[1];
					}
					this.ship.reactToAIMessage(&quot;TARGET_FOUND&quot;);
				} else {
					// Target a (very) bigbug.
					// Now decide which bigbug, if more than one.
					if (bigBugs.length === 1 || Math.random() &lt; 0.6) {
						this.ship.target = bigBugs[0];
					} else {
						this.ship.target = bigBugs[1];
					}
					this.ship.reactToAIMessage(&quot;TARGET_FOUND&quot;);
				}
			}
		} else {
			// Are no sweepers. So look for (very) big bugs.
			bigBugs = system.filteredEntities(this, $isVeryBigBug, this.ship, 25600); // note range
			if (bigBugs.length &gt; 0) {
				if (bigBugs.length === 1 || Math.random() &lt; 0.55) {
					this.ship.target = bigBugs[0];
				} else {
					this.ship.target = bigBugs[1];
				}
				this.ship.reactToAIMessage(&quot;TARGET_FOUND&quot;);
			} else {
				// Found no sweeper nor any very big bug - so look, up to just outside scanner range, for fairly big bugs.
				bigBugs = system.filteredEntities(this, this.$isBigBug, this.ship, 25600);
				if (bigBugs.length &gt; 0) {
					if (bigBugs.length === 1 || Math.random() &lt; 0.6) {
						this.ship.target = bigBugs[0];
					} else {
						this.ship.target = bigBugs[1];
					}
					this.ship.reactToAIMessage(&quot;TARGET_FOUND&quot;);
				} else {
					this.ship.reactToAIMessage(&quot;NOTHING_FOUND&quot;); // Do need always to end with this or $doInterceptOfThargoid.
				}
			}
		}
	};

	this.$isSuitableTarget = function(e) {
		return e.isShip &amp;&amp; e.isThargoid &amp;&amp; e.mass &gt; 500000 &amp;&amp; e.primaryRole !== &quot;thargoidRebel&quot;;
	};

	this.$scanForSecondaryTarget = function() {
		if (!this.ship || !this.ship.isPiloted) {
			return;
		}
		// if ( this.debug ) {player.consoleMessage(&quot;3G - SEEKING&quot;, 5);}

		// Tharglet mass: 7829.43
		// Frigate mass: 110048
		// Warship mass: 899378
		var targetArray = system.filteredEntities(this, this.$isSuitableTarget, this.ship, 25600);
		if (targetArray.length === 0) {
			this.ship.reactToAIMessage(&quot;NOTHING_FOUND&quot;);
			return;
		}
		// else
		if ((targetArray.length === 1) || (Math.random() &lt; 0.7)) {
			this.ship.target = targetArray[0];
		} else {
			this.ship.target = targetArray[1];
		}
		// player.consoleMessage(&quot;3G - OK!&quot;, 5);
		this.ship.reactToAIMessage(&quot;TARGET_FOUND&quot;);
	};

	this.$isSuitableNavy = function(e) {
		return e.isShip &amp;&amp; (e.mass &gt; 20000000) &amp;&amp; (e.isPolice || e.scanClass === &quot;CLASS_MILITARY&quot;);
	};

	this.$findNavy = function() {
		var navalArray;

		navalArray = system.filteredEntities(this, this.$isSuitableNavy, this.ship, 50000);
		if (navalArray.length &gt; 0) {
			if ((navalArray.length === 1) || (Math.random() &lt; 0.7)) {
				this.ship.target = navalArray[0];
			} else {
				this.ship.target = navalArray[1];
			}
			this.ship.reactToAIMessage(&quot;TARGET_FOUND&quot;);
		} else {
			this.ship.reactToAIMessage(&quot;NOTHING_FOUND&quot;);
		}
	};


	/*
	---------------------
	ATTACK ROUTINES &amp; co.
	---------------------
	*/

	this.$considerRespondingToAttack = function() {
		if (!this.ship || !this.ship.isPiloted) {
			return;
		}
		if (!this.ship.target || !this.ship.target.isValid) {
			return;
		}
		if (this.ship.target.isThargoid) {
			this.ship.reactToAIMessage(&quot;RESPOND_TO_ATTACK&quot;);
			return;
		}
		// else
		if (this.ship.target.scanClass === &quot;CLASS_MILITARY&quot; || this.ship.target.scanClass === &quot;CLASS_POLICE&quot;) {
			if (Math.random() &lt; 0.02) {
				this.ship.reactToAIMessage(&quot;RESPOND_TO_ATTACK&quot;);
			} else {
				this.ship.reactToAIMessage(&quot;POOTLE_IN_RESPONSE_TO_ATTACK&quot;);
			}
		} else {
			if (Math.random() &lt; 0.2) {
				this.ship.reactToAIMessage(&quot;RESPOND_TO_ATTACK&quot;);
			} else {
				this.ship.reactToAIMessage(&quot;POOTLE_IN_RESPONSE_TO_ATTACK&quot;);
			}
		}
	};

	this.$considerRespondingToAttackWhenInterceptingNavy = function() {
		if (!this.ship || !this.ship.isPiloted) {
			return;
		}
		if (!this.ship.target || !this.ship.target.isValid) {
			return;
		}
		if (
			this.ship.target.isPlayer ||
			(!this.ship.target.isThargoid &amp;&amp; (this.ship.target.scanClass !== &quot;CLASS_MILITARY&quot;) &amp;&amp; (this.ship.target.scanClass !== &quot;CLASS_POLICE&quot;))
		) {
			if (Math.random() &lt; 0.27) {
				this.ship.reactToAIMessage(&quot;RESPOND_TO_ATTACK&quot;);
			} else {
				this.ship.reactToAIMessage(&quot;DO_NOT_RESPOND_TO_ATTACK&quot;);
			}
		} else {
			this.ship.reactToAIMessage(&quot;RESPOND_TO_ATTACK&quot;);
		}
	};

	this.$setMisjump = function() {
		var r = Math.random();
		this.ship.scriptedMisjump = true;
		if (r &lt; 0.4) {
			this.ship.scriptedMisjumpRange = r * 2;
		}
	};


	/*
	---------
	DEBUGGING
	---------
	*/

	//this.messagePlayerIfPlayerWithinScannerRangeOfShip = function(text)
	//{
	//	if (!this.ship) {return;}
	//	if (!this.ship.position) {return;}
	//	if (!player.ship) {return;}
	//	if (!player.ship.isValid) {return;}
	//	if ( this.ship.position.distanceTo(player.ship.position) &lt; 23000 ) {player.consoleMessage(text, 6);}
	//}
	//
	//
	//this.message = function(text) {player.consoleMessage(text, 6);}


	/*
	----------------------
	JSLINT: end of wrapper
	----------------------
	*/

}).call(this);


// EOF</pre></td>
                </tr>
                <tr>
                    <td valign="top">Scripts/ferdelance3G_pirate.js</td>
                    <td><pre>/*
========================================================================
ferdelance3G_pirate.js
This file is part of the &#39;Ferdelance 3G&#39; expansion pack.
Author: UK_Eliter
License: 2017 Creative Commons: attribution, non-commercial, sharealike.
========================================================================
*/


/*
====================
JSLINT: set options
====================
*/

/*jshint esversion: 6*/
/*jshint sub:true*/


this.name = &quot;ferdelance3G_pirate&quot;;
this.author = &quot;UK_Eliter&quot;;
this.copyright = &quot;&quot;;
this.description = &quot;ferdelance3G_pirate.js (for NPCs)&quot;;
this.license = &quot;CC-by-nc-sa 3.0&quot;;

/*
------------------
DEBUGGING SWITCHES
------------------
*/


// this.logging = true;

this.debug = false;

if (this.debug) {
	this.ship.reportAIMessages = true;
}


/*
------------------------
JSLINT: start of wrapper
------------------------
*/

(function() {
	&quot;use strict&quot;;


	/*
	--------------
	EVENT HANDLERS
	---------------
	*/

	this.shipSpawned = function() // For BOUNTY and ALLOCATING MISSILES
	{
		var l;
		/*jshint -W009 */
		var ordinance_available = new Array();
		/*jshint +W009 */
		var ordinance_available_level_two;
		var ordinance_available_level_three_chance;
		var ordinance_capacity;
		var ordinanceCount;
		var ordinance_available_length;

		ordinance_available_level_two = false;
		ordinance_available_level_three_chance = 0.11;
		ordinance_capacity = this.shipSpawned.missileCapacity;

		if (this.ship.hasRole(&quot;ferdelance3G_+T&quot;)) {
			ordinance_available_level_two = true;
			if (this.ship.hasRole(&quot;ferdelance3G_pirateKing&quot;)) {
				this.ship.bounty += 50 + ~~((Math.random() * 120) + 1);
				ordinance_available_level_three_chance = 0.8;
			}
		} else if (Math.random() &gt; 0.6) {
			ordinance_available_level_two = true;
		}

		if (ordinance_available_level_two) {
			if (worldScripts[&quot;Missiles &amp; Bombs&quot;]) {
				ordinance_available.push(&quot;EQ_RMB_FRAG_MISSILE&quot;, &quot;EQ_RMB_OVERRIDE_MISSILE&quot;, &quot;EQ_RMB_INTERCEPT_MISSILE&quot;, &quot;EQ_RMB_INTERCEPT_MISSILE&quot;);
			}

			if (worldScripts[&quot;armoury_trackerWorldScript.js&quot;]) {
				ordinance_available.push(&quot;EQ_ARMOURY_STUNBOMB_MINE&quot;);
				if (this.ship.equipmentStatus(&quot;EQ_CLOAKING_DEVICE&quot;) != &quot;EQUIPMENT_OK&quot;) {
					ordinance_available.push(&quot;EQ_KDRONE_LAUNCHER_MINE&quot;, &quot;EQ_CDRONE_LAUNCHER_MINE&quot;);
				}
			}

			if (EquipmentInfo.infoForKey(&quot;EQ_TORPEDO_MISSILE&quot;)) {
				ordinance_available.push(&quot;EQ_TORPEDO_MISSILE&quot;);
			}

			if (EquipmentInfo.infoForKey(&quot;EQ_HARPOON_NUKE1_MISSILE&quot;)) {
				ordinance_available.push(&quot;EQ_HARPOON_NUKE1_MISSILE&quot;);
			}

			if (EquipmentInfo.infoForKey(&quot;EQ_NEXUS_BUG_MISSILE&quot;)) {
				if (Math.random() &gt; 0.25) {
					ordinance_available.push(&quot;EQ_NEXUS_BASIC_MISSILE&quot;);
				} else {
					ordinance_available.push(&quot;EQ_NEXUS_PREMIUM_MISSILE&quot;);
				}
			}

			if (Math.random() &lt; ordinance_available_level_three_chance) {
				this.ship.awardEquipment(&quot;EQ_QC_MINE&quot;); // NB: actually award
				--ordinance_capacity;
			}
		}

		// Ensure there is at least one item in the ordinance list (so that can triple the list and not get zero).
		ordinance_available.push(&quot;EQ_HARDENED_MISSILE&quot;);

		// Triple the size of ordinance_available by adding, for every entry present already, a normal missile and a hardhead. 
		ordinance_available_length = ordinance_available.length;
		l = ordinance_available_length;
		while (l--) {
			ordinance_available.push(&quot;EQ_MISSILE&quot;);
			ordinance_available.push(&quot;EQ_HARDENED_MISSILE&quot;);
		}

		// Load the ordinance (save for Q-Mine, which may have been loaded above).
		ordinance_available_length = ordinance_available.length; // The latter has changed, so set the former again.
		l = ordinance_capacity;
		do {
			this.ship.awardEquipment(ordinance_available[~~(Math.random() * ordinance_available_length)]);
		}
		while (l--);
		delete this.shipSpawned;
	};


	/*
	=======================
	JSHINT: end of wrapper
	=======================
	*/

}).call(this);

// EOF</pre></td>
                </tr>
                <tr>
                    <td valign="top">Scripts/ferdelance3G_populator.js</td>
                    <td><pre>/*
========================================================================
ferdelance3G_populator.js
This file is part of the &#39;Ferdelance 3G&#39; expansion pack.
Author: UK_Eliter
License: 2017 Creative Commons: attribution, non-commercial, sharealike.
========================================================================
*/


/*
====================
JSLINT: set options
====================
*/

/*jshint esversion: 6*/
/*jshint sub:true*/


this.name = &quot;ferdelance3G_populator&quot;;
this.author = &quot;UK_Eliter&quot;;
this.copyright = &quot;2014 Creative Commons: attribution, non-commercial, sharealike.&quot;;
this.licence = &quot;CC-NC-SA 4&quot;;
this.description = &quot;Fer-de-Lance 3G populator script&quot;;


/*
------------------
DEBUGGING SWITCHES
------------------
*/

// this.logging = true;
this.consoleDebugMessages = false; // to disable this, set it to false. DO NOT comment it out.


/*
------------------------
JSLINT: start of wrapper
------------------------
*/

(function() {
	&quot;use strict&quot;;


	/*
	-----------------------
	INTERSTELLAR population
	-----------------------
	*/

	this.interstellarSpaceWillPopulate = function() {
		if (Math.random() &lt; 0.94) {
			return;
		} // NB: 0.94
		// Otherwise
		system.setPopulator(&quot;ferdelance3G_interstellar&quot;, {
			priority: 300,
			callback: this._addinterstellar3Gs.bind(this)
		});
	};

	this._addinterstellar3Gs = function(pos) {
		var threeG_number = ~~(1 + (Math.random() * 8));
		this.$addShips_ringless(&quot;ferdelance3G_interstellar&quot;, threeG_number, [0, 0, 0], 22000);
	};

	this.$isBug = function(e) {
		return e.isThargoid;
	};

	this.interstellarSpaceWillRepopulate = function() {
		// It is important for smooth gameplay that this function runs very quickly. If calculations are needed, run as many as possible in the populator function to save the result.
		// &#39;interstellarSpaceWillRepopulate&#39; does *not* use system.setPopulator 
		//
		// Note re Interstellar Tweaks OXP: that function will stop this routine being called, except in &#39;modified&#39; scenarios. For &#39;new&#39; scenarios, InterstellarTweaks can itself spawn 3Gs.

		if (!player.ship || !player.ship.position) {
			return;
		}

		if (this.threeG_addNoMore === true) {
			return;
		}

		var bugs = system.filteredEntities(this, this.$isBug);
		if (bugs.length &lt; 5) {
			return;
		}

		var police_num = system.countShipsWithRole(&quot;police&quot;);
		if (police_num &gt;= bugs.length) {
			return;
		}

		var threeG_chanceAdd;
		if (police_num &lt; 15) {
			threeG_chanceAdd = 0.02;
		} else {
			threeG_chanceAdd = 0.05;
		}
		var numCarriers = system.countShipsWithRole(&quot;thargoid_carrier&quot;);
		if (numCarriers &gt; 2) {
			threeG_chanceAdd = threeG_chanceAdd * (numCarriers - 1);
			// &quot;threeG_chanceAdd* = (numCarriers-1)&quot; throws exception
		}
		if (threeG_chanceAdd &gt; 0.4) {
			threeG_chanceAdd = 0.4;
		}
		if (Math.random() &gt; threeG_chanceAdd) {
			return;
		}

		// Else
		var threeG_number = 3 + ~~((Math.random() * 6) + 1);
		system.addGroup(&quot;ferdelance3G_interstellar&quot;, threeG_number, [0, 0, 0], 875);
		if (Math.random() &lt; 0.6) {
			this.threeG_addNoMore = true;
		}
	};


	/*
	------------------
	STELLAR population
	------------------
	*/

	this.systemWillPopulate = function() {
		/* STELLAR POPULATOR
		LANE_PS, LANE_WP, LANE_WS, STATION_AEGIS, PLANET_ORBIT, OUTER_SYSTEM, OUTER_SYSTEM_OFFPLANE
		Use &#39;callback: this._myFunction.bind(this)&#39; not callback: this._myFunction&#39; in order to use global variables and functions
		*/

		// log(&quot;3G - DEBUG&quot;, &quot;entered populator&quot;); // TEST

		if (!((system.government &lt; 3) &amp;&amp; (Math.random() &lt; 0.2))) {
			return;
		}

		var place = ~~(1 + (Math.random() * 8));

		// log(&quot;3G - DEBUG&quot;, &quot;place is &lt;&quot; + place + &quot;&gt;&quot;); // TEST

		switch (place) {
			case 1:
				system.setPopulator(&quot;ferDeLance3G-huntersPO&quot;, {
					groupCount: 1,
					priority: 150,
					location: &quot;PLANET_ORBIT&quot;,
					callback: this._addHunter.bind(this)
				});
				break;
			case 2:
				system.setPopulator(&quot;ferDeLance3G-huntersLWP&quot;, {
					groupCount: 1,
					priority: 111,
					location: &quot;LANE_WP&quot;,
					callback: this._addHunter.bind(this)
				});
				break;
			case 3:
				system.setPopulator(&quot;ferDeLance3G-huntersOS&quot;, {
					groupCount: 1,
					priority: 150,
					location: &quot;OUTER_SYSTEM&quot;,
					callback: this._addHunter.bind(this)
				});
				break;
			case 4:
				system.setPopulator(&quot;ferDeLance3G-huntersSA&quot;, {
					groupCount: 1,
					priority: 150,
					location: &quot;STATION_AEGIS&quot;,
					callback: this._addHunter.bind(this)
				});
				break;
			case 5:
				system.setPopulator(&quot;ferDeLance3G-huntersWP&quot;, {
					groupCount: 1,
					priority: 110,
					location: &quot;WITCHPOINT&quot;,
					callback: this._addHunter.bind(this)
				});
				break;
			case 6:
				system.setPopulator(&quot;ferDeLance3G-huntersSOL&quot;, {
					groupCount: 1,
					priority: 150,
					location: &quot;STAR_ORBIT_LOW&quot;,
					callback: this._addHunter.bind(this)
				});
				break;
			default:
				system.setPopulator(&quot;ferDeLance3G-huntersLWPS&quot;, {
					groupCount: 1,
					priority: 111,
					location: &quot;LANE_WPS&quot;,
					callback: this._addHunter.bind(this)
				});
		}
	};

	this._addHunter = function(pos) {
		var s = system.addShips(&quot;ferdelance3G_hunter&quot;, 1, pos, 35000);
		// function addShips(role : String, count : Number [, position: vectorExpression] [, radius: Number]) : Array
		// log(&quot;3G TESTING&quot;, &quot;Added stellar hunter&quot;);
	};


	/*
	-----
	OTHER
	-----
	*/

	this.playerWillEnterWitchspace = function() {
		this.threeG_addNoMore = false;
	};

	this.$addShips_ringless = function(role, count, position, radius) {
		var i, offset, ships;
		offset = new Vector3D(0, 50000, 0);
		if (count &lt; 1) {
			this.$error(&quot;Bad count argument &lt;&quot; + count + &quot;&gt; for function addShips_ringless&quot;);
			count = 1; // fix the problem.
		}
		ships = system.addShips(role, count, offset, radius);
		offset = new Vector3D(position).subtract(offset);
		i = ships.length;
		while (i--) {
			ships[i].position = ships[i].position.add(offset);
		}
		return ships;
	};

	// For TESTING
	/*
	this.shipWillLaunchFromStation = function()
	{
		// this.$addShips_ringless(&quot;ferdelance3G_trader&quot;, 4, player.ship.position, 25000);
		// this.$addShips_ringless(&quot;ferdelance3G_pirate&quot;, 4, player.ship.position, 25000);
		this.$addShips_ringless(&quot;ferdelance3G_pirateKing&quot;, 2, player.ship.position, 25000);
		// this.$addShips_ringless(&quot;ferdelance3G_hunter&quot;, 4, player.ship.position, 25000);
		// this.$addShips_ringless(&quot;ferdelance3G_police&quot;, 3, player.ship.position, 25000);
		//this.$addShips_ringless(&quot;ferdelance3G_interstellar&quot;, 4, player.ship.position, 25000);
		this.$addShips_ringless(&quot;ferdelance3G_hardPiratePoliceDecomissioned&quot;, 1, player.ship.position, 25000);
		this.$addShips_ringless(&quot;ferdelance3G_hardestHunterPoliceDecomissioned&quot;, 1, player.ship.position, 25000);
	}
	*/


	/*
	----------------------
	JSLINT: end of wrapper
	----------------------
	*/

}).call(this);


// EOF</pre></td>
                </tr>
                <tr>
                    <td valign="top">Scripts/ferdelance3G_trader.js</td>
                    <td><pre>/*
========================================================================
ferdelance3G_trader.js
This file is part of the &#39;Ferdelance 3G&#39; expansion pack.
Author: UK_Eliter
License: 2017 Creative Commons: attribution, non-commercial, sharealike.
========================================================================
*/


/*
====================
JSLINT: set options
====================
*/

/*jshint esversion: 6*/
/*jshint sub:true*/


this.name = &quot;ferdelance3G_trader&quot;;
this.author = &quot;UK_Eliter&quot;;
this.copyright = &quot;&quot;;
this.description = &quot;ferdelance3G_hunter.js (for NPCs)&quot;;
this.license = &quot;CC-by-nc-sa 3.0&quot;;


/*
------------------
DEBUGGING SWITCHES
------------------
*/

// this.logging = true;

this.debug = false;

if (this.debug) {
	this.ship.reportAIMessages = true;
}


/*
------------------------
JSLINT: start of wrapper
------------------------
*/

(function() {
	&quot;use strict&quot;;


	/*
	-------------------------
	EVENT HANDLERS
	(except incoming missile)
	-------------------------
	*/

	this.shipSpawned = function() // For ALLOCATING MISSILES
	{
		var capacity;
		var chanceForSeriousBomb = 0.1;
		var giveSeriousOrdinance = false;
		var i;
		var ordinanceAvailable;
		var ordinanceCount;
		var startTime;

		//Build list of available ordinance.
		ordinanceAvailable = [&quot;EQ_MISSILE&quot;, &quot;EQ_MISSILE&quot;, &quot;EQ_MISSILE&quot;, &quot;EQ_HARDENED_MISSILE&quot;, &quot;EQ_HARDENED_MISSILE&quot;];
		if (this.ship.hasRole(&quot;ferdelance3G_+T&quot;)) {
			giveSeriousOrdinance = true;
			chanceForSeriousBomb = 0.17;
		} else if (Math.random() &gt; 0.8) {
			giveSeriousOrdinance = true;
		}
		if (giveSeriousOrdinance) {
			if (worldScripts[&quot;Missiles &amp; Bombs&quot;]) {
				ordinanceAvailable.push(&quot;EQ_RMB_FRAG_MISSILE&quot;, &quot;EQ_RMB_OVERRIDE_MISSILE&quot;, &quot;EQ_RMB_LAW_MISSILE&quot;, &quot;EQ_RMB_INTERCEPT_MISSILE&quot;, &quot;EQ_RMB_INTERCEPT_MISSILE&quot;, &quot;EQ_RMB_INTERCEPT_MISSILE&quot;);
			}
			if (EquipmentInfo.infoForKey(&quot;EQ_TORPEDO_MISSILE&quot;)) {
				ordinanceAvailable.push(&quot;EQ_TORPEDO_MISSILE&quot;);
			}
			if (EquipmentInfo.infoForKey(&quot;EQ_HARPOON_NUKE1_MISSILE&quot;)) {
				ordinanceAvailable.push(&quot;EQ_HARPOON_NUKE1_MISSILE&quot;);
			}
			if (worldScripts[&quot;armoury_trackerWorldScript.js&quot;]) {
				ordinanceAvailable.push(&quot;EQ_ARMOURY_STUNBOMB_MINE&quot;);
				if (this.ship.equipmentStatus(&quot;EQ_CLOAKING_DEVICE&quot;) != &quot;EQUIPMENT_OK&quot;) {
					ordinanceAvailable.push(&quot;EQ_KDRONE_LAUNCHER_MINE&quot;, &quot;EQ_CDRONE_LAUNCHER_MINE&quot;);
				}
			}
			if (EquipmentInfo.infoForKey(&quot;EQ_NEXUS_BUG_MISSILE&quot;)) {
				ordinanceAvailable.push(&quot;EQ_NEXUS_PREMIUM_MISSILE&quot;);
				if (Math.random() &gt; 0.2) {
					ordinanceAvailable.push(&quot;EQ_NEXUS_BASIC_MISSILE&quot;);
				} else {
					ordinanceAvailable.push(&quot;EQ_NEXUS_PREMIUM_MISSILE&quot;);
				}
			}
			capacity = this.ship.missileCapacity;
			if (Math.random() &lt;= chanceForSeriousBomb) {
				this.ship.awardEquipment(&quot;EQ_QC_MINE&quot;); // NB: actually award
				--capacity;
			}
		}
		// Load ordinance to ship
		ordinanceCount = ordinanceAvailable.length;
		i = capacity - 1;
		do {
			this.ship.awardEquipment(ordinanceAvailable[~~(Math.random() * ordinanceCount)]);
		}
		while (i--);
		delete this.shipSpawned;
	};


	/*
	----------------------
	JSLINT: end of wrapper
	----------------------
	*/

}).call(this);


// EOF</pre></td>
                </tr>
            </table>
        </a>
    </body>
</html>
