<html>
    <head>
        <title>Expansion Masslock Compensator</title>
        <link rel="stylesheet" href="../style.css">
    </head>
    <body>
        <table border="0" width="100%">
            <tr>
                <td>Back to <a href='../index.html'>Index</a></td>
                <td align="right"><small>Page generated: Oct 11, 2023, 3:16:49 PM</small></td>
            </tr>
        </table>

        <h1>Expansion Masslock Compensator</h1>

        <h2>Content</h2>
        <ul>
          <li><a href="#warnings">Warnings</a></li>
          <li><a href="#manifest">Manifest</a></li>
          <li><a href="#documentation">Documentation</a></li>
          <li><a href="#equipment">1 Equipment</a></li>
          <li><a href="#ships">0 Ships</a></li>
          <li><a href="#models">0 Models</a></li>
          <li><a href="#scripts">1 Scripts</a></li>
        </ul>

          <a name="warnings">
            <h2>Warnings</h2>
            <ol>
                <li>Information URL mismatch between OXP Manifest and Expansion Manager string length at character position 0</li>
            </ol>
          </a>

        <a name="manifest">
        <h2>Manifest</h2>
            <table border="1">
                <tr>
                    <th></th>
                    <th>from Expansion Manager's OXP list</th>
                    <th>from Expansion Manifest</th>
                </tr>
                <tr>
                    <td>Description</td>
                    <td>Script to increase max ship speed during passive masslocks (yellow alert)</td>
                    <td>Script to increase max ship speed during passive masslocks (yellow alert)</td>
                </tr>
                <tr>
                    <td>Identifier</td>
                    <td>oolite.oxp.redspear.masslock_compensator</td>
                    <td>oolite.oxp.redspear.masslock_compensator</td>
                </tr>
                <tr>
                    <td>Title</td>
                    <td>Masslock Compensator</td>
                    <td>Masslock Compensator</td>
                </tr>
                <tr>
                    <td>Category</td>
                    <td>Mechanics</td>
                    <td>Mechanics</td>
                </tr>
                <tr>
                    <td>Author</td>
                    <td>Redspear</td>
                    <td>Redspear</td>
                </tr>
                <tr>
                    <td>Version</td>
                    <td>1.4</td>
                    <td>1.4</td>
                </tr>
                <tr>
                    <td>Tags</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Required Oolite Version</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Maximum Oolite Version</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Required Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Optional Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Conflict Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Information URL</td>
                    <td><a target="_blank" href=""></a></td>
                    <td><a target="_blank" href="">n/a</a></td>
                </tr>
                <tr>
                    <td>Download URL</td>
                    <td><a target="_blank" href="https://wiki.alioth.net/img_auth.php/d/d2/Oolite.oxp.redspear.masslock_compensator.oxz">https://wiki.alioth.net/img_auth.php/d/d2/Oolite.oxp.redspear.masslock_compensator.oxz</a></td>
                    <td><a target="_blank" href="">n/a</a></td>
                </tr>
                <tr>
                    <td>License</td>
                    <td>CC-BY-NC-SA 4.0</td>
                    <td>CC-BY-NC-SA 4.0</td>
                </tr>
                <tr>
                    <td>File Size</td>
                    <td>n/a</td>
                </tr>
                <tr>
                    <td>Upload date</td>
                    <td>1610873478</td>
                </tr>
            </table>
                </a>

        <a name="documentation">
        <h2>Documentation</h2>
        <p>Also read <a href='http://wiki.alioth.net/index.php/Masslock%20Compensator'>http://wiki.alioth.net/index.php/Masslock%20Compensator</a></p>
        </a>

        <a name="equipment">          
        <h2>Equipment</h2>
            <table>
                <tr>
                    <th>Name</th>
                    <th>Visible</th>
                    <th>Cost [deci-credits]</th>
                    <th>Tech-Level</th>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_MASSLOCK_COMPENSATOR.html">Masslock Compensators active</a></td>
                    <td>no</td>
                    <td align="right">1</td>
                    <td align="center">101+</td>
                </tr>
            </table>
        </a>

        <a name="ships">    
        <h2>Ships</h2>
            This expansion declares no ships. This may be related to warnings.
        </a>

        <a name="models">    
        <h2>Models</h2>
            This expansion declares no models. This may be related to warnings.
        </a>

        <a name="scripts">    
        <h2>Scripts</h2>
            <table>
                <tr>
                    <th>Path</th>
                </tr>
                <tr>
                    <td valign="top">Scripts/masslock_compensator.js</td>
                    <td><pre>this.name        = &quot;masslock_compensator&quot;; 
this.author      = &quot;Redspear&quot;; 
this.copyright   = &quot;2019 Redspear&quot;;
this.licence     = &quot;CC-BY-NC-SA 4.0&quot;; 
this.description = &quot;Script to increase max ship speed during passive masslocks (yellow alert)&quot;; 
this.version     = &quot;1.4&quot;;

&quot;use strict&quot;;

// determine compensator speed based on ship
this.startUpComplete = this.playerBoughtEquipment = this.playerBoughtNewShip = function()
{
	// establish base speed
	this._mlcOFF = player.ship.maxSpeed;
	// this._mlcON = (_mlcOFF + 1000) /2;
	
	// set compensator speed
	if (player.ship.maxSpeed &gt; 900) {	
		this._mlcON = _mlcOFF; // no bonus
		} else {
		if (player.ship.maxSpeed &gt; 600) {
			this._mlcON = 900; // max boosted value
			} else {
			if (player.ship.maxSpeed &gt; 300) {
				this._mlcON = _mlcOFF + 300; // standard bonus
				} else {
				this._mlcON = 600; // min boosted value
				}
			}
		}
}

// delay activation if station has aegis
this.shipWillLaunchFromStation = function(station)
{	
	if (station.isMainStation === false) {
		this._mlcState = _mlcON;
		player.ship.awardEquipment (&quot;EQ_MASSLOCK_COMPENSATOR&quot;);
		player.consoleMessage (&quot;Mass-Lock Compensators Online&quot;);
		// log(this.name, &quot;launched = &quot; + player.ship.maxSpeed);
		} else {
			this._mlcState = _mlcOFF;
			// log(this.name, &quot;launched = &quot; + player.ship.maxSpeed);		
		}
		return;
}

// check if player entering station aegis
this.shipEnteredStationAegis = function()
{
	this._mlcState = _mlcOFF;
	player.ship.removeEquipment (&quot;EQ_MASSLOCK_COMPENSATOR&quot;);
	player.consoleMessage (&quot;Entering Aegis: Mass-Lock Compensators Disabled&quot;);
	
	if (player.ship.equipmentStatus(&quot;EQ_POWER_TO_ENGINES&quot;) == &quot;EQUIPMENT_OK&quot;) {
		player.ship.maxSpeed = _mlcOFF * 1.5;
		} else {
		player.ship.maxSpeed = _mlcOFF;
		}
		
	// log(this.name, &quot;enter aegis = &quot; + player.ship.maxSpeed);
}

// check if player approaching star
this.shipEnteredPlanetaryVicinity = function(entity)	// entity isSun
{
	if (entity.isSun === true) {
		this._mlcState = _mlcOFF;
		player.ship.removeEquipment (&quot;EQ_MASSLOCK_COMPENSATOR&quot;);
		player.consoleMessage (&quot;Strong Magnetic Fields: Mass-Lock Compensators Offline&quot;);
		
		if (player.ship.equipmentStatus(&quot;EQ_POWER_TO_ENGINES&quot;) == &quot;EQUIPMENT_OK&quot;) {
			player.ship.maxSpeed = _mlcOFF * 1.5;
			} else {
			player.ship.maxSpeed = _mlcOFF;
			}
		}
		
	// log(this.name, &quot;star approach = &quot; + player.ship.maxSpeed);
}

// check if player leaving station aegis
this.shipExitedStationAegis = function()
{
	this._mlcState = _mlcON;
	player.ship.awardEquipment (&quot;EQ_MASSLOCK_COMPENSATOR&quot;);
	player.consoleMessage (&quot;Mass-Lock Compensators Online&quot;);
	
	if (player.alertCondition == 2 &amp;&amp; player.ship.equipmentStatus(&quot;EQ_POWER_TO_ENGINES&quot;) == &quot;EQUIPMENT_OK&quot;) { //	passive masslock + PTE
		player.ship.maxSpeed = _mlcState * 1.5;	
		} else {
		if (player.alertCondition == 2 &amp;&amp; player.ship.equipmentStatus(&quot;EQ_POWER_TO_ENGINES&quot;) != &quot;EQUIPMENT_OK&quot;) { // passive masslock alonme
			player.ship.maxSpeed = _mlcState;
			// log(this.name, &quot;exit A y = &quot; + player.ship.maxSpeed);
			} else {
			if (player.alertCondition != 2 &amp;&amp; player.ship.equipmentStatus(&quot;EQ_POWER_TO_ENGINES&quot;) == &quot;EQUIPMENT_OK&quot;) {
				player.ship.maxSpeed = _mlcOFF * 1.5;	// active masslock (red alert) or no masslock (status green)
				} else {
				player.ship.maxSpeed = _mlcOFF;
				}
			} // log(this.name, &quot;exit A = &quot; + player.ship.maxSpeed);
		}
}

// check if player leaving star aegis
this.shipExitedPlanetaryVicinity = function(planet)
{
	if (planet.isSun === true) {
		this._mlcState = _mlcON;
		player.ship.awardEquipment (&quot;EQ_MASSLOCK_COMPENSATOR&quot;);
		player.consoleMessage (&quot;Mass-Lock Compensators Online&quot;);
		if (player.alertCondition == 2 &amp;&amp; player.ship.equipmentStatus(&quot;EQ_POWER_TO_ENGINES&quot;) == &quot;EQUIPMENT_OK&quot;) { //	passive masslock + PTE
			player.ship.maxSpeed = _mlcState * 1.5;	
			} else {
			if (player.alertCondition == 2 &amp;&amp; player.ship.equipmentStatus(&quot;EQ_POWER_TO_ENGINES&quot;) != &quot;EQUIPMENT_OK&quot;) { // passive masslock alonme
				player.ship.maxSpeed = _mlcState;
				//log(this.name, &quot;witchspace y = &quot; + player.ship.maxSpeed);
				} else {
				if (player.alertCondition != 2 &amp;&amp; player.ship.equipmentStatus(&quot;EQ_POWER_TO_ENGINES&quot;) == &quot;EQUIPMENT_OK&quot;) {
					player.ship.maxSpeed = _mlcOFF * 1.5;	// active masslock (red alert) or no masslock (status green)
					} else {
					player.ship.maxSpeed = _mlcOFF;
					}
				} //log(this.name, &quot;witchspace = &quot; + player.ship.maxSpeed);
			}
				//log(this.name, &quot;exit star = &quot; + player.ship.maxSpeed);
		}	
}


// check for hyperspace (esp from within aegis)
this.shipWillEnterWitchspace = function()
{
	this._mlcState = _mlcON;
	player.ship.removeEquipment (&quot;EQ_MASSLOCK_COMPENSATOR&quot;);
	player.ship.awardEquipment (&quot;EQ_MASSLOCK_COMPENSATOR&quot;);
	
	if (player.alertCondition == 2 &amp;&amp; player.ship.equipmentStatus(&quot;EQ_POWER_TO_ENGINES&quot;) == &quot;EQUIPMENT_OK&quot;) { //	passive masslock + PTE
		player.ship.maxSpeed = _mlcState * 1.5;	
		} else {
		if (player.alertCondition == 2 &amp;&amp; player.ship.equipmentStatus(&quot;EQ_POWER_TO_ENGINES&quot;) != &quot;EQUIPMENT_OK&quot;) { // passive masslock alonme
			player.ship.maxSpeed = _mlcState;
			//log(this.name, &quot;witchspace y = &quot; + player.ship.maxSpeed);
			} else {
			if (player.alertCondition != 2 &amp;&amp; player.ship.equipmentStatus(&quot;EQ_POWER_TO_ENGINES&quot;) == &quot;EQUIPMENT_OK&quot;) {
				player.ship.maxSpeed = _mlcOFF * 1.5;	// active masslock (red alert) or no masslock (status green)
				} else {
				player.ship.maxSpeed = _mlcOFF;
				}
			} //log(this.name, &quot;witchspace = &quot; + player.ship.maxSpeed);
		}
}

// activate compensator in yellow alert and outside aegis only
this.alertConditionChanged = function()
{
	if (player.alertCondition == 2 &amp;&amp; player.ship.equipmentStatus(&quot;EQ_POWER_TO_ENGINES&quot;) == &quot;EQUIPMENT_OK&quot;) { //	passive masslock + PTE
		player.ship.maxSpeed = _mlcState * 1.5;	
		//log(this.name, &quot;generic y = &quot; + player.ship.maxSpeed);
		} else {
		if (player.alertCondition == 2 &amp;&amp; player.ship.equipmentStatus(&quot;EQ_POWER_TO_ENGINES&quot;) != &quot;EQUIPMENT_OK&quot;) { // passive masslock alonme
			player.ship.maxSpeed = _mlcState;
			} else {
			if (player.alertCondition != 2 &amp;&amp; player.ship.equipmentStatus(&quot;EQ_POWER_TO_ENGINES&quot;) == &quot;EQUIPMENT_OK&quot;) {
				player.ship.maxSpeed = _mlcOFF * 1.5;	// active masslock (red alert) or no masslock (status green)
				} else {
				player.ship.maxSpeed = _mlcOFF;
				}
			}
		}
			
}

// reset to base speed when docked
this.shipWillDockWithStation = function ()
{
	player.ship.maxSpeed = _mlcOFF;
	this._mlcState = _mlcOFF;
	player.ship.removeEquipment (&quot;EQ_MASSLOCK_COMPENSATOR&quot;);
	// log(this.name, &quot;docked = &quot; + player.ship.maxSpeed);
}

</pre></td>
                </tr>
            </table>
        </a>
    </body>
</html>
