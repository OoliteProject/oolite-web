<html>
    <head>
        <title>Expansion Barrel Roll</title>
        <link rel="stylesheet" href="../style.css">
    </head>
    <body>
        <table border="0" width="100%">
            <tr>
                <td>Back to <a href='../index.html'>Index</a></td>
                <td align="right"><small>Page generated: Oct 11, 2023, 3:16:49 PM</small></td>
            </tr>
        </table>

        <h1>Expansion Barrel Roll</h1>

        <h2>Content</h2>
        <ul>
          <li><a href="#warnings">Warnings</a></li>
          <li><a href="#manifest">Manifest</a></li>
          <li><a href="#documentation">Documentation</a></li>
          <li><a href="#equipment">1 Equipment</a></li>
          <li><a href="#ships">0 Ships</a></li>
          <li><a href="#models">0 Models</a></li>
          <li><a href="#scripts">1 Scripts</a></li>
        </ul>

          <a name="warnings">
            <h2>Warnings</h2>
            <ol>
                <li>Information URL mismatch between OXP Manifest and Expansion Manager string length at character position 0</li>
            </ol>
          </a>

        <a name="manifest">
        <h2>Manifest</h2>
            <table border="1">
                <tr>
                    <th></th>
                    <th>from Expansion Manager's OXP list</th>
                    <th>from Expansion Manifest</th>
                </tr>
                <tr>
                    <td>Description</td>
                    <td>Adds a barrel roll function to your auto-pilot.</td>
                    <td>Adds a barrel roll function to your auto-pilot.</td>
                </tr>
                <tr>
                    <td>Identifier</td>
                    <td>oolite.oxp.dybal.BarrelRoll</td>
                    <td>oolite.oxp.dybal.BarrelRoll</td>
                </tr>
                <tr>
                    <td>Title</td>
                    <td>Barrel Roll</td>
                    <td>Barrel Roll</td>
                </tr>
                <tr>
                    <td>Category</td>
                    <td>Equipment</td>
                    <td>Equipment</td>
                </tr>
                <tr>
                    <td>Author</td>
                    <td>Dybal</td>
                    <td>Dybal</td>
                </tr>
                <tr>
                    <td>Version</td>
                    <td>1.1</td>
                    <td>1.1</td>
                </tr>
                <tr>
                    <td>Tags</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Required Oolite Version</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Maximum Oolite Version</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Required Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Optional Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Conflict Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Information URL</td>
                    <td><a target="_blank" href=""></a></td>
                    <td><a target="_blank" href="">n/a</a></td>
                </tr>
                <tr>
                    <td>Download URL</td>
                    <td><a target="_blank" href="https://wiki.alioth.net/img_auth.php/d/db/BarrelRoll-1.1.oxz">https://wiki.alioth.net/img_auth.php/d/db/BarrelRoll-1.1.oxz</a></td>
                    <td><a target="_blank" href="">n/a</a></td>
                </tr>
                <tr>
                    <td>License</td>
                    <td>CC-BY-NC-SA 4.0</td>
                    <td>CC-BY-NC-SA 4.0</td>
                </tr>
                <tr>
                    <td>File Size</td>
                    <td>n/a</td>
                </tr>
                <tr>
                    <td>Upload date</td>
                    <td>1610873485</td>
                </tr>
            </table>
                </a>

        <a name="documentation">
        <h2>Documentation</h2>
        <p>Also read <a href='http://wiki.alioth.net/index.php/Barrel%20Roll'>http://wiki.alioth.net/index.php/Barrel%20Roll</a></p>
        <h3>Readme.txt</h3>
        <pre>Barrel Roll OXP
---------------
v1.1, by Dybal

Barrel-rolling is a time-proven evasive tactic, when attacked, for those that can&#39;t afford or prefer not to fight back.

But manually keeping a ship barrel-rolling for minutes to hours until the attacker(s) give up is a boring, mindless and even painful task.

With that in mind, Think of It as Evolution in Action Corporation would like to present Barrel Roll Governor, a software add-on to your ship&#39;s auto-pilot.

Once primed (by pressing &lt;Shift&gt;-&lt;N&gt; in the default keyboard configuration) and activated (by pressing &lt;N&gt; in the default keyboard configuration), this little add-on keeps the ship in a barrel-roll until de-activated (by pressing &lt;N&gt; again), leaving you to just adjust heading through your yaw controls now and then to keep going in the direction you want, but otherwise free to browse the Galactic Net, eat your doughnut, drink you tea, pet your cat, or do whatever your prefer to while the time away.

Available at Tech Level 9 and above systems for 300 credits.


License 
-------

CC-BY-NC-SA 4.0 - Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International
(https://creativecommons.org/licenses/by-nc-sa/4.0/)

Change log
----------

v1.1
- Changes price to make the equipment more accessible to new Jamesons.

v1.0
- Initial version
</pre>
        </a>

        <a name="equipment">          
        <h2>Equipment</h2>
            <table>
                <tr>
                    <th>Name</th>
                    <th>Visible</th>
                    <th>Cost [deci-credits]</th>
                    <th>Tech-Level</th>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_BARREL_ROLL.html">Barrel Roll Governor</a></td>
                    <td>yes</td>
                    <td align="right">300</td>
                    <td align="center">7+</td>
                </tr>
            </table>
        </a>

        <a name="ships">    
        <h2>Ships</h2>
            This expansion declares no ships. This may be related to warnings.
        </a>

        <a name="models">    
        <h2>Models</h2>
            This expansion declares no models. This may be related to warnings.
        </a>

        <a name="scripts">    
        <h2>Scripts</h2>
            <table>
                <tr>
                    <th>Path</th>
                </tr>
                <tr>
                    <td valign="top">Scripts/barrel_roll.js</td>
                    <td><pre>&quot;use strict&quot;;
this.name           = &quot;BarrelRoll&quot;;
this.author         = &quot;Dybal&quot;;
this.copyright      = &quot;2020 Dybal&quot;;
this.license        = &quot;CC-BY-NC-SA 4.0&quot;;
this.description    = &quot;Barrel Roll auto-pilot&quot;;
this.version        = &quot;1.1&quot;;

this.$debug = false;
this.$logging = true;
this.$FCB_tracking_ID = null;
this.$rbEnabled = false;
this.$rbActive = false;


//
// Event Handlers
//

//------------------------------------------------------------------------------------------//
this.startUpComplete = function _BarrelRoll_startUpComplete() {
    this.ship = player.ship;
    if (this.ship.equipmentStatus(&quot;EQ_BARREL_ROLL&quot;) === &quot;EQUIPMENT_OK&quot;)
        this.$rbEnabled = true;
    else
        this.$rbEnabled = false;
}

//------------------------------------------------------------------------------------------//
this.playerBoughtNewShip = this.playerReplacedShip = function _BarrelRoll_playerGotNewShip(ship) {
    this.ship = ship;
    if (this.ship.equipmentStatus(&quot;EQ_BARREL_ROLL&quot;) === &quot;EQUIPMENT_OK&quot;)
        this.$rbEnabled = true;
    else
        this.$rbEnabled = false;
}

//------------------------------------------------------------------------------------------//
this.equipmentAdded = function _BarrelRoll_equipmentAdded(equipmentKey) {
    if (equipmentKey === &quot;EQ_BARREL_ROLL&quot;) {
        if (this.$debug) log(this.name, &quot;Barrel Roll added&quot;)
        this.$rbEnabled = true;
        this.$rbActive = false;
    }
}

//------------------------------------------------------------------------------------------//
this.equipmentRemoved = function _BarrelRoll_equipmentRemoved(equipmentKey) {
    if (equipmentKey === &quot;EQ_BARREL_ROLL&quot;) {
        if (this.$debug) log(this.name, &quot;Barrel Roll removed&quot;)
        this.$rbEnabled = false;
        if (this.$rbActive) {
            if (this.$FCB_tracking_ID &amp;&amp; isValidFrameCallback(this.$FCB_tracking_ID)) 
                removeFrameCallback(this.$FCB_tracking_ID);
            this.$rbActive = false;
        }
    }
}

//------------------------------------------------------------------------------------------//
this.shipWillLaunchFromStation = this.shipWillExitWitchspace = function _BarrelRoll_StartFlight() {
    this.$rbActive = false;
}

//------------------------------------------------------------------------------------------//
this.activated = function _BarrelRoll_activated() {
    var ws = worldScripts.BarrelRoll;
    if (ws.$rbEnabled) {
        if (ws.$rbActive) {
            // de-activate
            if (ws.$FCB_tracking_ID &amp;&amp; isValidFrameCallback(ws.$FCB_tracking_ID))
                removeFrameCallback(ws.$FCB_tracking_ID);
            ws.$rbActive = false;
            if (ws.$logging) log(ws.name, &quot;De-activating&quot;)
        } else {
            if (!isValidFrameCallback(ws.$FCB_tracking_ID))
                ws.$FCB_tracking_ID = addFrameCallback(ws.$FCB.bind(ws)); 
            ws.$rbActive = true;
            if (ws.$logging) log(ws.name, &quot;Activating&quot;)
        }
    }
}


//
// Internal Functions
//

//------------------------------------------------------------------------------------------//
this.$FCB = function _BarrelRoll_FCB(delta) {
    var ship = this.ship;
    var pitch, roll, heading, right, orientation;

    if (!this.$rbEnabled || !this.$rbActive || delta == 0) return;
    pitch = ship.maxPitch * delta;
    roll = ship.maxRoll * delta;
    heading = ship.heading;
    right = ship.vectorRight;
    // roll the ship anti-clock-wise
    orientation = ship.orientation.rotate(heading, -roll);
    // pitch the ship
    ship.orientation = orientation.rotate(orientation.vectorRight(), -pitch);
}   
</pre></td>
                </tr>
            </table>
        </a>
    </body>
</html>
