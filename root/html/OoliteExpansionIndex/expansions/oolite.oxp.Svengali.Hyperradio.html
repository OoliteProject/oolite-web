<html>
    <head>
        <title>Expansion Hyperradio</title>
        <link rel="stylesheet" href="../style.css">
    </head>
    <body>
        <table border="0" width="100%">
            <tr>
                <td>Back to <a href='../index.html'>Index</a></td>
                <td align="right"><small>Page generated: Oct 11, 2023, 3:16:49 PM</small></td>
            </tr>
        </table>

        <h1>Expansion Hyperradio</h1>

        <h2>Content</h2>
        <ul>
          
          <li><a href="#manifest">Manifest</a></li>
          <li><a href="#documentation">Documentation</a></li>
          <li><a href="#equipment">3 Equipment</a></li>
          <li><a href="#ships">0 Ships</a></li>
          <li><a href="#models">0 Models</a></li>
          <li><a href="#scripts">2 Scripts</a></li>
        </ul>


        <a name="manifest">
        <h2>Manifest</h2>
            <table border="1">
                <tr>
                    <th></th>
                    <th>from Expansion Manager's OXP list</th>
                    <th>from Expansion Manifest</th>
                </tr>
                <tr>
                    <td>Description</td>
                    <td>Your personal tool for playing music in the game. Depends on Cabal Common Library and Snoopers, suggests Musicpacks.</td>
                    <td>Your personal tool for playing music in the game. Depends on Cabal Common Library and Snoopers, suggests Musicpacks.</td>
                </tr>
                <tr>
                    <td>Identifier</td>
                    <td>oolite.oxp.Svengali.Hyperradio</td>
                    <td>oolite.oxp.Svengali.Hyperradio</td>
                </tr>
                <tr>
                    <td>Title</td>
                    <td>Hyperradio</td>
                    <td>Hyperradio</td>
                </tr>
                <tr>
                    <td>Category</td>
                    <td>Equipment</td>
                    <td>Equipment</td>
                </tr>
                <tr>
                    <td>Author</td>
                    <td>Svengali</td>
                    <td>Svengali</td>
                </tr>
                <tr>
                    <td>Version</td>
                    <td>1.26.1</td>
                    <td>1.26.1</td>
                </tr>
                <tr>
                    <td>Tags</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Required Oolite Version</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Maximum Oolite Version</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Required Expansions</td>
                    <td>
                            <li>oolite.oxp.Svengali.CCL:1.7</li>
                            <li>oolite.oxp.Svengali.Snoopers:2.4</li>
                    </td>
                    <td>
                            <li>oolite.oxp.Svengali.CCL:1.7</li>
                            <li>oolite.oxp.Svengali.Snoopers:2.4</li>
                    </td>
                </tr>
                <tr>
                    <td>Optional Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Conflict Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Information URL</td>
                    <td><a target="_blank" href="http://wiki.alioth.net/index.php/Hyperradio_js_OXP">http://wiki.alioth.net/index.php/Hyperradio_js_OXP</a></td>
                    <td><a target="_blank" href="">n/a</a></td>
                </tr>
                <tr>
                    <td>Download URL</td>
                    <td><a target="_blank" href="https://wiki.alioth.net/img_auth.php/b/b2/Hyperradio_1.26.1.oxz">https://wiki.alioth.net/img_auth.php/b/b2/Hyperradio_1.26.1.oxz</a></td>
                    <td><a target="_blank" href="">n/a</a></td>
                </tr>
                <tr>
                    <td>License</td>
                    <td>CC BY-NC-SA 3</td>
                    <td>CC BY-NC-SA 3</td>
                </tr>
                <tr>
                    <td>File Size</td>
                    <td>n/a</td>
                </tr>
                <tr>
                    <td>Upload date</td>
                    <td>1610873446</td>
                </tr>
            </table>
                </a>

        <a name="documentation">
        <h2>Documentation</h2>
        <p>Also read <a href='http://wiki.alioth.net/index.php/Hyperradio'>http://wiki.alioth.net/index.php/Hyperradio</a></p>
        <h3>Hyperradio1.26.1 Readme.rtf</h3>
        <pre>{\rtf1\ansi\ansicpg1252\deff0{\fonttbl{\f0\fswiss\fprq2\fcharset0 Helvetica;}{\f1\fnil\fcharset0 Helvetica;}{\f2\fnil\fcharset238 Helvetica;}}
{\colortbl ;\red128\green128\blue128;\red128\green0\blue128;\red0\green0\blue0;}
{\*\generator Msftedit 5.41.15.1515;}\viewkind4\uc1\pard\lang1031\ul\b\f0\fs24 HYPERRADIO v1.26.1\ulnone\b0  for Oolite\par
\cf1\f1\fs18 Copyright 2008-2013, Svengali\par
\f0 License: CC-by-nc-sa-3.0\par
\cf0\fs20\par
\ul\fs24 OVERVIEW:\ulnone\par
\fs22 Trading goods between worlds is an extremely dangerous and hard job and a commander will need\par
some relaxing moments. Listen to your radio station and enjoy Jazz, Folk, Rock or whatever you like.\par
\par
Use one station for all systems or expand it, so you will get different programs in different systems.\par
It is even encouraged to add your own music to the playlist.\par
\par
So rip your CDs, download songs, or install one or more of the available musicpacks. Everything\par
is possible - and travelling will be much more fun - even &#39;milkruns&#39; won&#39;t be boring business anymore.\par
And the capacity to be expanded by other users creating their own musicpacks it is a flexible toy.\par
\fs20\par
\ul\fs24 HANDLING:\par
\ulnone\fs22 Adding own songs to the main playlist is simple. Please note that only \b ogg-vorbis\b0  is supported.\fs20\par
\fs22 1. Just place your soundfiles in the \b OXPs\b0  \b Music-folder\b0 .\par
2. Open \b hyperradio.js \b0 in the \b OXPs Scripts-folder \b0 (you can use a simple text-editor)\par
    and add your filenames to the array.\par
\cf1 Example:\par
\tab this.hyperradio_playListOriginal = [\par
\tab\tab &quot;Rage-Back_in_time.ogg&quot;,\par
\tab\tab &quot;Stevie_Ray_Vaughan-Voodoo_Child.ogg&quot;\par
\tab ];\par
\cf0     Save your additions. That&#39;s it.\par
\par
Ingame:\par
Fire up Oolite and buy the Hyperradio license (it is not everywhere available).\par
- Launch from the station and select it via priming key (Shift + N).\par
- Select the station via activation key (n). You can cycle through the available stations.\par
- To start a station press the mode key (b).\par
\fs20\par
\ul\fs24 MUSICPACKS:\b\fs22\par
\ulnone\b0 To get some more fun it is possible to use different &#39;stations&#39; with different playlists.\par
There are already some station-musicpacks with different musicstyles available for you:\par
\cf2 http://wiki.alioth.net/index.php/Hyperradio_Musicpacks\cf0 .\par
\par
If you are using one or more of the available musicpacks the Hyperradio preselects one of them\par
or the main list.\par
\par
Documentation about creating own stations is available:\par
\cf2 http://wiki.alioth.net/index.php/Hyperradio_Howto_Musicpacks\ul\par
\cf0\fs20\par
\fs24 REQUIREMENTS:\b\par
\ulnone\b0\fs22 - Oolite v1.77.\par
- Cabal_Common_Library1.7.\par
- If Snoopers2.4 or musicpacks installed extra features are enabled.\par
\par
\ul\f1\fs24 PROBLEMS:\par
\ulnone\fs22 In case of problems, please report it: \cf2 http://aegidian.org/bb/viewtopic.php?f=4&amp;t=4067.\par
\cf0 Include the following infos:\par
- Oolites version (and if trunk or nightly is used the revision number)\par
- OS, Graphics card (and driver version)\par
- Fullscreen/Windowed mode\par
- Shader mode\par
- List of used OXPs (incl. versions)\f0\par
\cf3\f1\fs24 _________________________________________________________________________\par
\fs20\par
Thanks to:\par
  - \ul The development team\ulnone\par
  Giles Williams (aegidian), Jens Ayton (Ahruman), Nikos Barkas (another_commander), David Taylor (dajt),\par
  Chris Crowther (hikari), James (cmdrjames), Darren Salt (dsalt), Eddy Petri\f2\&#39;baor\f1  (\f2 eddyp\f1 ), \f2 Erich Ritz\f1  (\f2 eritz\f1 ),\par
  \f2 Konstantinos Sykas\f1  (\f2 getafix\f1 ),  K\f2 aks\f1 , \f2 Nic \f1 (\f2 nic_asdf\f1 ), \f2 Michael Werle\f1  (\f2 mwerle\f1 ), \f2 Dave Hughes\f1  (s\f2 elezen\f1 ),\par
  Eric Walch, \f2 Dylan Smith\f1  (\f2 winston\f1 ).\f2\par
\f1\par
Special thanks to:\par
  - Thargoid for adding this equipment to his RepairBots.oxp\par
  - vebfilm.net for the backgroundmusic used for the escapepod-sequence (CC-by-nc-sa)\ul\par
\ulnone\fs24 _________________________________________________________________________\par
\fs20\par
This OXP is licensed under the Creative Commons Attribution-NonCommercial-ShareAlike 3.0 Unported License.\par
 To view a copy of this license, visit \cf2 http://creativecommons.org/licenses/by-nc-sa/3.0/\cf3  or send a letter to\par
 Creative Commons, 444 Castro Street, Suite 900, Mountain View, California, 94041, USA.\par
\par
DISCLAIMER:\par
THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY\par
EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\par
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT\par
SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\par
SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT\par
OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)\par
HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR\par
TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\par
SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\par
\par
A SMALL PERCENTAGE OF USERS MAY EXPERIENCE EPILEPTIC SEIZURES WHEN EXPOSED TO\par
CERTAIN LIGHT PATTERNS OR BACKGROUNDS ON A COMPUTER SCREEN OR WHILE USING THIS OXP.\par
CERTAIN CONDITIONS MAY INDUCE PREVIOUSLY UNDETECTED EPILEPTIC SYMPTOMS EVEN IN USERS\par
WHO HAVE NO HISTORY OF PRIOR SEIZURES OR EPILEPSY. IF YOU, OR ANYONE IN YOUR FAMILY,\par
HAVE AN EPILEPTIC CONDITION, CONSULT YOUR PHYSICIAN PRIOR TO USING THIS OXP. IMMEDIATELY\par
DISCONTINUE USE OF THIS OXP AND CONSULT YOUR PHYSICIAN IF YOU EXPERIENCE ANY OF THE\par
FOLLOWING SYMPTOMS WHILE USING THIS OXP: DIZZINESS, ALTERED VISION, EYE OR MUSCLE\par
TWITCHES, LOSS OF AWARENESS, DISORIENTATION, ANY INVOLUNTARY MOVEMENT, OR CONVULSIONS.\par
\fs24 _________________________________________________________________________\par
\fs20\par
\par
\par
\par
}
 </pre>
        </a>

        <a name="equipment">          
        <h2>Equipment</h2>
            <table>
                <tr>
                    <th>Name</th>
                    <th>Visible</th>
                    <th>Cost [deci-credits]</th>
                    <th>Tech-Level</th>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_HYPER_RADIO.html">HyperRadio™</a></td>
                    <td>yes</td>
                    <td align="right">12000</td>
                    <td align="center">8+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_HYPER_RADIO_ADD.html">HyperRadio™</a></td>
                    <td>yes</td>
                    <td align="right">8000</td>
                    <td align="center">100+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_HYPER_RADIO_PIRATE.html">HyperRadio™ Social</a></td>
                    <td>yes</td>
                    <td align="right">1000</td>
                    <td align="center">100+</td>
                </tr>
            </table>
        </a>

        <a name="ships">    
        <h2>Ships</h2>
            This expansion declares no ships. 
        </a>

        <a name="models">    
        <h2>Models</h2>
            This expansion declares no models. 
        </a>

        <a name="scripts">    
        <h2>Scripts</h2>
            <table>
                <tr>
                    <th>Path</th>
                </tr>
                <tr>
                    <td valign="top">Scripts/hyperradio.js</td>
                    <td><pre>&quot;use strict&quot;;
this.name = &quot;hyperradio&quot;;
this.author = &quot;Svengali&quot;;
this.copyright = &quot;(C)2008-2013, License:CC-by-nc-sa-3.0&quot;;
this.description = &quot;Musicplayer. Expandable by musicpacks.&quot;;
this.version = &quot;1.26.1&quot;;

/* *** CHANGE ONLY THIS PART - Add new or override the following entries to use it as playList *** */
this.hyperradio_playListOriginal = [
	&quot;hyperradio-exampleA.ogg&quot;,
	&quot;hyperradio-exampleB.ogg&quot;
];
/* *** END OF CHANGES *** */
this.stationList = [&#39;hyperradio_playListOriginal&#39;];
this.stationDesc = [&#39;GalaxyRadio 1.26.1&#39;];

this.startUp = function()
{
	delete this.startUp;
	if(!worldScripts.Cabal_Common_Functions || typeof(worldScripts.Cabal_Common_Functions.Cabal_Common)===&#39;undefined&#39;){this.killSelf(&quot; -&gt; Cabal_Common_Library is missing.&quot;); return;}
	this.helper = new worldScripts.Cabal_Common_Functions.Cabal_Common();
	if(this.helper.internalVersion&lt;15){this.killSelf(&quot; -&gt; Cabal_Common_Functions is too old.&quot;); return;}
	var requires = [&quot;snoopers&quot;,&quot;2.4&quot;];
	this.news = 0;
	this.vNews = 31;
	this.showNews = false;
	if(this.helper.oxpVersionTest(this.name,requires)){
		this.showNews = true;
		if(missionVariables.hyperradio_news){
			var tmp = missionVariables.hyperradio_news.split(&#39;|&#39;);
			this.news = parseInt(tmp[0],null);
			this.sysA = tmp[1];
			this.sysB = tmp[2];
			this.vNews = 15+parseInt(this.news,null);
		}
	} else log(this.name,this.name+&quot; - deactivating all specials&quot;);
	/* Via OXPConfig2 configurable settings */
	this.logging = false;
	this.mergePacks = true;
	this.podMusic = true;
	this.onlyMain = false;
	// Other settings
	this.canPlay = false; // false if EQ not installed, docked, EQ damaged, in interstallar space or tempDisabled
	this.tempDisabled = false; // used to temp disable the HyperRadio, reset on witchspacing
	this.hyperRadio = false; // true if installed and license is valid
	if(missionVariables.hyperradio_last) this.hyperradioDuration = parseInt(missionVariables.hyperradio_last,null);
	else this.hyperradioDuration = 0;
	this.current = &#39;start&#39;; // current song
	this.next = &#39;start&#39;; // next selected song
	this.currentStation = &#39;&#39;; // musicpack or main
	this.currentList = []; // playlist
	this.selectable = [[],[],[],[],[],[],[],[]];
	this.cleanMVs();
	delete this.killSelf;
};
this.killSelf = function(desc)
{
	if(desc!==1){
		player.consoleMessage(this.name+&quot; - Check your Latest.log.&quot;,10);
		log(this.name,this.name+&quot; - Shutting down.&quot;+desc);
	}
	for(var prop in this){if(prop!==&#39;name&#39; &amp;&amp; prop!==&#39;version&#39; &amp;&amp; prop!==&#39;stationList&#39;) delete this[prop];}
	this.deactivated = true;
	return;
};
this.playerWillSaveGame = function()
{
	missionVariables.hyperradio_last = this.hyperradioDuration;
	if(this.news) missionVariables.hyperradio_news = this.news+&#39;|&#39;+this.sysA+&#39;|&#39;+this.sysB;
	this.saved = true;
};
this.cleanMVs = function()
{
	missionVariables.hyperradio_last = null;
	missionVariables.hyperradio_news = null;
	delete this.saved;
	return;
};
this.distribution = function(P)
{
	var K = Math.random()%1;
	for(var j=0;j&lt;P.length;j++){
		if(P[j]&gt;K){
			return(j);
		}
	}
	return(0);
};
this.doInit = function()
{
	this.stations = this.stationList.length;
	if(this.logging) log(this.name,this.name+&#39;: Stations found:&#39;+this.stations);
	if(this.stations&gt;1){
		if(this.mergePacks){
			var lname = &quot;&quot;,outL = this.stationList.length,inL = 0;
			while(outL--){
				inL = worldScripts.hyperradio[this.stationList[outL]].length;
				while(inL--){
					lname = this.stationList[outL];
					this.hyperradio_playListOriginal.push(worldScripts.hyperradio[lname][inL]);
				}
				if(outL===1) break;
			}
			this.hyperradio_playListOriginal = this.helper.arrRemoveByValue(this.hyperradio_playListOriginal,&#39;hyperradio-exampleA.ogg&#39;);
			this.hyperradio_playListOriginal = this.helper.arrRemoveByValue(this.hyperradio_playListOriginal,&#39;hyperradio-exampleB.ogg&#39;);
			if(this.logging) log(this.name,this.name+&#39;: Main Playlist contains &#39;+this.hyperradio_playListOriginal.length+&#39; songs. Examples files removed.&#39;);
		}
		for(var de=1;de&lt;this.stations;de++){
			var sDesc = this.stationList[de];
			var test = sDesc.replace(/(^hyperradio_|playList|[0-9])/g,&#39;&#39;);
			test += &quot; &quot;+this.helper.randSpan(100,999)+&quot;.&quot;+this.helper.rand(99);
			this.stationDesc.push(test);
			if(this.logging) log(this.name,&quot;Desc: &quot;+test);
		}
		var Given = [],j,k,A = [],Probs = [],S = &quot;&quot;,Q = 1,Total = 8;
		for(var c=0;c&lt;this.stations;c++){Given.push(1);}
		for(j=Given.length-1;j&gt;=0;j--){A[j] = 0; Probs[j] = Q; Q -= Given[j]/Total;}
		for(j=0;j&lt;64;j++){k = this.distribution(Probs); S += k; A[k]++;}
		var g=8,ii,c=Given.length-1;
		while(g--){
			ii =Given.length;
			if(c&gt;0) this.selectable[g].push(c);
			c--;
			while(ii--){
				if((S[g+ii]&amp;ii)) this.selectable[g].push((S[g+ii]&amp;ii));
				else this.selectable[g].push(0);
			}
			this.selectable[g] = this.helper.arrUnique(this.selectable[g]);
		}
		if(this.logging){for(var o=0;o&lt;8;o++){log(this.name,this.selectable[o]);}}
	} else this.selectable = [[0],[0],[0],[0],[0],[0],[0],[0]];
	delete this.doInit;
	delete this.helper;
	delete this.distribution;
	return;
};
this.playerBoughtEquipment = function(equipmentKey)
{
	switch(equipmentKey){
		case &#39;EQ_HYPER_RADIO&#39;:
			this.hyperRadio = true;
			this.hyperradioDuration = Math.floor(20+clock.days);
			EquipmentInfo.infoForKey(&#39;EQ_HYPER_RADIO_ADD&#39;).effectiveTechLevel = 7;
			break;
		case &#39;EQ_HYPER_RADIO_ADD&#39;:
			this.hyperRadio = true;
			this.hyperradioDuration += 20;
			player.ship.removeEquipment(&#39;EQ_HYPER_RADIO_ADD&#39;);
			missionVariables.TL_FOR_EQ_HYPER_RADIO_ADD = null;
			break;
		case &#39;EQ_HYPER_RADIO_PIRATE&#39;:
			player.ship.removeEquipment(&#39;EQ_HYPER_RADIO_PIRATE&#39;);
			this.hyperRadio = true;
			player.ship.awardEquipment(&#39;EQ_HYPER_RADIO&#39;);
			missionVariables.TL_FOR_EQ_HYPER_RADIO_PIRATE = null;
			this.hyperradioDuration += Math.ceil(20/Math.log(system.government+2.1));
			this.news = 0;
			break;
	}
};
this.equipmentDamaged = this.equipmentDestroyed = function(equipmentKey)
{
	if(equipmentKey===&#39;EQ_HYPER_RADIO&#39;){
		this.canPlay = false;
		this.failPlay(1);
	}
};
this.shipWillDockWithStation = function()
{
	this.failPlay();
	this.canPlay = false;
	this.CheckHyperradioLicence();
};
this.shipWillLaunchFromStation = function()
{
	missionVariables.TL_FOR_EQ_HYPER_RADIO_ADD = null;
	if(player.ship.equipmentStatus(&#39;EQ_HYPER_RADIO&#39;)===&#39;EQUIPMENT_OK&#39;){
		if(system.isInterstellarSpace || this.tempDisabled){
			this.canPlay = false;
			return;
		}
		this.hyperRadio = true;
		this.SelectHyperradioStation();
	}
};
this.shipLaunchedFromStation = function()
{
	if(this.hyperRadio &amp;&amp; !system.isInterstellarSpace){
		this.current = &#39;start&#39;;
		this.next = &#39;start&#39;;
		if(!this.tempDisabled) this.canPlay = true;
		if(this.logging) log(this.name,this.name+&#39;: Duration:&#39;+this.hyperradioDuration+&#39; tmp:&#39;+this.tempDisabled);
	}
};
this.shipExitedWitchspace = function()
{
	if(this.logging) log(this.name,this.name+&#39;: clock:&#39;+(clock.days&amp;31)+&#39; vNews:&#39;+this.vNews);
	this.tempDisabled = false;
	if(this.hyperRadio){
		if(system.isInterstellarSpace){
			this.failPlay(1);
			player.consoleMessage(&quot;HyperRadio deactivated. Could not transfer data.&quot;,8);
			this.canPlay = false;
			return;
		} else this.SelectHyperradioStation();
		this.canPlay = true;
	}
	if(!this.showNews || system.isInterstellarSpace) return;
	if(this.news){
		if(this.news===4){
			var a = System.systemIDForName(this.sysA);
			var b = System.systemIDForName(this.sysB);
			if(!missionVariables.TL_FOR_EQ_HYPER_RADIO_PIRATE &amp;&amp; (system.ID===a || system.ID===b)){
				EquipmentInfo.infoForKey(&#39;EQ_HYPER_RADIO_PIRATE&#39;).effectiveTechLevel = 1;
				this.news = 0;
				return;
			} else missionVariables.TL_FOR_EQ_HYPER_RADIO_PIRATE = null;
		} else if(this.news===3){
			this.news = 0;
			return;
		}
	}
	if(this.news) return;
	if((clock.days&amp;31)===this.vNews){
		missionVariables.TL_FOR_EQ_HYPER_RADIO_PIRATE = null;
		var a = Math.random();
		if(a&gt;0.5){
			this.sysA = System.systemNameForID(Math.floor(Math.random()*255));
			this.sysB = System.systemNameForID(Math.floor(Math.random()*255));
			var obj;
			if(this.hyperRadio){
				if(a&gt;0.9){
					this.news = 2;
					obj = {Message:&#39;[HYPERRADIO_NEWSA]&#39;,Pic:&#39;hyperradio_news.png&#39;,Music:&#39;snoopers_gcnews.ogg&#39;,Model:&#39;snoopers_gcnewsA1&#39;,Pos:[57,36,170]};
				} else if(a&gt;0.8){
					this.news = 3;
					obj = {Message:&#39;[HYPERRADIO_NEWSD]&#39;,Agency:1};
				} else {
					this.news = 4;
					obj = {Message:&#39;[HYPERRADIO_NEWSE] &#39;+this.sysA+&#39; and &#39;+this.sysB+&#39; [HYPERRADIO_NEWSE2]&#39;,Agency:3};
				}
			} else {
				if(a&gt;0.7){
					if(a&gt;0.9){
						this.news = 1;
						obj = {Message:&#39;[HYPERRADIO_NEWSB]&#39;,Pic:&#39;hyperradio_news.png&#39;,Music:&#39;snoopers_gcnews.ogg&#39;,Model:&#39;snoopers_gcnewsA1&#39;,Pos:[57,36,170]};
					} else {
						this.news = 4;
						obj = {Message:&#39;[HYPERRADIO_NEWSE] &#39;+this.sysA+&#39; and &#39;+this.sysB+&#39; [HYPERRADIO_NEWSE2]&#39;,Agency:3};
					}
				} else {
					this.news = 5;
					obj = {Message:&#39;[HYPERRADIO_NEWSC] &#39;+this.sysA+&#39; and &#39;+this.sysB+&#39; in this sector. [HYPERRADIO_NEWSC2]&#39;,Agency:2};
				}
			}
			if(this.logging) log(this.name,this.name+&#39;: New event:&#39;+this.news);
			obj.ID = this.name;
			var b = worldScripts.snoopers.insertNews(obj);
			if(b) this.news = 0;
			else this.vNews ^= this.news+15;
		}
	}
};
this.alertConditionChanged = function(condition)
{
	if(this.doInit) this.doInit();
	if(this.hyperRadio){
		if(condition===3) this.failPlay();
		else if(!player.ship.docked &amp;&amp; !system.isInterstellarSpace &amp;&amp; !this.tempDisabled) this.canPlay = true;
	}
};
this.shipLaunchedEscapePod = function()
{
	this.failPlay();
	if(this.podMusic) Sound.playMusic(&#39;hyperradio-escapepod.ogg&#39;);
};
this.SelectHyperradioStation = function(next)
{
	if(system.isInterstellarSpace){
		player.consoleMessage(&quot;HyperRadio deactivated. Could not transfer data.&quot;,8);
		return;
	}
	if(this.onlyMain || this.stations&lt;2) this.stationSelect = 0;
	else {
		var currentAvail = this.selectable[system.government];
		if(this.logging &amp;&amp; !next) log(this.name,&quot;Subset:&quot;+currentAvail);
		if(next){
			this.cycle++;
			if(this.cycle&gt;currentAvail.length-1) this.cycle = 0;
			this.stationSelect = currentAvail[this.cycle];
		} else {
			this.stationSelect = currentAvail[Math.floor(Math.random()*currentAvail.length)];
			this.cycle = this.stationSelect;
		}
	}
	if(next) player.consoleMessage(&quot;Channel : &quot;+this.stationDesc[this.stationSelect]);
	if(this.logging) log(this.name,&quot;Selected: &quot;+this.stationSelect);
	return;
};
this.GetHyperradioSongName = function()
{
	var listName = this.stationList[this.stationSelect];
	var i = worldScripts.hyperradio[listName].length;
	if(listName===this.currentStation){
		if(!this.currentList.length){
			while(i--) this.currentList.push(worldScripts.hyperradio[listName][i]);
		}
	} else {
		this.currentStation = listName;
		this.currentList = [];
		while(i--) this.currentList.push(worldScripts.hyperradio[listName][i]);
	}
	if(this.currentList.length) this.currentList.sort(function(){return 0.5-Math.random();});
	var songName = this.currentList[0];
	if(!listName || !songName || !songName.match(&#39;.ogg&#39;)){
		player.consoleMessage(&quot;HyperRadio: NO VALID ENTRY FOUND! See Logfile for Details.&quot;,8);
		log(this.name,this.name+&#39;: WARNING. NO VALID ENTRY IN PLAYLIST FOUND. Error in:&#39;+listName+&#39; &#39;+songName+&#39; Station:&#39;+this.stationSelect);
		return(false);
	}
	this.next = songName;
	this.currentList.shift();
	if(this.logging) log(this.name,this.name+&#39;: Station:&#39;+listName+&#39; Song:&#39;+songName+&#39; remaining #&#39;+this.currentList.length+&#39; in this list.&#39;);
	return(true);
};
this.CheckHyperradioLicence = function()
{
	if(this.hyperRadio &amp;&amp; clock.days&gt;=this.hyperradioDuration){
		player.ship.removeEquipment(&#39;EQ_HYPER_RADIO&#39;);
		this.hyperRadio = false;
		this.canPlay = false;
		this.hyperradioDuration = 0;
		player.consoleMessage(&quot;Your HyperRadio license expired. Buy a new one at your local dealer.&quot;,6);
		return(false);
	}
	if(system.isInterstellarSpace) return(false);
	if(player.ship.equipmentStatus(&#39;EQ_HYPER_RADIO&#39;)===&#39;EQUIPMENT_DAMAGED&#39;){
		this.canPlay = false;
		player.consoleMessage(&quot;Can&#39;t connect to HyperRadio station. Device damaged.&quot;,6);
		return(false);
	}
	if(player.ship.equipmentStatus(&#39;EQ_HYPER_RADIO&#39;)===&#39;EQUIPMENT_OK&#39;) this.canPlay = true;
	return(true);
};
this.guiScreenChanged = function()
{
	if(this.doInit) this.doInit();
	if(this.saved) this.cleanMVs();
};
this.startMusic = function()
{
	if(player.ship.status===&#39;STATUS_IN_FLIGHT&#39;){
		if(this.tempDisabled){
			player.consoleMessage(&quot;HyperRadio signal interrupted.&quot;);
			this.failPlay();
		} else if(this.hyperRadio &amp;&amp; this.CheckHyperradioLicence() &amp;&amp; this.canPlay){
			if(this.current!==&#39;start&#39;) Sound.stopMusic(this.current);
			if(!this.GetHyperradioSongName() || this.next===this.stationList[this.stationSelect]){
				this.canPlay = false;
				return;
			} else {
				this.current = this.next;
				player.consoleMessage(&quot;Connection to &quot;+this.stationDesc[this.stationSelect]+&quot; established. Days left: &quot;+(this.hyperradioDuration-clock.days));
				Sound.playMusic(this.current);
			}
		}
	}
	return;
};
this.shipDied = function()
{
	this.failPlay(1);
};
this.failPlay = function(mode)
{
	if(this.current!==&#39;start&#39;){
		Sound.stopMusic(this.current);
		if(mode) Sound.playMusic(&#39;hyperradio-fail.ogg&#39;);
	}
	return;
};
// Callback from Snoopers
this.newsDisplayed = function()
{
	switch(this.news){
		case 3: this.tempDisabled = true; break;
		case 4: break;
		default: this.news = 0; break;}
};
// OXPConfig2 settings
this.oxpcSettings = {
	Info: {Name:this.name,Display:&quot;Hyperradio&quot;,EarlyCall:true,EarlySet:true,
		InfoB:&quot;If musicpacks are installed channel lists are generated. Switching is done via primed EQ activation key. mergePacks removes the example files, onlyMain uses only the main playlist. Changes to mergePack needs restart to take effect.&quot;},
	Bool0: {Name:&quot;logging&quot;,Def:false,Desc:&quot;Logging functions.&quot;},
	Bool1: {Name:&quot;mergePacks&quot;,Def:true,Desc:&quot;Copy Packs in mainlist.&quot;},
	Bool2: {Name:&quot;podMusic&quot;,Def:true,Desc:&quot;Escapepod music.&quot;},
	Bool3: {Name:&quot;onlyMain&quot;,Def:false,Desc:&quot;Use only mainlist.&quot;}
};
</pre></td>
                </tr>
                <tr>
                    <td valign="top">Scripts/hyperradio_eq.js</td>
                    <td><pre>&quot;use strict&quot;;
this.name = &quot;hyperradio_eq&quot;;
this.author = &quot;Svengali&quot;;
this.copyright = &quot;(C)2008-2013, License:CC-by-nc-sa-3.0&quot;;
this.description = &quot;Musicplayer. EQ script.&quot;;
this.version = &quot;1.26.1&quot;;

this.activated = function()
{
	worldScripts.hyperradio.SelectHyperradioStation(1);
};
this.mode = function()
{
	worldScripts.hyperradio.startMusic();
};
</pre></td>
                </tr>
            </table>
        </a>
    </body>
</html>
