<html>
    <head>
        <title>Expansion Satellites</title>
        <link rel="stylesheet" href="../style.css">
    </head>
    <body>
        <table border="0" width="100%">
            <tr>
                <td>Back to <a href='../index.html'>Index</a></td>
                <td align="right"><small>Page generated: Oct 11, 2023, 3:16:49 PM</small></td>
            </tr>
        </table>

        <h1>Expansion Satellites</h1>

        <h2>Content</h2>
        <ul>
          
          <li><a href="#manifest">Manifest</a></li>
          <li><a href="#documentation">Documentation</a></li>
          <li><a href="#equipment">0 Equipment</a></li>
          <li><a href="#ships">4 Ships</a></li>
          <li><a href="#models">0 Models</a></li>
          <li><a href="#scripts">2 Scripts</a></li>
        </ul>


        <a name="manifest">
        <h2>Manifest</h2>
            <table border="1">
                <tr>
                    <th></th>
                    <th>from Expansion Manager's OXP list</th>
                    <th>from Expansion Manifest</th>
                </tr>
                <tr>
                    <td>Description</td>
                    <td>Adds some (0 to 15, dependent on tech level and size of population) of four small satellites to every main planet.</td>
                    <td>Adds some (0 to 15, dependent on tech level and size of population) of four small satellites to every main planet.</td>
                </tr>
                <tr>
                    <td>Identifier</td>
                    <td>oolite.oxp.Rorschachhamster.Satellites</td>
                    <td>oolite.oxp.Rorschachhamster.Satellites</td>
                </tr>
                <tr>
                    <td>Title</td>
                    <td>Satellites</td>
                    <td>Satellites</td>
                </tr>
                <tr>
                    <td>Category</td>
                    <td>Ambience</td>
                    <td>Ambience</td>
                </tr>
                <tr>
                    <td>Author</td>
                    <td>Rorschachhamster</td>
                    <td>Rorschachhamster</td>
                </tr>
                <tr>
                    <td>Version</td>
                    <td>1.10</td>
                    <td>1.10</td>
                </tr>
                <tr>
                    <td>Tags</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Required Oolite Version</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Maximum Oolite Version</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Required Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Optional Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Conflict Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Information URL</td>
                    <td><a target="_blank" href="http://aegidian.org/bb/viewtopic.php?f=4&amp;t=13687">http://aegidian.org/bb/viewtopic.php?f=4&amp;t=13687</a></td>
                    <td><a target="_blank" href="">n/a</a></td>
                </tr>
                <tr>
                    <td>Download URL</td>
                    <td><a target="_blank" href="https://wiki.alioth.net/img_auth.php/9/9d/Satellites.oxz">https://wiki.alioth.net/img_auth.php/9/9d/Satellites.oxz</a></td>
                    <td><a target="_blank" href="">n/a</a></td>
                </tr>
                <tr>
                    <td>License</td>
                    <td>CC BY-NC-SA 3</td>
                    <td>CC BY-NC-SA 3</td>
                </tr>
                <tr>
                    <td>File Size</td>
                    <td>n/a</td>
                </tr>
                <tr>
                    <td>Upload date</td>
                    <td>1610873392</td>
                </tr>
            </table>
                </a>

        <a name="documentation">
        <h2>Documentation</h2>
        <p>Also read <a href='http://wiki.alioth.net/index.php/Satellites'>http://wiki.alioth.net/index.php/Satellites</a></p>
        <h3>Readme.txt</h3>
        <pre>Satellites OXP.
By Rorschachhamster aka Christian Sturke 2013
License:CC-by-nc-sa-3.0

Adds a random number (0 to 15, dependent on tech level and size of population) of four small satellites to every main planet. Many thanks to Eric Walch for the script/ai-combo I could use to bash on until I got them into orbit. ;)
Oh, and I took a GNN Logo from Snoopers for one of the satellites. :)

INSTALLATION
Unzip the Satellites.oxp into your addons folder. 

Version 1.10
Fixed small bug that was preventing 2 satellite types from having their beacons hidden on secondary planets.

Version 1.09
Fixed bugs with Library interface.

Version 1.08
Destroyed satellites will stay destroyed in the current system until you leave.
Small bugfix in the save game routine.

Version 1.07
Small bugfix in the new populator.

Version 1.06
Reworked populator methods to use new functions, and to make the number and types of satellites the same in each system.
Added satellites to any extra planets in the system.
Added Library config options to turn off beacons and control the number of satellites spawned.

version 1.05
Added check if mainplanet is existant, in case of nova system... and corrected versions in scripts.

version 1.04 
Added AI-code by Dr.Tripsa, that will let spy-sats work as police, and reduzed texture size with Optipng thanks to a tip from Shipbuilder. Cleaned up the shipdata.plist, as well. 

Version 1.03
...and if you change the texture names, you should change the names in the model.dats as well... and I should propably test before I release a &quot;fixed&quot; version. Sorry.

Version 1.02
--and deleted a paste and copy error... &lt;_&lt;ï¿½

Version 1.01
Changed the roles, models , textures etc. to more unique names to avoid compability issues, thanks again to Eric Walch. Corrected the demoship.plist, so that all 4 satellites can be seen... 

Version 1.0
Original release. 


    
</pre>
        </a>

        <a name="equipment">          
        <h2>Equipment</h2>
            This expansion declares no equipment. 
        </a>

        <a name="ships">    
        <h2>Ships</h2>
            <table>
                <tr>
                    <th>Name</th>
                </tr>
                <tr>
                    <td><a href="../ships/RSSatellite_1.html">Surveillance-Satellite</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/RSSatellite_2.html">COMLR-Satellite</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/RSSatellite_3.html">COM-Satellite</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/RSSatellite_4.html">Satellite Telescope</a></td>
                </tr>
            </table>
        </a>

        <a name="models">    
        <h2>Models</h2>
            This expansion declares no models. 
        </a>

        <a name="scripts">    
        <h2>Scripts</h2>
            <table>
                <tr>
                    <th>Path</th>
                </tr>
                <tr>
                    <td valign="top">Config/script.js</td>
                    <td><pre>&quot;use strict&quot;;
this.name					 = &quot;Satellite&quot;;
this.author					 = &quot;Rorschachhamster&quot;;
this.copyright				 = &quot;Creative Commons Attribution - Non-Commercial - Share Alike 3.0 license&quot;;
this.description			 = &quot;Populator for Satellites around Main Planet&quot;;

this._mainBeacons = true;
this._maxSatsMain = 6;
this._epBeacons = true;
this._maxSatsEP = 2;
this._trueValues = [&quot;yes&quot;, &quot;1&quot;, 1, &quot;true&quot;, true];
this._extraPlanetSatellites = null;
this._lastID = 0;
this._destroyed = [];

// configuration settings for use in Lib_Config
this._satConfig = {Name:this.name, Alias:&quot;Satellites&quot;, Display:&quot;Config&quot;, Alive:&quot;_satConfig&quot;,
    Bool:{
        B0:{Name:&quot;_mainBeacons&quot;, Def:true, Desc:&quot;Beacons on main planet&quot;},
        B1:{Name:&quot;_epBeacons&quot;, Def:true, Desc:&quot;Beacons on extra planets&quot;},
        Info:&quot;0 - Whether main planet satellites have beacons.\n1 - Whether extra planet satellites have beacons.&quot;},
    SInt: {
        S0:{Name:&quot;_maxSatsMain&quot;, Def:6, Min:0, Max:15, Desc:&quot;Max sats main planet&quot;},
        S1:{Name:&quot;_maxSatsEP&quot;, Def:2, Min:0, Max:5, Desc:&quot;Max sats extra planets&quot;},
        Info:&quot;0 - Maximum number of satellites around main planet\n1 - Maximum number of satellites around any extra planets&quot;},
};

//-------------------------------------------------------------------------------------------------------------
this.startUp = function() {
    if (missionVariables.Satellites_MainBeacons) this._mainBeacons = (this._trueValues.indexOf(missionVariables.Satellites_MainBeacons) &gt;= 0 ? true : false);
    if (missionVariables.Satellites_ExtraPlanetBeacons) this._epBeacons = (this._trueValues.indexOf(missionVariables.Satellites_ExtraPlanetBeacons) &gt;= 0 ? true : false);
    if (missionVariables.Satellites_MaxMain) this._maxSatsMain = parseInt(missionVariables.Satellites_MaxMain);
    if (missionVariables.Satellites_MaxEP) this._maxSatsEP = parseInt(missionVariables.Satellites_MaxEP);
    if (missionVariables.Satellites_Destroyed) this._destroyed = JSON.parse(missionVariables.Satellites_Destroyed);

	// register our settings, if Lib_Config is present
    if (worldScripts.Lib_Config) worldScripts.Lib_Config._registerSet(this._satConfig);
}

//-------------------------------------------------------------------------------------------------------------
this.playerWillSaveGame = function() {
    missionVariables.Satellites_MainBeacons = this._mainBeacons;
    missionVariables.Satellites_ExtraPlanetBeacons = this._epBeacons;
    missionVariables.Satellites_MaxMain = this._maxSatsMain;
    missionVariables.Satellites_MaxEP = this._maxSatsEP;
    missionVariables.Satellites_Destroyed = JSON.stringify(this._destroyed);
}

//-------------------------------------------------------------------------------------------------------------
this.shipWillEnterWitchspace = function() {
    this._destroyed = [];
}

//-------------------------------------------------------------------------------------------------------------
this.systemWillPopulate = function() {
    this._lastID = 0;
    if (system.isInterstellarSpace) return;
    if (!system.mainPlanet) return;
    // random number of sats, but consistent per system
    var RaSaCount = system.scrambledPseudoRandomNumber(3873 + system.ID) * (system.techLevel + 1) * ((system.population + 33) / 100);
    if (RaSaCount &gt; this._maxSatsMain) RaSaCount = this._maxSatsMain;
    for (var i = 0; i &lt;= RaSaCount; i++) {
        // skip any satellites that might have been destroyed
        if (Array.isArray(this._destroyed) &amp;&amp; this._destroyed.indexOf(i + 1) &gt;= 0) continue;
        // random initial position of sats, but consistent per system
        var Schalter = Math.round(system.scrambledPseudoRandomNumber(11212 + system.ID + i) * 6);
        
        switch (Schalter) {
            case 1 :
                var pos = Vector3D((Math.random() - 0.5), (Math.random() - 0.5), 1.6).fromCoordinateSystem(&quot;pwp&quot;);
                //system.legacy_addShipsAtPrecisely(this.role1, 1, &quot;pwp&quot;, [(Math.random() - 0.5), (Math.random() - 0.5), 1.6]);
                break;
            case 2 :
                var pos = Vector3D((Math.random() - 0.5), 1.6, (Math.random() - 0.5)).fromCoordinateSystem(&quot;pwp&quot;);
                //system.legacy_addShipsAtPrecisely(this.role1, 1, &quot;pwp&quot;, [(Math.random() - 0.5), 1.6, (Math.random() - 0.5)]);
                break;
            case 3 :
                var pos = Vector3D(1.6, (Math.random() - 0.5), (Math.random() - 0.5)).fromCoordinateSystem(&quot;pwp&quot;);
                //system.legacy_addShipsAtPrecisely(this.role1, 1, &quot;pwp&quot;, [1.6, (Math.random() - 0.5), (Math.random() - 0.5)]);
                break;
            case 4 :
                var pos = Vector3D((Math.random() - 0.5), (Math.random() - 0.5), - 1.6).fromCoordinateSystem(&quot;pwp&quot;);
                //system.legacy_addShipsAtPrecisely(this.role1, 1, &quot;pwp&quot;, [(Math.random() - 0.5), (Math.random() - 0.5), - 1.6]);
                break;
            case 5 :
                var pos = Vector3D((Math.random() - 0.5), - 1.6, (Math.random() - 0.5)).fromCoordinateSystem(&quot;pwp&quot;);
                //system.legacy_addShipsAtPrecisely(this.role1, 1, &quot;pwp&quot;, [(Math.random() - 0.5), - 1.6, (Math.random() - 0.5)]);
                break;
            case 6 :
                var pos = Vector3D(-1.6, (Math.random() - 0.5), (Math.random() - 0.5)).fromCoordinateSystem(&quot;pwp&quot;);
                //system.legacy_addShipsAtPrecisely(this.role1, 1, &quot;pwp&quot;, [ - 1.6, (Math.random() - 0.5), (Math.random() - 0.5)]);
                break;
            default :
                var pos = Vector3D((Math.random() - 0.5), (Math.random() - 0.5), 1.6).fromCoordinateSystem(&quot;pwp&quot;);
                //system.legacy_addShipsAtPrecisely(this.role1, 1, &quot;pwp&quot;, [(Math.random() - 0.5), (Math.random() - 0.5), 1.6]);
                break;
        }
        // random types, but consistent in system
        var satType = Math.floor(system.scrambledPseudoRandomNumber(983 + system.ID + i) * 4);
        switch (satType) {
            case 0:
                system.setPopulator(&quot;rs_satellite_&quot; + i, {
                    location: &quot;COORDINATES&quot;,
                    coordinates: pos,
                    callback: function(pos) {
                        var sat = system.addShips(&quot;[RSSatellite_1]&quot;, 1, pos, 0);
                        if (sat &amp;&amp; sat.length &gt; 0) {
                            sat[0].primaryRole = &quot;RSsatellite&quot;;
                            sat[0].script._ID = worldScripts.Satellite.$getID();
                            sat[0].script._orbiting = system.mainPlanet;
                            if (worldScripts.Satellite._mainBeacons === false) {
                                sat[0].beaconCode = &quot;&quot;;
                                sat[0].beaconLabel = &quot;&quot;;
                            }
                        }
                    }}
                );
                break;
            case 1:
                system.setPopulator(&quot;rs_satellite_&quot; + i, {
                    location: &quot;COORDINATES&quot;,
                    coordinates: pos,
                    callback: function(pos) {
                        var sat = system.addShips(&quot;[RSSatellite_2]&quot;, 1, pos, 0);
                        if (sat &amp;&amp; sat.length &gt; 0) {
                            sat[0].primaryRole = &quot;RSsatellite&quot;;
                            sat[0].script._ID = worldScripts.Satellite.$getID();
                            sat[0].script._orbiting = system.mainPlanet;
                            if (worldScripts.Satellite._mainBeacons === false) {
                                sat[0].beaconCode = &quot;&quot;;
                                sat[0].beaconLabel = &quot;&quot;;
                            }
                        }
                    }}
                );
                break;
            case 2:
                system.setPopulator(&quot;rs_satellite_&quot; + i, {
                    location: &quot;COORDINATES&quot;,
                    coordinates: pos,
                    callback: function(pos) {
                        var sat = system.addShips(&quot;[RSSatellite_3]&quot;, 1, pos, 0);
                        if (sat &amp;&amp; sat.length &gt; 0) {
                            sat[0].primaryRole = &quot;RSsatellite&quot;;
                            sat[0].script._ID = worldScripts.Satellite.$getID();
                            sat[0].script._orbiting = system.mainPlanet;
                            if (worldScripts.Satellite._mainBeacons === false) {
                                sat[0].beaconCode = &quot;&quot;;
                                sat[0].beaconLabel = &quot;&quot;;
                            }
                        }
                    }}
                );
                break;
            case 3:
                system.setPopulator(&quot;rs_satellite_&quot; + i, {
                    location: &quot;COORDINATES&quot;,
                    coordinates: pos,
                    callback: function(pos) {
                        var sat = system.addShips(&quot;[RSSatellite_4]&quot;, 1, pos, 0);
                        if (sat &amp;&amp; sat.length &gt; 0) {
                            sat[0].primaryRole = &quot;RSsatellite&quot;;
                            sat[0].script._ID = worldScripts.Satellite.$getID();
                            sat[0].script._orbiting = system.mainPlanet;
                            if (worldScripts.Satellite._mainBeacons === false) {
                                sat[0].beaconCode = &quot;&quot;;
                                sat[0].beaconLabel = &quot;&quot;;
                            }
                        }
                    }}
                );
                break;
        }
    }
    // we&#39;ll add extra planet satellites via a timer, because we can&#39;t be sure when the planets will actually be created and ready to use
    this._extraPlanetSatellites = new Timer(this, this.$addExtraPlanetSatellites, 2, 0);
}

//-------------------------------------------------------------------------------------------------------------
this.$addExtraPlanetSatellites = function $addExtraPlanetSatellites() {
    if (system.planets.length &gt; 1) {
        var satCount = system.countShipsWithRole(&quot;RSsatellite&quot;);
        var idCount = 0;
        var list = system.planets;
        for (var i = 0; i &lt; list.length; i++) {
            // only add to non-main planets and to planets with atmosphere
            var pl = list[i];
            if (pl.isMainPlanet === false &amp;&amp; pl.hasAtmosphere === true) {
                // random number, but consistent per system
                var s = Math.floor(system.scrambledPseudoRandomNumber(1245 + system.ID) * (this._maxSatsEP + 1));
                for (var j = 1; j &lt;= s; j++) {
                    idCount += 1;
                    // skip any that have been destroyed
                    if (Array.isArray(this._destroyed) &amp;&amp; this._destroyed.indexOf(satCount + idCount) &gt;= 0) continue;
                    // random position
                    var eppos = pl.position.add(new Vector3D.randomDirection(pl.radius * (1 + (Math.random() * 0.4) + 0.2)));
                    // random types, but consistent in system
                    var satType = Math.floor(system.scrambledPseudoRandomNumber(785 + system.ID + i) * 4);
                    switch (satType) {
                        case 0:
                            var sat = system.addShips(&quot;[RSSatellite_1]&quot;, 1, eppos, 0);
                            if (sat &amp;&amp; sat.length &gt; 0) {
                                sat[0].primaryRole = &quot;RSsatellite&quot;;
                                sat[0].script._ID = worldScripts.Satellite.$getID();
                                sat[0].script._orbiting = pl;
                                if (this._epBeacons === false) {
                                    sat[0].beaconCode = &quot;&quot;;
                                    sat[0].beaconLabel = &quot;&quot;;
                                }
                            }
                            break;
                        case 1:
                            var sat = system.addShips(&quot;[RSSatellite_2]&quot;, 1, eppos, 0);
                            if (sat &amp;&amp; sat.length &gt; 0) {
                                sat[0].primaryRole = &quot;RSsatellite&quot;;
                                sat[0].script._ID = worldScripts.Satellite.$getID();
                                sat[0].script._orbiting = pl;
                                if (this._epBeacons === false) {
                                    sat[0].beaconCode = &quot;&quot;;
                                    sat[0].beaconLabel = &quot;&quot;;
                                }
                            }
                            break;
                        case 2:
                            var sat = system.addShips(&quot;[RSSatellite_3]&quot;, 1, eppos, 0);
                            if (sat &amp;&amp; sat.length &gt; 0) {
                                sat[0].primaryRole = &quot;RSsatellite&quot;;
                                sat[0].script._ID = worldScripts.Satellite.$getID();
                                sat[0].script._orbiting = pl;
                                if (this._epBeacons === false) {
                                    sat[0].beaconCode = &quot;&quot;;
                                    sat[0].beaconLabel = &quot;&quot;;
                                }
                            }
                            break;
                        case 3:
                            var sat = system.addShips(&quot;[RSSatellite_4]&quot;, 1, eppos, 0);
                            if (sat &amp;&amp; sat.length &gt; 0) {
                                sat[0].primaryRole = &quot;RSsatellite&quot;;
                                sat[0].script._ID = worldScripts.Satellite.$getID();
                                sat[0].script._orbiting = pl;
                                if (this._epBeacons === false) {
                                    sat[0].beaconCode = &quot;&quot;;
                                    sat[0].beaconLabel = &quot;&quot;;
                                }
                            }
                            break;
                    }
                }
            }
        }
    }
}

//-------------------------------------------------------------------------------------------------------------
this.$getID = function() {
    this._lastID += 1;
    return this._lastID;
}</pre></td>
                </tr>
                <tr>
                    <td valign="top">Scripts/RSsatellite.js</td>
                    <td><pre>&quot;use strict&quot;;
this.name					= &quot;RSsatellite.js&quot;;
this.author					= &quot;Rorschachhamster&quot;;
this.copyright				= &quot;Creative Commons: attribution, non-commercial, sharealike.&quot;;
this.description			= &quot;Satellites&quot;;

//-------------------------------------------------------------------------------------------------------------
this.shipSpawned = function() {
    this.ship.radiusorbit = ((this.ship.script._orbiting.radius * 1.1) + (Math.random() * this.ship.script._orbiting.radius * 0.5));
}
	
//-------------------------------------------------------------------------------------------------------------
this.OrbitSatellite = function() {
    var v = this.ship.position.add(this.ship.heading.multiply(10000));
    v = v.subtract(this.ship.script._orbiting.position).direction().multiply(this.ship.radiusorbit);
    this.ship.savedCoordinates = this.ship.script._orbiting.position.add(v);
}
    
//-------------------------------------------------------------------------------------------------------------
this.shipDied = function(whom, why) {
    worldScripts.Satellite._destroyed.push(this.ship.script._ID);
	this.ship.commsMessage(&quot;[END_OF_A_SAT]&quot;);
};	
	
</pre></td>
                </tr>
            </table>
        </a>
    </body>
</html>
