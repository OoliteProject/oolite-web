<html>
    <head>
        <title>Expansion Fast Target Selector</title>
        <link rel="stylesheet" href="../style.css">
    </head>
    <body>
        <table border="0" width="100%">
            <tr>
                <td>Back to <a href='../index.html'>Index</a></td>
                <td align="right"><small>Page generated: Oct 11, 2023, 3:16:49 PM</small></td>
            </tr>
        </table>

        <h1>Expansion Fast Target Selector</h1>

        <h2>Content</h2>
        <ul>
          <li><a href="#warnings">Warnings</a></li>
          <li><a href="#manifest">Manifest</a></li>
          <li><a href="#documentation">Documentation</a></li>
          <li><a href="#equipment">3 Equipment</a></li>
          <li><a href="#ships">0 Ships</a></li>
          <li><a href="#models">0 Models</a></li>
          <li><a href="#scripts">3 Scripts</a></li>
        </ul>

          <a name="warnings">
            <h2>Warnings</h2>
            <ol>
                <li>Tags mismatch between OXP Manifest and Expansion Manager at character position 0002 (RIGHT SQUARE BRACKET vs LATIN SMALL LETTER E)(&#39;[]&#39; vs &#39;[equipment, scanner, targeting]&#39;)</li>
                <li>Information URL mismatch between OXP Manifest and Expansion Manager string length at character position 0</li>
            </ol>
          </a>

        <a name="manifest">
        <h2>Manifest</h2>
            <table border="1">
                <tr>
                    <th></th>
                    <th>from Expansion Manager's OXP list</th>
                    <th>from Expansion Manifest</th>
                </tr>
                <tr>
                    <td>Description</td>
                    <td>Primable equipment that allows quick targeting of other ships in scanner range.</td>
                    <td>Primable equipment that allows quick targeting of other ships in scanner range.</td>
                </tr>
                <tr>
                    <td>Identifier</td>
                    <td>oolite.oxp.phkb.FastTargetSelector</td>
                    <td>oolite.oxp.phkb.FastTargetSelector</td>
                </tr>
                <tr>
                    <td>Title</td>
                    <td>Fast Target Selector</td>
                    <td>Fast Target Selector</td>
                </tr>
                <tr>
                    <td>Category</td>
                    <td>Equipment</td>
                    <td>Equipment</td>
                </tr>
                <tr>
                    <td>Author</td>
                    <td>Nick Rogers</td>
                    <td>Nick Rogers</td>
                </tr>
                <tr>
                    <td>Version</td>
                    <td>1.5</td>
                    <td>1.5</td>
                </tr>
                <tr>
                    <td>Tags</td>
                    <td></td>
                    <td>equipment, scanner, targeting</td>
                </tr>
                <tr>
                    <td>Required Oolite Version</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Maximum Oolite Version</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Required Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Optional Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Conflict Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Information URL</td>
                    <td><a target="_blank" href=""></a></td>
                    <td><a target="_blank" href="">n/a</a></td>
                </tr>
                <tr>
                    <td>Download URL</td>
                    <td><a target="_blank" href="https://wiki.alioth.net/img_auth.php/7/73/FastTargetSelector.oxz">https://wiki.alioth.net/img_auth.php/7/73/FastTargetSelector.oxz</a></td>
                    <td><a target="_blank" href="">n/a</a></td>
                </tr>
                <tr>
                    <td>License</td>
                    <td>CC-BY-NC-SA 4.0</td>
                    <td>CC-BY-NC-SA 4.0</td>
                </tr>
                <tr>
                    <td>File Size</td>
                    <td>n/a</td>
                </tr>
                <tr>
                    <td>Upload date</td>
                    <td>1610873336</td>
                </tr>
            </table>
                </a>

        <a name="documentation">
        <h2>Documentation</h2>
        <p>Also read <a href='http://wiki.alioth.net/index.php/Fast%20Target%20Selector'>http://wiki.alioth.net/index.php/Fast%20Target%20Selector</a></p>
        <h3>readme.txt</h3>
        <pre>Fast Target Selector
By Nick Rogers

Overview
========
This OXP aims to simplify the process of targeting ships. In the core game, a pilot must point their crosshairs at a ship in order to target it. However, at the edge of scanner range it is quite hard to move the reticule over the small dot of a ship in order to get a target lock. This seems counter-intuitive as the scanner can certainly identify the ship - why can&#39;t a lock be set without having to jiggle the crosshairs over the ship?

This is where Fast Target Selector comes into play. Now you can do what NPC ships do - just cycle through all the available targets by priming the equipment and selecting &quot;n&quot;. During red alert conditions when enemies are targeting you, the list of targets cycled through will be reduced to just those who are targeting you. 

The Fast Target Selector is simple to install and use, costing a mere 10cr and available from all tech level 5 systems and above. The reason for the small cost is to make it a reasonable piece of equipment for new commanders to install even before they leave Lave. 

Usage
=====
Ideally the Fast Target Selector will be set as the &quot;Fast Defensive&quot; equipment item, using the &quot;0&quot; key on the keyboard to switch to the next target. However, you can also prime the equipment using &quot;Shift-N&quot;, and use the &quot;n&quot; key to go to the next target and &quot;b&quot; to go back to the previous target.

When a ship or object is targeted it will be highlighted on the scanner with an alternating color, depending on the type of ship. 

If you find yourself in a situation where you are in Condition Red, but you need to target something other than enemy ships, prime the &quot;FTS Mode Changer&quot; equipment (this becomes available during flight), and press the &quot;n&quot; key to change the mode between &quot;Standard target selection&quot; (which is the default mode where only enemy ships are targeted in Condition Red) and &quot;Include all targets&quot; (which essentially ignores Condition Red and targets all entities in range).

Note: Wormholes will not be targeted with this system. They must be targeted in the traditional way.
Note: This equipment is incompatible with the &quot;Targeter&quot; and &quot;Military Targeting System&quot; equipment items. You will not be able to purchase this equipment with those items already installed.

License
=======
This work is licensed under the Creative Commons Attribution-Noncommercial-Share Alike 4.0 Unported License. To view a copy of this license, visit http://creativecommons.org/licenses/by-nc-sa/4.0/

Thanks for Thargoid for his &quot;Target Autolock Plus&quot; OXP, from which I borrowed the scanner highlighting code, and for his &quot;sort by distance&quot; calculation (although I can&#39;t remember where I sourced this from).
Thanks to cag for his speed improvements and finding of bugs.

Version History
===============
1.5
- Bug fixes.
- Code refactoring.

1.4
- Removed incompatible behaviour when &quot;Target Autolock Plus&quot; OXP is active.

1.3
- Removed hard-coded scanner range value.
- Improved integration with EscortDesk, thanks to Norby and cag.

1.2
- Code optimisations with thanks to cag.

1.1
- Small tweak to the method of identifying hostile ships.

1.0
- Initial release.</pre>
        </a>

        <a name="equipment">          
        <h2>Equipment</h2>
            <table>
                <tr>
                    <th>Name</th>
                    <th>Visible</th>
                    <th>Cost [deci-credits]</th>
                    <th>Tech-Level</th>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_TARGETSELECTOR.html">Fast Target Selector</a></td>
                    <td>yes</td>
                    <td align="right">100</td>
                    <td align="center">5+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_TARGETSELECTOR_MODECHANGER.html">FTS Mode Changer</a></td>
                    <td>no</td>
                    <td align="right">100</td>
                    <td align="center">5+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_TARGETSELECTOR_REMOVAL.html">Remove Fast Target Selector</a></td>
                    <td>no</td>
                    <td align="right">10</td>
                    <td align="center">3+</td>
                </tr>
            </table>
        </a>

        <a name="ships">    
        <h2>Ships</h2>
            This expansion declares no ships. This may be related to warnings.
        </a>

        <a name="models">    
        <h2>Models</h2>
            This expansion declares no models. This may be related to warnings.
        </a>

        <a name="scripts">    
        <h2>Scripts</h2>
            <table>
                <tr>
                    <th>Path</th>
                </tr>
                <tr>
                    <td valign="top">Scripts/fasttargetselector.js</td>
                    <td><pre>&quot;use strict&quot;;
this.name	     = &quot;FastTargetSelector&quot;;
this.author	     = &quot;phkb&quot;;
this.copyright   = &quot;2016 phkb&quot;;
this.description = &quot;Allows quick targeting of ships or other entities visible on the scanner. Also highlights current target on the scanner.&quot;;
this.licence     = &quot;CC BY-NC-SA 4.0&quot;;

/* Borrows scanner highlight code from Thargoids Target Autolock OXP */
/* Also borrows &quot;sort by distance calc&quot; from Timer&#39;s Targeter OXP */
/* Bg thanks to cag for code optimisations */

this._normalColorsDefault = {color1:&quot;blueColor&quot;, color2:&quot;yellowColor&quot;};
this._normalColorsStation = {color1:&quot;blueColor&quot;, color2:&quot;greenColor&quot;};
this._normalColorsPolice = {color1:&quot;greenColor&quot;, color2:&quot;0.5 0.0 1.0&quot;};
this._normalColorsRock = {color1:&quot;blueColor&quot;, color2:&quot;whiteColor&quot;};
this._normalColorsThargoid = {color1:&quot;blueColor&quot;, color2:&quot;redColor&quot;};
this._normalColorsMissile = {color1:&quot;cyanColor&quot;, color2:&quot;whiteColor&quot;};
this._normalColorsBuoy = {color1:&quot;greenColor&quot;, color2:&quot;whiteColor&quot;};

this._battleColorsDefault = {color1:&quot;redColor&quot;, color2:&quot;yellowColor&quot;};
this._battleColorsMissile = {color1:&quot;redColor&quot;, color2:&quot;cyanColor&quot;};
this._battleColorsPolice = {color1:&quot;redColor&quot;, color2:&quot;1.0 0.0 0.5&quot;};

this._npc = [];								// current scan data array
this._index = -1;							// position of players selected target in array
this._dataAge = 0;							// age of current scan data
this._targetTimer = null;					// timer used to update the colors of the currently selected target, so it will stand out on the scanner
this._trueCondition = 0;					// current alert condition of the player. Adjusted slightly so that red alert (3) is limited to when there are hostile ships
this._oldCondition = 0;						// last state of the players alert condition
this._oldTarget = null;						// reference to the players last selected target
this._ignoreRoles = [&quot;btd_dummy_entity&quot;];	// ship roles that will be ignored (ie they won&#39;t be selected)
//cag: increasing the length of _ignoreRoles requires chg&#39;s to $findNPCShips()
this._active = false;						// flag to indicate the FTS is in operation
this._scanMode = 0;							// mode 0 = normal scan operations, mode 1 = include all objects, even under condition red. Default to 0.
this._removePrimableEquipment = false;		// flag to indicate whether the mode change primable equipment will be removed from the list. Default to false.
this._trueValues = [&quot;yes&quot;, &quot;1&quot;, 1, &quot;true&quot;, true];
this._tapInstalled = false;

// configuration settings for use in Lib_Config
this._ftsConfig = {Name:this.name, Alias:&quot;Fast Target Selector&quot;, Display:&quot;Config&quot;, Alive:&quot;_ftsConfig&quot;, 
	Bool:{
		B0:{Name:&quot;_removePrimableEquipment&quot;, Def:false, Desc:&quot;Removes the FTS Mode Changer&quot;},
		Info:&quot;0 - Removes the FTS Mode Changer from primable equipment.&quot;},
	EInt:{
		E0:{Name:&quot;_scanMode&quot;, Def:0, Desc:[&quot;Def. scan mode&quot;,&quot;Def. scan mode&quot;], Min:0, Max:1},
		Info:&quot;Default scan mode: 0=Standard (red alert limited). 1=All entities (even in red alert)&quot;}
};

//-------------------------------------------------------------------------------------------------------------
this.startUpComplete = function() {
	// register our settings, if Lib_Config is present
	if (worldScripts.Lib_Config) worldScripts.Lib_Config._registerSet(this._ftsConfig);

	if (missionVariables.FTS_RemoveModeChanger) this._removePrimableEquipment = (this._trueValues.indexOf(missionVariables.FTS_RemoveModeChanger) &gt;= 0 ? true : false);
	if (missionVariables.FTS_ScanMode) this._scanMode = parseInt(missionVariables.FTS_ScanMode);

	if (worldScripts.targetAutolock) {
		if (missionVariables.targetAutolock == &quot;TRUE&quot;) this._tapInstalled = true;
	}

	// make sure the mode change equipment isn&#39;t on board - we only push it into the equip list on launch
	player.ship.removeEquipment(&quot;EQ_TARGETSELECTOR_MODECHANGER&quot;);
	if (player.ship.equipmentStatus(&quot;EQ_TARGETSELECTOR&quot;) === &quot;EQUIPMENT_OK&quot;) this._active = true;
}

//-------------------------------------------------------------------------------------------------------------
this.playerWillSaveGame = function() {
	missionVariables.FTS_RemoveModeChanger = this._removePrimableEquipment;
	missionVariables.FTS_ScanMode = this._scanMode;
}

//-------------------------------------------------------------------------------------------------------------
this.shipTargetAcquired = function(newTarget) {
	if (this._active) this.$startTimer();
}

//-------------------------------------------------------------------------------------------------------------
this.alertConditionChanged = function(newCondition, oldCondition) {
	if (this._active === false) return;
	if (this._trueCondition !== newCondition &amp;&amp; ((newCondition === 3 &amp;&amp; player.alertHostiles === true) || newCondition &lt; 3)) {
		this._trueCondition = newCondition;
		this.$startTimer();
	}
}

//-------------------------------------------------------------------------------------------------------------
this.shipTargetLost = this.shipTargetDestroyed = function(target) {
	if (this._active === false) return;
	this.$resetOldTarget();
}

//-------------------------------------------------------------------------------------------------------------
this.shipDockedWithStation = function(station) {
	this.$resetOldTarget();
	// remove the mode changer
	player.ship.removeEquipment(&quot;EQ_TARGETSELECTOR_MODECHANGER&quot;);
}

//-------------------------------------------------------------------------------------------------------------
this.shipLaunchedFromStation = function(station) {
	// make sure the mode changer is installed, but only if (a) its not disabled, and the fts is not broken
	if (this._removePrimableEquipment === false &amp;&amp; player.ship.equipmentStatus(&quot;EQ_TARGETSELECTOR&quot;) === &quot;EQUIPMENT_OK&quot;) {
		player.ship.awardEquipment(&quot;EQ_TARGETSELECTOR_MODECHANGER&quot;);
	}
}

//-------------------------------------------------------------------------------------------------------------
this.shipDied = this.shipWillEnterWitchspace = function() {
	if (this._active === false) return;
	this.$resetOldTarget();
}

//-------------------------------------------------------------------------------------------------------------
this.playerBoughtEquipment = function(equipmentKey) {
	if (equipmentKey === &quot;EQ_TARGETSELECTOR_REMOVAL&quot;) {
		player.ship.removeEquipment(equipmentKey);
		player.ship.removeEquipment(&quot;EQ_TARGETSELECTOR_MODECHANGER&quot;);
		player.ship.removeEquipment(&quot;EQ_TARGETSELECTOR&quot;);
		this._active = false;
	}
	if (equipmentKey === &quot;EQ_TARGETSELECTOR&quot;) this._active = true;
	// monitor for when TAP is installed so we don&#39;t conflict with it
	if (equipmentKey === &quot;EQ_TARGET_AUTOLOCK&quot;) this._tapInstalled = true;
}

//-------------------------------------------------------------------------------------------------------------
this.equipmentDamaged = function(equipmentKey) {
	if (equipmentKey === &quot;EQ_TARGETSELECTOR&quot;) this._active = false;
	if (equipmentKey === &quot;EQ_SCANNER_SHOW_MISSILE_TARGET&quot;) this._tapInstalled = false;
}

//-------------------------------------------------------------------------------------------------------------
this.equipmentRepaired = function(equipmentKey) {
	if (equipmentKey === &quot;EQ_TARGETSELECTOR&quot;) this._active = true;
	// if the fts gets repaired in flight, add back the mode changer (if we haven&#39;t disabled it)
	if (player.ship.isInSpace &amp;&amp; equipmentKey === &quot;EQ_TARGETSELECTOR&quot; &amp;&amp; this._removePrimableEquipment === false) player.ship.awardEquipment(&quot;EQ_TARGETSELECTOR_MODECHANGER&quot;);
	if (equipmentKey === &quot;EQ_TARGET_AUTOLOCK&quot;) this._tapInstalled = true;
}

//-------------------------------------------------------------------------------------------------------------
this.alertConditionChanged = function(newCondition, oldCondition) {
	// update our &quot;trueCondition&quot; variable
	this._trueCondition = newCondition;
	// if this new condition is &quot;red alert&quot;, see if we&#39;re actually under attack
	if (newCondition === 3) {
		if (player.alertHostiles === false) {
			// if not, it&#39;s really only yellow alert from this OXP&#39;s point of view
			this._trueCondition = 2;
		}
	}
}

//-------------------------------------------------------------------------------------------------------------
// &quot;n&quot; key
this.activated = function () {
	// next target
	var w = worldScripts.FastTargetSelector;
	w.$lookForTarget(1);
	w = null;
}

//-------------------------------------------------------------------------------------------------------------
// &quot;b&quot; key
this.mode = function() {
	// previous target
	var w = worldScripts.FastTargetSelector;
	w.$lookForTarget(-1);
	w = null;
}

//-------------------------------------------------------------------------------------------------------------
// starts the lockon timer, if it isn&#39;t already
this.$startTimer = function() {
	if (this._targetTimer &amp;&amp; this._targetTimer.isRunning) return;
	this._targetTimer = new Timer(this, this.$lockOn, 0.25, 0);
}

//-------------------------------------------------------------------------------------------------------------
// reset the scanner colors of the previous target
this.$resetOldTarget = function() {
	if (this._targetTimer &amp;&amp; this._targetTimer.isRunning) this._targetTimer.stop();
	if (this._oldTarget) {
		if (this._tapInstalled === false) {
			this._oldTarget.scannerDisplayColor1 = null;
			this._oldTarget.scannerDisplayColor2 = null;
		}
		this._oldTarget = null;
	}
}

//-------------------------------------------------------------------------------------------------------------
// updates the scanner colors of the current target to make it more visible
this.$lockOn = function $lockOn() {
	//this.$resetOldTarget();
	var p = player.ship;

	// let&#39;s not lock onto ourselves shall we?
	if(p.target === p) p.target = null;

	// do we have a new target
	if (p.target) {
		// no changes, so don&#39;t do anything
		if (p.target === this._oldTarget &amp;&amp; this._trueCondition === this._oldCondition) return;

		this.$resetOldTarget();
		
		this._oldTarget = p.target;
		this._oldCondition = this._trueCondition;
		var battle = false;
		if (player.alertCondition === 3 &amp;&amp; player.alertHostiles === true) {
			// only switch to battle colors on ships that are actually trying to kill us
			if (this._oldTarget.isShip &amp;&amp; this._oldTarget.target === p) battle = true;
		}
		var currentColors = (battle === false ? this._normalColorsDefault : this._battleColorsDefault);
		if (this._oldTarget.isValid) {
			if (this._oldTarget.isMissile || this._oldTarget.isMine || this._oldTarget.isWeapon) {
				currentColors = (battle === false ? this._normalColorsMissile : this._battleColorsMissile);
			} else if (this._oldTarget.isPolice &amp;&amp; (this._oldTarget.isShip &amp;&amp; this._oldTarget.hasRole(&quot;RSsatellite&quot;) === false)) {
				currentColors = (battle === false ? this._normalColorsPolice : this._battleColorsPolice);
			} else if (this._oldTarget.isThargoid) {
				currentColors = this._normalColorsThargoid;
			} else if (this._oldTarget.isStation) {
				currentColors = this._normalColorsStation;
			} else if (this._oldTarget.isRock || this._oldTarget.isDerelict || this._oldTarget.isCargo || (this._oldTarget.isShip &amp;&amp; this._oldTarget.hasRole(&quot;RSsatellite&quot;) === true)) {
				currentColors = this._normalColorsRock;
			} else if (this._oldTarget.scanClass === &quot;CLASS_BUOY&quot;) {
				currentColors = this._normalColorsBuoy;
			}
		}
		if (this._tapInstalled === false) {
			p.target.scannerDisplayColor1 = currentColors.color1;
			p.target.scannerDisplayColor2 = currentColors.color2;
		}
	}
}

//-------------------------------------------------------------------------------------------------------------
this.$lookForTarget = function(direction) {
	
	var currNPC = null;
	var ps = player.ship;
	var valid = false;
	
	this.$refreshArray();

	var npc = this._npc;
	if (npc &amp;&amp; npc.length &gt; 0) {
		var lc = 0;
		do {
			this._index += direction;					
			// select the next/previous index value, based on the direction
			if (this._index &lt; 0) 						
				// if we get to the beginning of the array, go back to the end
				this._index = npc.length - 1;
			else if (this._index &gt; npc.length - 1) 
			// if we get to the end of the array, go back to the beginning
			this._index = 0;
			currNPC = npc[this._index];
			valid = currNPC &amp;&amp; currNPC.isValid === true &amp;&amp; currNPC.isJamming === false 
				&amp;&amp; currNPC.isCloaked === false;
			if (valid &amp;&amp; ps.position.distanceTo(currNPC) &lt; ps.scannerRange) {
				// if the item is valid, make it the player&#39;s target
				ps.target = currNPC;
				break;
			}
			lc += 1;
		} while ( valid &amp;&amp; lc &lt; npc.length ); 	
		// if we didn&#39;t get a target, keep looping until we do
	}

}

//-------------------------------------------------------------------------------------------------------------
this.$refreshArray = function() {
	// get the array of ships
	if ((global.clock.adjustedSeconds - this._dataAge) &gt; 1) { // limit to once/sec
		this._npc = this.$findNPCShips();
		this._dataAge = global.clock.adjustedSeconds;
	}
}

//-------------------------------------------------------------------------------------------------------------
// find all npc ships in range
this.$findNPCShips = function() {
	function _isNPC(entity)	{
		//var wF = worldScripts.FastTargetSelector; // shouldn&#39;t actually need this, as context should always be &quot;this&quot;
		if (!entity.isShip) return false;
		if (entity.isPlayer) return false;
		if (entity.displayName === &quot;Wreckage&quot;) return false;
		if (this._trueCondition === 3 &amp;&amp; this._scanMode === 0) {
			// during red alert, only target thargoids, missiles and enemy ships
			if (entity.isThargoid === true &amp;&amp; entity.isCargo === false) return true;
			if (entity.target === player.ship &amp;&amp; entity.hasHostileTarget) return true;
			if (entity.isMine) return true;
			if (entity.isWeapon) return true;
			return false;
		} 
		if (entity.isVisualEffect) return false ;
		// thanks to Norby for this escortdeck exclusion code
		var wE = worldScripts.escortdeck;
		if (wE) { //escortdeck oxp is present
			var i = wE.$EscortDeckShip.indexOf(entity);
			if (i &gt;= 0 &amp;&amp; wE.$EscortDeckShipPos[i]) //entity is on deck
				return false; //so exclude this entity from target list
		}
		if (this._ignoreRoles.length === 1) {
			if (entity.primaryRole === this._ignoreRoles[0]) return false;
		} else {
			// only do indexof if there is more than one entry in the ignoreroles list
			if (this._ignoreRoles.indexOf(entity.primaryRole) === -1) return false;
		}
		return true;
	}
	return system.filteredEntities(this, _isNPC, player.ship, player.ship.scannerRange);
}

//-------------------------------------------------------------------------------------------------------------
// removes any wreckage items from the array, then calls the sorting algorithm
/*this.$sortArray = function() {
	// remove any wreckage items
	for (var i = this._npc.length - 1; i &gt;= 0; i--) {
		if (this._npc[i].displayName === &quot;Wreckage&quot;) this._npc.splice(i, 1);
	}
	// then sort
	this.$sortByDistance(this._npc);
}*/

//-------------------------------------------------------------------------------------------------------------
// sort by distance function courtesy of Thargoid
/*this.$sortByDistance = function(targets) {
	var cache = {};
	// sort
	targets.sort( function sortByDist(a,b) {
		// cache distance
		var ai = a.entityPersonality, bi = b.entityPersonality; // use some &quot;uniq&quot; ident
		cache[ai] = cache[ai] || (a.isValid &amp;&amp; a.position.distanceTo(player.ship.position));
		cache[bi] = cache[bi] || (b.isValid &amp;&amp; b.position.distanceTo(player.ship.position));
		return ((cache[ai] &lt; cache[bi]) ? -1 : ((cache[ai] &gt; cache[bi]) ? 1 : 0));
	});

	cache = null;
	// turn off the flag that indicates the data isn&#39;t sorted
	this._sortRequired = false;
}
*/</pre></td>
                </tr>
                <tr>
                    <td valign="top">Scripts/fasttargetselector_conditions.js</td>
                    <td><pre>&quot;use strict&quot;;
this.name	     = &quot;FastTargetSelector_Conditions&quot;;
this.author	     = &quot;phkb&quot;;
this.copyright   = &quot;2016 phkb&quot;;
this.description = &quot;Condition script for equipment&quot;;
this.licence     = &quot;CC BY-NC-SA 4.0&quot;;

//-------------------------------------------------------------------------------------------------------------
this.allowAwardEquipment = function(equipment, ship, context) {
	if (equipment === &quot;EQ_TARGETSELECTOR_MODECHANGER&quot; &amp;&amp; context != &quot;scripted&quot;) return false;
	return true;
}</pre></td>
                </tr>
                <tr>
                    <td valign="top">Scripts/fasttargetselector_modechanger.js</td>
                    <td><pre>&quot;use strict&quot;;
this.name	     = &quot;FastTargetSelector_ModeChanger&quot;;
this.author	     = &quot;phkb&quot;;
this.copyright   = &quot;2016 phkb&quot;;
this.description = &quot;Changes the way the FTS works in Condition Red.&quot;;
this.licence     = &quot;CC BY-NC-SA 4.0&quot;;

//-------------------------------------------------------------------------------------------------------------
this.activated = function() {
	var w = worldScripts.FastTargetSelector;
	if (w) {
		if (player.ship.equipmentStatus(&quot;EQ_TARGETSELECTOR&quot;) != &quot;EQUIPMENT_OK&quot;) {
			player.consoleMessage(expandDescription(&quot;[fts_damaged]&quot;));
			w = null;
			return;
		}
		w._scanMode += 1;
		if (w._scanMode &gt;= 2) w._scanMode = 0;
		player.consoleMessage(expandDescription(&quot;[fts_scan_mode_&quot; + w._scanMode + &quot;]&quot;));
	}
	w = null;
}</pre></td>
                </tr>
            </table>
        </a>
    </body>
</html>
