<html>
    <head>
        <title>Expansion Target Autolock Plus</title>
        <link rel="stylesheet" href="../style.css">
    </head>
    <body>
        <table border="0" width="100%">
            <tr>
                <td>Back to <a href='../index.html'>Index</a></td>
                <td align="right"><small>Page generated: Oct 11, 2023, 3:16:49 PM</small></td>
            </tr>
        </table>

        <h1>Expansion Target Autolock Plus</h1>

        <h2>Content</h2>
        <ul>
          <li><a href="#warnings">Warnings</a></li>
          <li><a href="#manifest">Manifest</a></li>
          <li><a href="#documentation">Documentation</a></li>
          <li><a href="#equipment">1 Equipment</a></li>
          <li><a href="#ships">0 Ships</a></li>
          <li><a href="#models">0 Models</a></li>
          <li><a href="#scripts">1 Scripts</a></li>
        </ul>

          <a name="warnings">
            <h2>Warnings</h2>
            <ol>
                <li>Tags mismatch between OXP Manifest and Expansion Manager at character position 0002 (RIGHT SQUARE BRACKET vs LATIN SMALL LETTER E)(&#39;[]&#39; vs &#39;[equipment, weapons]&#39;)</li>
            </ol>
          </a>

        <a name="manifest">
        <h2>Manifest</h2>
            <table border="1">
                <tr>
                    <th></th>
                    <th>from Expansion Manager's OXP list</th>
                    <th>from Expansion Manifest</th>
                </tr>
                <tr>
                    <td>Description</td>
                    <td>A software update for the standard scanner targeting enhancement equipment that automatically locks onto attacking ships if you have no prior target selected.</td>
                    <td>A software update for the standard scanner targeting enhancement equipment that automatically locks onto attacking ships if you have no prior target selected.</td>
                </tr>
                <tr>
                    <td>Identifier</td>
                    <td>oolite.oxp.Thargoid.TAP</td>
                    <td>oolite.oxp.Thargoid.TAP</td>
                </tr>
                <tr>
                    <td>Title</td>
                    <td>Target Autolock Plus</td>
                    <td>Target Autolock Plus</td>
                </tr>
                <tr>
                    <td>Category</td>
                    <td>Equipment</td>
                    <td>Equipment</td>
                </tr>
                <tr>
                    <td>Author</td>
                    <td>Thargoid</td>
                    <td>Thargoid</td>
                </tr>
                <tr>
                    <td>Version</td>
                    <td>1.14</td>
                    <td>1.14</td>
                </tr>
                <tr>
                    <td>Tags</td>
                    <td></td>
                    <td>equipment, weapons</td>
                </tr>
                <tr>
                    <td>Required Oolite Version</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Maximum Oolite Version</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Required Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Optional Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Conflict Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Information URL</td>
                    <td><a target="_blank" href="http://wiki.alioth.net/index.php/Target_Autolock_OXP">http://wiki.alioth.net/index.php/Target_Autolock_OXP</a></td>
                    <td><a target="_blank" href="">n/a</a></td>
                </tr>
                <tr>
                    <td>Download URL</td>
                    <td><a target="_blank" href="https://wiki.alioth.net/img_auth.php/8/86/TargetAutolockPlus-1.14.oxz">https://wiki.alioth.net/img_auth.php/8/86/TargetAutolockPlus-1.14.oxz</a></td>
                    <td><a target="_blank" href="">n/a</a></td>
                </tr>
                <tr>
                    <td>License</td>
                    <td>CC BY-NC-SA 3.0</td>
                    <td>CC BY-NC-SA 3.0</td>
                </tr>
                <tr>
                    <td>File Size</td>
                    <td>n/a</td>
                </tr>
                <tr>
                    <td>Upload date</td>
                    <td>1610873352</td>
                </tr>
            </table>
                </a>

        <a name="documentation">
        <h2>Documentation</h2>
        <p>Also read <a href='http://wiki.alioth.net/index.php/Target%20Autolock%20Plus'>http://wiki.alioth.net/index.php/Target%20Autolock%20Plus</a></p>
        <h3>Readme.txt</h3>
        <pre>Target Autolock OXP
-------------------
v1.14, by Thargoid

A little OXP that offers a software upgrade to the Scanner Targeting Enhancement equipment (which is of course required). This adds the functionality that if the ship is attacked by surprise, or any other situation where there is currently no target set, then the attacking ship is automatically targetted. It is also tagged red/magenta on the scanner, so you know exactly who to take your aggression out on.

The modification is designed for bounty hunters and other hard-edged combat veterans to enable swift location of the hostile craft using the Targeting Enhancement&#39;s directional arrow and/or more simple useage of missiles and other ordinance. Note that this update offers target lock not laser lock, that kind of aiming still needs to be done manually.

Also as a new addition, the currently targetted entity on your scanner will now be artifically recoloured to flashing blue/grey (or whatever you prefer, see below) to make it easier to track amongst whatever else may be around you. If you close down your target or aim at something else it will return to its original colouration.

Available from all good tech 13+ systems for the small price of 200 credits.

Requires Oolite v1.74 or above.


Note for OXP Makers
-------------------

If you don&#39;t want Target Autolock to be able to lock onto your ship, just include &quot;TAP_noAutolock&quot; as one of the ships roles. Also if you are creating a stealth ship that does not show up on scanner and includes the &quot;OXP_stealthShip&quot; role in its role list, this also will not be locked on to by Autolock.

Also in both cases the ship will not be highlighted on the scanner if the player manually targets it.


Scanner Colours
---------------
If blue/cyan isn&#39;t your thing, just open the script.js file in the OXPs config folder using your preferred text editor (not Notepad under Windows!) and change the definitions of this.scanColor1 and this.scanColor2 in lines 10 &amp; 11 of this.startUp to your preferred colours. Then save the file and restart Oolite whilst holding down the shift key until you get the spinning Cobra mkIII screen to clear the cache.


License
-------

This OXP is released under the Creative Commons Attribution - Non-Commercial - Share Alike 3.0 license (https://creativecommons.org/licenses/by-nc-sa/3.0/)


Version history
---------------

21/04/2009 - Version 1.00
* Initial release.

19/08/2009 - Version 1.01
* Minor script tweak to deal with attacker getting destroyed before autolock.

14/04/2010 - Version 1.10
* Update for scanner colour marking. Now requires Oolite v1.74 or higher.

15/04/2010 - Version 1.10
* Added scanner colour-marking of current target.

23/06/2010 - Version 1.11
* Scanner colour markers now easier to change in script. Also script check for self-locking included

13/02/2011 - Version 1.12
* Removal of upper limit, to allow running with 1.75

25/11/2020 - Version 1.13
* Updated license to remove the &quot;Thargoid clauses&quot; after Thargoid allowed modification when retired from maintaining his OXps (http://aegidian.org/bb/viewtopic.php?f=4&amp;t=17085).
* Discards the use of a mission variable to indicate the equipment installation in the player ship and keeps the purchased equipment.
* Resets the highlighting of the target in the scanner if Scanner Target Enhancement is damaged.

30/11/2020 - Versiion 1.14
* Fixes typo that prevented resetting scanner when target is lost
* Some optimizations to avoid repeatedly setting up the target scanner display colors.
</pre>
        </a>

        <a name="equipment">          
        <h2>Equipment</h2>
            <table>
                <tr>
                    <th>Name</th>
                    <th>Visible</th>
                    <th>Cost [deci-credits]</th>
                    <th>Tech-Level</th>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_TARGET_AUTOLOCK.html">Automatic Target Acquisition</a></td>
                    <td>yes</td>
                    <td align="right">2000</td>
                    <td align="center">13+</td>
                </tr>
            </table>
        </a>

        <a name="ships">    
        <h2>Ships</h2>
            This expansion declares no ships. This may be related to warnings.
        </a>

        <a name="models">    
        <h2>Models</h2>
            This expansion declares no models. This may be related to warnings.
        </a>

        <a name="scripts">    
        <h2>Scripts</h2>
            <table>
                <tr>
                    <th>Path</th>
                </tr>
                <tr>
                    <td valign="top">Config/script.js</td>
                    <td><pre>this.name        = &quot;targetAutolock&quot;;
this.author      = &quot;Thargoid&quot;;
this.license     = &quot;CC BY-NC-SA 3.0&quot;;
this.description = &quot;Automatic target locking to attacking ships.&quot;;
this.version     = &quot;1.14&quot;;

this.$installed = false;
this.$oldTarget;
this.$scanColor1;
this.$scanColor2;
this.$targetTimer;
//
// Event Handlers
//

//---------------------------------------------------------------------------------
this.startUp = function _tap_startUp() {
    this.$oldTarget = null;
    this.$scanColor1 = &quot;cyanColor&quot;;
    this.$scanColor2 = &quot;grayColor&quot;;

    var old_color1 = player.ship.scannerDisplayColor1;
    var old_color2 = player.ship.scannerDisplayColor2;

    // uses the player ship to convert the color name strings to the color tuples so we can compare the later
    player.ship.scannerDisplayColor1 = this.$scanColor1;
    this.$scanColor1 = player.ship.scannerDisplayColor1;
    player.ship.scannerDisplayColor1 = old_color1;

    player.ship.scannerDisplayColor2 = this.$scanColor2;
    this.$scanColor2 = player.ship.scannerDisplayColor2;
    player.ship.scannerDisplayColor2 = old_color2;
}

//---------------------------------------------------------------------------------
this.startUpComplete = this.playerBoughtNewShip = this.playerReplacedShip = this.$newShip = function _tap_newShip() {
    this.ship = player.ship;
    if (this.ship.equipmentStatus(&quot;EQ_TARGET_AUTOLOCK&quot;) === &quot;EQUIPMENT_OK&quot;)
        this.$installed = true;
    else if (missionVariables.targetAutolock != null) {
        if (missionVariables.targetAutolock === &quot;TRUE&quot;) 
            this.ship.awardEquipment(&quot;EQ_TARGET_AUTOLOCK&quot;);
        else
            this.$installed = false;
    }
    if (missionVariables.targetAutolock) delete missionVariables.targetAutolock;
}

//---------------------------------------------------------------------------------
this.equipmentAdded = function _tap_equipmentAdded(equipmentKey) {
    if (equipmentKey === &quot;EQ_TARGET_AUTOLOCK&quot;) this.$installed = true;
}

//---------------------------------------------------------------------------------
this.equipmentRemoved = function _tap_equipmentRemoved(equipmentKey) {
    if (equipmentKey === &quot;EQ_TARGET_AUTOLOCK&quot;) {
        this.$installed = false;
        this.$reset();
    } else if (equipmentKey === &quot;EQ_SCANNER_SHOW_MISSILE_TARGET&quot; &amp;&amp; 
                this.$targetTimer &amp;&amp; this.$targetTimer.isRunning)
        this.$reset();
    
}

//---------------------------------------------------------------------------------
this.shipDied = this.shipWillEnterWitchspace = this.$reset = function _tap_reset() {
    var oldTarget = this.$oldTarget;

    if (this.$targetTimer &amp;&amp; this.$targetTimer.isRunning)
        this.$targetTimer.stop();

    if (oldTarget) {
        oldTarget.scannerDisplayColor1 = null;
        oldTarget.scannerDisplayColor2 = null;
    }
    this.$oldTarget = null;    
}

//---------------------------------------------------------------------------------
this.shipDockedWithStation = function _tap_shipDockedWithStation(station) {    
    if (this.$installed) this.$reset();
}    

//---------------------------------------------------------------------------------
this.shipTargetAcquired = function _tap_newTarget(newTarget) {
    if (!this.$installed || 
        this.ship.equipmentStatus(&quot;EQ_SCANNER_SHOW_MISSILE_TARGET&quot;) !== &quot;EQUIPMENT_OK&quot;)
        return;
    
    if (!this.$targetTimer)
        this.$targetTimer = new Timer(this, this.$lockOn, 0, 0.25);
    else if (!this.$targetTimer.isRunning)
        this.$targetTimer.start();
}
    
//---------------------------------------------------------------------------------
this.shipTargetLost = this.shipTargetDestroyed = function _tap_lostTarget(lostTarget) {
    if (this.$installed &amp;&amp; 
        this.ship.equipmentStatus(&quot;EQ_SCANNER_SHOW_MISSILE_TARGET&quot;) === &quot;EQUIPMENT_OK&quot;)
        this.$reset();
}    
    
//---------------------------------------------------------------------------------
this.shipBeingAttacked = function _tap_shipBeingAttacked(attacker) {
    var _player = player;
    var pship = _player.ship;

    if (this.$installed &amp;&amp; 
        pship.equipmentStatus(&quot;EQ_SCANNER_SHOW_MISSILE_TARGET&quot;) === &quot;EQUIPMENT_OK&quot; &amp;&amp; 
        pship.target == null &amp;&amp; 
        attacker &amp;&amp; !attacker.isCloaked &amp;&amp; 
        !attacker.hasRole(&quot;OXP_stealthShip&quot;) &amp;&amp; 
        !attacker.hasRole(&quot;OXP_noAutolock&quot;) &amp;&amp; 
        !attacker.hasRole(&quot;TAP_noAutolock&quot;)) {
        pship.target = attacker;
        _player.commsMessage(&quot;Auto-locked onto attacker - &quot; + attacker.displayName + &quot;.&quot;, 5);
    }
}

//
// Internal Functions
//

//---------------------------------------------------------------------------------
this.$lockOn = function _tap_lockOn() {
    var pship = this.ship;
    var ptarget = ship.target;

    if (this.$oldTarget &amp;&amp; !this.$oldTarget.isValid)
        this.$oldTarget = null;
        
    if (!ptarget || ptarget == pship) {
        pship.target = null;
        this.$reset();
        return;
    }

    if (this.$oldTarget &amp;&amp; this.$oldTarget != ptarget) {
        this.$oldTarget.scannerDisplayColor1 = null;
        this.$oldTarget.scannerDisplayColor2 = null;
    } 

    if (this.$oldTarget &amp;&amp; ptarget == this.$oldTarget &amp;&amp; 
        ptarget.scannerDisplayColor1.toString() == this.$scanColor1.toString() &amp;&amp; 
        ptarget.scannerDisplayColor2.toString() == this.$scanColor2.toString())
        return;
        
    if (ptarget) {        
        this.$oldTarget = ptarget;
        ptarget.scannerDisplayColor1 = this.$scanColor1;
        ptarget.scannerDisplayColor2 = this.$scanColor2;
    }
}

</pre></td>
                </tr>
            </table>
        </a>
    </body>
</html>
