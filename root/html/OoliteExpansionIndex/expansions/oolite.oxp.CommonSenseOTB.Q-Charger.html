<html>
    <head>
        <title>Expansion Q-Charger</title>
        <link rel="stylesheet" href="../style.css">
    </head>
    <body>
        <table border="0" width="100%">
            <tr>
                <td>Back to <a href='../index.html'>Index</a></td>
                <td align="right"><small>Page generated: Oct 11, 2023, 3:16:48 PM</small></td>
            </tr>
        </table>

        <h1>Expansion Q-Charger</h1>

        <h2>Content</h2>
        <ul>
          
          <li><a href="#manifest">Manifest</a></li>
          <li><a href="#documentation">Documentation</a></li>
          <li><a href="#equipment">4 Equipment</a></li>
          <li><a href="#ships">0 Ships</a></li>
          <li><a href="#models">0 Models</a></li>
          <li><a href="#scripts">3 Scripts</a></li>
        </ul>


        <a name="manifest">
        <h2>Manifest</h2>
            <table border="1">
                <tr>
                    <th></th>
                    <th>from Expansion Manager's OXP list</th>
                    <th>from Expansion Manifest</th>
                </tr>
                <tr>
                    <td>Description</td>
                    <td>Provides a boost in speed when at maximum throttle at the cost of some fuel and energy.</td>
                    <td>Provides a boost in speed when at maximum throttle at the cost of some fuel and energy.</td>
                </tr>
                <tr>
                    <td>Identifier</td>
                    <td>oolite.oxp.CommonSenseOTB.Q-Charger</td>
                    <td>oolite.oxp.CommonSenseOTB.Q-Charger</td>
                </tr>
                <tr>
                    <td>Title</td>
                    <td>Q-Charger</td>
                    <td>Q-Charger</td>
                </tr>
                <tr>
                    <td>Category</td>
                    <td>Equipment</td>
                    <td>Equipment</td>
                </tr>
                <tr>
                    <td>Author</td>
                    <td>CommonSenseOTB, Norby</td>
                    <td>CommonSenseOTB, Norby</td>
                </tr>
                <tr>
                    <td>Version</td>
                    <td>1.25</td>
                    <td>1.25</td>
                </tr>
                <tr>
                    <td>Tags</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Required Oolite Version</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Maximum Oolite Version</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Required Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Optional Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Conflict Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Information URL</td>
                    <td><a target="_blank" href="http://wiki.alioth.net/index.php/Q-Charger">http://wiki.alioth.net/index.php/Q-Charger</a></td>
                    <td><a target="_blank" href="">n/a</a></td>
                </tr>
                <tr>
                    <td>Download URL</td>
                    <td><a target="_blank" href="https://wiki.alioth.net/img_auth.php/6/60/Q-Charger_1.25.oxz">https://wiki.alioth.net/img_auth.php/6/60/Q-Charger_1.25.oxz</a></td>
                    <td><a target="_blank" href="">n/a</a></td>
                </tr>
                <tr>
                    <td>License</td>
                    <td>CC BY-NC-SA 3</td>
                    <td>CC BY-NC-SA 3</td>
                </tr>
                <tr>
                    <td>File Size</td>
                    <td>n/a</td>
                </tr>
                <tr>
                    <td>Upload date</td>
                    <td>1610873314</td>
                </tr>
            </table>
                </a>

        <a name="documentation">
        <h2>Documentation</h2>
        <p>Also read <a href='http://wiki.alioth.net/index.php/Q-Charger'>http://wiki.alioth.net/index.php/Q-Charger</a></p>
        <h3>Readme Q-Chargerv1.25.txt</h3>
        <pre>
USER CUSTOMIZABILITY:

You now have the option of going to the startUp function of the Q-Chargerv1 script
and setting the toggle to &quot;OFF&quot; if you don&#39;t want the sounds effects.
Toggles must be set to either &quot;ON&quot; or &quot;OFF&quot;, default is &quot;ON&quot;.


COMPATIBILITY:
Oolite version 1.75.3
NUMERIC HUDV1.3.oxp now displays Q-Charger&#39;s top speed correctly.

Changelog:
May.23, 2014 v1.25 - Smooth speed levels when throttle is between 95% and 100%.
May.8, 2014 v1.24 - Primeable Q-Charger to disable it and a bugfix without ShipVersion.
                    Small ships under 30t mass can not use it anymore.
Dec.13, 2013 v1.23 - Some NPCs use Q-Charger without ShipVersion OXP also.
Okt.30, 2013 v1.22 - Small bugfix after player ejected.
Apr.8, 2013 v1.21 - Modified to awardable for NPC ships to make compatible with ShipVersion OXP by Norby.
Aug.22, 2011 v1.2 -Added 3 missing toggle checks to prevent problems when the sound is toggled &quot;OFF&quot;.
Aug.7, 2011 v1.1 -Attenuated the high frequencies of the sound effects by putting them through a low-pass filter.					   

Q-Chargerv1.2.oxp

Q-RaceTech is proud to present an innovation in Main Drive boosting technology. 
The Q-Charger uses new understanding of the principles governing Main Drives and Quirium Fuel 
to boost the top speed of any ship by 2x. The Q-Charger kicks in when the throttle is set 
over 95% maximum. The speed will be maintained at a steady 2x ship max speed until it is 
kicked off by lowering the throttle below 95% maximum. The Q-Charger requires fuel injection 
be installed before buying and requires both fuel injection and either an extra energy unit 
or a naval energy unit for operation. The Q-Charger will automatically cut out when either 
fuel drops below 0.1 ly or energy drops below 32.
 
WARNING: Serious damage may result to the Q-Charger if either the fuel injection or 
energy unit is damaged while in operation. Additionally, the Q-Charger is particularily 
vulnerable when it is damaged directly. Proper safeguards prevent main drive damage however. 
It uses 0.1 ly of Quirium fuel per 30 seconds of use and 4 units of energy per second. 
Q-Chargers sell for 10000 credits at any tech level 10 system. 

Remember, things go better with Q.

You can disable Q-Charger by priming (Shift+N) and activating (n) if you want save your fuel sometimes.
Small ships under 30t mass like an Adder can not equip it due to the space requirement.

Author: CommonSenseOTB
Completed: July 25, 2011

This work is licensed under the Creative Commons Attribution-Noncommercial-Share Alike 3.0
Unported License. To view a copy of this license, visit &quot;http://creativecommons.org/licenses/by-
nc-sa/3.0/&#39;&#39; or send a letter to Creative Commons, 171 Second Street, Suite 300, San
Francisco, California, 94105, USA.


The Q-Charger sound effects courtesy of  � 1998-2011 GRSites.com. All Rights Reserved. Freeware for private and commercial use.
Sound effect aircraft048.wav  95.7 kb  Hawkeye E-2C powering-up/edited for use by CommonSenseOTB in Q-Chargerv1.oxp.

</pre>
        </a>

        <a name="equipment">          
        <h2>Equipment</h2>
            <table>
                <tr>
                    <th>Name</th>
                    <th>Visible</th>
                    <th>Cost [deci-credits]</th>
                    <th>Tech-Level</th>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_Q-CHARGER.html">Q-Charger</a></td>
                    <td>yes</td>
                    <td align="right">100000</td>
                    <td align="center">10+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_Q-CHARGER_MESS.html">There&#39;s a real &#39;Q-Mess&#39; in the engine room</a></td>
                    <td>yes</td>
                    <td align="right">0</td>
                    <td align="center">100+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_Q-CHARGER_MESS_REMOVAL.html">Clean up the &#39;Q-Mess&#39; in the engine room</a></td>
                    <td>yes</td>
                    <td align="right">5000</td>
                    <td align="center">10+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_Q-CHARGER_REMOVAL.html">Sell Q-Charger</a></td>
                    <td>yes</td>
                    <td align="right">0</td>
                    <td align="center">10+</td>
                </tr>
            </table>
        </a>

        <a name="ships">    
        <h2>Ships</h2>
            This expansion declares no ships. 
        </a>

        <a name="models">    
        <h2>Models</h2>
            This expansion declares no models. 
        </a>

        <a name="scripts">    
        <h2>Scripts</h2>
            <table>
                <tr>
                    <th>Path</th>
                </tr>
                <tr>
                    <td valign="top">Scripts/Q-Charger.js</td>
                    <td><pre>/*

Q-Charger.js

Script for a Q-Charger for your ship.


Oolite
Copyright � 2003-2010 Giles C Williams and contributors

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the Free Software
Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston,
MA 02110-1301, USA.


Q-Chargerv1.24.oxp
Copyright � 2011 &quot;CommonSenseOTB&quot;
updated by Norby

This work is licensed under the Creative Commons
Attribution-Noncommercial-Share Alike 3.0 Unported License.

To view a copy of this license, visit
http://creativecommons.org/licenses/by-nc-sa/3.0/ or send a letter
to Creative Commons, 171 Second Street, Suite 300, San Francisco,
California, 94105, USA.

*/

this.name               = &quot;Q-Charger&quot;;
this.author               = &quot;CommonSenseOTB&quot;;
this.copyright            = &quot;Copyright 2011 by CommonSenseOTB CC-NC-by-SA 3.0&quot;;
this.description         = &quot;Provides a Q-Charger for your ship.&quot;;
this.version            = &quot;1.25&quot;;


this.startUp = function()
   {
   // You may toggle the sound here
   // Developers may have their hud script toggle these remotely
   //
   //
   //
   // YOU MAY TOUCH THESE
   //
   this.togglesoundfx1 = &quot;ON&quot;;// default &quot;ON&quot;, change to &quot;OFF&quot; to turn off soundfx1(Q-Charger,power up and power down)(1,2,3,4,5)
   //
   //
   //
   // DO NOT TOUCH THESE PLEASE
   //
   this.qchargerenabled = true;// player can disable/enable by priming and activating Q-Charger 
   this.qchargercondition = &quot;OFF&quot;;// player OFF and ON
   this.qchargerfuelcounter = 0.0;// default for save anywhere do not prime Q-Charger with fuel first
   this.qchargerfuelcounters = [];// array hold fuelcounters to all NPC ships equipped with Q-Charger
   this.qchargerpercent = 0; //current speed bonus provided by q-charger to player, 1 mean +100%, read by NumericHUD
   this.qchargerships = [];// array hold all NPC ships equipped with Q-Charger
   this.qchargercounterpowerup = 0.0;// default is off
   this.qchargercounterpowerdown = 0.0;// default is off
   this.mySound1 = new SoundSource;
   this.mySound1.sound = &quot;Q-Charger.ogg&quot;;
   this.mySound1.loop = true;
   this.mySound2 = new SoundSource;
   this.mySound2.sound = &quot;Q-Charger Power Up.ogg&quot;;
   this.mySound2.loop = false;
   this.mySound3 = new SoundSource;
   this.mySound3.sound = &quot;Q-Charger Power Down.ogg&quot;;
   this.mySound3.loop = false;
   this.mySound4 = new SoundSource;
   this.mySound4.sound = &quot;Q-Charger Half Power Up.ogg&quot;;
   this.mySound4.loop = false;
   this.mySound5 = new SoundSource;
   this.mySound5.sound = &quot;Q-Charger Half Power Down.ogg&quot;;
   this.mySound5.loop = false;
   }

this.awardQCharger = function(ship) //call worldScripts[&quot;Q-Charger&quot;].awardQCharger(ship); to give Q-Charger to an NPC ship
   {
   if(!ship || !ship.isValid || ship.isStation || ship === player.ship) return; //for sure
   if(this.qchargerships.indexOf(ship) &gt;= 0) {
	   //player.consoleMessage(ship.displayName+&quot; Q-Charger already awarded&quot;);//debug
	   return;
   }
   if(ship.equipmentStatus(&quot;EQ_Q-CHARGER&quot;)!=&quot;EQUIPMENT_OK&quot;)
      ship.awardEquipment(&quot;EQ_Q-CHARGER&quot;);//not enough, must be in the qchargerships array also
   this.qchargerships[this.qchargerships.length] = ship;//store the ship, will not work without this
   this.qchargerfuelcounters[this.qchargerfuelcounters.length] = 60.0;//and this
   if(ship.equipmentStatus(&quot;EQ_ENERGY_UNIT&quot;)!=&quot;EQUIPMENT_OK&quot;)
      ship.awardEquipment(&quot;EQ_ENERGY_UNIT&quot;);//some other awards to make usable the Q-Charger
   if(ship.equipmentStatus(&quot;EQ_FUEL_INJECTION&quot;)!=&quot;EQUIPMENT_OK&quot;)
      ship.awardEquipment(&quot;EQ_FUEL_INJECTION&quot;);
   ship.fuel = 7.0;
   }

this.shipSpawned = function(ship)
   {
   if(!ship || !ship.isValid || ship.isStation || ship === player.ship) return; //for sure
   if(ship.equipmentStatus(&quot;EQ_Q-CHARGER&quot;)==&quot;EQUIPMENT_OK&quot;) 
      {
      //player.consoleMessage(ship.displayName+&quot; spawned with Q-Charger&quot;);//debug
      this.awardQCharger(ship);
      } else { //Award Q-Charger to NPCs without ShipVersion OXP
      if( ship.mass &gt;= 30000 &amp;&amp; Math.floor( ship.entityPersonality / 328 ) + 1 &gt;= 60 ) ///exactly as in ShipVersion OXP
         {
	 this.awardQCharger(ship);
   	 }
      }
   }

this.playerBoughtEquipment = function(equipmentKey)
   {     
   if(equipmentKey === (&quot;EQ_Q-CHARGER_REMOVAL&quot;))
      {
      player.ship.removeEquipment(&quot;EQ_Q-CHARGER&quot;);
      player.ship.removeEquipment(&quot;EQ_Q-CHARGER_REMOVAL&quot;);
      player.credits += 6500;
      }
   if(equipmentKey === (&quot;EQ_Q-CHARGER_MESS_REMOVAL&quot;))
      {
      player.ship.removeEquipment(&quot;EQ_Q-CHARGER_MESS&quot;);
      player.ship.removeEquipment(&quot;EQ_Q-CHARGER_MESS_REMOVAL&quot;);
      }
   }

this.equipmentDamaged = this.equipmentDestroyed = function(equipment)
   { // if fuel injection or energy units damaged while in use, damage the Q-Charger
   if((equipment === &quot;EQ_FUEL_INJECTION&quot;) || (equipment === &quot;EQ_ENERGY_UNIT&quot;) || (equipment === &quot;EQ_NAVAL_ENERGY_UNIT&quot;))
      {
	  if((player.ship.equipmentStatus(&quot;EQ_Q-CHARGER&quot;) === &quot;EQUIPMENT_OK&quot;) &amp;&amp; (this.qchargercondition === &quot;ON&quot;))
	     {
	     player.ship.setEquipmentStatus(&quot;EQ_Q-CHARGER&quot;,&quot;EQUIPMENT_DAMAGED&quot;);
	     if(this.mySound1.isPlaying)//shutdown sequence
            {
            this.mySound1.stop();
            }
         if(this.mySound2.isPlaying)
            {
            this.mySound2.stop();
            }
         if(this.mySound3.isPlaying)
            {
            this.mySound3.stop();
            }
         if(this.mySound4.isPlaying)
            {
            this.mySound4.stop();
            }
         if(this.mySound5.isPlaying)
            {
            this.mySound5.stop();
            }
         this.qchargercondition = &quot;OFF&quot;;
         }			
      }
   if(equipment === &quot;EQ_Q-CHARGER&quot;)
      {
	  if(this.qchargercondition === &quot;ON&quot;)// direct hit while in use is disastrous
	     {
		 player.ship.removeEquipment(&quot;EQ_Q-CHARGER&quot;);
		 player.ship.awardEquipment(&quot;EQ_Q-CHARGER_MESS&quot;);
	     if(this.mySound1.isPlaying)//shutdown sequence
            {
            this.mySound1.stop();
            }
         if(this.mySound2.isPlaying)
            {
            this.mySound2.stop();
            }
         if(this.mySound3.isPlaying)
            {
            this.mySound3.stop();
            }
         if(this.mySound4.isPlaying)
            {
            this.mySound4.stop();
            }
         if(this.mySound5.isPlaying)
            {
            this.mySound5.stop();
            }// play bad sounds here if required
         this.qchargercondition = &quot;OFF&quot;;
         }		
      }
   }
  
this.shipLaunchedFromStation = function()
   {
   if((missionVariables.framesave !== &quot;MoveToOxpStation&quot;) &amp;&amp; (missionVariables.framesave !== &quot;MoveToMainStation&quot;))//prevent priming Q-Charger when loading/saving Save Anywhere Savegame
	  {
	  this.qchargerfuelcounter = 120.0;// default at launch prime Q-Charger with fuel first
      }   
   if(this.qchargerCheckTimer)
      {
      this.qchargerCheckTimer.start();
      }
   else
      {
      this.qchargerCheckTimer = new Timer(this, this.qchargerCheck,0,0.25);// check Q-Charger every 0.25 seconds
      }
   }

this.qchargerCheck = function()
   {
   var wdet = worldScripts[&quot;detectors&quot;];
   for(var i = 0; i &lt; this.qchargerships.length; i++) //check all NPCs with Q-Charger
      {
      var ship = this.qchargerships[i];
      if(ship.script) ship.script.$Detectors_QC = false;//this turn off the flag after use
      if(ship.isValid &amp;&amp; !ship.docked &amp;&amp; ship.equipmentStatus(&quot;EQ_Q-CHARGER&quot;) === &quot;EQUIPMENT_OK&quot; &amp;&amp; ship.equipmentStatus(&quot;EQ_FUEL_INJECTION&quot;) === &quot;EQUIPMENT_OK&quot; &amp;&amp; (ship.equipmentStatus(&quot;EQ_ENERGY_UNIT&quot;) === &quot;EQUIPMENT_OK&quot; || ship.equipmentStatus(&quot;EQ_NAVAL_ENERGY_UNIT&quot;) === &quot;EQUIPMENT_OK&quot;) &amp;&amp; ship.fuel &gt;= 0.1 &amp;&amp; ship.energy &gt;= 32 &amp;&amp; (!ship.script || ship.script.name !== &quot;rocketships&quot; || ship.script.$RocketShips_RDPause || ship.script.$RocketShips_RDPause &lt;= 0) ) 
         {
	 if(ship.speed &gt; ship.maxSpeed * 0.95 &amp;&amp; ship.speed &lt;= ship.maxSpeed) 
	    {
	    ship.velocity = ship.thrustVector;
	    this.qchargerfuelcounters[i] += 1.0;
	    if(this.qchargerfuelcounters[i] &gt; 120.0)// use 0.1 ly of fuel every 30 seconds and at launch to prime the Q-Charger
	       {
               //player.consoleMessage(ship.script.$Detectors_Origname+&quot; Q-Charger ON&quot;);
	       this.qchargerfuelcounters[i] = 1.0;
	       ship.fuel -= 0.1;
	       }
	    ship.energy -= 1.0;// use 4 energy per second
            ship.velocity = ship.velocity.add(ship.vectorForward.multiply(ship.maxSpeed));
	    if(ship.isVisible &amp;&amp; wdet &amp;&amp; player.ship &amp;&amp; player.ship.isValid
			&amp;&amp; player.ship.position.distanceTo(ship.position) &lt; 25600)
	          ship.script.$Detectors_QC = true; //inform the player from the usage
//          log(&quot;QC&quot;,ship.displayName+&quot; &quot;+ship.speed+&quot; &quot;+ship.maxSpeed);
	    }
         }
      }
   
   if(player.ship.docked)
      {
	  if(this.qchargerCheckTimer)
         {
         this.qchargerCheckTimer.stop()
         }
      if(this.qchargercondition === &quot;ON&quot;)//shutdown sequence
	     {
	     if(this.mySound1.isPlaying)
            {
            this.mySound1.stop();
            }
         if(this.mySound2.isPlaying)
            {
            this.mySound2.stop();
            }
         if(this.mySound3.isPlaying)
            {
            this.mySound3.stop();
            }
         if(this.mySound4.isPlaying)
            {
            this.mySound4.stop();
            }
         if(this.mySound5.isPlaying)
            {
            this.mySound5.stop();
            }
         if(player.ship.equipmentStatus(&quot;EQ_Q-CHARGER&quot;) === &quot;EQUIPMENT_OK&quot;)
            {
			if(this.togglesoundfx1 === &quot;ON&quot;)
               {
		       this.mySound3.play();//v1.2 added toggle check here
		       }
			}
         this.qchargercondition = &quot;OFF&quot;;
         }
      }
   else
      { // main script functions
	  if((player.ship.equipmentStatus(&quot;EQ_Q-CHARGER&quot;) === &quot;EQUIPMENT_OK&quot;) &amp;&amp; (player.ship.equipmentStatus(&quot;EQ_FUEL_INJECTION&quot;) === &quot;EQUIPMENT_OK&quot;) &amp;&amp; ((player.ship.equipmentStatus(&quot;EQ_ENERGY_UNIT&quot;) === &quot;EQUIPMENT_OK&quot;) || (player.ship.equipmentStatus(&quot;EQ_NAVAL_ENERGY_UNIT&quot;) === &quot;EQUIPMENT_OK&quot;)) &amp;&amp; (player.ship.fuel &gt;= 0.1) &amp;&amp; (player.ship.energy &gt;= 32) &amp;&amp; (!player.ship.script || player.ship.script.name !== &quot;rocketships&quot; || player.ship.script.$RocketShips_RDPause || player.ship.script.$RocketShips_RDPause &lt;= 0))
         {		 
         this.qchargerdecision();
	     this.qchargeroperation();
		 return;
		 }
      if(this.qchargercondition === &quot;ON&quot;)// shutdown sequence
	     {
	     if(this.mySound1.isPlaying)
            {
            this.mySound1.stop();
            }
         if(this.mySound2.isPlaying)
            {
            this.mySound2.stop();
            }
         if(this.mySound3.isPlaying)
            {
            this.mySound3.stop();
            }
         if(this.mySound4.isPlaying)
            {
            this.mySound4.stop();
            }
         if(this.mySound5.isPlaying)
            {
            this.mySound5.stop();
            }
         if(player.ship.equipmentStatus(&quot;EQ_Q-CHARGER&quot;) === &quot;EQUIPMENT_OK&quot;)
            {
			if(this.togglesoundfx1 === &quot;ON&quot;)
               {
		       this.mySound3.play();//v1.2 added toggle check here
		       }
			}
         this.qchargercondition = &quot;OFF&quot;;
         }		 
      }
   }

this.shipWillEnterWitchspace = function()
   {
   if(this.qchargerCheckTimer)
      {
      this.qchargerCheckTimer.stop()
      }
   if(this.qchargercondition === &quot;ON&quot;)
      {
      if(this.mySound1.isPlaying)
         {
         this.mySound1.stop();
         }
      }
   delete this.qchargerfuelcounters;// start new arrays in the new system
   delete this.qchargerships;
   this.qchargerfuelcounters = [];// array hold fuelcounters to all NPC ships equipped with Q-Charger
   this.qchargerships = [];// array hold all NPC ships equipped with Q-Charger
   }

this.shipExitedWitchspace = function()
   {
   if(this.qchargercondition === &quot;ON&quot;)
      {
	  if(this.togglesoundfx1 === &quot;ON&quot;)
         {
         this.mySound1.play();//v1.2 added toggle check here
         }
      }		 
   if(this.qchargerCheckTimer)
      {
      this.qchargerCheckTimer.start();
      }
   else
      {
      this.qchargerCheckTimer = new Timer(this, this.qchargerCheck,0,0.25);// check Q-Charger every 0.25 seconds
      }
   }   
   
this.qchargerdecision = function()
   {
   if(this.qchargerenabled &amp;&amp; (player.ship.speed &gt; (player.ship.maxSpeed * 0.95)) &amp;&amp; (player.ship.speed &lt;= (player.ship.maxSpeed)))
      {
	  if(this.qchargercondition === &quot;OFF&quot;)
	     {
		 if(this.togglesoundfx1 === &quot;ON&quot;)
            {
			if(!this.mySound1.isPlaying)
			   {
		       this.mySound2.play();
			   this.qchargercounterpowerup = 1.0;
			   }
			if(this.mySound1.isPlaying)
			   {
		       this.mySound4.play();
			   this.qchargercounterpowerup = 0.0;
			   }
		    if(this.mySound3.isPlaying)
               {
               this.mySound3.stop();
			   this.qchargercounterpowerdown = 0.0;			   
               }
			if(this.mySound5.isPlaying)
               {
               this.mySound5.stop();
			   this.qchargercounterpowerdown = 0.0;			   
               }
            }			   
		 }
	  this.qchargercondition = &quot;ON&quot;;
	  }
   else
      {
	  if(this.qchargercondition === &quot;ON&quot;)
	     {
		 if(this.togglesoundfx1 === &quot;ON&quot;)
            {
			if(this.mySound1.isPlaying)
			   {
		       this.mySound3.play();
			   this.qchargercounterpowerdown = 1.0;
			   }
			if(!this.mySound1.isPlaying)
			   {
		       this.mySound5.play();
			   this.qchargercounterpowerdown = 0.0;
			   }
		    if(this.mySound2.isPlaying)
               {
               this.mySound2.stop();
			   this.qchargercounterpowerup = 0.0;
               }
			if(this.mySound4.isPlaying)
               {
               this.mySound4.stop();
			   this.qchargercounterpowerup = 0.0;
               }
            }			   
		 }
	  this.qchargercondition = &quot;OFF&quot;;
	  }
   }   
   
this.qchargeroperation = function()
   {
   if(this.qchargercounterpowerup &gt;= 1.0)
      {
	  this.qchargercounterpowerup += 1.0;
	  }
   if(this.qchargercounterpowerdown &gt;= 1.0)
      {
	  this.qchargercounterpowerdown += 1.0;
	  }
   player.ship.velocity = player.ship.thrustVector;
   if(this.qchargercondition === &quot;OFF&quot;)
      {
	  if(this.mySound1.isPlaying)
         {
		 if(this.qchargercounterpowerdown &gt;= 12.0)// timing of sound overlap
            {
            this.mySound1.stop();
			this.qchargercounterpowerdown = 0.0;
			}
         }  
	  return;
	  }
   if(this.qchargercondition === &quot;ON&quot;)
      {
	  var p = 20 * ( player.ship.speed - 0.95 * player.ship.maxSpeed ) / player.ship.maxSpeed;
	  if( p &gt; 0.9999 ) p = 1; //+100 percent speed at max. throttle
	  else if( p &lt; 0 ) p = 0; //+0 percent speed below 95% throttle
	  this.qchargerpercent = p; //save to NumericHUD
	  this.qchargerfuelcounter += p;
	  if(this.qchargerfuelcounter &gt; 120.0)// use 0.1 ly of fuel every 30 seconds and at launch to prime the Q-Charger
	     {
		 this.qchargerfuelcounter = 1.0;
		 player.ship.fuel -= 0.1;
		 }
	  player.ship.energy -= p;// use 4 energy per second at max. throttle
      player.ship.velocity = player.ship.velocity.add(player.ship.vectorForward.multiply(player.ship.maxSpeed * p));
	  if(this.togglesoundfx1 === &quot;ON&quot;)
         {
         if(!this.mySound1.isPlaying)
		    {
			if(this.qchargercounterpowerup &gt;= 24.0)// timing of sound overlap
               {
               this.mySound1.play();
			   this.qchargercounterpowerup = 0.0;
			   }
            }
         }
	  }
   }
 
this.shipDied = function()
   {
   if(this.qchargerCheckTimer)
      {
      this.qchargerCheckTimer.stop()
      }
   if(this.mySound1.isPlaying)
      {
      this.mySound1.stop();
      }
   if(this.mySound2.isPlaying)
      {
      this.mySound2.stop();
      }
   if(this.mySound3.isPlaying)
      {
      this.mySound3.stop();
      }
   if(this.mySound4.isPlaying)
      {
      this.mySound4.stop();
      }
   if(this.mySound5.isPlaying)
      {
      this.mySound5.stop();
      }
   this.qchargercondition = &quot;OFF&quot;;
   delete this.qchargerfuelcounters;// start new arrays
   delete this.qchargerships;
   this.qchargerfuelcounters = [];// array hold fuelcounters to all NPC ships equipped with Q-Charger
   this.qchargerships = [];// array hold all NPC ships equipped with Q-Charger
   }	</pre></td>
                </tr>
                <tr>
                    <td valign="top">Scripts/Q-Charger_eq.js</td>
                    <td><pre>&quot;use strict&quot;;
this.name        = &quot;Q-Charger_eq&quot;;
this.author      = &quot;Norby&quot;;
this.copyright   = &quot;2014 Norbert Nagy&quot;;
this.licence     = &quot;CC BY-NC-SA 3.0&quot;;
this.description = &quot;Disable Q-Charger&quot;;
this.version     = &quot;1.0&quot;;

//equipment events
this.activated = function() {
	var w = worldScripts[&quot;Q-Charger&quot;];
	if( w.qchargerenabled ) {
		w.qchargerenabled = false;
		player.consoleMessage(&quot;Q-Charger disabled.&quot;);
	} else { 
		w.qchargerenabled = true;
		player.consoleMessage(&quot;Q-Charger enabled!&quot;);
	}
}

this.mode = function() {
	//unused
}
</pre></td>
                </tr>
                <tr>
                    <td valign="top">Scripts/notforsmall.js</td>
                    <td><pre>&quot;use strict&quot;;
this.name        = &quot;notforsmall&quot;;
this.author      = &quot;Norby&quot;;
this.copyright   = &quot;2013 Norbert Nagy&quot;;
this.licence     = &quot;CC BY-NC-SA 3.0&quot;;
this.description = &quot;This equipment can not fit into small ships like the Rocket Fighter.&quot;;
this.version     = &quot;1.0&quot;;

this.allowAwardEquipment = function(eqKey, ship, context)
{
//bugfix for eqs with conditions scripts: need double replaceShip() to work!
//player.replaceShip(shipname, pers); player.replaceShip(shipname, pers);
//call twice! the first always got false for allow without run this script.
//Proof: if you uncomment the following line, only the 2nd call will write into the log.
//log(&quot;notforsmall&quot;, eqKey+&quot; &quot;+ship.name+&quot; &quot;+ship.mass+&quot; &quot;+context );

	if( ship.mass &gt;= 30000 ) return true;
	else return false;
}
</pre></td>
                </tr>
            </table>
        </a>
    </body>
</html>
