<html>
    <head>
        <title>Expansion Reduce Weapon Damage</title>
        <link rel="stylesheet" href="../style.css">
    </head>
    <body>
        <table border="0" width="100%">
            <tr>
                <td>Back to <a href='../index.html'>Index</a></td>
                <td align="right"><small>Page generated: Oct 11, 2023, 3:16:48 PM</small></td>
            </tr>
        </table>

        <h1>Expansion Reduce Weapon Damage</h1>

        <h2>Content</h2>
        <ul>
          <li><a href="#warnings">Warnings</a></li>
          <li><a href="#manifest">Manifest</a></li>
          <li><a href="#documentation">Documentation</a></li>
          <li><a href="#equipment">0 Equipment</a></li>
          <li><a href="#ships">0 Ships</a></li>
          <li><a href="#models">0 Models</a></li>
          <li><a href="#scripts">1 Scripts</a></li>
        </ul>

          <a name="warnings">
            <h2>Warnings</h2>
            <ol>
                <li>Information URL mismatch between OXP Manifest and Expansion Manager string length at character position 0</li>
            </ol>
          </a>

        <a name="manifest">
        <h2>Manifest</h2>
            <table border="1">
                <tr>
                    <th></th>
                    <th>from Expansion Manager's OXP list</th>
                    <th>from Expansion Manifest</th>
                </tr>
                <tr>
                    <td>Description</td>
                    <td>Reduce damage of lasers to player &amp; most npc-ships</td>
                    <td>Reduce damage of lasers to player &amp; most npc-ships</td>
                </tr>
                <tr>
                    <td>Identifier</td>
                    <td>oolite.oxp.Lone_Wolf.ReduceWeaponDamage</td>
                    <td>oolite.oxp.Lone_Wolf.ReduceWeaponDamage</td>
                </tr>
                <tr>
                    <td>Title</td>
                    <td>Reduce Weapon Damage</td>
                    <td>Reduce Weapon Damage</td>
                </tr>
                <tr>
                    <td>Category</td>
                    <td>Mechanics</td>
                    <td>Mechanics</td>
                </tr>
                <tr>
                    <td>Author</td>
                    <td>Lone_Wolf</td>
                    <td>Lone_Wolf</td>
                </tr>
                <tr>
                    <td>Version</td>
                    <td>0.10</td>
                    <td>0.10</td>
                </tr>
                <tr>
                    <td>Tags</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Required Oolite Version</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Maximum Oolite Version</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Required Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Optional Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Conflict Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Information URL</td>
                    <td><a target="_blank" href=""></a></td>
                    <td><a target="_blank" href="">n/a</a></td>
                </tr>
                <tr>
                    <td>Download URL</td>
                    <td><a target="_blank" href="https://wiki.alioth.net/img_auth.php/2/2c/Reduce_Weapon_Damage_0.10.oxz">https://wiki.alioth.net/img_auth.php/2/2c/Reduce_Weapon_Damage_0.10.oxz</a></td>
                    <td><a target="_blank" href="">n/a</a></td>
                </tr>
                <tr>
                    <td>License</td>
                    <td>CC-BY-SA 4.0</td>
                    <td>CC-BY-SA 4.0</td>
                </tr>
                <tr>
                    <td>File Size</td>
                    <td>n/a</td>
                </tr>
                <tr>
                    <td>Upload date</td>
                    <td>1610873258</td>
                </tr>
            </table>
                </a>

        <a name="documentation">
        <h2>Documentation</h2>
        <p>Also read <a href='http://wiki.alioth.net/index.php/Reduce%20Weapon%20Damage'>http://wiki.alioth.net/index.php/Reduce%20Weapon%20Damage</a></p>
        <h3>ReduceWeaponDamage v 0.10 ReadMe &amp; License.txt</h3>
        <pre>--------------------------------------------------------------

License:
This work is licensed under the Creative Commons Attribution-Share Alike 4.0 Unported License.
To view a copy of this license, visit http://creativecommons.org/licenses/by-sa/4.0/ 
or send a letter to Creative Commons, 171 Second Street, Suite 300, San Francisco, California, 94105, USA. 

--------------------------------------------------------------



Background

Oolite 1.80 brought many AI improvements for npc ships.
The increased difficulty meant new players had to learn how to to stay out of trouble very fast or they would die in seconds.
Even veteran players had a hard time starting with a fresh commander.

It looked to me the main difference was that npc had become much better at making shots hit the target.
In http://aegidian.org/bb/viewtopic.php?f=2&amp;t=16837 several approaches to solve this were discussed, and the most promising one was to reduce the damage done by shots.
This required changes in the source code, i started looking for a way to replicate this in 1.80 and found one.

http://aegidian.org/bb/viewtopic.php?f=4&amp;t=16925
My approach there had one big disadvantage : it was very player-centric.

I thought long and hard about the comments there, concluded that reducing damage for both player and npc would have this effect :
increased survivability for player AND npc ships &gt; longer fights 

The code to accomplish this wasn&#39;t easy, http://aegidian.org/bb/viewtopic.php?f=4&amp;t=16947 .

--------------------------------------------------------------

Reduce Weapon Damage

reduces damage from laser/missile hits on player ship &amp; most npc ships by 8 .
(the effect on missile hits should barely be noticable) .
This means more shots are needed to kill a ship.

History

v 0.10 First released version
</pre>
        </a>

        <a name="equipment">          
        <h2>Equipment</h2>
            This expansion declares no equipment. This may be related to warnings.
        </a>

        <a name="ships">    
        <h2>Ships</h2>
            This expansion declares no ships. This may be related to warnings.
        </a>

        <a name="models">    
        <h2>Models</h2>
            This expansion declares no models. This may be related to warnings.
        </a>

        <a name="scripts">    
        <h2>Scripts</h2>
            <table>
                <tr>
                    <th>Path</th>
                </tr>
                <tr>
                    <td valign="top">Scripts/Reduce_Weapon_Damage.js</td>
                    <td><pre>&quot;use strict&quot;;
this.name           = &quot;Reduce Weapon Damage&quot;;
this.author         = &quot;Lone_Wolf&quot;;
this.copyright      = &quot;(C) 2014 Lone_Wolf.&quot;;
this.licence        = &quot;CC-by-SA 4.0&quot;;
this.description    = &quot;Reduce laser/missile damage for ships&quot;;
this.version        = &quot;0.10&quot;;

// Player ship and all npc-ships that qualify ( see this.shipSpawned handler) will have their own separate instance of this script

// using separate values for player / npc for flexibility .
this._rwd_player_reduction = 8;
this._rwd_npc_reduction = 8;

this.startUpComplete = function()
  {
    // setup handler for player.ship . npc-ships are dealt with by this.shipSpawned handler
    if ( !player.ship.script ) { player.ship.setScript(&quot;oolite-default-ship-script.js&quot;); }; // just in case
    if ( player.ship.script.shipTakingDamage ) 
      {
	// there is already a shipTakingDamage handler, store it
	player.ship.script._rwd_player_oldShipTakingDamage = ship.script.shipTakingDamage;
      };
    player.ship.script._RWD = this; // setup pointer
    var new_std = function(amount, whom, type)
      {
	worldScripts[&quot;Reduce Weapon Damage&quot;]._rwd_player_ShipTakingDamage(this.ship, amount, whom, type); 
	if ( player.ship.script._rwd_player_oldShipTakingDamage )
	  { 
	    player.ship.script._rwd_oldShipTakingDamage(amount, whom, type); //call the original function 
	   };
      };
    player.ship.script.shipTakingDamage = new_std;
  };

this._rwd_player_ShipTakingDamage = function (whoami, amount, whom, type)
  {
    if ( type != &quot;energy damage&quot; ) { return; }; // only act upon laser / missile damage
    if ( amount != 0 ) { return; }; // if hit penetrated shields, do nothing
    /* shields have absorbed hit, there is no known way to determine the strength of the hit
    * simplest solution to reduce damage is to increase shield strength
    */
    // try to determine whether forward or aft shield is hit
    if( whom &amp;&amp; whom.isValid &amp;&amp; ( player.ship.vectorForward.dot(player.ship.position.subtract(whom.position) ) &gt; 0 ) ) 
      { 
	// forward shield hit
	player.ship.forwardShield += player.ship.script._RWD._rwd_player_reduction;
      }
    else
      {
	// aft hit
	player.ship.aftShield += player.ship.script._RWD._rwd_player_reduction;
      };
  };

  

this.shipSpawned = function(ship)
  {
    // called for non-player ships only
    if ( !ship || !ship.isPiloted || ship.isThargoid || ship.isStation ) { return; }; // only change npc-ships
    if ( !ship.autoWeapons ) {return; }; // ship properties are not supposed to be altered
    if ( !ship.script ) { ship.setScript(&quot;oolite-default-ship-script.js&quot;); }; // just in case
    if ( ship.script.shipTakingDamage ) 
      {
	// there is already a shipTakingDamage handler, store it
	ship.script._rwd_npc_oldShipTakingDamage = ship.script.shipTakingDamage;
      };
    ship.script._RWD = this;
    var new_std = function(amount, whom, type)
      {
	amount = worldScripts[&quot;Reduce Weapon Damage&quot;]._rwd_npc_ShipTakingDamage(this.ship, amount, whom, type); 
	if ( ship.script._rwd_npc_oldShipTakingDamage )
	  { 
	    ship.script._rwd_npc_oldShipTakingDamage(amount, whom, type); //call the original function 
	   };
      };
    ship.script.shipTakingDamage = new_std;
};
  
this._rwd_npc_ShipTakingDamage = function (whoami, amount, whom, type)
  {
    if ( type != &quot;energy damage&quot; ) { return amount; }; // only act upon laser / missile damage
    // npc ship, all that&#39;s needed is reducing damage amount
    amount -= whoami.script._RWD._rwd_npc_reduction;
    return amount;
  };
</pre></td>
                </tr>
            </table>
        </a>
    </body>
</html>
