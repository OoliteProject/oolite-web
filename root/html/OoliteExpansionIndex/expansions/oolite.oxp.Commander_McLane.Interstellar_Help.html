<html>
    <head>
        <title>Expansion Interstellar Help</title>
        <link rel="stylesheet" href="../style.css">
    </head>
    <body>
        <table border="0" width="100%">
            <tr>
                <td>Back to <a href='../index.html'>Index</a></td>
                <td align="right"><small>Page generated: Oct 11, 2023, 3:16:48 PM</small></td>
            </tr>
        </table>

        <h1>Expansion Interstellar Help</h1>

        <h2>Content</h2>
        <ul>
          
          <li><a href="#manifest">Manifest</a></li>
          <li><a href="#documentation">Documentation</a></li>
          <li><a href="#equipment">1 Equipment</a></li>
          <li><a href="#ships">22 Ships</a></li>
          <li><a href="#models">0 Models</a></li>
          <li><a href="#scripts">4 Scripts</a></li>
        </ul>


        <a name="manifest">
        <h2>Manifest</h2>
            <table border="1">
                <tr>
                    <th></th>
                    <th>from Expansion Manager's OXP list</th>
                    <th>from Expansion Manifest</th>
                </tr>
                <tr>
                    <td>Description</td>
                    <td>Introduces some interaction with fellow commanders in interstellar space, who might come to the player&#39;s rescue if they&#39;re stranded, or the player could be asked for help from other stranded ships.</td>
                    <td>Introduces some interaction with fellow commanders in interstellar space, who might come to the player&#39;s rescue if they&#39;re stranded, or the player could be asked for help from other stranded ships.</td>
                </tr>
                <tr>
                    <td>Identifier</td>
                    <td>oolite.oxp.Commander_McLane.Interstellar_Help</td>
                    <td>oolite.oxp.Commander_McLane.Interstellar_Help</td>
                </tr>
                <tr>
                    <td>Title</td>
                    <td>Interstellar Help</td>
                    <td>Interstellar Help</td>
                </tr>
                <tr>
                    <td>Category</td>
                    <td>Activities</td>
                    <td>Activities</td>
                </tr>
                <tr>
                    <td>Author</td>
                    <td>Commander McLane</td>
                    <td>Commander McLane</td>
                </tr>
                <tr>
                    <td>Version</td>
                    <td>2.3</td>
                    <td>2.3</td>
                </tr>
                <tr>
                    <td>Tags</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Required Oolite Version</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Maximum Oolite Version</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Required Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Optional Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Conflict Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Information URL</td>
                    <td><a target="_blank" href="http://wiki.alioth.net/index.php/Interstellar_help_OXP">http://wiki.alioth.net/index.php/Interstellar_help_OXP</a></td>
                    <td><a target="_blank" href="">n/a</a></td>
                </tr>
                <tr>
                    <td>Download URL</td>
                    <td><a target="_blank" href="https://wiki.alioth.net/img_auth.php/d/d9/Interstellar_Help.oxz">https://wiki.alioth.net/img_auth.php/d/d9/Interstellar_Help.oxz</a></td>
                    <td><a target="_blank" href="">n/a</a></td>
                </tr>
                <tr>
                    <td>License</td>
                    <td>CC-BY-NC-SA 3.0</td>
                    <td>CC-BY-NC-SA 3.0</td>
                </tr>
                <tr>
                    <td>File Size</td>
                    <td>n/a</td>
                </tr>
                <tr>
                    <td>Upload date</td>
                    <td>1626941524</td>
                </tr>
            </table>
                </a>

        <a name="documentation">
        <h2>Documentation</h2>
        <p>Also read <a href='http://wiki.alioth.net/index.php/Interstellar%20Help'>http://wiki.alioth.net/index.php/Interstellar%20Help</a></p>
        <h3>readMe.txt</h3>
        <pre>Interstellar Help v 2.2
by &quot;Commander McLane&quot;

an Expansion Pack for Oolite by Giles Williams

based on &quot;Elite&quot; by Ian Bell and David Braben

Introduction
------------
Interstellar space is a treacherous territory, and misjumps are dangerous. It&#39;s not only what you may meet out there, it&#39;s the sheer fact that you may get stranded in the vast voids of interstellar space forever. Initiating a witchjump and creating the tunnel through witchspace consumes fuel. So if -- for whatever reason -- the tunnel collapses halfway on your journey to the next planet, you are thrown out somewhere in the middle of nowhere, in the vast realms of ghastly, pale green half-light, your fuel tanks nearly depleted, possibly with not enough fuel left to create another tunnel to the closest system.

Many pilots have just vanished without a trace in the boundless void. Some ships have said to be found drifting into the outer zones of an adjacent system -- but only decades after their life support systems ran out of energy.

So the family of space-farers gets even closer together in the uncanny zone of interstellar space, where everybody is far away from home, and everybody may find himself at the mercy of fellow captains, or be lost in space forever. One for all, and all for one -- although for anybody in the dire straits of need for fuel help comes with a price.

Overview
--------
This OXP introduces some interaction with fellow commanders in interstellar space. You may meet another trader who got stuck in interstellar space who sends distress calls and asks for your help. He is willing to pay a good price for some fuel from your tanks, or for a ride in your wake. If you are in the mood to help him, just answer his call by flying towards him. You will have to get closer than 1000 meters in order to make clear that you are there for him.

He then will either be wanting to buy some fuel from you, or request to follow through your wormhole, after you have jumped to your destination. If you agree to sell him some of your fuel reserves, you just have to get very close to him. So close that he can scoop any of the fuel you are venting from your tanks. The process starts automatically, monitored by your ship&#39;s computer, as soon as you have approached him closely enough. If you want to end the transaction you just have to turn your nose away from his scoops. If you do not do so, he will take all the fuel you have until his tanks are completely filled. The usual price for a fuel transfer so far away from the next supplier is ten times what you would pay at a main station.

If he asks you for a witchspace ride, all you have to do is to jump to your current destination. After you have jumped to any system within your reach, he will follow you through your wormhole (note that he will not jump out at the exact same location as you; wormhole ends are a tiny little bit fuzzy, which means that ships leaving the same wormhole will all be somewhere in the vicinity of the witchpoint, but not at the exact same place). You will have earned the eternal gratitude of a fellow trader, and a financial reward, which will always be enough to cover your fuel costs for the jump.

But what if you are stuck in interstellar space yourself? Do not despair, that&#39;s where your Electronic Thumb comes in handy. The Electronic Thumb is a short squat black rod, smooth and matte with a couple of flat switches and dials at one end. Just activate it any time during flight to flag down passing spacecraft to either buy fuel from them or hitch a ride in their wormhole. Note that the Electronic Thumb only works if you need it, that is in interstellar space. If you&#39;re in a system it does nothing.

After you have activated it, just wait a little for a ship approaching you with the offer to help you. Again you have to close in to him in order to accept the offer. Depending on his mood he may offer you to buy some of his fuel reserves, or to take a ride through his wormhole. This time it is you, of course, who has to pay the price.

Again, if you agreed on a fuel transaction, you have to get close enough to scoop the fuel he is going to vent from his tanks, and again your ship&#39;s computer takes care of monitoring the transaction. You can end the transfer anytime, by pointing your ship&#39;s nose (and therefore your fuel scoops) away from your donor. The transaction will also end if you run out of money. And your benefactor will not sell all his fuel -- he is going to need some for his own journey, after all.

If the offer is to take a ride in his wormhole, he will initiate his jump and invite you to follow him. In that case you are supposed to pay him on the other side. Oh, in order to allow him to initiate the jump sequence it may be necessary that you get out of his way first.

In any case it would be considered very rude to shoot at your benefactor or try to extract his fuel otherwise. The attempt won&#39;t be successful.

Minimum Requirements
--------------------
Interstellar_help.oxp requires at least Oolite 1.75.1.

Download Location
-----------------
This OXP is available for download via the http://wiki.alioth.net/index.php/Interstellar_help_OXP

Installation
------------
Move or copy the file interstellar_help.oxp from this folder to the AddOns folder inside the Oolite main folder. Restart Oolite.

Acknowledgements
Thanks to Simon B who kicked me to just sit down and realize this old idea of mine. And thanks to all the Oolite coders who are continuously working to make OXPs like this possible.

License
-------
This work is licensed under the Creative Commons Attribution-NonCommercial-ShareAlike License version 3.0. For more information see the ReadMe of Oolite or http://creativecommons.org/licenses/by-nc-sa/3.0/

Practically this means that you may rip it apart and use whatever seems useful to you, as long as you credit the original author. It would be nice (although by no means necessary) to give me a note, if you intend to use parts of it.

History
-------
version 2.3 (July 1st, 2021)
- Prevented Javascript error condition if player ship has been destroyed.

version 2.2 (April 10th, 2018)
- Added &quot;use strict&quot; to all scripts.
- Converted XML plists to Openstep format.
- Converted RTF readme file to plain text.
- Added manifest file for OXZ publication.

version 2.1 (March 2nd, 2011)
- made the OXP Oolite 1.75-compliant
- moved all self-defined functions in their own namespace
- utilized the new possibility of a ship actually following you in your wormhole
- introduced the Electronic Thumb, utilizing the new possibility of player-activated equipment
- requires at least Oolite 1.75.1

version 2.0 (January 27th, 2009)
- small AI improvements
- added the selling-fuel mechanism as an alternative to the wormhole mechanism
- added the possibility for the player to be at the receiving end, and get out of an otherwise &#39;Press Space Commander&#39;-situation.

version 1.1 (December 29th, 2008)
- spawning the trader with a different method, so that it looks as if he was already around when you jump in
- tiny changes to this readMe

version 1.0 (November 15th, 2008)
- fully functional version
- requires Oolite 1.72

Possible further developments
-----------------------------
- further improve the AI of the NPCs, especially include handling of attacks
</pre>
        </a>

        <a name="equipment">          
        <h2>Equipment</h2>
            <table>
                <tr>
                    <th>Name</th>
                    <th>Visible</th>
                    <th>Cost [deci-credits]</th>
                    <th>Tech-Level</th>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ELECTRONIC_THUMB.html">Electronic Thumb</a></td>
                    <td>yes</td>
                    <td align="right">9850</td>
                    <td align="center">7+</td>
                </tr>
            </table>
        </a>

        <a name="ships">    
        <h2>Ships</h2>
            <table>
                <tr>
                    <th>Name</th>
                </tr>
                <tr>
                    <td><a href="../ships/interstellar-help-ship-1.html">interstellar-help-ship-1</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/interstellar-help-ship-10.html">interstellar-help-ship-10</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/interstellar-help-ship-11.html">interstellar-help-ship-11</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/interstellar-help-ship-12.html">interstellar-help-ship-12</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/interstellar-help-ship-13.html">interstellar-help-ship-13</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/interstellar-help-ship-14.html">interstellar-help-ship-14</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/interstellar-help-ship-15.html">interstellar-help-ship-15</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/interstellar-help-ship-2.html">interstellar-help-ship-2</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/interstellar-help-ship-3.html">interstellar-help-ship-3</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/interstellar-help-ship-4.html">interstellar-help-ship-4</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/interstellar-help-ship-5.html">interstellar-help-ship-5</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/interstellar-help-ship-6.html">interstellar-help-ship-6</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/interstellar-help-ship-7.html">interstellar-help-ship-7</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/interstellar-help-ship-8.html">interstellar-help-ship-8</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/interstellar-help-ship-9.html">interstellar-help-ship-9</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/interstellar-helper-1.html">interstellar-helper-1</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/interstellar-helper-2.html">interstellar-helper-2</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/interstellar-helper-3.html">interstellar-helper-3</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/interstellar-helper-4.html">interstellar-helper-4</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/interstellar-helper-5.html">interstellar-helper-5</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/interstellar-helper-6.html">interstellar-helper-6</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/interstellar-helper-7.html">interstellar-helper-7</a></td>
                </tr>
            </table>
        </a>

        <a name="models">    
        <h2>Models</h2>
            This expansion declares no models. 
        </a>

        <a name="scripts">    
        <h2>Scripts</h2>
            <table>
                <tr>
                    <th>Path</th>
                </tr>
                <tr>
                    <td valign="top">Config/script.js</td>
                    <td><pre>/*

interstellar_help.js

Adds a ship that asks for your help in interstellar space.


Oolite
Copyright © 2004-2011 Giles C Williams and contributors

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the Free Software
Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston,
MA 02110-1301, USA.


interstellar_help.oxp
Copyright © 2008-2011 &quot;Commander McLane&quot;

This work is licensed under the Creative Commons
Attribution-Noncommercial-Share Alike 3.0 Unported License.

To view a copy of this license, visit
http://creativecommons.org/licenses/by-nc-sa/3.0/ or send a letter
to Creative Commons, 171 Second Street, Suite 300, San Francisco,
California, 94105, USA.

*/

&quot;use strict&quot;;
this.name           = &quot;interstellar_help&quot;;
this.author         = &quot;Commander McLane&quot;;
this.copyright      = &quot;© 2011 Commander McLane&quot;;
this.license		= &quot;CC-by-nc-sa 3.0&quot;;

this.shipWillEnterWitchspace = function(cause)
{
	if(system.isInterstellarSpace &amp;&amp; this.interstellarHelp)
    {
        this.fuelUsed = system.info.distanceToSystem(System.infoForSystem(galaxyNumber, player.ship.targetSystem));
        missionVariables.interstellar_help_pay = (Math.round(this.fuelUsed * 2) * 10) + 50;
    }
	// next line is part of the substitution for playerJumpFailed
	if(system.isInterstellarSpace &amp;&amp; this.playerCanJumpTimer.isRunning)
        this.playerCanJumpTimer.stop();
}

this.shipWillExitWitchspace = function()
{
	if(system.isInterstellarSpace &amp;&amp; !this.interstellarHelp &amp;&amp; Math.random() &lt; 0.3) system.addShips(&quot;interstellar_help_trader&quot;, 1, [0, 0, 0], 15000);
}

this.playerJumpFailed = function(reason)
{
    if(system.isInterstellarSpace &amp;&amp; reason == &quot;insufficient fuel&quot; &amp;&amp; Math.random &gt; 0.75 &amp;&amp; system.countShipsWithRole(&quot;interstellar_helper&quot;) == 0)
	{
		system.addShips(&quot;interstellar_helper&quot;, 1, player.ship.position.add(Vector3D.randomDirection(27000)));
	}
}

/* the code below here is only a substitute as long as &#39;playerJumpFailed&#39; doesn&#39;t work */

this.shipExitedWitchspace = function()
{
	if(system.isInterstellarSpace)
	{
		if(!this.playerCanJumpTimer) this.playerCanJumpTimer = new Timer(this, this.$checkPlayerFuel, 45, 45);
		else this.playerCanJumpTimer.start();
	}
}

this.$checkPlayerFuel = function()
{
	if(player.ship.fuel &lt; 1 &amp;&amp; system.countShipsWithRole(&quot;interstellar_helper&quot;) == 0)
		system.addShips(&quot;interstellar_helper&quot;, 1, player.ship.position.add(Vector3D.randomDirection(27000)));
}
</pre></td>
                </tr>
                <tr>
                    <td valign="top">Scripts/interstellar-electronic-thumb.js</td>
                    <td><pre>/*

interstellar-electronic-thumb.js

Enables the player to call for help if left without fuel in interstellar space.


Oolite
Copyright © 2004-2011 Giles C Williams and contributors

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the Free Software
Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston,
MA 02110-1301, USA.


interstellar_help.oxp
Copyright © 2008-2011 &quot;Commander McLane&quot;

This work is licensed under the Creative Commons
Attribution-Noncommercial-Share Alike 3.0 Unported License.

To view a copy of this license, visit
http://creativecommons.org/licenses/by-nc-sa/3.0/ or send a letter
to Creative Commons, 171 Second Street, Suite 300, San Francisco,
California, 94105, USA.

*/

&quot;use strict&quot;;
this.name           = &quot;interstellar-electronic-thumb&quot;;
this.author         = &quot;Commander McLane&quot;;
this.copyright      = &quot;© 2011 Commander McLane&quot;;
this.license		= &quot;CC-by-nc-sa 3.0&quot;;

this.activated = function()
{
    if(!system.isInterstellarSpace)
    {
        player.consoleMessage(&quot;Please don&#39;t press this button again.&quot;);
        player.consoleMessage(&quot;The Electronic Thumb doesn&#39;t work inside a system.&quot;);
        return;
    }
    if(player.ship.isCloaked)
    {
        player.consoleMessage(&quot;Electronic Thumb off-line.&quot;);
        player.consoleMessage(&quot;Reason: Ship is cloaked. Please decloak first.&quot;);
    }
    else
    {
        player.consoleMessage(&quot;Electronic Thumb activated.&quot;);
        player.consoleMessage(&quot;Let&#39;s see if you could flag down a ship to your rescue.&quot;);
        if(system.countShipsWithPrimaryRole(&quot;interstellar_helper&quot;) == 0)
            system.addShips(&quot;interstellar_helper&quot;, 1, player.ship.position.add(Vector3D.randomDirection(27000)));
    }
}
</pre></td>
                </tr>
                <tr>
                    <td valign="top">Scripts/interstellar-help-ship.js</td>
                    <td><pre>/*

interstellar-help-ship.js

Script for the ship that asks for your help in interstellar space.


Oolite
Copyright © 2004-2011 Giles C Williams and contributors

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the Free Software
Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston,
MA 02110-1301, USA.


interstellar_help.oxp
Copyright © 2008-2011 &quot;Commander McLane&quot;

This work is licensed under the Creative Commons
Attribution-Noncommercial-Share Alike 3.0 Unported License.

To view a copy of this license, visit
http://creativecommons.org/licenses/by-nc-sa/3.0/ or send a letter
to Creative Commons, 171 Second Street, Suite 300, San Francisco,
California, 94105, USA.

*/

&quot;use strict&quot;;
this.name           = &quot;interstellar-help-ship&quot;;
this.author         = &quot;Commander McLane&quot;;
this.copyright      = &quot;© 2011 Commander McLane&quot;;
this.license		= &quot;CC-by-nc-sa 3.0&quot;;

this.shipSpawned = function()
{
    if(system.isInterstellarSpace)
    {
        this.ship.AIState = &quot;WAIT_A_LITTLE&quot;;
    }
    else
    {
        this.ship.primaryRole = &quot;trader&quot;;
        this.ship.switchAI(&quot;route1traderAI.plist&quot;);
    }
}

this.shipExitedWormhole = function()
{
    if(system.isInterstellarSpace)
    {	
        delete worldScripts.interstellar_help.interstellarHelp;
        delete worldScripts.interstellar_help.fuelUsed;
        delete missionVariables.interstellar_help_pay;
        this.ship.AIState = &quot;COMPLAIN&quot;;
        return;
    }
    else
    {
        this.ship.primaryRole = &quot;trader&quot;;
        this.ship.AIState = &quot;DESTINATION_REACHED&quot;;
        return;
    }
}

this.$waitForPlayer = function()
{
	if (!player.ship || !player.ship.isValid) return;
	if(this.ship.position.distanceTo(player.ship.position) &lt; 1000 &amp;&amp; !player.ship.isCloaked)
	{
		this.ship.target = player.ship;
		this.ship.reactToAIMessage(&quot;TARGET_FOUND&quot;);
	}
}

this.$checkJumpCapability = function()
{
	if(this.ship.hasHyperspaceMotor)
		this.ship.reactToAIMessage(&quot;BUYING&quot;);
	else
		this.ship.reactToAIMessage(&quot;ROLL_1&quot;);
}

this.$checkDistanceToPlayer = function()
{
	if(this.ship.position.distanceTo(player.ship) &lt; 250 &amp;&amp; player.ship.heading.angleTo(this.ship.position.subtract(player.ship.position).direction()) &lt; 0.15)
	{
		this.ship.AIState = &quot;REFUELING&quot;;
		this.fuelTransferred = 0;
		this.payment = 0;
		if(!this.refuelTimer)
			this.refuelTimer = new Timer(this, this.$refuelFromPlayerShip, 1, 1);
		else
			this.refuelTimer.start();
	}
}

this.$refuelFromPlayerShip = function()
{
	if(player.ship.heading.angleTo(this.ship.position.subtract(player.ship.position).direction()) &lt; 0.15)
	{
		player.ship.fuel -= 0.2;
		this.ship.fuel += 0.2;
		player.credits += 4;
		this.fuelTransferred += 0.2;
		this.payment += 4;
		player.consoleMessage(&quot;Fuel transferred: &quot; + Math.round(this.fuelTransferred * 10) / 10 + &quot; LY. Payment: &quot; + this.payment + expandDescription(&quot;[interstellar_help_cr]&quot;), 1);
		if(player.ship.fuel &lt; 0.2)
		{
			this.refuelTimer.stop();
			this.ship.reactToAIMessage(&quot;NO_MORE_FUEL&quot;);
		}
		if(this.ship.fuel &gt;= 7)
		{
			this.refuelTimer.stop();
			this.ship.reactToAIMessage(&quot;FULL&quot;);
		}
	}
	else
	{
		this.refuelTimer.stop();
		this.ship.reactToAIMessage(&quot;TRANSACTION_COMPLETE&quot;);
	}
}

this.$startWormholing = function()
{
	worldScripts.interstellar_help.interstellarHelp = &quot;FOLLOWING&quot;;
}

this.$payReward = function()
{
	player.credits += missionVariables.interstellar_help_pay;
	delete worldScripts.interstellar_help.interstellarHelp;
    delete worldScripts.interstellar_help.fuelUsed;
	delete missionVariables.interstellar_help_pay;
	this.ship.primaryRole = &quot;trader&quot;;
}


this.shipTargetCloaked = function()
{
	if(!this.ship.target.isPlayer) return;
    var currentAIState = this.ship.AIState;
	switch(currentAIState)
	{
	case &quot;BUYING&quot;:
        this.ship.commsMessage(&quot;Hey, friend, why have you disappeared?&quot;);
        this.ship.target = null;
		this.ship.AIState = &quot;WAIT_A_LITTLE&quot;;
		break;
    
	case &quot;WAIT_FOR_APPROACH&quot;:
        this.ship.commsMessage(&quot;Hey, friend, why have you disappeared?&quot;);
        this.ship.target = null;
		this.ship.AIState = &quot;WAIT_A_LITTLE&quot;;
		break;
    
    case &quot;REFUELING&quot;:
        this.refuelTimer.stop();
        this.ship.commsMessage(&quot;Hey, friend, why have you disappeared? We weren&#39;t finished yet.&quot;);
        this.ship.target = null;
		this.ship.AIState = &quot;PREPARE_JUMP&quot;;
    }
}	

this.shipDied = function()
{
	if(worldScripts.interstellar_help.interstellarHelp)
	{
		delete worldScripts.interstellar_help.interstellarHelp;
		delete missionVariables.interstellar_help_pay;
	}
}	
</pre></td>
                </tr>
                <tr>
                    <td valign="top">Scripts/interstellar-helper.js</td>
                    <td><pre>/*

interstellar-helper.js

Script for the ship that asks for your help in interstellar space.


Oolite
Copyright © 2004-2011 Giles C Williams and contributors

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the Free Software
Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston,
MA 02110-1301, USA.


interstellar_help.oxp
Copyright © 2008-2011 &quot;Commander McLane&quot;

This work is licensed under the Creative Commons
Attribution-Noncommercial-Share Alike 3.0 Unported License.

To view a copy of this license, visit
http://creativecommons.org/licenses/by-nc-sa/3.0/ or send a letter
to Creative Commons, 171 Second Street, Suite 300, San Francisco,
California, 94105, USA.

*/

&quot;use strict&quot;;
this.name = &quot;interstellar-helper&quot;;
this.author = &quot;Commander McLane&quot;;
this.copyright = &quot;© 2011 Commander McLane&quot;;
this.license = &quot;CC-by-nc-sa 3.0&quot;;

this.$playerInScannerRange = function () {
	if (this.ship.position.distanceTo(player.ship) &lt; 24000) {
		this.ship.reactToAIMessage(&quot;APPROACHING_PLAYER&quot;);
	}
}

this.$checkPlayerApproached = function () {
	if (this.ship.position.distanceTo(player.ship) &lt; 7000) {
		this.ship.reactToAIMessage(&quot;PLAYER_APPROACHED&quot;);
	}
}

this.$checkForFuelScoops = function () {
	if (player.ship.equipmentStatus(&quot;EQ_FUEL_SCOOPS&quot;) != &quot;EQUIPMENT_OK&quot;) {
		this.ship.AIState = &quot;WORMHOLE&quot;;
	}
}

this.$startWaiting = function () {
	this.waitTimer = new Timer(this, this.$stopWaiting, 30);
}

this.$stopWaiting = function () {
	this.ship.commsMessage(&quot;Sorry commander, I ain&#39;t got time forever. Have to continue my journey. So long!&quot;);
	this.ship.AIState = &quot;GOOD_BYE&quot;;
	this.ship.primaryRole = &quot;trader&quot;;
	delete this.waitTimer;
}

this.$checkDistanceToPlayer = function () {
	if (this.ship.position.distanceTo(player.ship) &lt; 250 &amp;&amp; player.ship.heading.angleTo(this.ship.position.subtract(player.ship.position).direction()) &lt; 0.15) {
		this.waitTimer.stop();
		delete this.waitTimer;
		this.ship.AIState = &quot;REFUELING&quot;;
		this.fuelTransferred = 0;
		this.payment = 0;
		if (!this.refuelTimer)
			this.refuelTimer = new Timer(this, this.$refuelPlayerShip, 1, 1);
		else
			this.refuelTimer.start();
	}
}

this.$refuelPlayerShip = function () {
	if (player.ship.heading.angleTo(this.ship.position.subtract(player.ship.position).direction()) &lt; 0.15) {
		player.ship.fuel += 0.2;
		this.ship.fuel -= 0.2;
		player.credits -= 4;
		this.fuelTransferred += 0.2;
		this.payment += 4;
		player.consoleMessage(&quot;Fuel transferred: &quot; + Math.round(this.fuelTransferred * 10) / 10 + &quot; LY. Price: &quot; + this.payment + expandDescription(&quot;[interstellar_help_cr]&quot;), 1);
		if (this.ship.fuel &lt; 3.4) {
			this.refuelTimer.stop();
			this.ship.reactToAIMessage(&quot;NO_MORE_FUEL&quot;);
			this.ship.primaryRole = &quot;trader&quot;;
		}
		if (player.ship.fuel &gt;= 7) {
			this.refuelTimer.stop();
			this.ship.reactToAIMessage(&quot;FULL&quot;);
			this.ship.primaryRole = &quot;trader&quot;;
		}
		if (player.credits &lt; 4) {
			this.refuelTimer.stop();
			this.ship.reactToAIMessage(&quot;NO_MORE_MONEY&quot;);
			this.ship.primaryRole = &quot;trader&quot;;
		}
	} else {
		this.refuelTimer.stop();
		this.ship.reactToAIMessage(&quot;TRANSACTION_COMPLETE&quot;);
		this.ship.primaryRole = &quot;trader&quot;;
	}
}

this.shipSpawned = this.$setTargetToPlayer = function () {
	this.ship.target = player.ship;
}

this.shipDied = function () {
	this.ship.fuel = 0;
}</pre></td>
                </tr>
            </table>
        </a>
    </body>
</html>
