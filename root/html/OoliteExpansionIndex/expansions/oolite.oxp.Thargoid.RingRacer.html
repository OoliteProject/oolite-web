<html>
    <head>
        <title>Expansion Ring Racer</title>
        <link rel="stylesheet" href="../style.css">
    </head>
    <body>
        <table border="0" width="100%">
            <tr>
                <td>Back to <a href='../index.html'>Index</a></td>
                <td align="right"><small>Page generated: Oct 11, 2023, 3:16:49 PM</small></td>
            </tr>
        </table>

        <h1>Expansion Ring Racer</h1>

        <h2>Content</h2>
        <ul>
          <li><a href="#warnings">Warnings</a></li>
          <li><a href="#manifest">Manifest</a></li>
          <li><a href="#documentation">Documentation</a></li>
          <li><a href="#equipment">1 Equipment</a></li>
          <li><a href="#ships">4 Ships</a></li>
          <li><a href="#models">0 Models</a></li>
          <li><a href="#scripts">2 Scripts</a></li>
        </ul>

          <a name="warnings">
            <h2>Warnings</h2>
            <ol>
                <li>Found XML equipment list</li>
                <li>Tags mismatch between OXP Manifest and Expansion Manager at character position 0002 (RIGHT SQUARE BRACKET vs LATIN SMALL LETTER A)(&#39;[]&#39; vs &#39;[activities, system]&#39;)</li>
            </ol>
          </a>

        <a name="manifest">
        <h2>Manifest</h2>
            <table border="1">
                <tr>
                    <th></th>
                    <th>from Expansion Manager's OXP list</th>
                    <th>from Expansion Manifest</th>
                </tr>
                <tr>
                    <td>Description</td>
                    <td>Corporate Systems Ring Racer league in Galaxy 1.</td>
                    <td>Corporate Systems Ring Racer league in Galaxy 1.</td>
                </tr>
                <tr>
                    <td>Identifier</td>
                    <td>oolite.oxp.Thargoid.RingRacer</td>
                    <td>oolite.oxp.Thargoid.RingRacer</td>
                </tr>
                <tr>
                    <td>Title</td>
                    <td>Ring Racer</td>
                    <td>Ring Racer</td>
                </tr>
                <tr>
                    <td>Category</td>
                    <td>Activities</td>
                    <td>Activities</td>
                </tr>
                <tr>
                    <td>Author</td>
                    <td>Thargoid</td>
                    <td>Thargoid</td>
                </tr>
                <tr>
                    <td>Version</td>
                    <td>1.21</td>
                    <td>1.21</td>
                </tr>
                <tr>
                    <td>Tags</td>
                    <td></td>
                    <td>activities, system</td>
                </tr>
                <tr>
                    <td>Required Oolite Version</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Maximum Oolite Version</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Required Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Optional Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Conflict Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Information URL</td>
                    <td><a target="_blank" href="http://wiki.alioth.net/index.php/Ring_Racer_OXP">http://wiki.alioth.net/index.php/Ring_Racer_OXP</a></td>
                    <td><a target="_blank" href="">n/a</a></td>
                </tr>
                <tr>
                    <td>Download URL</td>
                    <td><a target="_blank" href="https://wiki.alioth.net/img_auth.php/c/ce/Ring_Racer_1.21.oxz">https://wiki.alioth.net/img_auth.php/c/ce/Ring_Racer_1.21.oxz</a></td>
                    <td><a target="_blank" href="">n/a</a></td>
                </tr>
                <tr>
                    <td>License</td>
                    <td>Creative Commons Attribution - Non-Commercial - Share Alike 3.0 license with clauses - see readme file</td>
                    <td>Creative Commons Attribution - Non-Commercial - Share Alike 3.0 license with clauses - see readme file</td>
                </tr>
                <tr>
                    <td>File Size</td>
                    <td>n/a</td>
                </tr>
                <tr>
                    <td>Upload date</td>
                    <td>1610873475</td>
                </tr>
            </table>
                </a>

        <a name="documentation">
        <h2>Documentation</h2>
        <p>Also read <a href='http://wiki.alioth.net/index.php/Ring%20Racer'>http://wiki.alioth.net/index.php/Ring%20Racer</a></p>
        <h3>RingRacer v1.21 ReadMe &amp; License.txt</h3>
        <pre>Ring Racer OXP by Thargoid.

Welcome one and all to the Corporate States Ring Racer League!

This OXP adds a new sub-game to Oolite v1.74 or later, that of ring racing. Entry is available at any Corporate State system in Galaxy 1 for commanders with a suitably sporty ship equipped with an Advanced Space Compass and Fuel Injectors. 

Once the entrance fee is paid and a license obtained, the Ring Racer courses become available. The first race is in the Zaonce system, and there are 9 other courses spread around the galaxy. The location of the next one is updated on the ships manifest screen (F5-F5) once a course is completed, and is also marked on the ships long range chart. The racers fastest course time is also noted on the manifest screen, so Commanders can have best bragging rights at their favourite space bar.

To attempt a course, once the license is bought and you have flown to the correct system, you must fly to the course. This is marked by a buoy with a beacon &quot;Q&quot; on the ASC, and is normally found out beyond the witchpoint in the opposite direction to the main planet of the system. 
For variation there are two types of race. The first is a standard linear race, with the rings in a rough line leading on from the course buoy. The second is a sphere race, where all 10 rings can be found within a 20km radius sphere of the buoy. In both cases the course consists of 10 rings, which can be flown through in any order. The timer begins when you fly through the first ring, and ends once all 10 rings have been successfully navigated. Each race can last up to a maximum of 15 minutes.

Active rings are marked by green flashing lights and show with a green and yellow marker on the ships scanner. Once the ring has been successfully traversed the flashers turn red, and the scanner marker goes yellow.

Happy racing Commander!

--------------------------------------------------------------

License:

This OXP is released under the Creative Commons Attribution - Non-Commercial - Share Alike 3.0 license with the following clauses:

* Whilst you are free (and encouraged) to re-use any of the scripting, models or texturing in this OXP, the usage must be distinct from that within this OXP. Unique identifiers such as (but not limited to) unique shipdata.plist entity keys, mission variables, script names (this.name), equipment identity strings (EQ_), description list arrays and entity roles must not be re-used without prior agreement. Basically if it&#39;s unique or would identify or overwrite anything in the original OXP, then you may not re-use it (for obvious compatibility reasons).
* rebundling of this OXP within another distribution is permitted as long as it is unchanged. The following derivates however are permitted and except from the above:
	* the conversion of files between XML and openStep.
	* the merging of files with other files of the same type from other OXPs.
* The license information (either as this file or merged into a larger one) must be included in the OXP.
* Even though it is not compulsory, if you are re-using any sizable or recognisable piece of this OXP, please let me know :)

--------------------------------------------------------------
Instructions:

Unzip the file, and then move the folder &quot;RingRacer v1.21.oxp&quot; to the AddOns directory of your Oolite installation. 
Then start the game up and the racing league should be added. 

--------------------------------------------------------------

Version history:

08/02/2009 - Version 1.00, Initial release.
08/02/2009 - Version 1.01, moved first race from Leesti to Zaonce to prevent clashes with Asteroid Storm OXP.
01/09/2009 - Version 1.10, update for Oolite 1.73. Also due to the credit crunch and team budget limits, the entry fee is now only 2000 cr.
14/04/2010 - Version 1.20, update for v1.74. Now no longer compatible with lower versions.
13/02/2011 - Version 1.21, removal of upper limit, to allow running with 1.75

--------------------------------------------------------------

Acknowledgements:

This OXP is an update of the original RingPods OXP by Aegidian.</pre>
        </a>

        <a name="equipment">          
        <h2>Equipment</h2>
            <table>
                <tr>
                    <th>Name</th>
                    <th>Visible</th>
                    <th>Cost [deci-credits]</th>
                    <th>Tech-Level</th>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_RINGRACER.html">Ring Racer League Entry</a></td>
                    <td>yes</td>
                    <td align="right">20000</td>
                    <td align="center">1+</td>
                </tr>
            </table>
        </a>

        <a name="ships">    
        <h2>Ships</h2>
            <table>
                <tr>
                    <th>Name</th>
                </tr>
                <tr>
                    <td><a href="../ships/ringRacer_courseBuoy.html">Ring Racer Course Buoy</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ringRacer_genericRing.html">Racing Course Ring</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ringRacer_greenRing.html">ringRacer_greenRing</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/ringRacer_redRing.html">ringRacer_redRing</a></td>
                </tr>
            </table>
        </a>

        <a name="models">    
        <h2>Models</h2>
            This expansion declares no models. This may be related to warnings.
        </a>

        <a name="scripts">    
        <h2>Scripts</h2>
            <table>
                <tr>
                    <th>Path</th>
                </tr>
                <tr>
                    <td valign="top">Scripts/ringRacer_greenRingScript.js</td>
                    <td><pre>this.name					= &quot;ringRacer_ringScript&quot;;
this.author					= &quot;Thargoid&quot;;
this.copyright				= &quot;Creative Commons Attribution - Non-Commercial - Share Alike 3.0 license with clauses - see readme.txt.&quot;;
this.description			= &quot;Script for racing ring&quot;;
this.version				= &quot;1.20&quot;;

this.shipSpawned = function()
	{ // lets randomise the ring&#39;s orientation
	this.newW = (Math.random()*2)-1; // a value between -1 and 1 for each component
	this.newX = (Math.random()*2)-1;
	this.newY = (Math.random()*2)-1;
	this.newZ = (Math.random()*2)-1;
	this.newOrientation = new Quaternion(this.newW, this.newX, this.newY, this.newZ);
	this.ship.orientation = this.newOrientation; 
	}

this.ringSwap = function()
	{
	this.ringPosition = this.ship.position;
	this.ringOrientation = this.ship.orientation;
	let redRing = this.ship.spawnOne(&quot;ringRacer_redRing&quot;);
	this.ship.remove();
	redRing.position = this.ringPosition;
	redRing.orientation = this.ringOrientation;
	}</pre></td>
                </tr>
                <tr>
                    <td valign="top">Scripts/ringRacer_systemScript.js</td>
                    <td><pre>this.name					= &quot;RingRacer&quot;;
this.author					= &quot;Thargoid&quot;;
this.copyright				= &quot;Creative Commons Attribution - Non-Commercial - Share Alike 3.0 license with clauses - see readme.txt.&quot;;
this.description			= &quot;Script for setting up Ring Racer Courses and running them.&quot;;
this.version				= &quot;1.20&quot;;

this.startUp = function()
	{
	if(missionVariables.ringRacer == null)
		{ missionVariables.ringRacer = 0; }
	if(missionVariables.ringRacer_location == null)
		{ missionVariables.ringRacer_location = 0; }
	if(missionVariables.ringRacer_raceCounter == null)
		{ missionVariables.ringRacer_raceCounter = 0; }
	if(missionVariables.ringRacer_bestTimeM == null)
		{ missionVariables.ringRacer_bestTimeM = 0; }
	if(missionVariables.ringRacer_bestTimeS == null)
		{ missionVariables.ringRacer_bestTimeS = 0; }
	this.courseLocations = [129, 178, 151, 65, 87, 119, 33, 72, 168, 104];
	this.racing = false;
	}

this.playerBoughtEquipment = function(equipment)
	{
	if(equipment == &quot;EQ_RINGRACER&quot;)
		{
		player.ship.removeEquipment(&quot;EQ_RINGRACER&quot;);
		missionVariables.ringRacer = 1;
		mission.markSystem(this.courseLocations[0]);
		mission.setInstructionsKey(&quot;RingRacer_&quot; + this.courseLocations[0]);
		mission.runScreen({title:&quot;Ring Racer League&quot;, messageKey:&quot;ringRacer_infoScreen&quot;, model:&quot;ringRacer_greenRing&quot;});
		}
	}

this.shipWillExitWitchspace = this.shipLaunchedFromStation = function()
	{
	if(!missionVariables.ringRacer == 1) // if the ring racer pass hasn&#39;t been purchased
		{return;}

	this.raceLocation = this.courseLocations[missionVariables.ringRacer_raceCounter];
	if(galaxyNumber == 0 &amp;&amp; system.ID == this.raceLocation)
		{
		if(system.countShipsWithRole(&quot;ringRacer_greenRing&quot;) == 0) // if the course isn&#39;t there yet
			{
			player.commsMessage(&quot;Welcome Ring Racer! Follow Q on your compass to the course.&quot;, 6);
			switch(this.raceLocation)
				{
				case 178:
				case 119:
				case 168:
					{	// sphere race
					log(&quot;Ring Racer&quot;, &quot;Sphere race started near &quot; + system.name);
					system.legacy_addShipsAtPrecisely(&quot;ringRacer_courseBuoy&quot;, 1, &quot;abs&quot;, [0, 0, -50000]);
					system.legacy_addShipsWithinRadius(&quot;ringRacer_greenRing&quot;, 10, &quot;abs&quot;, [0, 0, -50000], 20000);
					this.startRace();
					break;
					}

				case 129: 
				case 151:
				case 65:
				case 87:
				case 33:
				case 72:
				case 104:
					{	// linear race
					log(&quot;Ring Racer&quot;, &quot;Linear race started near &quot; + system.name);
					system.legacy_addShipsAtPrecisely(&quot;ringRacer_courseBuoy&quot;, 1, &quot;abs&quot;, [0, 0, -40000]);
					system.legacy_addShipsWithinRadius(&quot;ringRacer_greenRing&quot;, 1, &quot;abs&quot;, [0, 0, -60000], 2500);
					system.legacy_addShipsWithinRadius(&quot;ringRacer_greenRing&quot;, 1, &quot;abs&quot;, [0, 0, -80000], 2500);
					system.legacy_addShipsWithinRadius(&quot;ringRacer_greenRing&quot;, 1, &quot;abs&quot;, [0, 20000, -80000], 2500);
					system.legacy_addShipsWithinRadius(&quot;ringRacer_greenRing&quot;, 1, &quot;abs&quot;, [0, 40000, -80000], 2500);
					system.legacy_addShipsWithinRadius(&quot;ringRacer_greenRing&quot;, 1, &quot;abs&quot;, [20000, 40000, -80000], 2500);
					system.legacy_addShipsWithinRadius(&quot;ringRacer_greenRing&quot;, 1, &quot;abs&quot;, [40000, 40000, -80000], 2500);
					system.legacy_addShipsWithinRadius(&quot;ringRacer_greenRing&quot;, 1, &quot;abs&quot;, [50000, 40000, -90000], 2500);
					system.legacy_addShipsWithinRadius(&quot;ringRacer_greenRing&quot;, 1, &quot;abs&quot;, [50000, 50000, -100000], 2500);
					system.legacy_addShipsWithinRadius(&quot;ringRacer_greenRing&quot;, 1, &quot;abs&quot;, [60000, 60000, -100000], 2500);
					system.legacy_addShipsWithinRadius(&quot;ringRacer_greenRing&quot;, 1, &quot;abs&quot;, [60000, 75000, -110000], 2500);
					this.startRace();
					break;
					}
				}
			}
		}
	}

this.startRace = function()
	{
	missionVariables.ringRacer_ringCount = 0; // reset the count for a new race
	this.startTime = 0; // reset the time

	if(worldScripts[&quot;Welcome Information Script&quot;]) // if Welcome Mat is loaded &amp; running, disable it to stop data messages with the course buoys
		{
		if(worldScripts[&quot;Welcome Information Script&quot;].welcomeTimer.isRunning)
			{
			worldScripts[&quot;Welcome Information Script&quot;].welcomeTimer.stop();
			player.consoleMessage(&quot;Planetary Information System deactivated.&quot;,6);
			}
		}

	if(this.raceTimer)
		{
		this.raceTimer.start();
		}
	else
		{
		this.raceTimer = new Timer(this, this.raceCheck, 0, 1);
		}
	}

this.raceCheck = function()
	{
	if(missionVariables.ringRacer_ringCount == 1 &amp;&amp; this.startTime == 0)
		{
		this.startTime = clock.absoluteSeconds;
		player.commsMessage(&quot;Ring race clock started.&quot;, 6);
		this.racing = true;
		}

	if(missionVariables.ringRacer_ringCount == 10) // if we&#39;re at the end of the race, having done all 10 rings
		{
		this.raceTimer.stop();
		this.raceEnd();
		}

	this.raceElapsedTime = Math.floor(clock.absoluteSeconds - this.startTime); // absolute time since the race began
	if(this.racing &amp;&amp; this.raceElapsedTime &gt; 900) // if we&#39;ve been racing for over 15 minutes
		{
		player.commsMessage(&quot;Race time limit exceeded, clock stopped.&quot;,6);
		this.raceTimer.stop();
		missionVariables.ringRacer_ringCount = 0;
		}

	}

this.raceEnd = function()
	{
	this.racing = false;
	this.endTime = clock.absoluteSeconds;
	player.commsMessage(&quot;Ring race clock stopped.&quot;, 6);
	missionVariables.ringRacer_ringCount = 0;
	this.raceTime = Math.floor(this.endTime - this.startTime);
	this.raceTimeMinutes = Math.floor(this.raceTime / 60);
	this.raceTimeSeconds = this.raceTime - (60 * this.raceTimeMinutes);
	player.commsMessage(&quot;You completed the race in &quot; + this.raceTimeMinutes + &quot;m &quot; + this.raceTimeSeconds + &quot;s.&quot;, 6);
	this.bestTime = (missionVariables.ringRacer_bestTimeM * 60) + missionVariables.ringRacer_bestTimeS;

	if(this.bestTime == 0 &amp;&amp; this.raceTime &gt; 0)
		{
		player.commsMessage(&quot;We have registered your new best time.&quot;, 6);
		missionVariables.ringRacer_bestTimeM = this.raceTimeMinutes;
		missionVariables.ringRacer_bestTimeS = this.raceTimeSeconds;
		}

	if(this.bestTime &gt; this.raceTime)
		{
		player.commsMessage(&quot;Congratulations, you&#39;ve improved your best time!&quot;, 6);
		missionVariables.ringRacer_bestTimeM = this.raceTimeMinutes;
		missionVariables.ringRacer_bestTimeS = this.raceTimeSeconds;		
		}

	mission.unmarkSystem(this.courseLocations[missionVariables.ringRacer_raceCounter]);
	mission.setInstructionsKey(null);

	if(worldScripts[&quot;Welcome Information Script&quot;]) // if Welcome Mat has been disabled earlier, restart it
		{
		if(!worldScripts[&quot;Welcome Information Script&quot;].welcomeTimer.isRunning)
			{
			worldScripts[&quot;Welcome Information Script&quot;].welcomeTimer.start();
			player.consoleMessage(&quot;Planetary Information System restarted.&quot;,6);
			}
		}

	if(missionVariables.ringRacer_raceCounter == 9) // if all 10 races have been run
		{
		missionVariables.ringRacer = 0;
		missionVariables.ringRacer_raceCounter = 0;
		player.commsMessage(&quot;And that concludes the Ring Racing league for this season.&quot;, 10);
		player.commsMessage(&quot;Your best time for the season was &quot; + missionVariables.ringRacer_bestTimeM + &quot;m &quot; + missionVariables.ringRacer_bestTimeS + &quot;s.&quot;, 10); 
		return;
		}

	missionVariables.ringRacer_raceCounter += 1;
	mission.markSystem(this.courseLocations[missionVariables.ringRacer_raceCounter]);
	mission.setInstructionsKey(&quot;RingRacer_&quot; + this.courseLocations[missionVariables.ringRacer_raceCounter]);
	}

this.shipDied = this.shipWillEnterWitchspace = this.shipWillDockWithStation = function()
	{
	if(missionVariables.ringRacer == 1)
		{
		this.racing = false;
		if(this.raceTimer)
			{
			this.raceTimer.stop();
			missionVariables.ringRacer_ringCount = 0;
			}

		this.courseList = system.shipsWithRole(&quot;ringRacer_ringCourse&quot;); // find all course entities so we can remove them
		if(this.courseList.length &gt; 0) // if there are parts of the course present, loop through them and remove
			{
			let loopCounter = 0; // reset the counter
			for(loopCounter = 0; loopCounter &lt; this.courseList.length; loopCounter++)
				{
				this.courseList[loopCounter].remove();
				}
			}

			if(worldScripts[&quot;Welcome Information Script&quot;]) // if Welcome Mat has been disabled earlier, restart it
				{
				if(!worldScripts[&quot;Welcome Information Script&quot;].welcomeTimer.isRunning)
					{
					worldScripts[&quot;Welcome Information Script&quot;].welcomeTimer.start();
					}
				}
		}
	}

this.playerEnteredNewGalaxy = function(galaxyNumber)
	{
	if(missionVariables.ringRacer == 1)
		{
		missionVariables.ringRacer = 0;
		missionVariables.ringRacer_raceCounter = 0;
		missionVariables.ringRacer_location = 0;
		missionVariables.ringRacer_bestTimeM = 0;
		missionVariables.ringRacer_bestTimeS = 0;
		this.racing = false;
		}
	}</pre></td>
                </tr>
            </table>
        </a>
    </body>
</html>
