<html>
    <head>
        <title>Expansion Laser Cooler</title>
        <link rel="stylesheet" href="../style.css">
    </head>
    <body>
        <table border="0" width="100%">
            <tr>
                <td>Back to <a href='../index.html'>Index</a></td>
                <td align="right"><small>Page generated: Oct 11, 2023, 3:16:48 PM</small></td>
            </tr>
        </table>

        <h1>Expansion Laser Cooler</h1>

        <h2>Content</h2>
        <ul>
          
          <li><a href="#manifest">Manifest</a></li>
          <li><a href="#documentation">Documentation</a></li>
          <li><a href="#equipment">2 Equipment</a></li>
          <li><a href="#ships">0 Ships</a></li>
          <li><a href="#models">0 Models</a></li>
          <li><a href="#scripts">2 Scripts</a></li>
        </ul>


        <a name="manifest">
        <h2>Manifest</h2>
            <table border="1">
                <tr>
                    <th></th>
                    <th>from Expansion Manager's OXP list</th>
                    <th>from Expansion Manifest</th>
                </tr>
                <tr>
                    <td>Description</td>
                    <td>Turn off and on your hot weapons to attach the Cooler then fire until heat is dissipated. Need much energy, fuel and a ship over 130t mass.</td>
                    <td>Turn off and on your hot weapons to attach the Cooler then fire until heat is dissipated. Need much energy, fuel and a ship over 130t mass.</td>
                </tr>
                <tr>
                    <td>Identifier</td>
                    <td>oolite.oxp.Norby.Laser_Cooler</td>
                    <td>oolite.oxp.Norby.Laser_Cooler</td>
                </tr>
                <tr>
                    <td>Title</td>
                    <td>Laser Cooler</td>
                    <td>Laser Cooler</td>
                </tr>
                <tr>
                    <td>Category</td>
                    <td>Equipment</td>
                    <td>Equipment</td>
                </tr>
                <tr>
                    <td>Author</td>
                    <td>Norby</td>
                    <td>Norby</td>
                </tr>
                <tr>
                    <td>Version</td>
                    <td>1.2</td>
                    <td>1.2</td>
                </tr>
                <tr>
                    <td>Tags</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Required Oolite Version</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Maximum Oolite Version</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Required Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Optional Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Conflict Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Information URL</td>
                    <td><a target="_blank" href="http://wiki.alioth.net/index.php/Laser_Cooler">http://wiki.alioth.net/index.php/Laser_Cooler</a></td>
                    <td><a target="_blank" href="">n/a</a></td>
                </tr>
                <tr>
                    <td>Download URL</td>
                    <td><a target="_blank" href="https://wiki.alioth.net/img_auth.php/a/ab/Laser_Cooler_1.2.oxz">https://wiki.alioth.net/img_auth.php/a/ab/Laser_Cooler_1.2.oxz</a></td>
                    <td><a target="_blank" href="">n/a</a></td>
                </tr>
                <tr>
                    <td>License</td>
                    <td>CC BY-NC-SA 4</td>
                    <td>CC BY-NC-SA 4</td>
                </tr>
                <tr>
                    <td>File Size</td>
                    <td>n/a</td>
                </tr>
                <tr>
                    <td>Upload date</td>
                    <td>1610873407</td>
                </tr>
            </table>
                </a>

        <a name="documentation">
        <h2>Documentation</h2>
        <p>Also read <a href='http://wiki.alioth.net/index.php/Laser%20Cooler'>http://wiki.alioth.net/index.php/Laser%20Cooler</a></p>
        <h3>Laser_Cooler_readme.txt</h3>
        <pre>Laser Cooler


Turn off and on your weapons (press twice the underscore key) when overheated to attach the Cooler to the current laser, then fire until heat is dissipated.

Do not press the weapons key second time too fast after the first press, else the Cooler can not attach. Must spend about 1/4 sec without weapons to get the &quot;Laser Cooler attached&quot; message, then turn on your weapons again.

The cooler will automatically detach when finished or when 1.0 ly fuel remain only and your laser open fire instantly. Stop cooling when a friendly target is in your crosshairs to avoid accidental hits.

This equipment use very much energy and fuel for cooling and need a ship over 130t mass like a Cobra Mark III. Your cabin temperature will be higher due to the ship take over the heat from the laser.

Your cooler can be attached to one laser at the same time.

You can detach the cooler from your laser anytime by turning off and on your weapons.

The cooler can not start his work until the weapon is in overheat. Usually this is not a noticeable problem, except if you use Laser Cannons with high heat where you probably need to wait a bit or should start cooling one shot before overheat.


License:

This work is licensed under the Creative Commons Attribution-NonCommercial-ShareAlike License version 4.0.
If you are re-using any piece of this OXP, please let me know by sending an e-mail to norbylite@gmail.com.

Changelog:
 2020.05.05. v1.2  Fixed integration issues with New Lasers, improved integration with XenonHUD.
 2015.08.01. v1.1  Fuel usage and cabin temp raising added, thanks to avder and Disembodied.
 2015.08.01. v1.0  First release.

Forum:
See this topic: http://bb.aegidian.org/viewtopic.php?f=4&amp;t=17638
</pre>
        </a>

        <a name="equipment">          
        <h2>Equipment</h2>
            <table>
                <tr>
                    <th>Name</th>
                    <th>Visible</th>
                    <th>Cost [deci-credits]</th>
                    <th>Tech-Level</th>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_LASER_COOLER.html">Laser Cooler</a></td>
                    <td>yes</td>
                    <td align="right">50000</td>
                    <td align="center">5+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_WEAPON_LASER_COOLER.html">Laser Cooler</a></td>
                    <td>yes</td>
                    <td align="right">0</td>
                    <td align="center">16+</td>
                </tr>
            </table>
        </a>

        <a name="ships">    
        <h2>Ships</h2>
            This expansion declares no ships. 
        </a>

        <a name="models">    
        <h2>Models</h2>
            This expansion declares no models. 
        </a>

        <a name="scripts">    
        <h2>Scripts</h2>
            <table>
                <tr>
                    <th>Path</th>
                </tr>
                <tr>
                    <td valign="top">Scripts/laser_cooler.js</td>
                    <td><pre>&quot;use strict&quot;;
this.name	= &quot;laser_cooler&quot;;
this.author	= &quot;Norby&quot;;
this.copyright	= &quot;2015 Norby&quot;;
this.description= &quot;laser cooler&quot;;
this.licence	= &quot;CC BY-NC-SA 4.0&quot;;

//Internal variables, should not touch
this.$FuelPart = 0;
this.$Heat = 0;
this.$Timer = null;
this.$View = null;
this.$WeaponKey = null;
this.$WeaponsOff = false;
this.$WeaponsOn = false;

//worldscript events
this.startUp = function() {
	if( !this.$Timer ) this.$Timer = new Timer(this, this.$Timed.bind(this), 0.25, 0.25);
}

this.shipWillDockWithStation = function() {
	this.$DetachCooler();
}

//Internal functions
this.$DetachCooler = function() {
	var lmss = worldScripts.LMSS_Core; // ** added
	if (lmss) lmss._switching = true;
	if( this.$WeaponKey ) player.ship.currentWeapon = this.$WeaponKey;
	var x = worldScripts.XenonHUD;
	if (x) x.weaponsSystemsToggled(true);
	if (lmss) lmss._switching = false;
	this.$Fuelpart = 0;
	this.$Heat = 0;
	this.$View = null;
	this.$WeaponKey = null;
	this.$WeaponsOff = false;
	this.$WeaponsOn = false;
}

this.$Timed = function() {
	var c = &quot;EQ_WEAPON_LASER_COOLER&quot;;
	var p = player.ship;
	if( !p.isValid ) return;
	var k = p.currentWeapon.equipmentKey;
	if( !p.weaponsOnline ) {
		if( p.equipmentStatus(&quot;EQ_LASER_COOLER&quot;) == &quot;EQUIPMENT_OK&quot; &amp;&amp; !this.$WeaponKey
			&amp;&amp; p.laserHeatLevel &gt; 0.6 &amp;&amp; k != c ) {
				if( p.fuel &lt;= 1.0 ) {
					player.consoleMessage(&quot;Not enough fuel for Laser Cooler&quot;);
				} else {
					this.$Fuelpart = 0;
					this.$Heat = p.laserHeatLevel;
					this.$View = p.viewDirection;
					this.$WeaponKey = k;
					this.$WeaponsOff = false;
					this.$WeaponsOn = false;
					log(this.name, &quot;setting &quot; + this.$WeaponKey);
					p.currentWeapon = c;
					player.consoleMessage(&quot;Laser Cooler attached, press fire for cooling&quot;,5);
				}
		} else if( this.$WeaponKey &amp;&amp; this.$WeaponsOn ) this.$WeaponsOff = true;
	} else {
		this.$WeaponsOn = true;
		if( this.$WeaponKey &amp;&amp; k == c
			&amp;&amp; ( p.laserHeatLevel &lt; 0.1 || this.$WeaponsOff || p.fuel &lt;= 1.0 )
			&amp;&amp; this.$View == p.viewDirection ) {
				this.$DetachCooler();
				var f = &quot;&quot;;
				if( p.fuel &lt;= 1.0 ) f = &quot; due to low fuel&quot;
				player.consoleMessage(&quot;Laser Cooler detached&quot;+f, 5);
		}
	}
	if( this.$View == p.viewDirection &amp;&amp; k == c ) {
		if( this.$Heat &gt; 0 &amp;&amp; this.$Heat &gt; p.laserHeatLevel + 0.01 ) { //detect fast cooling
			p.temperature += 0.035; //increase cabin temp
			this.$FuelPart++;
			if( this.$FuelPart &gt;= 2 ) { //1 mean 0.4 ly/s, 2 mean 0.2 ly/s, 4 mean 0.1 ly/s
				this.$FuelPart = 0;
				p.fuel -= 0.1; //must be at least 0.1 and divisible by 0.1
			}
		}
		this.$Heat = p.laserHeatLevel;//save for the next timer call
	} else this.$Heat = 0;
}</pre></td>
                </tr>
                <tr>
                    <td valign="top">Scripts/lasercooler-conditions.js</td>
                    <td><pre>&quot;use strict&quot;;
this.name	= &quot;lasercooler-conditions&quot;;
this.author	= &quot;Norby&quot;;
this.copyright   = &quot;2013 Norbert Nagy&quot;;
this.licence     = &quot;CC BY-NC-SA 4.0&quot;;
this.description = &quot;This equipment is usable only for ships over 130t like the Cobra Mark III.&quot;;

this.allowAwardEquipment = function(equipment, ship, context)
{
	// OXP hook to allow stations to forbid specific equipment
	if (context == &quot;purchase&quot; &amp;&amp; player.ship.dockedStation &amp;&amp; player.ship.dockedStation.scriptInfo[&quot;oolite-barred-equipment&quot;])
	{
		if (player.ship.dockedStation.scriptInfo[&quot;oolite-barred-equipment&quot;].indexOf(equipment) != -1)
		{
			return false;
		}
	}

	// OXP hook to allow ships to forbid specific &quot;available to all&quot; equipment
	if (ship.scriptInfo &amp;&amp; ship.scriptInfo[&quot;oolite-barred-equipment&quot;] &amp;&amp; ship.scriptInfo[&quot;oolite-barred-equipment&quot;].indexOf(equipment) != -1)
	{
		return false;
	}

//	player.consoleMessage( eqKey+&quot; &quot;+ship+&quot; &quot;+context );//debug

	//for large ships only like Cobra Mark III
	if( ship.mass &lt; 130000 ) {
		return false;
	}
	
//	if( equipment == &quot;EQ_WEAPON_LASER_COOLER&quot; &amp;&amp; context != &quot;scripted&quot; ) return false;
//	if( equipment == &quot;EQ_WEAPON_LASER_COOLER&quot; ) {
//		log(this.name,  context +&quot; &quot;+equipment+&quot; &quot;+ship);
//		if( context != &quot;scripted&quot; ) return false;
//	}

	return true;
}</pre></td>
                </tr>
            </table>
        </a>
    </body>
</html>
