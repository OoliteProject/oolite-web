<html>
    <head>
        <title>Expansion Stealth</title>
        <link rel="stylesheet" href="../style.css">
    </head>
    <body>
        <table border="0" width="100%">
            <tr>
                <td>Back to <a href='../index.html'>Index</a></td>
                <td align="right"><small>Page generated: Oct 11, 2023, 3:16:49 PM</small></td>
            </tr>
        </table>

        <h1>Expansion Stealth</h1>

        <h2>Content</h2>
        <ul>
          <li><a href="#warnings">Warnings</a></li>
          <li><a href="#manifest">Manifest</a></li>
          <li><a href="#documentation">Documentation</a></li>
          <li><a href="#equipment">0 Equipment</a></li>
          <li><a href="#ships">3 Ships</a></li>
          <li><a href="#models">0 Models</a></li>
          <li><a href="#scripts">4 Scripts</a></li>
        </ul>

          <a name="warnings">
            <h2>Warnings</h2>
            <ol>
                <li>Tags mismatch between OXP Manifest and Expansion Manager at character position 0002 (RIGHT SQUARE BRACKET vs LATIN SMALL LETTER M)(&#39;[]&#39; vs &#39;[missions, ships]&#39;)</li>
            </ol>
          </a>

        <a name="manifest">
        <h2>Manifest</h2>
            <table border="1">
                <tr>
                    <th></th>
                    <th>from Expansion Manager's OXP list</th>
                    <th>from Expansion Manifest</th>
                </tr>
                <tr>
                    <td>Description</td>
                    <td>A small mission set in Galaxy 3 to showcase the new scanner features and the possibility for stealth ships.</td>
                    <td>A small mission set in Galaxy 3 to showcase the new scanner features and the possibility for stealth ships.</td>
                </tr>
                <tr>
                    <td>Identifier</td>
                    <td>oolite.oxp.Thargoid.Stealth</td>
                    <td>oolite.oxp.Thargoid.Stealth</td>
                </tr>
                <tr>
                    <td>Title</td>
                    <td>Stealth</td>
                    <td>Stealth</td>
                </tr>
                <tr>
                    <td>Category</td>
                    <td>Missions</td>
                    <td>Missions</td>
                </tr>
                <tr>
                    <td>Author</td>
                    <td>Thargoid</td>
                    <td>Thargoid</td>
                </tr>
                <tr>
                    <td>Version</td>
                    <td>1.05</td>
                    <td>1.05</td>
                </tr>
                <tr>
                    <td>Tags</td>
                    <td></td>
                    <td>missions, ships</td>
                </tr>
                <tr>
                    <td>Required Oolite Version</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Maximum Oolite Version</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Required Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Optional Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Conflict Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Information URL</td>
                    <td><a target="_blank" href="http://wiki.alioth.net/index.php/Stealth_OXP">http://wiki.alioth.net/index.php/Stealth_OXP</a></td>
                    <td><a target="_blank" href="">n/a</a></td>
                </tr>
                <tr>
                    <td>Download URL</td>
                    <td><a target="_blank" href="https://wiki.alioth.net/img_auth.php/c/cb/Stealth_1.05.oxz">https://wiki.alioth.net/img_auth.php/c/cb/Stealth_1.05.oxz</a></td>
                    <td><a target="_blank" href="">n/a</a></td>
                </tr>
                <tr>
                    <td>License</td>
                    <td>Creative Commons Attribution - Non-Commercial - Share Alike 3.0 license with clauses - see readme file</td>
                    <td>Creative Commons Attribution - Non-Commercial - Share Alike 3.0 license with clauses - see readme file</td>
                </tr>
                <tr>
                    <td>File Size</td>
                    <td>n/a</td>
                </tr>
                <tr>
                    <td>Upload date</td>
                    <td>1610873473</td>
                </tr>
            </table>
                </a>

        <a name="documentation">
        <h2>Documentation</h2>
        <p>Also read <a href='http://wiki.alioth.net/index.php/Stealth'>http://wiki.alioth.net/index.php/Stealth</a></p>
        <h3>Stealth 1.05 Readme &amp; License.txt</h3>
        <pre>Stealth OXP by Thargoid.

This is a little mission OXP set in Galaxy 3, designed to showcase what can be done in Oolite with scanner lollipop colours and the creation of stealth ships which do not appear (in this case programmed to only be visible when they are attacking prey). 

A squadron of six experimental stealth Barracuda fighters have been stolen by a pirate gang and are preying on innocent traders. The navy needs someone to take care of business and take them out, and your name&#39;s in the frame.

To kick off the mission, fly to the main station in the Beenbeor system.

Requirements -

This OXP is scripted for Oolite v1.76 or later, and will not run on any earlier versions of the game. 

The mission is set in Galaxy 3, and requires the player to have at least 512 kills to their name. If these conditions are met then the mission will be offered on docking, after which time reminder instructions are provided in mission screens with pointers via the manifest (F5-F5) screen.

--------------------------------------------------------------

License:

This OXP is released under the Creative Commons Attribution - Non-Commercial - Share Alike 3.0 license with the following clauses:

* Whilst you are free (and encouraged) to re-use any of the scripting, models or texturing in this OXP, the usage must be distinct from that within this OXP. Unique identifiers such as (but not limited to) unique shipdata.plist entity keys, mission variables, script names (this.name), equipment identity strings (EQ_), description list arrays and entity roles must not be re-used without prior agreement. Basically if it&#39;s unique or would identify or overwrite anything in the original OXP, then you may not re-use it (for obvious compatibility reasons).
* rebundling of this OXP within another distribution is permitted as long as it is unchanged. The following derivates however are permitted and except from the above:
	* the conversion of files between XML and openStep.
	* the merging of files with other files of the same type from other OXPs.
* The license information (either as this file or merged into a larger one) must be included in the OXP.
* Even though it is not compulsory, if you are re-using any sizable or recognisable piece of this OXP, please let me know :)

--------------------------------------------------------------

Instructions:

Unzip the file, and then move the folder &quot;Stealth 1.05.oxp&quot; to the AddOns directory of your Oolite installation. Then start the game up and the ships should be added. 

Version history:

13/06/2010 - Version 1.00, Initial release.
02/11/2010 - Version 1.01, bugfix correcting missing script element which spawns the base!
13/02/2011 - Version 1.02, removal of upper limit, to allow running with 1.75
02/03/2011 - Version 1.03, added a couple of missing break; commands to the script.js
14/07/2011 - Version 1.04, tweaked script to make sure pirate base is added if player saves and reloads in mission system.
26/03/2013 - Version 1.05, some script and message adjustments to make the objectives a bit clearer, and to notify that the mission will fail if the target system is left once the mission is active and the hunt underway.

--------------------------------------------------------------

Acknowledgements:

With thanks to another_commander for the implementation of the scanner functions in 1.74, and a nod to Frame for his discussions on stealth ships on the forum. Also thanks to bjasspa for the missing break&#39;s heads-up.

Thanks also to Mauiby de Fug for the bug report on the save/reload issue, and Stewart for the constructive write-up on v1.04 which lead to v1.05</pre>
        </a>

        <a name="equipment">          
        <h2>Equipment</h2>
            This expansion declares no equipment. This may be related to warnings.
        </a>

        <a name="ships">    
        <h2>Ships</h2>
            <table>
                <tr>
                    <th>Name</th>
                </tr>
                <tr>
                    <td><a href="../ships/stealth_barracuda.html">Stealth Barracuda (Stolen)</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/stealth_base.html">Asteroid</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/stealth_mine.html">Homing Mine (Inactive)</a></td>
                </tr>
            </table>
        </a>

        <a name="models">    
        <h2>Models</h2>
            This expansion declares no models. This may be related to warnings.
        </a>

        <a name="scripts">    
        <h2>Scripts</h2>
            <table>
                <tr>
                    <th>Path</th>
                </tr>
                <tr>
                    <td valign="top">Config/script.js</td>
                    <td><pre>this.name					= &quot;stealth_missionScript&quot;;
this.author					= &quot;Thargoid&quot;;
this.copyright				= &quot;Creative Commons: attribution, non-commercial, sharealike with clauses - see readme.txt&quot;;
this.description			= &quot;Mission script for Stealth OXP.&quot;;
this.version				= &quot;1.05&quot;;

this.startUp = function()
	{
	// mission has already been rejected or completed, clean up and remove active script parts
	if(missionVariables.stealth_mission == &quot;CASE_CLOSED&quot;) 
		{
		this.cleanUp();
		return;
		}
	 
	//initialise mission variables
	if(!missionVariables.stealth_mission) // mission general status
		{ missionVariables.stealth_mission = &quot;OFFER&quot;; }

	if(!missionVariables.stealth_barraCount) // how many barracuda&#39;s launched
		{ missionVariables.stealth_barraCount = 0; }
		
	if(!missionVariables.stealth_barraKills) // and how many killed by the player
		{ missionVariables.stealth_barraKills = 0; }
	}
	
this.cleanUp = function() // get rid of active script elements if no longer needed.
		{
		delete this.startUp;
		delete this.playerEnteredNewGalaxy;
		delete this.missionScreenOpportunity;
		delete this.choice;
		mission.setInstructionsKey(null);
		return;
		}

this.missionScreenOpportunity = function()
	{	
	// next check if we have any conditions preventing the offering or continuing of the mission
	if(!player.ship.docked // we&#39;re in space
			|| player.score &lt; 512 // need to be dangerous rank to begin
			|| galaxyNumber != 2 // we&#39;re not in G3
			|| !player.ship.dockedStation.isMainStation // if we&#39;re not at the main station
			) 
		{ return; }
	
	if(system.ID === 131) // if we&#39;re at Lequena
		{
		if(player.ship.docked &amp;&amp; player.ship.dockedStation.isMainStation &amp;&amp; missionVariables.stealth_mission === &quot;GO_GET_EM&quot; &amp;&amp; this.dockHint === &quot;NO&quot;)
			{
			this.dockHint = &quot;YES&quot;;
			mission.runScreen({title: &quot;Anyone seen old Jeeq?&quot;, messageKey:&quot;stealth_hint&quot;});
			return;
			}
		}
	
	if(system.ID === 116) // if we&#39;re at Beenboer
		{
		switch(missionVariables.stealth_mission)
			{
			case &quot;OFFER&quot;: // make the initial offer
				{
				mission.runScreen({title: &quot;Catch the Barracuda&quot;, messageKey:&quot;stealth_initialOffer&quot;, choicesKey:&quot;stealth_choices&quot;}, this.choice);
				break;
				}
			case &quot;REJECTED&quot;: // player said no
				{
				missionVariables.stealth_mission = &quot;CASE_CLOSED&quot;;
				mission.setInstructionsKey(null);
				mission.runScreen({title: &quot;Ah well...&quot;, messageKey:&quot;stealth_rejected&quot;});
				break;
				}
			case &quot;ACCEPTED&quot;: // player said yes
				{
				missionVariables.stealth_mission = &quot;GO_GET_EM&quot;;
				mission.setInstructionsKey(&quot;stealth_missionShort&quot;);
				mission.markSystem(131);
				mission.runScreen({title: &quot;Final briefing&quot;, messageKey:&quot;stealth_accepted&quot;});
				break;
				}
			case &quot;BASE_DESTROYED&quot;: // mission over - base destroyed
				{
				missionVariables.stealth_mission = &quot;CASE_CLOSED&quot;;
				mission.setInstructionsKey(null);
				mission.unmarkSystem(116);
				switch(missionVariables.stealth_barraKills)
					{
					case(6):
						{
						mission.runScreen({title: &quot;Mission accomplished&quot;, messageKey:&quot;stealth_allBarraDestroyed&quot;});
						player.credits += 2000;
						break;
						}
					case(5):
					case(4):
					case(3):
						{
						missionVariables.stealth_award = missionVariables.stealth_barraKills * 250;
						mission.runScreen({title: &quot;Mission debriefing&quot;, messageKey:&quot;stealth_someBarraDestroyed&quot;});
						player.credits += missionVariables.stealth_award;
						break;
						}
					case(2):
					case(1):
						{
						mission.runScreen({title: &quot;Mission debriefing&quot;, messageKey:&quot;stealth_fewBarraDestroyed&quot;});
						break;
						}					
					case(0):
						{
						mission.runScreen({title: &quot;Mission debriefing&quot;, messageKey:&quot;stealth_noBarraDestroyed&quot;});
						break;
						}
					}
				break;	
				}
			case &quot;BASE_INTACT&quot;: // mission over - base intact
				{
				missionVariables.stealth_mission = &quot;CASE_CLOSED&quot;;
				mission.setInstructionsKey(null);
				mission.unmarkSystem(116);
				switch(missionVariables.stealth_barraKills)
					{
					case(6):
						{
						mission.runScreen({title: &quot;Mission debriefing&quot;, messageKey:&quot;stealth_allBarraIntact&quot;});
						player.credits += 1000;
						break;
						}
					case(5):
					case(4):
					case(3):
						{
						missionVariables.stealth_award = missionVariables.stealth_barraKills * 100;
						mission.runScreen({title: &quot;Mission debriefing&quot;, messageKey:&quot;stealth_someBarraIntact&quot;});
						player.credits += missionVariables.stealth_award;
						break;
						}
					case(2):
					case(1):
						{
						mission.runScreen({title: &quot;Mission debriefing&quot;, messageKey:&quot;stealth_fewBarraIntact&quot;});
						break;
						}					
					case(0):
						{
						mission.runScreen({title: &quot;Mission failed&quot;, messageKey:&quot;stealth_noBarraIntact&quot;});
						break;
						}	
					}
				break;	
				}
			}
		return;	
		}
	}
	
this.choice = function(choice)
	{
	switch(choice)
		{
		case &quot;STEALTH_1_ACCEPTED&quot;:
			{
			missionVariables.stealth_mission = &quot;ACCEPTED&quot;;
			break;
			}
		case &quot;STEALTH_2_REJECTED&quot;:
			{
			missionVariables.stealth_mission = &quot;REJECTED&quot;;
			break;
			}
		}
	}

this.playerEnteredNewGalaxy	= function(galaxyNumber)
	{ // if we jump galaxies whilst mission is running or after rejection
	if(galaxyNumber == 3 &amp;&amp; missionVariables.stealth_mission != &quot;OFFER&quot;)
		{
		missionVariables.stealth_mission = &quot;CASE_CLOSED&quot;;
		this.cleanUp();
		}
	}
	
this.shipWillExitWitchspace = function()
	{
	if(galaxyNumber == 2 &amp;&amp; system.ID == 131 &amp;&amp; missionVariables.stealth_mission &amp;&amp; missionVariables.stealth_mission == &quot;GO_GET_EM&quot; &amp;&amp; system.countShipsWithRole(&quot;stealth_base&quot;) == 0)
		{
		this.location = (Math.random() * 0.5) + 0.25;
		system.addShipsToRoute(&quot;stealth_base&quot;, 1, this.location, &quot;ws&quot;);
		this.dockHint = &quot;NO&quot;;
		}
	}
	
this.playerStartedJumpCountdown = function()
	{ 
	if(galaxyNumber == 2 &amp;&amp; system.ID == 131 &amp;&amp; missionVariables.stealth_mission &amp;&amp; missionVariables.stealth_mission == &quot;GO_GET_EM&quot;)
		{
		player.commsMessage(&quot;If we leave now there will not be sufficient time to return before the Barracuda base is evacuated - the mission will be lost!&quot;);
		delete this.playerStartedJumpCountdown;
		}
	}	
	
this.shipWillLaunchFromStation = function()
	{
	this.shipWillExitWitchspace();
	delete this.shipWillLaunchFromStation;
	}
</pre></td>
                </tr>
                <tr>
                    <td valign="top">Scripts/stealth_barracuda.js</td>
                    <td><pre>this.name			= &quot;stealth_barracuda&quot;;
this.author			= &quot;Thargoid&quot;;
this.copyright		= &quot;Creative Commons: attribution, non-commercial, sharealike with clauses - see readme.txt&quot;;
this.description	= &quot;Script for stealth ship appearing and vanishing&quot;;
this.version		= &quot;1.05&quot;;

this.shipSpawned = function ()
	{
	if (player.score &gt; 512) { this.ship.awardEquipment(&quot;EQ_SHIELD_BOOSTER&quot;); }
	if (player.score &gt; 2560) { this.ship.awardEquipment(&quot;EQ_SHIELD_ENHANCER&quot;); }
	missionVariables.stealth_barraCount += 1;
	}

this.stealthMode = function(state)
	{
	if(state &amp;&amp; state == &quot;off&quot;)
		{
		this.ship.scannerDisplayColor1 = &quot;redColor&quot;;
		this.ship.scannerDisplayColor2 = &quot;redColor&quot;;
		}
	else
		{
		this.ship.scannerDisplayColor1 = [0,0,0,0];
		}
	}

this.shipDied = function(who, why)
	{ missionVariables.stealth_barraKills += 1; }</pre></td>
                </tr>
                <tr>
                    <td valign="top">Scripts/stealth_base.js</td>
                    <td><pre>this.name			= &quot;stealth_base&quot;;
this.author			= &quot;Thargoid&quot;;
this.copyright		= &quot;Creative Commons: attribution, non-commercial, sharealike with clauses - see readme.txt&quot;;
this.description	= &quot;Script for stealth base&quot;;
this.version		= &quot;1.05&quot;;

var stealth_stealthGroup = new ShipGroup();

this.shipSpawned = function()
	{
	stealth_stealthGroup.leader = this.ship;
	this.ship.scannerDisplayColor1 = &quot;whiteColor&quot;;
	this.ship.scannerDisplayColor2 = &quot;grayColor&quot;;
	system.addShips(&quot;asteroid&quot;, 30, this.ship.position, 25600); // add the asteroid field
	system.addShips(&quot;stealth_mine&quot;, 10, this.ship.position, 20000); // and the mines hidden in it
	this.watchTimer = new Timer(this, this.checkPlayer, 0, 1);
	}

this.checkPlayer = function()	
	{
	if(system.countShipsWithRole(&quot;player&quot;) == 0)
		{ this.stopWatch(); }
	
	this.distanceToPlayer = this.ship.position.distanceTo(player.ship.position);	
	if(this.distanceToPlayer &lt; 25600)
		{
		this.launchBarra();
		this.launchBarra();
		this.stopWatch();
		}
	}
		
this.playerWillEnterWitchspace = function()
	{
	this.stopWatch();
	if(missionVariables.stealth_mission != &quot;BASE_DESTROYED&quot;)
		{ 
		missionVariables.stealth_mission = &quot;BASE_INTACT&quot;; 
		mission.setInstructionsKey(&quot;stealth_backToBaseFailure&quot;, &quot;stealth_missionScript&quot;);
		}
	}

this.stopWatch = function()
	{
	if(this.watchTimer &amp;&amp; this.watchTimer.isRunning)
		{	
		this.watchTimer.stop();
		delete this.watchTimer;
		}
	}
	
this.launchBarra = function()
	{
	if(missionVariables.stealth_barraCount &lt; 6)
		{
		this.launchSpot = (this.ship.position.add(this.ship.orientation.vectorForward().multiply(1000)));
		var newShip = system.addShips(&quot;stealth_barracuda&quot;, 1, this.launchSpot, 100);
		newShip.group = stealth_stealthGroup;
		}
	}

this.shipBeingAttacked = this.shipBeingAttackedByCloaked = function()
	{
	this.launchChance = (this.ship.maxEnergy - this.ship.energy) / this.ship.maxEnergy;
	if(Math.random() &lt; this.launchChance) 
		{ this.launchBarra(); }
	}
	
this.shipEnergyIsLow = function()
	{
	player.commsMessage(&quot;Emergency warning to all Barracuda, base systems are going critical!      Take that SOB out before we&#39;re toasted!&quot;, 6);	
	if(missionVariables.stealth_barraCount &lt; 6)
		{		
		this.launchSpot = (this.ship.position.add(this.ship.orientation.vectorForward().multiply(1000)));
		var newShip = system.addShips(&quot;stealth_barracuda&quot;, (6 - missionVariables.stealth_barraCount), this.launchSpot, 200);
		newShip.group = stealth_stealthGroup;
		}	
	delete this.shipEnergyIsLow;	
	}
	
this.shipDied = function(who, why)
	{
	this.stopWatch();
	
	if(this.scanTimer &amp;&amp; this.scanTimer.isRunning)
		{	
		this.scanTimer.stop();
		delete this.scanTimer;
		}
	
	if(why &amp;&amp; why != &quot;removed&quot;)
		{
		missionVariables.stealth_mission = &quot;BASE_DESTROYED&quot;;
		mission.setInstructionsKey(&quot;stealth_backToBaseSuccess&quot;, &quot;stealth_missionScript&quot;);
		mission.unmarkSystem(131);
		mission.markSystem(116);
		}
	}
	
this.otherShipDocked = function(whom)		
	{	
	if(whom.isPlayer)
		{ // if the player was dumb enough to dock
		mission.runScreen({title: &quot;Bad Move!&quot;, messageKey:&quot;stealth_getHim&quot;}, this.damagePlayer);
		}
	}	
	
this.damagePlayer = function()
	{
	player.ship.launch();
	player.ship.takeInternalDamage();
	player.ship.takeInternalDamage();
	player.ship.energy *= (0.5 + (Math.random() * 0.5));
	player.ship.aftShield *= (0.1 + (Math.random() * 0.8));
	player.ship.forwardShield *= (0.1 + (Math.random() * 0.8));
	}	</pre></td>
                </tr>
                <tr>
                    <td valign="top">Scripts/stealth_mine.js</td>
                    <td><pre>this.name			= &quot;stealth_mine&quot;;
this.author			= &quot;Thargoid&quot;;
this.copyright		= &quot;Creative Commons: attribution, non-commercial, sharealike with clauses - see readme.txt&quot;;
this.description	= &quot;Script for space mine&quot;;
this.version		= &quot;1.05&quot;;

this.activate = function()
	{
	this.ship.scannerDisplayColor1 = &quot;yellowColor&quot;;
	this.ship.scannerDisplayColor2 = &quot;redColor&quot;;
	this.ship.displayName = &quot;Homing Mine (Active)&quot;;
	}

this.deactivate = function()
	{
	this.ship.scannerDisplayColor1 = &quot;whiteColor&quot;;
	this.ship.scannerDisplayColor2 = &quot;whiteColor&quot;;
	this.ship.displayName = &quot;Homing Mine (Inactive)&quot;;
	}	
</pre></td>
                </tr>
            </table>
        </a>
    </body>
</html>
