<html>
    <head>
        <title>Expansion Extra Thargoids</title>
        <link rel="stylesheet" href="../style.css">
    </head>
    <body>
        <table border="0" width="100%">
            <tr>
                <td>Back to <a href='../index.html'>Index</a></td>
                <td align="right"><small>Page generated: Oct 11, 2023, 3:16:49 PM</small></td>
            </tr>
        </table>

        <h1>Expansion Extra Thargoids</h1>

        <h2>Content</h2>
        <ul>
          <li><a href="#warnings">Warnings</a></li>
          <li><a href="#manifest">Manifest</a></li>
          <li><a href="#documentation">Documentation</a></li>
          <li><a href="#equipment">0 Equipment</a></li>
          <li><a href="#ships">18 Ships</a></li>
          <li><a href="#models">0 Models</a></li>
          <li><a href="#scripts">6 Scripts</a></li>
        </ul>

          <a name="warnings">
            <h2>Warnings</h2>
            <ol>
                <li>Tags mismatch between OXP Manifest and Expansion Manager at character position 0002 (RIGHT SQUARE BRACKET vs LATIN SMALL LETTER T)(&#39;[]&#39; vs &#39;[thargoids, ships, system]&#39;)</li>
                <li>Optional Expansions mismatch between OXP Manifest and Expansion Manager at character position 0068 (DIGIT ZERO vs LATIN SMALL LETTER N)</li>
                <li>Conflict Expansions mismatch between OXP Manifest and Expansion Manager at character position 0049 (DIGIT ZERO vs LATIN SMALL LETTER N)</li>
                <li>Unknown key &#39;upload_date&#39; at https://wiki.alioth.net/img_auth.php/8/8a/Oolite.oxp.UK_Eliter.Extra_Thargoids.oxz!manifest.plist</li>
            </ol>
          </a>

        <a name="manifest">
        <h2>Manifest</h2>
            <table border="1">
                <tr>
                    <th></th>
                    <th>from Expansion Manager's OXP list</th>
                    <th>from Expansion Manifest</th>
                </tr>
                <tr>
                    <td>Description</td>
                    <td>Adds new types of Thargoid, which are to be encountered especially in interstellar space.</td>
                    <td>Adds new types of Thargoid, which are to be encountered especially in interstellar space.</td>
                </tr>
                <tr>
                    <td>Identifier</td>
                    <td>oolite.oxp.UK_Eliter.ExtraThargoids</td>
                    <td>oolite.oxp.UK_Eliter.ExtraThargoids</td>
                </tr>
                <tr>
                    <td>Title</td>
                    <td>Extra Thargoids</td>
                    <td>Extra Thargoids</td>
                </tr>
                <tr>
                    <td>Category</td>
                    <td>Ships</td>
                    <td>Ships</td>
                </tr>
                <tr>
                    <td>Author</td>
                    <td>UK_Eliter</td>
                    <td>UK_Eliter</td>
                </tr>
                <tr>
                    <td>Version</td>
                    <td>6.73</td>
                    <td>6.73</td>
                </tr>
                <tr>
                    <td>Tags</td>
                    <td></td>
                    <td>thargoids, ships, system</td>
                </tr>
                <tr>
                    <td>Required Oolite Version</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Maximum Oolite Version</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Required Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Optional Expansions</td>
                    <td>
                            <li>oolite.oxp.UK_Eliter.Ferdelance_3G:0</li>
                            <li>oolite.oxp.UK_Eliter.InterstellarTweaks:0</li>
                    </td>
                    <td>
                            <li>oolite.oxp.UK_Eliter.Ferdelance_3G:</li>
                            <li>oolite.oxp.UK_Eliter.InterstellarTweaks:</li>
                    </td>
                </tr>
                <tr>
                    <td>Conflict Expansions</td>
                    <td>
                            <li>Extra Thargoids:0</li>
                    </td>
                    <td>
                            <li>Extra Thargoids:</li>
                    </td>
                </tr>
                <tr>
                    <td>Information URL</td>
                    <td><a target="_blank" href="http://aegidian.org/bb/viewtopic.php?t=10154&amp;p=143763">http://aegidian.org/bb/viewtopic.php?t=10154&amp;p=143763</a></td>
                    <td><a target="_blank" href="">n/a</a></td>
                </tr>
                <tr>
                    <td>Download URL</td>
                    <td><a target="_blank" href="https://wiki.alioth.net/img_auth.php/8/8a/Oolite.oxp.UK_Eliter.Extra_Thargoids.oxz">https://wiki.alioth.net/img_auth.php/8/8a/Oolite.oxp.UK_Eliter.Extra_Thargoids.oxz</a></td>
                    <td><a target="_blank" href="http://wiki.alioth.net/img_auth.php/8/8a/Oolite.oxp.UK_Eliter.Extra_Thargoids.oxz">http://wiki.alioth.net/img_auth.php/8/8a/Oolite.oxp.UK_Eliter.Extra_Thargoids.oxz</a></td>
                </tr>
                <tr>
                    <td>License</td>
                    <td>Creative Commons Attribution - Non-Commercial - Share Alike 4.0 license</td>
                    <td>Creative Commons Attribution - Non-Commercial - Share Alike 4.0 license</td>
                </tr>
                <tr>
                    <td>File Size</td>
                    <td>n/a</td>
                </tr>
                <tr>
                    <td>Upload date</td>
                    <td>1647012498</td>
                </tr>
            </table>
                </a>

        <a name="documentation">
        <h2>Documentation</h2>
        <p>Also read <a href='http://wiki.alioth.net/index.php/Extra%20Thargoids'>http://wiki.alioth.net/index.php/Extra%20Thargoids</a></p>
        <h3>Readme &amp; License.txt</h3>
        <pre>====================================
&#39;Extra Thargoids&#39; OXP by &#39;UK_Eliter&#39;
====================================

-------------
GENERAL NOTES
-------------

� This OXP adds various types of Thargoid. The most commonly (or least infrequently) encountered of these are (/will be) the &#39;Gruntbuggly&#39; (which itself comes in various versions), the &#39;anti-poet&#39; Frigate, the minesweeper.

� This OXP works best with the &#39;Thargorn_Threat&#39; OXP. (I have tested it with Thargorn_Threat version 1.5.)


-------
LICENSE
-------

This OXP is released under the Creative Commons Attribution - Non-Commercial - Share Alike 3.0 license.

This work is licensed under the Creative Commons Attribution-NonCommercial-ShareAlike License. To view a copy of this license, visit http://creativecommons.org/licenses/by-nc-sa/2.0/ or send a letter to Creative Commons, 559 Nathan Abbott Way, Stanford, California 94305, USA. 

You are free:

� to copy, distribute, display, and perform the work;
� to make derivative works. 

But only under the following conditions.

� Attribution: you must give the original author credit. 
� Non-commercial use: you may not use this work for commercial purposes. 
� Share Alike: if you alter, transform, or build upon this work, you may distribute the resulting work only under a license materially identical to this one. 

Your fair use right and other rights are in no way affected by the above.

----------------
ACKNOWLEDGEMENTS
----------------

This OXP derives in considerable part from the Thargoid Threat OXP. That OXP was created by &#39;Arexack_Heretic&#39; and modified by Eric Walch, who himself in so doing drew upon a version of the &#39;freaky thargoid shader&#39; by Ahruman. The Thargoid Threat OXP contains this statement: &#39;Created under Creative Commons Licence, as expansion on Oolite, created by Giles Williams (Aegidian). Look the relevant stuff up at http://oolite.aegidian.org. In short however; anyone is welcome to expand to or use parts of this OXP as long as credit is given where due, and as long as not in any commercial enterprise.&#39; I am happy to give that credit!

The &#39;displacement&#39; code in one of my scripts owes to Thargoid&#39;s Armoury OXP.

The displacement sound is an OGG conversion of &#39;stk-DM300_18.wav&#39;, which is a sound provided, under the Creative Commons License and via www.freesound.org/, by user &#39;stk&#39;.

Other materials are adapted from stuff built-in to Oolite. For the license for Oolite itself, see the OoliteReadMe.pdf file included with that program.

My thanks to the following for help with debugging and for ideas (though probably I omit some people here, by accident): cag; Fleurghber; Milo; Nite Owl; Staer9.


----------------- END ----------------- </pre>
        </a>

        <a name="equipment">          
        <h2>Equipment</h2>
            This expansion declares no equipment. This may be related to warnings.
        </a>

        <a name="ships">    
        <h2>Ships</h2>
            <table>
                <tr>
                    <th>Name</th>
                </tr>
                <tr>
                    <td><a href="../ships/extraThargoids_TCAT_droneAndControllerOVERRIDE.html">extraThargoids_TCAT_droneAndControllerOVERRIDE</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/extraThargoids_UberTurret.html">Thargoid Uberbuggly Turret</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/extraThargoids_buggly1.html">Thargoid Gruntbuggly</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/extraThargoids_buggly1b.html">extraThargoids_buggly1b</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/extraThargoids_buggly2.html">extraThargoids_buggly2</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/extraThargoids_buggly2b.html">extraThargoids_buggly2b</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/extraThargoids_buggly3.html">Thargoid Gruntbuggly</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/extraThargoids_bugglyTurret.html">Thargoid Gruntbuggly Ball Turret</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/extraThargoids_exploding_causedByPlayer.html">extraThargoids_exploding_causedByPlayer</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/extraThargoids_exploding_notCausedByPlayer.html">Thargoid Gruntbuggly</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/extraThargoids_frigatePoet.html">Terroriser Frigate (anti-poet variant)</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/extraThargoids_lurker.html">Thargoid Warship</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/extraThargoids_missile.html">Thargoid missile</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/extraThargoids_poetTurret.html">Poet Ball Turret</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/extraThargoids_satellite.html">extraThargoids_satellite</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/extraThargoids_sweeper.html">Thargoid mine sweeper</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/extraThargoids_tharglet.html">extraThargoids_tharglet</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/extraThargoids_uberBuggly.html">Thargoid UberBuggly</a></td>
                </tr>
            </table>
        </a>

        <a name="models">    
        <h2>Models</h2>
            This expansion declares no models. This may be related to warnings.
        </a>

        <a name="scripts">    
        <h2>Scripts</h2>
            <table>
                <tr>
                    <th>Path</th>
                </tr>
                <tr>
                    <td valign="top">Scripts/extraThargoids_buggly.js</td>
                    <td><pre>/*
========================================================================
extraThargoids_buggly.js

This file is part of the ExtraThargoids expansion pack.
Author: UK_Eliter
License: 2017 Creative Commons: attribution, non-commercial, sharealike.
========================================================================

*/

/*
-------------------
JSLINT: set options
-------------------
*/

/*jshint esversion: 6*/
/*jshint sub:true*/


this.name = &quot;extraThargoids_buggly&quot;;
this.author = &quot;UK_Eliter&quot;;
this.copyright = &quot;2014 Creative Commons: attribution, non-commercial, sharealike.&quot;;
this.licence = &quot;CC-NC-SA 3&quot;;
this.description = &quot;Script for the &#39;Gruntbuggly&#39; Thargon ships&quot;;


/*
-----------------------------------------------------------------------
Corresponding AIs:

	- extraThargoids_bugglyAI.plist (which sends no messages to script)

	- extraThargoids_kamikazeAI
-----------------------------------------------------------------------
*/



/*
------------------
DEBUGGING SWITCHES
------------------
*/

// this.logging = true;
var consoleDebugMessages = false; // do NOT comment this out. Rather, to disable, set to false.


/*
------
SOUNDS
------
*/

var mysound_Warning = new SoundSource();
mysound_Warning.sound = &quot;warning.ogg&quot;;
//	This sound is built-in to Oolite - and does not need to be declared in the &#39;customsounds&#39; file.


/*
------------------------
JSHINT: start of wrapper
------------------------
*/

(function() {
	&quot;use strict&quot;;


	/*
	--------------
	EVENT HANDLERS
	--------------
	*/

	this.shipSpawned = function() {
		// set timer to check for stun bomb from Armoury OXP - and give some buggly models missiles
		if (worldScripts[&quot;armoury_machineScript.js&quot;]) {
			this.checkStun = new Timer(this, this.$checkStunTimed, 12, 12);
		}
		delete this.shipSpawned;
	};

	this.shipDied = this.entityDestroyed = this.playerWillEnterWitchspace = function() {
		this.$deleteTimers();
	};

	this.shipTakingDamage = function(amount, whom, type) {
		if ((amount &lt; 50) &amp;&amp; (this.ship.energy &gt; 19)) {
			return;
		}
		var chance;
		if (amount &gt; 49) {
			if (this.ship.energy &lt; 20) {
				chance = 0.5;
			} else {
				chance = 0.1;
			}
		} else {
			chance = 0.2; // this will mean both (this.ship.energy &lt; 20) AND NOT (amount &gt; 49)
		}
		if (this.ship.target &amp;&amp; this.ship.target.isValid) {
			this.distanceToTarget = this.ship.position.distanceTo(this.ship.target);
			if (this.distanceToTarget &lt; 650) {
				chance += 0.67;
			} else {
				if (this.distanceToTarget &lt; 1000) {
					chance += 0.55;
				} else if (this.distanceToTarget &lt; 3000) {
						chance += 0.3;
				}
			}
		}
		if (Math.random() &lt; chance) {
			this.ship.energy += 100 + amount; // stop it blowing up normally 
			if (whom &amp;&amp; whom.isPlayer) {
				this.$explode_causedByPlayer();
			} else {
				this.explode_notCausedByPlayer();
			}
		}
	};

	this.shipTargetCloaked = function() {
		if (this.decloakTargetTimer &amp;&amp; this.decloakTargetTimer.isRunning) {
			return;
		}
		if (this.ship.target.isThargoid) {
			return;
		}
		var r = Math.random();
		if (r &lt; 0.16) {
			return;
		}
		if (r &gt; 0.75) {
			this.ship.commsMessage(expandDescription(&quot;[thargoid_curses]&quot;));
		}
		this.ship.cloakedTarget = this.ship.target;
		var seconds = 0.5 + ~~(Math.random() * 8);
		if (this.decloakTargetTimer) {
			delete this.decloakTargetTimer;
		}
		this.decloakTargetTimer = new Timer(this, this.$decloakTargetTimed, seconds);
	};


	/*
	---------------------------------------------------
	ROUTINES CALLED BY EVENT HANDLERS
	or called by the routines called by event handlers.
	---------------------------------------------------
	*/

	this.explode_notCausedByPlayer = function() {
		this.$deleteTimers();
		if (!this.ship) {
			return;
		}
		this.explodingShip = this.ship.spawnOne(&quot;extraThargoids_exploding_notCausedByPlayer&quot;);
		this.explodingShip.newBounty = this.ship.bounty;
		this.explodingShip.bounty = this.ship.bounty;
		this.explodingShip.orientation = this.ship.orientation;
		this.explodingShip.position = this.ship.position;
		if (Math.random() &lt; 0.4) {
			this.ship.commsMessage(&quot;We boom your bases!&quot;);
		}
		if (!this.ship) {
			return;
		}
		this.ship.remove(true);
	};

	this.$explode_causedByPlayer = function() {
		this.$deleteTimers();
		if (!this.ship) {
			return;
		}
		if (Math.random() &lt; 0.7) {
			this.ship.commsMessage(&quot;We boom your bases!&quot;);
		}
		this.explodingShip = this.ship.spawnOne(&quot;extraThargoids_exploding_causedByPlayer&quot;);
		this.explodingShip.newBounty = this.ship.bounty;
		this.explodingShip.bounty = this.ship.bounty;
		this.explodingShip.orientation = this.ship.orientation;
		this.explodingShip.position = this.ship.position;
		if (!this.ship) {
			return;
		}
		this.ship.remove(true);
	};

	this.$decloakTargetTimed = function $decloakTargetTimed() {
		this.decloakTargetTimer.stop();
		if (!this.ship || !this.ship.isValid) {
			delete this.decloakTargetTimer;
			return;
		}
		if (!this.ship.cloakedTarget || !this.ship.cloakedTarget.isValid) {
			delete this.decloakTargetTimer;
			return;
		}
		if (!this.ship.cloakedTarget.isCloaked) {
			delete this.decloakTargetTimer;
			return;
		}
		this.distanceToTarget = this.ship.position.distanceTo(this.ship.cloakedTarget);
		if (this.distanceToTarget &lt; 10000) {
			mysound_Warning.play();
			this.ship.cloakedTarget.lightsActive = true;
			if (Math.random() &gt; 0.91) {
				this.ship.cloakedTarget.setEquipmentStatus(&quot;EQ_CLOAKING_DEVICE&quot;, &quot;EQUIPMENT_DAMAGED&quot;);
				if (this.ship.cloakedTarget.isPlayer &amp;&amp; !player.ship) {
					delete this.decloakTargetTimer;
					return;
				}
				this.ship.commsMessage(&quot;CLOAKING DEVICE DAMAGED!&quot;, this.ship.cloakedTarget);
			} else {
				player.consoleMessage(&quot;CLOAKING FAILURE!&quot;, 10);
				player.ship.isCloaked = false;
				this.ship.target = this.ship.cloakedTarget;
				this.ship.reactToAIMessage(&quot;ATTACK_SHIP&quot;);
			}
		}
		if (Math.random() &lt; 0.25) {
			this.ship.commsMessage(expandDescription(&quot;[thargoid_curses]&quot;));
		}
		delete this.decloakTargetTimer;
	};


	this.$checkStunTimed = function $checkStunTimed() {
		if (this.ship.AIState == &quot;STUNNED&quot;) {
			this.ship.exitAI();
			this.explode_notCausedByPlayer();
		}
	};

	this.$deleteTimers = function() {
		if (this.decloakTargetTimer) {
			if (this.decloakTargetTimer.isRunning) {
				this.decloakTargetTimer.stop();
			}
			delete this.decloakTargetTimer;
		}
		if (this.checkStunTimed) {
			if (this.checkStunTimed.isRunning) {
				this.checkStunTimed.stop();
			}
			delete this.checkStunTimed;
		}
	};


	/*
	--------------------------------------------------------------------------
	CALLED BY AI
	These routines are called by this AI: 
	extraThargoids_kamikazeAI (which itself is invoked, only, by the shipdata)
	--------------------------------------------------------------------------
	*/

	this.$_seekPrimaryTarget = function() {
		if (!this.ship) {
			return;
		}
		var primaryTargetsArray = system.shipsWithRole(&quot;behemoth&quot;, this.ship, 25600);
		if (primaryTargetsArray.length &gt; 0) {
			this.ship.target = primaryTargetsArray[0];
			this.ship.reactToAIMessage(&quot;TARGET_FOUND&quot;);
			return;
		}
		primaryTargetsArray = system.shipsWithRole(&quot;leviathan&quot;, this.ship, 25600);
		if (primaryTargetsArray.length &gt; 0) {
			this.ship.target = primaryTargetsArray[0];
			this.ship.reactToAIMessage(&quot;TARGET_FOUND&quot;);
			return;
		}
		primaryTargetsArray = system.shipsWithRole(&quot;patrol-frigate&quot;, this.ship, 25600);
		if (primaryTargetsArray.length &gt; 0) {
			this.ship.target = primaryTargetsArray[0];
			this.ship.reactToAIMessage(&quot;TARGET_FOUND&quot;);
			return;
		}
		primaryTargetsArray = system.shipsWithRole(&quot;navy-frigate&quot;, this.ship, 25600);
		if (primaryTargetsArray.length &gt; 0) {
			this.ship.target = primaryTargetsArray[0];
			this.ship.reactToAIMessage(&quot;TARGET_FOUND&quot;);
		} else {
			this.ship.reactToAIMessage(&quot;NO_PRIMARY&quot;);
		}
	};

	this.$_rangeAchieved = function() {
		if (!this.ship || !this.ship.isValid) {
			return;
		}
		// else
		this.explode_notCausedByPlayer();
		var explosiveBits = this.ship.spawn(&quot;explosive_shrapnel&quot;, 5);
	};


	/*
	----------------------
	JSLINT: end of wrapper
	----------------------
	*/

}).call(this);

// EOF</pre></td>
                </tr>
                <tr>
                    <td valign="top">Scripts/extraThargoids_exploding_generic.js</td>
                    <td><pre>/*
========================================================================
extraThargoids_exploding_generic.js

This file is part of the ExtraThargoids expansion pack.
Author: UK_Eliter
License: 2017 Creative Commons: attribution, non-commercial, sharealike.
========================================================================
*/

/*
-------------------
JSLINT: set options
-------------------
*/

/*jshint esversion: 6*/
/*jshint sub:true*/


this.name = &quot;extraThargoids_exploding_generic&quot;;
this.author = &quot;UK_Eliter&quot;;
this.copyright = &quot;2014 Creative Commons: attribution, non-commercial, sharealike.&quot;;
this.licence = &quot;CC-NC-SA 3&quot;;
this.description = &quot;Script for exploding &#39;Gruntbuggly&#39; Thargon ships&quot;;



/*
------------------------------------------------------
CORRESPONDING AIs:
  
  	- extraThargoids_exploding_causedByPlayerAI.plist
	- extraThargoids_exploding_notCausedByPlayerAI.plist
------------------------------------------------------


/*
------------------
DEBUGGING SWITCHES
------------------
*/

// this.logging = true; // THIS SHOULD BE COMMENTED OUT WHEN NOT TESTING
// this.ship.reportAIMessages = true; // if set to true, continuously dumps AI stuff to log - and produces vector lines.
// var consoleDebugMessages = false;


/*
------
SOUNDS
------
*/

this.bigBang = new SoundSource();
this.bigBang.sound = &quot;bigbang.ogg&quot;;

this.mediumBang = new SoundSource();
this.mediumBang.sound = &quot;extraThargoids_mediumBang.ogg&quot;;

this.quietBang = new SoundSource();
this.quietBang.sound = &quot;extraThargoids_quietBang.ogg&quot;;


/*
------------------------
JSLINT: start of wrapper
------------------------
*/

(function() {
	&quot;use strict&quot;;


	/*
	--------------
	EVENT HANDLERS
	--------------
	*/

	this.shipDied = this.entityDestroyed = function() {
		var frags = this.ship.spawn(&quot;explosive_shrapnel&quot;, 3);
	};


	/*
	-------------
	CALLED BY AIs
	-------------
	*/

	this.$_bountyHack = function() {
		if (this.ship.isValid &amp;&amp; this.ship.newBounty &amp;&amp; (this.ship.newBounty &gt; 0)) {
			this.ship.bounty = this.ship.newBounty;
		}
	};

	this.$_explode_core = function() {
		this.ship.dealEnergyDamage(980, 1750);
		// SYNTAX: function dealEnergyDamage(damage : Number, idealRange : Number [, velocityBias : Number])
		this.$bangSoundEffect();
	};

	this.$_explode_notCausedByPlayer = function() {
		this.$_explode_core();
	};

	this.$_explode_causedByPlayer = function() {
		var bounty;
		this.$_explode_core();
		player.score += 1;
		if (!this.ship.isValid || !this.ship || this.ship.bounty == 0) {
			bounty = 200;
		} else {
			bounty = this.ship.bounty;
		}
		var string = &quot;Bounty: &quot; + bounty;
		player.consoleMessage(string, 6);
		player.credits += bounty;
		if (player.ship.isValid &amp;&amp; Math.random() &lt; 0.15) {
			string = &quot;The navy has awarded a 500 credit bonus!&quot;;
			player.consoleMessage(string, 8);
			player.credits += 500;
		}
	};


	/*
	-----
	OTHER
	-----
	*/

	this.$bangSoundEffect = function() {
		if (!this.ship || !this.ship.position || !player.ship.position) {
			return;
		}
		var ps = player.ship; // for speed, but changes won&#39;t affect the original variable
		if (this.ship.position.distanceTo(ps.position) &lt; 2000) {
			this.bigBang.play(); // this one really is VERY loud, so only use for VERY close
			return;
		}
		if (this.ship.position.distanceTo(ps.position) &lt; 15000) {
			this.mediumBang.play();
			return;
		}
		if (this.ship.position.distanceTo(ps.position) &lt; 27000) {
			this.quietBang.play();
		}
	};


	/*
	-----------------------
	JSHINT: end of wrapper
	----------------------
	*/

}).call(this);

// EOF</pre></td>
                </tr>
                <tr>
                    <td valign="top">Scripts/extraThargoids_frigatePoet.js</td>
                    <td><pre>/*
========================================================================
extraThargoids_frigatePoet.js

This file is part of the ExtraThargoids expansion pack.
Author: UK_Eliter
License: 2017 Creative Commons: attribution, non-commercial, sharealike.
========================================================================
*/

/*
-------------------
JSLINT: set options
-------------------
*/

/*jshint esversion: 6*/
/*jshint sub:true*/


this.name = &quot;extraThargoids_frigatePoet&quot;;
this.author = &quot;UK_Eliter&quot;;
this.copyright = &quot;2014 Creative Commons: attribution, non-commercial, sharealike.&quot;;
this.licence = &quot;CC-NC-SA 3&quot;;
this.description = &quot;extraThargoids_frigatePoet&quot;;

// NB: There is no special AI - but rather an inbuilt one - corresponding to this script.


/*
-------------
VARIABLES etc
-------------
*/

this.displace = new SoundSource();
this.displace.sound = &quot;extraThargoids_displacement.ogg&quot;;

this.quietDisplace = new SoundSource();
this.quietDisplace.sound = &quot;[extraThargods_displacementQuiet.ogg]&quot;;

this.warning = new SoundSource();
this.warning.sound = &quot;warning.ogg&quot;; // this sound built-in to Oolite - and does not need to be declared in the &#39;customsounds&#39; file.


/*
------------------------
JSHINT: start of wrapper
------------------------
*/

(function() {
	&quot;use strict&quot;;


	/*
	--------------
	EVENT HANDLERS
	--------------
	*/

	this.shipSpawned = function() {
		this.canDisplaceCurrently = true;
		delete this.shipSpawned;
	};

	this.shipDied = this.entityDestroyed = this.playerWillEnterWitchspace = function() {
		this.$cleanUp();
	};

	this.shipAttackedWithMissile = function() // run by oolite core itself {
	{
		if (Math.random() &gt; 0.7) {
			return;
		}
		this.ship.isCloaked = true;
		// but if can&#39;t cloak . .
		if (this.ship.isCloaked === false) {
			this.$displace();
		}
	};

	this.shipTargetCloaked = function() {
		if (Math.random() &gt; 0.82) {
			this.$displace();
		}
		if (this.ship.target) {
			this.ship.target = null;
		}
	};

	this.shipEnergyIsLow = function() {
		if (Math.random() &gt; 0.13) {
			this.ship.isCloaked = false;
			this.$displace();
		}
	};


	/*
	-----
	OTHER
	-----
	*/

	// Following code includes parts adapted from Thargoid&#39;s armoury_displacerMissile.js script in his Armoury OXP.

	this.$displace = function() {
		if (this.canDisplaceCurrently === false || !this.ship) {
			return;
		}
		if (this.ship.fuel &lt; 4) {
			this.canDisplaceCurrently = false;
			return;
		}
		this.canDisplaceCurrently = false;
		if (this.timerToReenableDisplace) {
			if (this.timerToReenableDisplace.isRunning) {
				this.timerToReenableDisplace.stop(); // should never happen
			}
			delete this.timerToReenableDisplace;
		}
		if (!player.ship.position) {
			return;
		}
		var ps = player.ship; // for speed, but changes won&#39;t affect the original variable
		var xDistance = ((Math.random() * 2) - 1) * 8600;
		var yDistance = ((Math.random() * 2) - 1) * 8600;
		var zDistance = ((Math.random() * 2) - 1) * 8600;
		this.ship.position = this.ship.position.add([xDistance, yDistance, zDistance]);
		if (Math.random() &lt; 0.7) {
			this.ship.commsMessage(expandDescription(&quot;[thargoid_curses]&quot;), ps);
		}
		var shipDistanceToDisplacedShip = this.ship.position.distanceTo(ps.position); // would be good to alter the following to occur to ANY ship within the specified range . .
		var displacementChance = 0;
		this.ship.position = this.ship.position.add([xDistance, yDistance, zDistance]);
		this.ship.isCloaked = false;
		if (shipDistanceToDisplacedShip &lt; 1200) {
			if (shipDistanceToDisplacedShip &lt; 500) {
				displacementChance = 0.5;
			} else {
				displacementChance = 0.2;
			}
		}
		if (shipDistanceToDisplacedShip &lt; 12000) {
			this.displace.play();
		} else if (shipDistanceToDisplacedShip &lt; 18000) {
			this.quietDisplace.play();
		}
		this.ship.fuel -= (Math.ceil(Math.random() * 5)); // drain off some fuel to simulate the jump
		if (this.ship.target) {
			if (Math.random() &lt; 0.5) {
				this.ship.target = null;
			}
		}
		if (Math.random() &lt;= displacementChance) {
			player.ship.position = player.ship.position.add([xDistance, yDistance, zDistance]);
			this.warning.play();
			player.consoleMessage(&quot;EMERGENCY - position changed by nearby displacement device&quot;, 6);
			if (Math.random() &lt; 0.1) {
				player.ship.scriptedMisjump = true;
				player.ship.scriptedMisjumpRange = r;
			}
		}
		var t = 8 + Math.ceil(Math.random() * 6);
		this.timerToReenableDisplace = new Timer(this, this.$reenableDisplace, t);
	};

	this.$reenableDisplace = function $reenableDisplace() {
		this.canDisplaceCurrently = true;
	};

	this.$cleanUp = function() {
		this.canDisplaceCurrently = true;
		if (this.timerToReenableDisplace) {
			if (this.timerToReenableDisplace.isRunning) {
				this.timerToReenableDisplace.stop();
			}
			delete this.timerToReenableDisplace;
		}
	};


	/*
	----------------------
	JSLINT: end of wrapper
	----------------------
	*/

}).call(this);

// EOF</pre></td>
                </tr>
                <tr>
                    <td valign="top">Scripts/extraThargoids_populator.js</td>
                    <td><pre>/*
========================================================================
extraThargoids_populator.js

This file is part of the ExtraThargoids expansion pack.
Author: UK_Eliter
License: 2017 Creative Commons: attribution, non-commercial, sharealike.
========================================================================
*/


/*
-------------------
JSLINT: set options
-------------------
*/

/*jshint esversion: 6*/
/*jshint sub:true*/

this.name = &quot;extraThargoids_populator&quot;;
this.author = &quot;UK_Eliter&quot;;
this.copyright = &quot;2014 Creative Commons: attribution, non-commercial, sharealike.&quot;;
this.licence = &quot;CC-NC-SA 3&quot;;
this.description = &quot;This script adds some of the &#39;Extra Thargoids&#39; to the game&quot;;


/*
--------
SWITCHES
--------
*/

this.logging = false; // NB: Most log lines are commented out at present.


/*
----------------
GLOBAL VARIABLES
----------------
*/

this.invasionChance = 0.003;
// 0.003. Increased somewhat by player score . . - see this.startUp.


/*
------------------------
JSHINT: start of wrapper
------------------------
*/

(function() {
	&quot;use strict&quot;;


	/*
	---------
	MAIN CODE
	---------
	*/

	this.startUp = function() {
		this.threeG_Installed = (worldScripts.ferdelance3G_populator !== undefined);
		var score = player.score;
		if (score &gt; 7000) {
			if (score &gt; 19200) {
				this.invasionChance += 0.0035;
			} else {
				this.invasionChance += 0.0025;
			} // &#39;Elite&#39; score is 6400.
		}
		this.invasionExtantInCurrentSystem = false;
		// log(&quot;Extra Thargoids&quot;, &quot;Initialised OK&quot;);
	};

	this.playerWillEnterWitchspace = function() {
		if (this.invasionExtantInCurrentSystem || this.invasionChance === 0 || player.score &lt; 1500 || Math.random() &gt; this.invasionChance) {
			this.invasionExtantInCurrentSystem = false;
		} else {
			this.repopulationsCounter = 0;
			this.invasionExtantInCurrentSystem = true; // well, will occur in the NEXT system.
			this.maxRepopulations = 40 + Math.ceil(Math.random() * 100);
			this.repopulationsCounter = 0;
		}
		// this.invasionExtantInCurrentSystem = true; // TEST
	};

	this.entityDestroyed = function() {
		this.invasionExtantInCurrentSystem = false;
	};

	this.interstellarSpaceWillPopulate = function() {
		// INTERSTELLAR POPULATOR
		// Use &#39;callback: this._myFunction.bind(this)&#39; not callback: this._myFunction&#39; in order to use global variables and functions.
		// if two populator entries have same &#39;priority&#39;, Oolite will randomly determine their order.
		// if (Math.random() &gt; 0.86) {return;}
		// ADD THARGOIDS
		system.setPopulator(&quot;extraThargs-interstellarThargoids&quot;, {
			priority: 101,
			callback: this._perhapsAddInterstellarThargoids.bind(this)
		});
	};

	this._perhapsAddInterstellarThargoids = function(pos) {
		//
		// log(&quot;extraThargoids_populator.js&quot;, &quot;One or more Thargoid(s) added to interstellar space by populator script.&quot;);
		var n;
		if (player.score &gt; 3750) {
			n = 36;
		} else {
			n = 40;
		}
		var c = Math.ceil(Math.random() * n);
		var s;
		switch (c) {
			case 1:
				s = system.addShips(&quot;extraThargoid&quot;, 1, pos, 27000);
				break;
			case 2:
				s = system.addShips(&quot;extraThargoid&quot;, 1, pos, 27000);
				break;
			case 3:
				s = system.addShips(&quot;extraThargoid&quot;, 2, pos, 27000);
				break;
			case 4:
				s = system.addShips(&quot;extraThargoid&quot;, 3, pos, 30000);
				break;
			case 5:
				s = system.addShips(&quot;extraThargoids_buggly3&quot;, 3, pos, 15000);
				break;
			case 6:
				s = system.addShips(&quot;extraThargoid&quot;, 2, pos, 60000);
				break;
			case 7:
				s = system.addShips(&quot;extraThargoid&quot;, 2, pos, 27000); /* falls through */
			case 8:
				s = system.addShips(&quot;extraThargoids_buggly2&quot;, 1, pos, 27000);
				break;
			case 9:
				s = system.addShips(&quot;extraThargoids_sweeper&quot;, 1, pos, 20000);
				break;
			case 10:
				s = system.addShips(&quot;extraThargoids_sweeper&quot;, 1, pos, 25000);
				break;
			case 11:
				s = system.addShips(&quot;extraThargoids_sweeper&quot;, 1, pos, 28000);
				break;
			case 12:
				s = system.addShips(&quot;extraThargoids_sweeper&quot;, 2, pos, 40000);
				break;
			default:
		}
	};

	// INTERSTELLAR REPOPULATOR - NONE
	/*
	this.interstellarSpaceWillRepopulate = function()
	{
	}
	*/

	this.systemWillPopulate = function() {
		// STELLAR POPULATOR

		// LANE_PS, LANE_WP, LANE_WS, STATION_AEGIS, PLANET_ORBIT, OUTER_SYSTEM, OUTER_SYSTEM_OFFPLANE

		// INVASION stuff
		// Use &#39;callback: this._myFunction.bind(this)&#39; not callback: this._myFunction&#39; in order to use global variables and functions
		if (this.invasionExtantInCurrentSystem === false) {
			return;
		} // Else - INVASION
		// Add thargoids and other ships
		system.setPopulator(&quot;extraThargs-invasionShips&quot;, {
			groupCount: 1,
			priority: 100,
			location: &quot;LANE_WP&quot;,
			callback: this._addInvasionEntities.bind(this)
		});
		if (Math.random() &gt; 0.8) {
			return;
		}
		var gc = 1;
		if (Math.random() &lt; 0.3) {
			gc += 1;
		}
		system.setPopulator(&quot;extraThargs-invasionShips_More&quot;, {
			groupCount: gc,
			priority: 101,
			location: &quot;LANE_WPS&quot;,
			callback: this._addInvasionEntities.bind(this)
		});
	};

	this.shipWillExitWitchspace = function() {
		if (!this.invasionExtantInCurrentSystem) {
			return;
		}
		// Under certain conditions, cancel it. (And can&#39;t do this earlier, i.e. not initiate in the first place, because of technical problems. .
		// Or, rather, because cannot cancel in sense of undo the population function, just try to make sure all ships I&#39;ve added leave.
		if (system.isInterstellarSpace) {
			this.invasionExtantInCurrentSystem = false;
			return;
			// This will not actually cancel anything, because interstellar - rather than stellar - populator will have been called.
		}
		// Else
		if (system.sun.isGoingNova || system.sun.hasGoneNova) {
			system.sendAllShipsAway();
			this.invasionExtantInCurrentSystem = false;
			return;
		}
		// Else
		//
		// Remove some existing ships - try to do this as late as possible
		this.$removeShipsEtcForInvasion();
	};

	this.shipExitedWitchspace = function() {
		if (this.invasionExtantInCurrentSystem) {
			// this.invasionExtantInCurrentSystem will have been set to false if we are in interstellar space.
			player.consoleMessage(&quot;** POLICE ALERT **: Thargoid invasion!&quot;, 300);
		}
		// var s = system.addShips(&quot;extraThargoids_uberBuggly&quot;, 1, [0,0,0], 22000); // TEST
	};

	this.$is_a_targettedNonMainStation = function(e) {
		return e.isStation &amp;&amp; e.scanClass === &quot;CLASS_STATION&quot; &amp;&amp; (e.position.distanceTo(system.mainPlanet.position) &lt; system.mainPlanet.radius * 13);
	};

	this.$isWitchpointBuoy = function(e) {
		return e.isShip &amp;&amp; e.scanClass === &quot;CLASS_BUOY&quot; &amp;&amp; e.hasRole(&quot;buoy-witchpoint&quot;) &amp;&amp; (e.position.distanceTo(system.mainPlanet.position) &lt; system.mainPlanet.radius * 50);
	};

	this.$removeShipsEtcForInvasion = function() {
		// Some populators might add stuff *after* this, so err on removing too much
		var i, l, f, r, s;

		// Stations
		s = system.filteredEntities(this, this.$is_a_targettedNonMainStation, system.mainStation);
		for (i = 0; i &lt; s.length; i++) {
			r = Math.random();
			if (r &lt; 0.5) {
				if (r &lt; 0.4) {
					s[i].explode();
				} else {
					s[i].remove(true); // no death action
				}
			}
		}
		// Buoys
		s = system.filteredEntities(this, this.$isWitchpointBuoy);
		l = s.length;
		if (l &gt; 0) {
			i = s.length;
			while (i--) {
				if (Math.random() &lt; 0.6) {
					s[i].remove(true);
				}
			}
		}
		// Neutral ships
		s = system.entitiesWithScanClass(&quot;CLASS_NEUTRAL&quot;);
		l = s.length;
		if (l &gt; 9) {
			if (Math.random() &lt; 0.6) {
				f = 0.9;
			} else {
				f = 0.75;
			}
			// NB: The following will run before various (old-style) OXP populators
			l = Math.ceil(s.length * f);
			i = l;
			while (l--) {
				if (
					(s[i].isValid) &amp;&amp;
					s[i].isShip &amp;&amp;
					!s[i].isPlayer &amp;&amp;
					s[i].primaryRole !== &quot;hunter-medium&quot; &amp;&amp;
					s[i].primaryRole !== &quot;hunter-heavy&quot; &amp;&amp;
					!s[i].hasRole(&quot;ecl_escape_pod_beacon&quot;) &amp;&amp;
					!s[i].hasRole(&quot;escape-capsule&quot;) &amp;&amp;
					!s[i].hasRole(&quot;hiredGuns_escort&quot;)
				) {
					if ((i % 3 === 0) &amp;&amp; (s[i].distanceToPlayer &gt; 30000) &amp;&amp; (s[i].distanceToPlayer &lt; 3072000)) {
						if (s[i].abandonShip === true) {
							s[i].energy = (s[i].energy * f) - 100 - i;
						} else if (i % 6 === 0) {
							s[i].explode();
						} else {
							s[i].remove(true);
						}
					}
				}
			}
		}
		// Remove some rocks
		s = system.entitiesWithScanClass(&quot;CLASS_ROCK&quot;, player.ship, 3072000);
		if (s.length &lt; 1) {
			return;
		}
		l = Math.ceil(s.length * 0.35);
		i = l;
		while (i--) {
			if (s[i].isValid) {
				if ((i % 2 === 0) &amp;&amp; (s[i].distanceToPlayer &gt; 30000)) {
					s[i].explode();
				} else {
					s[i].remove(true); // no death action
				}
			}
		}
	};

	this._addInvasionEntities = function(pos) {
		var baseThargoidNum, basePoliceNum, i, n, n2, r, s;

		// THARGOIDS
		if (player.score &lt; 5000) {
			baseThargoidNum = 18;
		} else {
			baseThargoidNum = 23;
		}

		// log(&quot;ET TESTING&quot;, &quot;OK&quot;);

		// Main action - carriers and other ships
		if (this.$roleExists(&quot;thargoidCarrier&quot;) !== undefined &amp;&amp; system.mainStation &amp;&amp; Math.random() &lt; 0.9) {
			n = 1 + Math.ceil(Math.random() * 2);
			if (n === 1 &amp;&amp; Math.random() &lt; 0.5) {
				n++;
			}
			i = n;
			while (i--) {
				s = system.addShips(&quot;thargoid_carrier&quot;, 1, pos, 26000);
				s[0].script.targetStation = system.mainStation;
				s[0].script.destinationCoordinates = system.mainStation.position;
				if (Math.random() &lt; 0.6) {
					s = system.addShips(&quot;extraThargoids_sweeper&quot;, 1, pos, 15000);
				}
			}
			baseThargoidNum -= 5; // if (baseThargoidNum &lt; 10) {baseThargoidNum = 10;}
			if (Math.random() &lt; 0.7) {
				s = system.addShips(&quot;extraThargoids_uberBuggly&quot;, 1, pos, 20000); // has sweeper escorts
				baseThargoidNum -= 1;
			}
		} else if (Math.random() &lt; 0.92) {
			s = system.addShips(&quot;extraThargoids_uberBuggly&quot;, 1, pos, 17000); // has sweeper escorts
			baseThargoidNum -= 2;
			if (Math.random() &lt; 0.57) {
				s = system.addShips(&quot;extraThargoids_uberBuggly&quot;, 1, pos, 20000); // has sweeper escorts
				baseThargoidNum -= 1;
			}
		}
		s = system.addShips(&quot;thargoid&quot;, baseThargoidNum, pos, 20000);
		// Witchspace - planet
		n = Math.ceil(Math.random() * baseThargoidNum);
		s = system.addShipsToRoute(&quot;thargoid&quot;, baseThargoidNum, Math.random(), &quot;wp&quot;);
		// POLICE
		// Main action - normal ships and carriers
		basePoliceNum = baseThargoidNum + 2 + Math.ceil(Math.random() * 4);
		if (Math.random() &lt; 0.7) {
			n = 1 + Math.ceil(Math.random() * 5);
			s = system.addShips(&quot;interceptor&quot;, n, pos, 23000);
			if (s[0] &amp;&amp; s[0].isValid) {
				basePoliceNum--;
			}
		}
		r = Math.random();
		if (r &lt; 0.7) {
			s = system.addShips(&quot;behemoth&quot;, 1, pos, 23000);
			if (r &lt; 0.35) {
				s = system.addShips(&quot;behemoth&quot;, 1, pos, 32000);
			}
			if (s[0] &amp;&amp; s[0].isValid) {
				basePoliceNum -= 2;
			} // have done no check actually are these ships installed
		}
		if (Math.random() &lt; 0.5) {
			s = system.addShips(&quot;leviathan&quot;, 1, pos, 23000);
			basePoliceNum -= 2;
			if (s[0] &amp;&amp; s[0].isValid) {
				basePoliceNum -= 2;
			} // have done no check actually are these ships installed
		}
		if (basePoliceNum &gt; 0) {
			s = system.addShips(&quot;police&quot;, basePoliceNum, pos, 20000);
		}
		// Witchpoint - planet
		if (Math.random() &lt; 0.5) {
			n = 1 + Math.ceil(Math.random() * basePoliceNum);
			s = system.addShipsToRoute(&quot;police&quot;, n, Math.random(), &quot;wp&quot;);
		}
		// HUNTERS
		r = Math.random();
		if (r &lt; 0.25) {
			n = 1 + Math.ceil(Math.random() * 2);
			s = system.addShips(&quot;hunter-medium&quot;, n, pos, 35000);
		}
		if (r &lt; 0.2) {
			n = 1 + Math.ceil(Math.random() * 3);
			s = system.addShips(&quot;hunter-heavy&quot;, n, pos, 30000);
		}
		// WRECKAGE. Note that removal of entities via removeShipsEtcForInvasion will tend to generate some wreckage.
		// At the site of the main action
		n = 1 + Math.ceil(Math.random() * 4);
		s = system.addShips(&quot;alloy&quot;, n, pos, 45000);
		n = 1 + Math.ceil(Math.random() * 9);
		s = system.addShips(&quot;extraThargoids_tharglet&quot;, n, pos, 40000);
		// Witchpoint
		r = Math.random();
		if (r &lt; 0.6) {
			n = 1 + Math.ceil(r * 3);
			s = system.addShips(&quot;alloy&quot;, n, [0, 0, 0], 45000);
			n = 1 + Math.ceil(r * 13);
			s = system.addShips(&quot;extraThargoids_tharglet&quot;, n, [0, 0, 0], 40000);
			if (Math.random() &lt; 0.5) {
				n2 = 1 + Math.ceil(Math.random() * 4);
				s = system.addShips(&quot;cargopod&quot;, n2, [0, 0, 0], 4000);
			}
		}
		// Witchpoint - planet
		n = 1 + Math.ceil(Math.random() * 7);
		i = n;
		while (i--) {
			n2 = 1 + Math.ceil(Math.random() * 4);
			s = system.addShipsToRoute(&quot;cargopod&quot;, n2, Math.random(), &quot;wp&quot;);
		}
		n = 1 + Math.ceil(Math.random() * 4);
		i = n;
		while (i--) {
			n2 = 1 + Math.ceil(Math.random() * 4);
			s = system.addShipsToRoute(&quot;extraThargoids_tharglet&quot;, n2, Math.random(), &quot;wp&quot;);
			if (Math.random() &lt; 0.3) {
				s = system.addShipsToRoute(&quot;alloy&quot;, 1, r, &quot;wp&quot;);
			}
		}
		s = system.addShipsToRoute(&quot;extraThargoids_tharglet&quot;, n, Math.random(), &quot;wp&quot;);
	};

	this.systemWillRepopulate = function() {
		// It is important for smooth gameplay that this function runs very quickly. If calculations are needed, run as many as possible in the populator function to save the result.
		// &#39;systemWillRepopulate&#39; does *not* use system.setPopulator 

		if (this.invasionExtantInCurrentSystem === false) {
			return;
		}
		// THE FOLLOWING ONLY RUNS *WHEN IS AN INVASION*
		if (this.repopulationsCounter &gt; this.maxRepopulations) {
			return;
		}
		// Else
		this.repopulationsCounter++;
		if (Math.random() &gt; 0.04) {
			return;
		}
		// Else
		var i, g, n, s, s2;
		// Perhaps add police
		if (Math.random() &lt; 0.45) {
			n = system.countShipsWithRole(&quot;police&quot;);
			if (n &gt; 50) {
				return;
			}
			// Else
			n = 3 + Math.ceil(Math.random() * 8);
			if (this.threeG_Installed &amp;&amp; r &lt; 0.015) {
				s = system.addShips(&quot;ferdelance3G_interstellar&quot;, n);
				i = s.length;
				while (i--) {
					s[i].ai.switchAI(&quot;route1patrolAI.plist&quot;);
					// Need to set AI to stop them trying to go interstellar
				}
			} else {
				s = system.addShips(&quot;police&quot;, n);
			}
			return;
		}
		// perhaps add thargoids
		if (Math.random() &lt; 0.35) {
			n = system.countShipsWithRole(&quot;thargoid&quot;);
			if (n &gt; 150) {
				return;
			}
			n = 2 + Math.ceil(Math.random() * 30);
			s = system.addShips(&quot;thargoid&quot;, n);
			return;
		}
		// Else, add hunters
		s = system.addShips(&quot;hunter-heavy&quot;, 1);
		if (s[0]) {
			g = new ShipGroup(&quot;hunter group vs invasion&quot;, s[0]);
			s[0].group = g;
			log(&quot;ET TESTING&quot;, &quot;add hunter-heavy(&quot; + g.name + &quot;) to ...&quot;);
			// TODO: Set weapons, skill, AI
			if (s[0].autoAI) {
				s[0].switchAI(&quot;oolite-bountyHunterLeaderAI.js&quot;);
			}
			n = 2 + Math.ceil(Math.random() * 5);
			s2 = system.addShips(&quot;hunter&quot;, n);
			for (i = 0; i &lt; n; i++) {
				s2[i].group = g;
				g.addShip(s2[i]);
				// s2[i].setAI(&quot;oolite-bountyHunterAI.js&quot;); // autoAI
			}
			// log(&quot;ET TESTING&quot;, &quot;added &quot;+n+&quot; hunters(&quot;+g.name+&quot;) to ...&quot;);
		}
	};

	this.$roleExists = function(roleString) {
		var dummyShips = system.addShips(roleString, 1, [100000, 100000, 100000]);
		if (dummyShips == null) {
			return false;
		}
		var exists = (dummyShips.length == 1);
		if (exists) dummyShips[0].remove(true);
		return exists;
	};


	/*
	----------------------
	JSHINT: end of wrapper
	----------------------
	*/

}).call(this);

// EOF</pre></td>
                </tr>
                <tr>
                    <td valign="top">Scripts/extraThargoids_sweeper.js</td>
                    <td><pre>/*
========================================================================
extraThargoids_sweeper.js

This file is part of the ExtraThargoids expansion pack.
Author: UK_Eliter
License: 2017 Creative Commons: attribution, non-commercial, sharealike.
========================================================================
*/


/*
-------------------
JSLINT: set options
-------------------
*/

/*jshint esversion: 6*/
/*jshint sub:true*/


this.name = &quot;extraThargoids_sweeper&quot;;
this.author = &quot;UK_Eliter&quot;;
this.copyright = &quot;2014 Creative Commons: attribution, non-commercial, sharealike.&quot;;
this.licence = &quot;CC-NC-SA 3&quot;;
this.description = &quot;Script for Thargon sweepers&quot;;


/*
------------------
DEBUGGING SWITCHES
------------------
*/

//this.logging = true; // THIS SHOULD BE COMMENTED OUT WHEN NOT TESTING
//var consoleDebugMessages = false;


/*
--------------
VARIABLES etc.
--------------
*/

this.sweep = new SoundSource();
this.sweep.sound = &quot;extraThargoids_sweep.ogg&quot;;

this.mediumSweep = new SoundSource();
this.mediumSweep.sound = &quot;extraThargoids_mediumSweep.ogg&quot;;

this.quietSweep = new SoundSource();
this.quietSweep.sound = &quot;extraThargoids_quietSweep.ogg&quot;;


/*
------------------------
JSHINT: start of wrapper
------------------------
*/

(function() {
	&quot;use strict&quot;;


	/*
	--------------
	EVENT HANDLERS
	--------------
	*/

	this.shipSpawned = function() {
		// If the scanTimer does not exist, create it.
		// If it does exist, and it is not running, start it.
		// Then - as usual - remove the ship object created by this function.
		if (!this.$scanTimer) {
			this.$scanTimer = new Timer(this, this.$scan, 1, 2.8);
		} else if (!this.$scanTimer.isRunning) {
			this.$scanTimer.start();
		}
		delete this.shipSpawned;
	};

	this.shipDied = this.entityDestroyed = this.playerWillEnterWitchspace = function() {
		this.$deleteTimers();
	};


	/*
	------------
	CALLED BY AI
	------------
	*/

	this.$_incomingMissile = function() {
		// This run (only) by extraThargoids_sweeperAI
		if (this.$incomingMissileTimer) {
			if (this.$incomingMissileTimer.isRunning) {
				return;
			} else {
				this.$incomingMissileTimer.start();
			}
		} else {
			this.$incomingMissileTimer = new Timer(this, this.$incomingMissileActual, 0.2);
		}
	};

	this.$_validateTarget = function() {
		if (this.ship.target &amp;&amp; !this.ship.target.isThargoid) {
			this.ship.reactToAIMessage(&quot;TARGET_VALID&quot;);
		} else {
			this.ship.reactToAIMessage(&quot;TARGET_INVALID&quot;);
		}
	};

	this.$_sophistatedBeligerentAttackResponse = function() {
		// = if has this missile type, fire it, else . .
		if (this.ship.fireMissile(&quot;EQ_THARGON&quot;) == null) {
			this.ship.reactToAIMessage(&quot;DO_ATTACK&quot;);
		}
	};

	this.$_checkForPossiblyFarThargoids = function() {
		var s = system.filteredEntities(this, this.$isBug, this.ship, 55000);
		if (s.length &gt; 0) {
			this.ship.reactToAIMessage(&quot;TARGET_FOUND&quot;); // AI does actual SETTING of the target
		} else if (s.length &gt; 0) {
			this.ship.reactToAIMessage(&quot;NOTHING_FOUND&quot;);
		}
	};


	/*
	-------
	FILTERS
	-------
	*/

	this.$poppable = function(e) {
		return e.isShip &amp;&amp; (e.isMissile || e.isMine);
	};

	this.$isBug = function(e) {
		return (e.isShip &amp;&amp; e.isThargoid);
	};

	this.$isTarget = function(e) {
		return e.isShip &amp;&amp; (e.isMissile || e.isMine) &amp;&amp; e.primaryRole !== &quot;EQ_BUGGLYMISSILE&quot; &amp;&amp; e.name !== &quot;Thargoid Projectile&quot;;
	};


	/*
	-------
	GENERAL
	-------
	*/

	this.$scan = function() {
		/*
		MASSES:
			MM Hardened Missile: 114 (!)M
			Nexus premium warhead: 67ish
			mini-missile mass: 114
			intercept missile mass: 210.3
			q-bomb: 135
			normal mass: 1324
			hardhead mass: 1638
			TCAT_claw: 472.5
			TCAT_talon: 135
			s[c].hasRole(&quot;EQ_HARDENED_MISSILE&quot;) || s[c].hasRole(&quot;armoury_MMHardMissile&quot; || s[c].hasRole(&quot;EQ_MISSILE&quot;)
		*/

		if (!this.ship) {
			return;
		}
		if (this.$incomingMissileTimer &amp;&amp; this.$incomingMissileTimer.isRunning) {
			return;
		}
		this.ship.lightsActive = false; // turn them off, in case they&#39;ve been turned on before
		if (this.ship.energy &lt; 45) {
			return;
		}
		this.ship.energy -= 1; // merely scanning takes a bit of energy
		var s = system.filteredEntities(this, this.$isTarget, this.ship, 26000);
		var num = s.length;
		if (num === 0) {
			return;
		}

		// What follows  starts going through all ordinance at large, and stops when the sweeper detects one of those pieces (or when reaches end of list)
		var detected = false;
		var chance;
		var c = num;
		while (c--) {
			if (s[c].mass &lt; 125) {
				chance = 0.05;
			} else {
				chance = 0.86;
			}
			if (this.ship.position.distanceTo(s[c]) &lt; 15000) {
				chance += 0.12;
			}
			if (Math.random() &lt;= chance) {
				detected = true;
				break;
			}
		}
		// if has been a detection, sweeper fires its special ECM . .
		if ((detected) &amp;&amp; (this.ship.energy &gt; 14)) {
			this.$actualSweep();
		}
	};

	this.$actualSweep = function() {
		this.ship.lightsActive = true;
		this.ship.energy -= 14; // takes more energy to destroy (or try to destroy, anyway) something
		var s = system.filteredEntities(this, this.$poppable, this.ship, 26000);
		var num = s.length;
		if (num &gt; 0) {
			var c = num;
			var chance;
			while (c--) {
				// log(&quot;EXTRA&quot;, s[c].primaryRole);
				switch (s[c].primaryRole) {
					case &quot;TCAT_talon&quot;:
						chance = 0.05;
						break;
					case &quot;TCAT_claw&quot;:
						chance = 0.035;
						break;
					case &quot;EQ_BUGGLYMISSILE&quot;:
						chance = 0.01;
						break;
					case &quot;EQ_F3G_ANTISWEEP_MISSILE&quot;:
						chance = 0.02;
						break;
					default:
						chance = 0.97;
				}
				if (Math.random() &lt;= chance) {
					var damage = 16 + (Math.ceil(Math.random() * 40));
					if (s[c].energy &lt;= damage) {
						s[c].explode();
					} else {
						s[c].energy -= damage;
					}
				}
			}
		}
		if (!this.ship || !player.ship) {
			return;
		}
		var ps = player.ship; // for speed, but changes won&#39;t affect the original variable
		var distanceToPlayer = this.ship.position.distanceTo(ps);
		if (distanceToPlayer &lt; 28000) {
			if (distanceToPlayer &lt; 13000) {
				this.sweep.play();
				if (Math.random() &gt; 0.83) {
					this.ship.commsMessage(expandDescription(&quot;[thargoid_curses]&quot;, ps));
				}
			} else if (distanceToPlayer &lt; 17500) {
				this.mediumSweep.play();
				if (Math.random() &gt; 0.9) {
					this.ship.commsMessage(expandDescription(&quot;[thargoid_curses]&quot;, ps));
				}
			} else {
				this.quietSweep.play();
				if (Math.random() &gt; 0.95) {
					this.ship.commsMessage(expandDescription(&quot;[thargoid_curses]&quot;, ps));
				}
			}
		}
	};

	this.$incomingMissileActual = function $incomingMissileActual() {
		this.$incomingMissileTimer.stop();
		if (this.ship.energy &gt; 14) {
			this.$actualSweep();
		} else {
			this.ship.reactToAIMessage(&quot;GO_FLEE&quot;);
		}
	};


	/*
	-------
	CLEANUP
	-------
	*/

	this.$deleteTimers = function() {
		this.$deleteIncomingMissileTimer();
		this.$deleteScanTimer();
	};

	this.$deleteIncomingMissileTimer = function() {
		if (!this.$incomingMissileTimer) {
			return;
		}
		if (this.$incomingMissileTimer.isRunning) {
			this.$incomingMissileTimer.stop();
		}
		delete this.$incomingMissileTimer;
	};

	this.$deleteScanTimer = function() {
		if (!this.$scanTimer) {
			return;
		}
		if (this.$scanTimer.isRunning) {
			this.$scanTimer.stop();
		}
		delete this.$scanTimer;
	};


	/*
	----------------------
	JSHINT: end of wrapper
	----------------------
	*/

}).call(this);

// EOF</pre></td>
                </tr>
                <tr>
                    <td valign="top">Scripts/extraThargoids_uber.js</td>
                    <td><pre>/*
========================================================================
extraThargoids_uber.js

This file is part of the ExtraThargoids expansion pack.
Author: UK_Eliter
License: 2017 Creative Commons: attribution, non-commercial, sharealike.
========================================================================
*/

/*
-------------------
JSLINT: set options
-------------------
*/

/*jshint esversion: 6*/
/*jshint sub:true*/



this.name = &quot;thargoid_uberbuggly&quot;;
this.author = &quot;UK_Eliter&quot;;
this.copyright = &quot;2014 Creative Commons: attribution, non-commercial, sharealike.&quot;;
this.licence = &quot;CC-NC-SA 3&quot;;
this.description = &quot;Script for the &#39;uberbuggly&#39; Thargon ships&quot;;


/*
------------------
DEBUGGING SWITCHES
------------------
*/

// this.logging = true;
var consoleDebugMessages = false; // do NOT comment this out. Rather, to disable, set to false.


/*
------
SOUNDS
------
*/

var mysound_Warning = new SoundSource();
mysound_Warning.sound = &quot;warning.ogg&quot;; // this sound built-in to Oolite - and does not need to be declared in the &#39;customsounds&#39; file.


/*
------------------------
JSHINT: start of wrapper
------------------------
*/

(function() {
	&quot;use strict&quot;;


	/*
	--------------
	EVENT HANDLERS
	--------------
	*/

	this.shipTargetCloaked = function() {
		var seconds;

		if (this.decloakTargetTimer &amp;&amp; this.decloakTargetTimer.isRunning) {
			return;
		}
		if (this.ship.target.isThargoid) {
			return;
		}
		if (Math.random() &lt; 0.13) {
			return;
		}
		if (Math.random() &gt; 0.4) {
			this.ship.commsMessage(expandDescription(&quot;[thargoid_curses]&quot;));
		}
		this.ship.cloakedTarget = this.ship.target;
		seconds = (1 + Math.floor(Math.random() * 6));
		if (this.decloakTargetTimer) {
			delete this.decloakTargetTimer;
		}
		this.decloakTargetTimer = new Timer(this, this.$decloakTargetTimed, seconds);
	};

	this.shipDied = this.entityDestroyed = this.playerWillEnterWitchspace = function() {
		this.$_deleteTimers();
	};


	/*
	------------
	CALLED BY AI
	------------
	*/

	this.$_deleteTimers = function() {
		if (!this.decloakTargetTimer) {
			return;
		}
		if (this.decloakTargetTimer.isRunning) {
			this.decloakTargetTimer.stop();
		}
		delete this.decloakTargetTimer;
	};

	this.$_deleteTimersAndSetMisJump = function() {
		this.ship.scriptedMisjump = true;
		this.$_deleteTimers();
	};

	this.$_curse = function() {
		this.ship.commsMessage(expandDescription(&quot;[thargoid_curses]&quot;));
	};

	this.$_possiblyCurse = function() {
		if (Math.random() &lt; 0.35) {
			this.ship.commsMessage(expandDescription(&quot;[thargoid_curses]&quot;));
		}
	};

	this.$_fireQuirium = function() {
		this.ship.awardEquipment(&quot;EQ_QC_MINE&quot;);
		this.ship.fireMissile(&quot;EQ_QC_MINE&quot;);
		this.$_possiblyCurse();
		this.$_deleteTimers();
	};


	/*
	-----
	OTHER
	-----
	*/

	this.$decloakTargetTimed = function() {
		this.decloakTargetTimer.stop();
		if (!this.ship || !this.ship.isValid) {
			delete this.decloakTargetTimer;
			return;
		}
		if (!this.ship.cloakedTarget || !this.ship.cloakedTarget.isValid) {
			delete this.decloakTargetTimer;
			return;
		}
		if (!this.ship.cloakedTarget.isCloaked) {
			delete this.decloakTargetTimer;
			return;
		}
		this.distanceToTarget = this.ship.position.distanceTo(this.ship.cloakedTarget);
		if (this.distanceToTarget &lt; 10000) {
			mysound_Warning.play();
			this.ship.cloakedTarget.lightsActive = true;
			if (Math.random() &gt; 0.9) {
				this.ship.cloakedTarget.setEquipmentStatus(&quot;EQ_CLOAKING_DEVICE&quot;, &quot;EQUIPMENT_DAMAGED&quot;);
				if (this.ship.cloakedTarget.isPlayer &amp;&amp; !player.ship) {
					delete this.decloakTargetTimer;
					return;
				}
				this.ship.commsMessage(&quot;CLOAKING DEVICE DAMAGED!&quot;, this.ship.cloakedTarget);
				this.ship.target = this.ship.cloakedTarget;
				this.ship.reactToAIMessage(&quot;TARGET_REGAINED&quot;);
			} else {
				player.consoleMessage(&quot;CLOAKING FAILURE!&quot;, 10);
				player.ship.isCloaked = false;
				this.ship.target = this.ship.cloakedTarget;
				this.ship.reactToAIMessage(&quot;TARGET_REGAINED&quot;);
			}
		}
		if (Math.random() &lt; 0.26) {
			this.ship.commsMessage(expandDescription(&quot;[thargoid_curses]&quot;));
		}
		delete this.decloakTargetTimer;
	};


	/*
	----------------------
	JSHINT: end of wrapper
	----------------------
	*/

}).call(this);

// EOF</pre></td>
                </tr>
            </table>
        </a>
    </body>
</html>
