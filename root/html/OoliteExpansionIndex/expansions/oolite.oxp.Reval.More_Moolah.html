<html>
    <head>
        <title>Expansion More Moolah</title>
        <link rel="stylesheet" href="../style.css">
    </head>
    <body>
        <table border="0" width="100%">
            <tr>
                <td>Back to <a href='../index.html'>Index</a></td>
                <td align="right"><small>Page generated: Oct 11, 2023, 3:16:49 PM</small></td>
            </tr>
        </table>

        <h1>Expansion More Moolah</h1>

        <h2>Content</h2>
        <ul>
          <li><a href="#warnings">Warnings</a></li>
          <li><a href="#manifest">Manifest</a></li>
          <li><a href="#documentation">Documentation</a></li>
          <li><a href="#equipment">0 Equipment</a></li>
          <li><a href="#ships">0 Ships</a></li>
          <li><a href="#models">0 Models</a></li>
          <li><a href="#scripts">1 Scripts</a></li>
        </ul>

          <a name="warnings">
            <h2>Warnings</h2>
            <ol>
                <li>http://wiki.alioth.net/index.php/More%20Moolah -&gt; 404 Not Found</li>
                <li>Information URL mismatch between OXP Manifest and Expansion Manager string length at character position 0</li>
            </ol>
          </a>

        <a name="manifest">
        <h2>Manifest</h2>
            <table border="1">
                <tr>
                    <th></th>
                    <th>from Expansion Manager's OXP list</th>
                    <th>from Expansion Manifest</th>
                </tr>
                <tr>
                    <td>Description</td>
                    <td>An enhanced and extended Market for the zealous merchanter. 5 (five) new commodities for industrial and agricultural economies; 10 (ten) recast display aliases for the Oolite goods. Full descriptions and advice for all 18 commodities via the F8F8 Market screen. More variety, more realism, more trade possibilities, more moolah. MM makes an ideal pairing with Merchanter&#39;s Zeal (MM + MZ = $$$)</td>
                    <td>An enhanced and extended Market for the zealous merchanter. 5 (five) new commodities for industrial and agricultural economies; 10 (ten) recast display aliases for the Oolite goods. Full descriptions and advice for all 18 commodities via the F8F8 Market screen. More variety, more realism, more trade possibilities, more moolah. MM makes an ideal pairing with Merchanter&#39;s Zeal (MM + MZ = $$$)</td>
                </tr>
                <tr>
                    <td>Identifier</td>
                    <td>oolite.oxp.Reval.More_Moolah</td>
                    <td>oolite.oxp.Reval.More_Moolah</td>
                </tr>
                <tr>
                    <td>Title</td>
                    <td>More Moolah</td>
                    <td>More Moolah</td>
                </tr>
                <tr>
                    <td>Category</td>
                    <td>Mechanics</td>
                    <td>Mechanics</td>
                </tr>
                <tr>
                    <td>Author</td>
                    <td>Reval</td>
                    <td>Reval</td>
                </tr>
                <tr>
                    <td>Version</td>
                    <td>1.5</td>
                    <td>1.5</td>
                </tr>
                <tr>
                    <td>Tags</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Required Oolite Version</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Maximum Oolite Version</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Required Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Optional Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Conflict Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Information URL</td>
                    <td><a target="_blank" href=""></a></td>
                    <td><a target="_blank" href="">n/a</a></td>
                </tr>
                <tr>
                    <td>Download URL</td>
                    <td><a target="_blank" href="https://wiki.alioth.net/img_auth.php/4/49/More_Moolah.oxz">https://wiki.alioth.net/img_auth.php/4/49/More_Moolah.oxz</a></td>
                    <td><a target="_blank" href="">n/a</a></td>
                </tr>
                <tr>
                    <td>License</td>
                    <td>CC-BY-NC-SA 4.0</td>
                    <td>CC-BY-NC-SA 4.0</td>
                </tr>
                <tr>
                    <td>File Size</td>
                    <td>n/a</td>
                </tr>
                <tr>
                    <td>Upload date</td>
                    <td>1672816087</td>
                </tr>
            </table>
                </a>

        <a name="documentation">
        <h2>Documentation</h2>
        
        </a>

        <a name="equipment">          
        <h2>Equipment</h2>
            This expansion declares no equipment. This may be related to warnings.
        </a>

        <a name="ships">    
        <h2>Ships</h2>
            This expansion declares no ships. This may be related to warnings.
        </a>

        <a name="models">    
        <h2>Models</h2>
            This expansion declares no models. This may be related to warnings.
        </a>

        <a name="scripts">    
        <h2>Scripts</h2>
            <table>
                <tr>
                    <th>Path</th>
                </tr>
                <tr>
                    <td valign="top">Scripts/mm_script.js</td>
                    <td><pre>&quot;use strict&quot;
this.name = &quot;More Moolah&quot;;
this.author = &quot;Reval&quot;;
this.license = &quot;CC-BY-NC-SA 4.0&quot;;
this.version = &quot;1.5&quot;;
this.description = &quot;An enhanced and extended Market for the zealous merchanter. 5 (five) new commodities for industrial and agricultural economies; 10 (ten) recast display aliases for the Oolite goods. Full descriptions and advice for all 18 commodities via the F8F8 Market screen. More variety, more realism, more trade possibilities, more moolah. MM makes an ideal pairing with Merchanter&#39;s Zeal (MM + MZ = $$$)&quot;;

/* ALL credit and homage to Spara for this code! The only things Reval changed were the content, and order of the items in the commodities array; also introduced conditional for the loop and a try catch() to reduce the logged errors. When, oh when will the devs fix this persistent Oolite BUG that even now, with version 1.91, forces workarounds and kludges like this? Shows how much _they_ care about Trading, eh? */

//1.1 save every market on save and restore when spawning. now it&#39;s fully compatible with market inquirer.

this.startUp = function() {
	if (missionVariables.marketRestorePrimaryRoles) {
		this.$primaryRoles = JSON.parse(missionVariables.marketRestorePrimaryRoles);
		this.$markets = JSON.parse(missionVariables.marketRestoreMarkets);
	}
	else {
		this.$primaryRoles = new Array();
		this.$markets = new Array();
		delete this.shipSpawned;
	}
}

//restore market when station is spawned
this.shipSpawned = function(ship) {
	if (ship.isStation) {
		var index = this.$primaryRoles.indexOf(ship.primaryRole);
		if (index !== -1) {
			var commodities  = [&quot;slaves&quot;,&quot;androids&quot;,&quot;robots&quot;,&quot;luxuries&quot;,&quot;computers&quot;,&quot;live_animals&quot;,&quot;furs&quot;,&quot;leather_goods&quot;,&quot;firearms&quot;,&quot;machinery&quot;,&quot;medicines&quot;,&quot;narcotics&quot;,&quot;alloys&quot;,&quot;liquor_wines&quot;,&quot;textiles&quot;,&quot;food&quot;,&quot;minerals&quot;,&quot;radioactives&quot;,&quot;gold&quot;,&quot;platinum&quot;,&quot;gem_stones&quot;,&quot;alien_items&quot;];		
			var market = this.$markets.splice(index, 1)[0];
			if (market!=null) {
				var i, commodity;
				for (i = 0; i &lt; market.length; i++) {
					commodity = commodities[i];
					try {
						ship.setMarketQuantity(commodity, market[i][0]);
						ship.setMarketPrice(commodity, market[i][1]);
					} catch(err) {}
				}
				this.$primaryRoles.splice(index, 1);
			}
		}		
	}
}

//wipe everything when leaving system
this.shipWillEnterWitchSpace = function() {
	this.$primaryRoles = new Array();
	this.$markets = new Array();
	delete this.shipSpawned;
}

//save primaryRoles and markets (prices and quantities) of all stationary stations
this.playerWillSaveGame = function() {
	function stations(entity) {return (entity.isStation &amp;&amp; !entity.isMainStation &amp;&amp; !entity.maxSpeed)};
	var i, j, station, commodity;
	var stationMarket = new Array();
	var primaryRoles = this.$primaryRoles.concat();
	var markets = this.$markets.concat();
	var commodities  = [&quot;slaves&quot;,&quot;androids&quot;,&quot;robots&quot;,&quot;luxuries&quot;,&quot;computers&quot;,&quot;live_animals&quot;,&quot;furs&quot;,&quot;leather_goods&quot;,&quot;firearms&quot;,&quot;machinery&quot;,&quot;medicines&quot;,&quot;narcotics&quot;,&quot;alloys&quot;,&quot;liquor_wines&quot;,&quot;textiles&quot;,&quot;food&quot;,&quot;minerals&quot;,&quot;radioactives&quot;,&quot;gold&quot;,&quot;platinum&quot;,&quot;gem_stones&quot;,&quot;alien_items&quot;];	
	var oxpStations = system.filteredEntities(this, stations, player.ship);
	for (i = 0; i &lt; oxpStations.length; i++) {
		station = oxpStations[i];
		primaryRoles.push(station.primaryRole);
		stationMarket = new Array();
		for (j = 0; j &lt; commodities.length; j++) {
			commodity = commodities[j];
			try {
				stationMarket.push([station.market[commodity].quantity, station.market[commodity].price]);
			} catch(err) {}
		}
		markets.push(stationMarket);
	}
	if (primaryRoles.length &gt; 0) {
		missionVariables.marketRestorePrimaryRoles = JSON.stringify(primaryRoles);
		missionVariables.marketRestoreMarkets = JSON.stringify(markets);
	}
	else {
		delete missionVariables.marketRestorePrimaryRoles;
		delete missionVariables.marketRestoreMarkets;
	}
}

</pre></td>
                </tr>
            </table>
        </a>
    </body>
</html>
