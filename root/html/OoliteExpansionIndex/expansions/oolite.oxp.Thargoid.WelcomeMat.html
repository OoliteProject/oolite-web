<html>
    <head>
        <title>Expansion Welcome Mat</title>
        <link rel="stylesheet" href="../style.css">
    </head>
    <body>
        <table border="0" width="100%">
            <tr>
                <td>Back to <a href='../index.html'>Index</a></td>
                <td align="right"><small>Page generated: Oct 11, 2023, 3:16:49 PM</small></td>
            </tr>
        </table>

        <h1>Expansion Welcome Mat</h1>

        <h2>Content</h2>
        <ul>
          <li><a href="#warnings">Warnings</a></li>
          <li><a href="#manifest">Manifest</a></li>
          <li><a href="#documentation">Documentation</a></li>
          <li><a href="#equipment">1 Equipment</a></li>
          <li><a href="#ships">0 Ships</a></li>
          <li><a href="#models">0 Models</a></li>
          <li><a href="#scripts">1 Scripts</a></li>
        </ul>

          <a name="warnings">
            <h2>Warnings</h2>
            <ol>
                <li>Found XML equipment list</li>
                <li>Tags mismatch between OXP Manifest and Expansion Manager at character position 0002 (RIGHT SQUARE BRACKET vs LATIN SMALL LETTER E)(&#39;[]&#39; vs &#39;[equipment, system, OXPConfig]&#39;)</li>
            </ol>
          </a>

        <a name="manifest">
        <h2>Manifest</h2>
            <table border="1">
                <tr>
                    <th></th>
                    <th>from Expansion Manager's OXP list</th>
                    <th>from Expansion Manifest</th>
                </tr>
                <tr>
                    <td>Description</td>
                    <td>Information equipment to give system summary information on arrival.</td>
                    <td>Information equipment to give system summary information on arrival.</td>
                </tr>
                <tr>
                    <td>Identifier</td>
                    <td>oolite.oxp.Thargoid.WelcomeMat</td>
                    <td>oolite.oxp.Thargoid.WelcomeMat</td>
                </tr>
                <tr>
                    <td>Title</td>
                    <td>Welcome Mat</td>
                    <td>Welcome Mat</td>
                </tr>
                <tr>
                    <td>Category</td>
                    <td>Equipment</td>
                    <td>Equipment</td>
                </tr>
                <tr>
                    <td>Author</td>
                    <td>Thargoid</td>
                    <td>Thargoid</td>
                </tr>
                <tr>
                    <td>Version</td>
                    <td>1.13</td>
                    <td>1.13</td>
                </tr>
                <tr>
                    <td>Tags</td>
                    <td></td>
                    <td>equipment, system, OXPConfig</td>
                </tr>
                <tr>
                    <td>Required Oolite Version</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Maximum Oolite Version</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Required Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Optional Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Conflict Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Information URL</td>
                    <td><a target="_blank" href="http://wiki.alioth.net/index.php/Welcome_Mat_OXP">http://wiki.alioth.net/index.php/Welcome_Mat_OXP</a></td>
                    <td><a target="_blank" href="">n/a</a></td>
                </tr>
                <tr>
                    <td>Download URL</td>
                    <td><a target="_blank" href="https://wiki.alioth.net/img_auth.php/6/6a/Welcome_Mat_1.13.oxz">https://wiki.alioth.net/img_auth.php/6/6a/Welcome_Mat_1.13.oxz</a></td>
                    <td><a target="_blank" href="">n/a</a></td>
                </tr>
                <tr>
                    <td>License</td>
                    <td>Creative Commons Attribution - Non-Commercial - Share Alike 3.0 license with clauses - see readme file</td>
                    <td>Creative Commons Attribution - Non-Commercial - Share Alike 3.0 license with clauses - see readme file</td>
                </tr>
                <tr>
                    <td>File Size</td>
                    <td>n/a</td>
                </tr>
                <tr>
                    <td>Upload date</td>
                    <td>1610873327</td>
                </tr>
            </table>
                </a>

        <a name="documentation">
        <h2>Documentation</h2>
        <p>Also read <a href='http://wiki.alioth.net/index.php/Welcome%20Mat'>http://wiki.alioth.net/index.php/Welcome%20Mat</a></p>
        <h3>Welcome Mat v1.13 ReadMe &amp; LIcense.txt</h3>
        <pre>Welcome Mat OXP by Thargoid.

The Ships Systems Department of the Aquarian Shipbuilding Corporation present an expansion to the communications system to enhance the system information available on arrival from Witchspace.

The enhancement to the ships software enables communication with the witchspace beacon (after connection through the ship identification system, position the buoy in your sights and press &quot;r&quot;). After a connection is established (which can take anything up to 60 seconds), the system will be transferred and displayed. This facility is also available for the main station navigation buoy.

For the busy commander on the go, a small piece of add-on equipment is also offered, which automatically negotiates communications on arrival, making the information available instantly. Please note that due to the volume of traffic this only operates at the witchspace beacon only, not the main station one.

--------------------------------------------------------------

License:

This OXP is released under the Creative Commons Attribution - Non-Commercial - Share Alike 3.0 license with the following clauses:

* Whilst you are free (and encouraged) to re-use any of the scripting, models or texturing in this OXP, the usage must be distinct from that within this OXP. Unique identifiers such as (but not limited to) unique shipdata.plist entity keys, mission variables, script names (this.name), equipment identity strings (EQ_), description list arrays and entity roles must not be re-used without prior agreement. Basically if it&#39;s unique or would identify or overwrite anything in the original OXP, then you may not re-use it (for obvious compatibility reasons).
* rebundling of this OXP within another distribution is permitted as long as it is unchanged. The following derivates however are permitted and except from the above:
	* the conversion of files between XML and openStep.
	* the merging of files with other files of the same type from other OXPs.
* The license information (either as this file or merged into a larger one) must be included in the OXP.
* Even though it is not compulsory, if you are re-using any sizable or recognisable piece of this OXP, please let me know :)

--------------------------------------------------------------

Instructions:

Unzip the file, and then move the folder &quot;Welcome Mat 1.13.oxp&quot; to the AddOns directory of your Oolite installation. Then start the game up whilst holding down shift until you see the spinning Cobra MkIII screen.

This OXP is fully compatible with the OXPConfig.oxp game tweaking application, and the logging and messages appearing can be changed through that or via the javaScript console.

Due to the script commands involved, this OXP requires Oolite version 1.72 or higher.

--------------------------------------------------------------

Version history:

13/09/2008 - Version 1.00, Initial release (Equipment version).
14/03/2008 - Version 1.01, messaging switchable between console and comms systems (via this.audio &amp; OXPConfig).
17/09/2008 - Version 1.02, made OXPConfig flags sticky via mission variables, and changed Galcop warning messages. Also streamlined the script and worked around the system.techLevel vs system info screen discrepancy.
18/09/2008 - Version 1.03, merging of script and equipment versions. If equipment is purchased, message is displayed immediately on arrival. If not then player must lock onto the witchspace buoy and wait for connection to be made.
22/08/2008 - Version 1.04, expanded network to include all buoys. Fixed a glitch with the flag settings too.
04/11/2008 - Version 1.05, scripting update for compatability with v1.72.
19/08/2009 - Version 1.06, update for scripting depreciation, plus to limit messages to beacon buoys. Also removed the 1.71 code.
24/05/2010 - Version 1.10, strengthened the damaged equipment checking for 1.74
13/02/2011 - Version 1.11, removal of upper limit, to allow running with 1.75
15/04/2012 - Version 1.12, script change for compatibility with Interstellar Tweaks OXP (by request of UK_Eliter).
05/02/2013 - Version 1.13, update to restore the compatibility with the new OXPConfig.

---------------------------------------------------------------

Acknowledgements:

With thanks to PAGroove for the idea of the buoy lock-on, and Eric Walch for the scenario to merge the two version OXPs.

</pre>
        </a>

        <a name="equipment">          
        <h2>Equipment</h2>
            <table>
                <tr>
                    <th>Name</th>
                    <th>Visible</th>
                    <th>Cost [deci-credits]</th>
                    <th>Tech-Level</th>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_WELCOME_MAT.html">Planetary Information System</a></td>
                    <td>yes</td>
                    <td align="right">3000</td>
                    <td align="center">6+</td>
                </tr>
            </table>
        </a>

        <a name="ships">    
        <h2>Ships</h2>
            This expansion declares no ships. This may be related to warnings.
        </a>

        <a name="models">    
        <h2>Models</h2>
            This expansion declares no models. This may be related to warnings.
        </a>

        <a name="scripts">    
        <h2>Scripts</h2>
            <table>
                <tr>
                    <th>Path</th>
                </tr>
                <tr>
                    <td valign="top">Config/script.js</td>
                    <td><pre>this.name			= &quot;Welcome Information Script&quot;; 
this.author			= &quot;Thargoid&quot;; 
this.copyright		= &quot;Creative Commons: attribution, non-commercial, sharealike with clauses - see readme.txt&quot;;
this.description	= &quot;Expanded information when you witchspace jump into a system.&quot;; 
this.version		= &quot;1.13&quot;; 

/* this.logging, this.audio, this.extraA and this.extraB are for compatability with OXPConfig.oxp.

	this.logging - Sends arrival location to stderr.txt and JSConsole (off by default).
	this.audio - Switch between console and comms messaging (on (comms) by default).
	this.extraA - General system information (on by default).
	this.extraB - System safety information (on by default).

	Set the default values up below:
*/

this.logging = false;
this.audio = true;
this.extraA = true;
this.extraB = true;

this.oxpcSettings = {
	Info: {Name:this.name,Display:this.name,InfoB:&quot;1 - If false suppresses the general system information.\n2 - If false suppresses system safety information.\n3 - If true, log arrival locations to the console and latest.log.\n4 - If true send messages to the ships comms system, if false to the console instead.&quot;},
	Bool0: {Name:&quot;extraA&quot;,Def:true,Desc:&quot;General system information displayed.&quot;},
	Bool1: {Name:&quot;extraB&quot;,Def:true,Desc:&quot;System safety information displayed.&quot;},
	Bool2: {Name:&quot;logging&quot;,Def:false,Desc:&quot;Send arrival locations.&quot;},
	Bool3: {Name:&quot;audio&quot;,Def:true,Desc:&quot;Switch output to comms or console messaging&quot;}
};

this.shipLaunchedFromStation = function() 
	{	
	missionVariables.welcomeLogging = this.logging;
	missionVariables.welcomeAudio = this.audio;
	missionVariables.welcomeExtraA = this.extraA;
	missionVariables.welcomeExtraB = this.extraB;
	if(this.welcomeTimer)
		{ this.welcomeTimer.start(); }
	else
		{ this.welcomeTimer = new Timer(this, this.checkForBuoy, 30, 30); }
	}


this.shipWillDockWithStation = function(station)
	{	
	missionVariables.welcomeLogging = this.logging;
	missionVariables.welcomeAudio = this.audio;
	missionVariables.welcomeExtraA = this.extraA;
	missionVariables.welcomeExtraB = this.extraB;
	this.welcomeTimer.stop();
	}

this.shipExitedWitchspace = function() 
	{
	if(system.isInterstellarSpace) { return; }
	
	if(player.ship.equipmentStatus(&quot;EQ_WELCOME_MAT&quot;) != &quot;EQUIPMENT_OK&quot;)
		{
		player.consoleMessage(&quot;Please lock onto the beacon to initiate data connection.&quot;, 6);
		if(this.welcomeTimer)
			{ this.welcomeTimer.start(); }
		else
			{ this.welcomeTimer = new Timer(this, this.checkForBuoy, 30, 30); }
		}
	else
		{ this.displayMessage(); }	
	}


this.checkForBuoy = function()
	{
	if(player.ship.target &amp;&amp; system.entitiesWithScanClass(&quot;CLASS_BUOY&quot;, player.ship, 25600).length) // check player has equipment and a buoy is on the scanner
		{
		if(player.ship.target.scanClass == &quot;CLASS_BUOY&quot; &amp;&amp; player.ship.target.isBeacon &amp;&amp; !player.ship.target.hasRole(&quot;welcomeMat_suppress&quot;)) 
			{ this.displayMessage(); }
		}
	}

this.displayMessage = function()
	{
	if(!system.isInterstellarSpace)
		{ 
		this.pirateCount = system.shipsWithPrimaryRole(&quot;pirate&quot;).length; // how many ships in the system which have a role of pirate
		this.policeCount = system.entitiesWithScanClass(&quot;CLASS_POLICE&quot;).length + system.entitiesWithScanClass(&quot;CLASS_MILITARY&quot;).length; // how many ships with scanClass police or military
		this.thargoidCount = system.entitiesWithScanClass(&quot;CLASS_THARGOID&quot;).length; // how many ships in the system with Thargoid scanclass
		this.systemSafety = ((this.pirateCount + this.thargoidCount) - this.policeCount); // the balance between pirate/Thargoid and police/military ships.
		if(this.logging)
			{
			log(&quot;Player in galaxy &quot; + (galaxyNumber+1) + &quot; at &quot; + system.name + &quot; (&quot; + system.ID + &quot;).&quot;);
			log(&quot;Pirate count - &quot; + this.pirateCount); 
			log(&quot;Police count - &quot; + this.policeCount); 
			log(&quot;Thargoid count - &quot; + this.thargoidCount); 
			log(&quot;System safety figure - &quot; + this.systemSafety);
			} 
		if(this.audio) // messages via commsMessage
			{
			if(this.extraA) 
				{ // display the information to the comms system, after the in-built system name message.
				player.commsMessage(&quot;Government - &quot; + system.governmentDescription + &quot;.&quot;, 6);
				player.commsMessage(&quot;Tech level - &quot; + (system.techLevel + 1) + &quot;.&quot;, 6); 
				player.commsMessage(&quot;Economy - &quot; + system.economyDescription + &quot;.&quot;, 6); 
				} 
			if(this.extraB)
				{
				if(this.systemSafety &gt; 5) 
					{ // if there are significantly more pirates/Thargoids than police/military
					player.commsMessage(&quot;Beware, significant pirate activity has been reported in this system!&quot;, 6); 
					} 
				else
					{
					if(this.systemSafety &lt; -5) 
						{ // if there are significantly less pirates/Thargoids than police/military
						player.commsMessage(&quot;This system has a strong police presence.&quot;, 6); 
						}
					else
						{ // if system is balanced between police/military and pirates/Thargoids
						player.commsMessage(&quot;No reports of major pirate activity.&quot;, 6);
						}
					}
				if(this.thargoidCount == 1) {player.commsMessage (&quot;Alien vessel reported in system.&quot;, 6); };
				if(this.thargoidCount &gt; 1) {player.commsMessage (&quot;Alien vessels reported in system.&quot;, 6); };
				if(system.sun.isGoingNova) {player.commsMessage(&quot;The sun is going nova! Get out now!&quot;, 6); };
				}
			}
			else // messages via consoleMessage
			{
			if(this.extraA) 
				{ // display the information to the console system, after the in-built system name message.
				player.consoleMessage(&quot;Government - &quot; + system.governmentDescription + &quot;.&quot;, 6);
				player.consoleMessage(&quot;Tech level - &quot; + (system.techLevel + 1) + &quot;.&quot;, 6); 
				player.consoleMessage(&quot;Economy - &quot; + system.economyDescription + &quot;.&quot;, 6); 
				} 
			if(this.extraB)
				{
				if(this.systemSafety &gt; 5) 
					{ // if there are significantly more pirates/Thargoids than police/military
					player.consoleMessage(&quot;Beware, significant pirate activity has been reported in this system!&quot;, 6); 
					} 
				else
					{
					if(this.systemSafety &lt; -5) 
						{ // if there are significantly less pirates/Thargoids than police/military
						player.consoleMessage(&quot;This system has a strong police presence.&quot;, 6); 
						}
						else
						{ // if system is balanced between police/military and pirates/Thargoids
						player.consoleMessage(&quot;No reports of major pirate activity.&quot;, 6);
						}
					}
				if(this.thargoidCount == 1) {player.consoleMessage (&quot;Alien vessel reported in system.&quot;, 6); }; 
				if(this.thargoidCount &gt; 1) {player.consoleMessage (&quot;Alien vessels reported in system.&quot;, 6); }; 
				if(system.sun.isGoingNova) {player.consoleMessage(&quot;The sun is going nova! Get out now!&quot;, 6); }; 	
				}
			}
		}
	else
		{ if(this.logging) {log(&quot;Player in interstellar space&quot;); }; }
	} </pre></td>
                </tr>
            </table>
        </a>
    </body>
</html>
