<html>
    <head>
        <title>Expansion Realistic Damage</title>
        <link rel="stylesheet" href="../style.css">
    </head>
    <body>
        <table border="0" width="100%">
            <tr>
                <td>Back to <a href='../index.html'>Index</a></td>
                <td align="right"><small>Page generated: Oct 11, 2023, 3:16:49 PM</small></td>
            </tr>
        </table>

        <h1>Expansion Realistic Damage</h1>

        <h2>Content</h2>
        <ul>
          <li><a href="#warnings">Warnings</a></li>
          <li><a href="#manifest">Manifest</a></li>
          <li><a href="#documentation">Documentation</a></li>
          <li><a href="#equipment">0 Equipment</a></li>
          <li><a href="#ships">0 Ships</a></li>
          <li><a href="#models">0 Models</a></li>
          <li><a href="#scripts">1 Scripts</a></li>
        </ul>

          <a name="warnings">
            <h2>Warnings</h2>
            <ol>
                <li>Tags mismatch between OXP Manifest and Expansion Manager at character position 0002 (RIGHT SQUARE BRACKET vs LATIN SMALL LETTER M)(&#39;[]&#39; vs &#39;[mechanics]&#39;)</li>
            </ol>
          </a>

        <a name="manifest">
        <h2>Manifest</h2>
            <table border="1">
                <tr>
                    <th></th>
                    <th>from Expansion Manager's OXP list</th>
                    <th>from Expansion Manifest</th>
                </tr>
                <tr>
                    <td>Description</td>
                    <td>A scripted tweak which causes randomly some equipment to be totally destroyed when it gets damaged.</td>
                    <td>A scripted tweak which causes randomly some equipment to be totally destroyed when it gets damaged.</td>
                </tr>
                <tr>
                    <td>Identifier</td>
                    <td>oolite.oxp.Thargoid.RealisticDamage</td>
                    <td>oolite.oxp.Thargoid.RealisticDamage</td>
                </tr>
                <tr>
                    <td>Title</td>
                    <td>Realistic Damage</td>
                    <td>Realistic Damage</td>
                </tr>
                <tr>
                    <td>Category</td>
                    <td>Mechanics</td>
                    <td>Mechanics</td>
                </tr>
                <tr>
                    <td>Author</td>
                    <td>Thargoid</td>
                    <td>Thargoid</td>
                </tr>
                <tr>
                    <td>Version</td>
                    <td>1.00</td>
                    <td>1.00</td>
                </tr>
                <tr>
                    <td>Tags</td>
                    <td></td>
                    <td>mechanics</td>
                </tr>
                <tr>
                    <td>Required Oolite Version</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Maximum Oolite Version</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Required Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Optional Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Conflict Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Information URL</td>
                    <td><a target="_blank" href="http://wiki.alioth.net/index.php/RealisticDamage_OXP">http://wiki.alioth.net/index.php/RealisticDamage_OXP</a></td>
                    <td><a target="_blank" href="">n/a</a></td>
                </tr>
                <tr>
                    <td>Download URL</td>
                    <td><a target="_blank" href="https://wiki.alioth.net/img_auth.php/5/55/Realistic_Damage_1.00.oxz">https://wiki.alioth.net/img_auth.php/5/55/Realistic_Damage_1.00.oxz</a></td>
                    <td><a target="_blank" href="">n/a</a></td>
                </tr>
                <tr>
                    <td>License</td>
                    <td>Creative Commons Attribution - Non-Commercial - Share Alike 3.0 license with clauses - see readme file</td>
                    <td>Creative Commons Attribution - Non-Commercial - Share Alike 3.0 license with clauses - see readme file</td>
                </tr>
                <tr>
                    <td>File Size</td>
                    <td>n/a</td>
                </tr>
                <tr>
                    <td>Upload date</td>
                    <td>1610873301</td>
                </tr>
            </table>
                </a>

        <a name="documentation">
        <h2>Documentation</h2>
        <p>Also read <a href='http://wiki.alioth.net/index.php/Realistic%20Damage'>http://wiki.alioth.net/index.php/Realistic%20Damage</a></p>
        <h3>Realistic Damage v1.00 ReadMe &amp; License.txt</h3>
        <pre>Realistic Damage OXP by Thargoid.

A small and simple script OXP, which makes equipment damage a little more realistic.

In the vanilla game, most equipment can become damaged but it will never be fully destroyed. This script modifies that, and gives a chance whenever an item is damaged that it will be broken beyond repair and completely destroyed. In such cases repair will not be possible and the item will need to be purchased again from scratch.

The base chance of a damaged piece of equipment being totally destroyed is between 5-10%, and is also weighted by the items complexity (it&#39;s tech level).

For OXP makers, if an item is destroyed the event this.equipmentDestroyed is sent to all other loaded world scripts, with the equipment entity as the parameter (in the same way as this.equipmentDamaged). The script also has a 0.25s delay after the equipmentDamaged trigger, so immediately self-repairing OXP equipment will be immune to destruction.

Requires v1.76 or later of Oolite.

--------------------------------------------------------------

License:

This OXP is released under the Creative Commons Attribution - Non-Commercial - Share Alike 3.0 license with the following clauses:

* Whilst you are free (and encouraged) to re-use any of the scripting, models or texturing in this OXP, the usage must be distinct from that within this OXP. Unique identifiers such as (but not limited to) unique shipdata.plist entity keys, mission variables, script names (this.name), equipment identity strings (EQ_), description list arrays and entity roles must not be re-used without prior agreement. Basically if it&#39;s unique or would identify or overwrite anything in the original OXP, then you may not re-use it (for obvious compatibility reasons).
* rebundling of this OXP within another distribution is permitted as long as it is unchanged. The following derivates however are permitted and except from the above:
	* the conversion of files between XML and openStep.
	* the merging of files with other files of the same type from other OXPs.
* The license information (either as this file or merged into a larger one) must be included in the OXP.
* Even though it is not compulsory, if you are re-using any sizable or recognisable piece of this OXP, please let me know :)

--------------------------------------------------------------

Instructions:

Unzip the file, and then move the folder &quot;Realistic Damage 1.00.oxp&quot; to the AddOns directory of your Oolite installation. 

--------------------------------------------------------------

Version history:

16/08/2012 - Version 1.00, initial release.

--------------------------------------------------------------

Acknowledgements:

With thanks to Eric Walch for the discussion on setting up unique timer IDs for multiple concurrent function triggering, and to IronFist for beta-testing and bug reports.</pre>
        </a>

        <a name="equipment">          
        <h2>Equipment</h2>
            This expansion declares no equipment. This may be related to warnings.
        </a>

        <a name="ships">    
        <h2>Ships</h2>
            This expansion declares no ships. This may be related to warnings.
        </a>

        <a name="models">    
        <h2>Models</h2>
            This expansion declares no models. This may be related to warnings.
        </a>

        <a name="scripts">    
        <h2>Scripts</h2>
            <table>
                <tr>
                    <th>Path</th>
                </tr>
                <tr>
                    <td valign="top">Config/script.js</td>
                    <td><pre>this.name           = &quot;realisticDamage.js&quot;;
this.author         = &quot;Thargoid&quot;;
this.copyright      = &quot;Creative Commons: attribution, non-commercial, sharealike with clauses - see readme.txt&quot;;
this.description    = &quot;Chance for damaged equipment to be totally destroyed&quot;;
this.version        = &quot;1.00&quot;;

this.startUp = function()
	{ this.scriptDelay = new Timer(this, this.$scanScripts, 0.25); }

this.$scanScripts = function()
	{ // delay of 0.25s to ensure all worldscripts are loaded before scanning
	this.scriptArray = []; // array of loaded worldscripts which contain equipmentDestroyed function
	this.damagedArray = []; // array of damaged equipment to be checked for destruction
	if(worldScriptNames.length &gt; 0)
		{
		var scriptCounter = 0 ; // reset the counter
		for(scriptCounter = 0;scriptCounter&lt;worldScriptNames.length;scriptCounter++)
			{
			if(worldScriptNames[scriptCounter] &amp;&amp; worldScripts[worldScriptNames[scriptCounter]] &amp;&amp; worldScripts[worldScriptNames[scriptCounter]].equipmentDestroyed)
				{ this.scriptArray.push(worldScriptNames[scriptCounter]); }
			}
		}
	}

this.shipWillLaunchFromStation = function(station)
	{ this.itemCounter = 0; }
	
this.equipmentDamaged = function(equipment) 
	{
	this.damagedArray.push(equipment);
	this[&quot;checkDelay&quot;+(this.itemCounter++)] = new Timer(this, this.$checkEquipment, 0.25); 
	// unique timer ID for each item, in case of multiple concurrent damages
	}

this.$checkEquipment = function()
	{	
	if(!this.damagedArray || this.damagedArray.length === 0)	{ return; }
	this.damagedEquipment = this.damagedArray.pop();
	if(player.ship.equipmentStatus(this.damagedEquipment) !== &quot;EQUIPMENT_DAMAGED&quot;) { return; }
	this.equipmentItem = EquipmentInfo.infoForKey(this.damagedEquipment);
	this.equipLevel = this.equipmentItem.effectiveTechLevel;
	this.chance = 0.05 + (0.05 * Math.random()) + ((this.equipLevel - 7) * 0.01);
	if(Math.random() &lt; this.chance)
		{
		this.link = (this.equipmentItem.name.length &gt; 1 &amp;&amp; this.equipmentItem.name.charAt(this.equipmentItem.name.length-1) === &quot;s&quot; &amp;&amp; this.equipmentItem.name.charAt(this.equipmentItem.name.length-2) !== &quot;s&quot;) ? &quot; have &quot; : &quot; has &quot;;
		player.consoleMessage(this.equipmentItem.name + this.link + &quot;been destroyed!&quot;);
		player.ship.removeEquipment(this.equipmentItem);
		if(this.scriptArray &amp;&amp; this.scriptArray.length &gt; 0)
			{
			var scriptCounter = 0 ; // reset the counter
			for(scriptCounter = 0;scriptCounter&lt;this.scriptArray.length;scriptCounter++)
				{ worldScripts[this.scriptArray[scriptCounter]].equipmentDestroyed(this.damagedEquipment); }
			}
		}
	}
</pre></td>
                </tr>
            </table>
        </a>
    </body>
</html>
