<html>
    <head>
        <title>Expansion Lazarus</title>
        <link rel="stylesheet" href="../style.css">
    </head>
    <body>
        <table border="0" width="100%">
            <tr>
                <td>Back to <a href='../index.html'>Index</a></td>
                <td align="right"><small>Page generated: Oct 11, 2023, 3:16:49 PM</small></td>
            </tr>
        </table>

        <h1>Expansion Lazarus</h1>

        <h2>Content</h2>
        <ul>
          <li><a href="#warnings">Warnings</a></li>
          <li><a href="#manifest">Manifest</a></li>
          <li><a href="#documentation">Documentation</a></li>
          <li><a href="#equipment">0 Equipment</a></li>
          <li><a href="#ships">0 Ships</a></li>
          <li><a href="#models">0 Models</a></li>
          <li><a href="#scripts">2 Scripts</a></li>
        </ul>

          <a name="warnings">
            <h2>Warnings</h2>
            <ol>
                <li>http://wiki.alioth.net/index.php/Lazarus -&gt; 404 Not Found</li>
                <li>Low hanging fuit: Information URL exists...</li>
                <li>Tags mismatch between OXP Manifest and Expansion Manager at character position 0002 (RIGHT SQUARE BRACKET vs LATIN SMALL LETTER S)(&#39;[]&#39; vs &#39;[ships]&#39;)</li>
            </ol>
          </a>

        <a name="manifest">
        <h2>Manifest</h2>
            <table border="1">
                <tr>
                    <th></th>
                    <th>from Expansion Manager's OXP list</th>
                    <th>from Expansion Manifest</th>
                </tr>
                <tr>
                    <td>Description</td>
                    <td>A small OXP which replaces the trunk Thargoid warship ship script, giving new capabilities of Thargon reanimation plus occasional reinforcements arriving in and just after battles.</td>
                    <td>A small OXP which replaces the trunk Thargoid warship ship script, giving new capabilities of Thargon reanimation plus occasional reinforcements arriving in and just after battles.</td>
                </tr>
                <tr>
                    <td>Identifier</td>
                    <td>oolite.oxp.Thargoid.Lazarus</td>
                    <td>oolite.oxp.Thargoid.Lazarus</td>
                </tr>
                <tr>
                    <td>Title</td>
                    <td>Lazarus</td>
                    <td>Lazarus</td>
                </tr>
                <tr>
                    <td>Category</td>
                    <td>Ships</td>
                    <td>Ships</td>
                </tr>
                <tr>
                    <td>Author</td>
                    <td>Thargoid</td>
                    <td>Thargoid</td>
                </tr>
                <tr>
                    <td>Version</td>
                    <td>1.00</td>
                    <td>1.00</td>
                </tr>
                <tr>
                    <td>Tags</td>
                    <td></td>
                    <td>ships</td>
                </tr>
                <tr>
                    <td>Required Oolite Version</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Maximum Oolite Version</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Required Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Optional Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Conflict Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Information URL</td>
                    <td><a target="_blank" href="http://wiki.alioth.net/index.php/Lazarus_OXP">http://wiki.alioth.net/index.php/Lazarus_OXP</a></td>
                    <td><a target="_blank" href="">n/a</a></td>
                </tr>
                <tr>
                    <td>Download URL</td>
                    <td><a target="_blank" href="https://wiki.alioth.net/img_auth.php/0/09/Lazarus_1.00.oxz">https://wiki.alioth.net/img_auth.php/0/09/Lazarus_1.00.oxz</a></td>
                    <td><a target="_blank" href="">n/a</a></td>
                </tr>
                <tr>
                    <td>License</td>
                    <td>Creative Commons Attribution - Non-Commercial - Share Alike 3.0 license with clauses - see readme file</td>
                    <td>Creative Commons Attribution - Non-Commercial - Share Alike 3.0 license with clauses - see readme file</td>
                </tr>
                <tr>
                    <td>File Size</td>
                    <td>n/a</td>
                </tr>
                <tr>
                    <td>Upload date</td>
                    <td>1610873222</td>
                </tr>
            </table>
                </a>

        <a name="documentation">
        <h2>Documentation</h2>
        
        <h3>Lazarus v1.00 Readme &amp; License.txt</h3>
        <pre>Lazarus OXP by Thargoid.

Something has changed - the bugs have up&#39;d their game. Numerous reports from both civilian and miltary Commanders have told of encounters with Thargoids where, after the battle they were cleaning up the debris and dormant Thargon fighters, a further warship appeared and suddenly all those drones were no longer dormant but flying and blasting. Some unfortunates have even reported this happening with drones that they have already scooped, with more than one ship being destroyed as the drones bust out and start attacking.

So keep your wits about you all, especially Commanders who are unfortunate (or foolish) enough to end up facing off against the bugs in interstellar space!

--------------------------------------------------------------

This OXP is a substitute/replacement oolite-thargoid-warship.js ship script file. It will supercede the existing trunk one, and provide all Thargoid vessels which use the script with the capability to scan for (once every 30-90s) and have a chance (50%) to resurrect previously uncontrolled Thargon fighters and take control of them. 

In the case of Thargons which have already been scooped, there is a 1% chance per ton in the hold that one or more will also be reactivated, causing them to blast their way out of the hold and rejoin the fight and doing nasty damage to the ship in the process.

Additionally if the fight lasts for a longer time, there is a chance that it will attract further warship reinforcements, who may also have the same resurrection capability.

The OXP is designed for seasoned players (they taste better :) ) who are looking for a little more challenge. It shifts the balance back somewhat towards the aliens and makes interstellar space somewhere you really don&#39;t wanna be for long.

It requires Oolite version 1.76 or above to work.

--------------------------------------------------------------
License:

This OXP is released under the Creative Commons Attribution - Non-Commercial - Share Alike 3.0 license with the following clauses:

* Whilst you are free (and encouraged) to re-use any of the scripting, models or texturing in this OXP, the usage must be distinct from that within this OXP. Unique identifiers such as (but not limited to) unique shipdata.plist entity keys, mission variables, script names (this.name), equipment identity strings (EQ_), description list arrays and entity roles must not be re-used without prior agreement.
* rebundling of this OXP within another distribution is permitted as long as it is unchanged. The following derivates however are permitted and except from the above:
	* the conversion of files between XML and openStep.
	* the merging of files with other files of the same type from other OXPs.
* Even though it is not compulsory, if you are re-using any sizable or recognisable piece of this OXP, please let me know :)

--------------------------------------------------------------
Instructions:

Unzip the file, and then move the folder &quot;Lazarus 1.00.oxp&quot; to the AddOns directory of your Oolite installation. 

--------------------------------------------------------------
Version history:

25/03/2013 - First release, version 1.00

--------------------------------------------------------------
Acknowledgements:

With thanks to Gizmo and Cody for beta-testing the script and for valuable feedback. The OXP idea came from a discussion thread on the BB forum.
</pre>
        </a>

        <a name="equipment">          
        <h2>Equipment</h2>
            This expansion declares no equipment. This may be related to warnings.
        </a>

        <a name="ships">    
        <h2>Ships</h2>
            This expansion declares no ships. This may be related to warnings.
        </a>

        <a name="models">    
        <h2>Models</h2>
            This expansion declares no models. This may be related to warnings.
        </a>

        <a name="scripts">    
        <h2>Scripts</h2>
            <table>
                <tr>
                    <th>Path</th>
                </tr>
                <tr>
                    <td valign="top">Config/script.js</td>
                    <td><pre>this.name					= &quot;Lazarus WorldScript&quot;;
this.author					= &quot;Thargoid&quot;;
this.copyright				= &quot;Creative Commons: attribution, non-commercial, sharealike with clauses - see readme.txt&quot;;
this.description			= &quot;WorldScript for Lazarus OXP&quot;;
this.version				= &quot;1.00&quot;;
&quot;use strict&quot;;

this.startUp = function()
	{ 
	log(this.name, &quot;Lazarus OXP - Thargoid warship trunk ship script has been replaced.&quot;); 
	delete this.startUp;
	}

this.$startCountdown = function(entryPos)
	{ 
	this.entryPos = entryPos;
	this.$stopCountdown();
	this.spawnTimer = new Timer(this, this.$spawnShip, (15 + Math.ceil(Math.random() * 45))); 
	}
	
this.$stopCountdown = function()
	{
	if(this.spawnTimer &amp;&amp; this.spawnTimer.isRunning)
		{ 
		this.spawnTimer.stop();
		delete this.spawnTimer;
		}
	}
	
this.$spawnShip = function()
	{ 
	if(this.entryPos)
		{ this.newArrival = system.addShips(&quot;thargoid&quot;, 1, this.entryPos, 12800); }
	}</pre></td>
                </tr>
                <tr>
                    <td valign="top">Scripts/oolite-thargoid-warship.js</td>
                    <td><pre>this.name           = &quot;oolite-thargoid-warship&quot;;
this.author         = &quot;Thargoid&quot;;
this.copyright      = &quot;Creative Commons: attribution, non-commercial, sharealike with clauses - see readme.txt&quot;;
this.description    = &quot;New ship script for Thargoid warships - overwrites and replaces the trunk one&quot;;
this.version        = &quot;1.00&quot;;
&quot;use strict&quot;;

this.shipSpawned = function()
	{
	this.ship.group = new ShipGroup();
	this.ship.group.addShip(this.ship);
	this.ship.group.leader = this.ship;
	this.$reanimate();
	this.scanTimer = new Timer(this, this.$scanForThargons, Math.ceil(Math.random() * 15));
	}

this.shipDied = function()
	{
	this.$stopTimer();
	this.ship.commsMessage(expandDescription(&quot;[thargoid_curses]&quot;));
	}

this.$scanForThargons = function()
	{
	delete this.scanTimer;
	if(!player.ship || !this.ship || !player.ship.isValid || !this.ship.isValid) { return; }	

	if(this.ship.position.distanceTo(player.ship.position) &lt; 25600 &amp;&amp; Math.random() &lt; (manifest.alienItems * 0.01))
		{
		player.consoleMessage(&quot;Focussed alien beam detected.&quot;);
		player.consoleMessage(&quot;Scooped Thargons activated! Weapon fire detected in hold!&quot;);
		player.ship.takeInternalDamage();
		player.ship.energy *= (0.2 + (Math.random() * 0.7));
		manifest.alienItems--;
		for(var i=0; i &lt; manifest.alienItems; i++)
			{ 
			if(Math.random() &lt; 0.5) 
				{ 
				this.ejected = player.ship.ejectItem(&quot;thargon&quot;); 
				this.$swapEntity(this.ejected);
				manifest.alienItems--;
				} 
			}
		}
		
	if(Math.random() &gt; 0.5) { this.$reanimate(); }
	
	if(Math.random() &gt; 0.9 &amp;&amp; this.ship.hasHostileTarget &amp;&amp; worldScripts[&quot;Lazarus WorldScript&quot;])
		{ worldScripts[&quot;Lazarus WorldScript&quot;].$startCountdown(this.ship); }	

	this.scanTimer = new Timer(this, this.$scanForThargons, (15 + Math.ceil(Math.random() * 75)));
	}
	
this.playerWillEnterWitchspace = function()
	{
	if(worldScripts[&quot;Lazarus WorldScript&quot;])
		{ worldScripts[&quot;Lazarus WorldScript&quot;].$stopCountdown(); }
	}	
	
this.$stopTimer = function()
	{
	if(this.scanTimer &amp;&amp; this.scanTimer.isRunning)
		{ 
		this.scanTimer.stop(); 
		delete this.scanTimer;
		}
	}
	
this.$reanimate = function() 
	{ 
	function isUncontrolledThargon(entity) 
		{ 
		return (entity.isShip &amp;&amp; (entity.hasRole(&quot;thargon&quot;) || entity.hasRole(&quot;tharglet&quot;)) &amp;&amp; !entity.isThargoid &amp;&amp; entity.isCargo &amp;&amp; entity.AI === &quot;dumbAI.plist&quot;);
    	}

	var thargonArray = system.filteredEntities(this, isUncontrolledThargon, this.ship, 25600)	
	if(thargonArray.length &gt; 0)
		{
		var thargCounter = thargonArray.length - 1; // reset the counter
		for(thargCounter = thargonArray.length - 1; thargCounter &gt;= 0; thargCounter--)
			{ 
			this.chance = Math.random();
			if(this.chance &lt; 0.5) { this.$swapEntity(thargonArray[thargCounter]); }
			if(this.chance &gt; 0.9) { thargonArray[thargCounter].explode(); }
			}
		}
	}

this.$swapEntity = function(entity)
	{
	if(!entity || entity === null || !entity.isValid) { return; }
	let newThargons = system.addShips(&quot;[&quot; + entity.dataKey + &quot;]&quot;, 1);
	newThargon = newThargons[0];
	newThargon.position = entity.position; 
	newThargon.orientation = entity.orientation; 
	this.ship.group.addShip(newThargon);
	if(this.ship &amp;&amp; this.ship.target &amp;&amp; this.ship.target.isValid) { newThargon.target = this.ship.target; }
	entity.remove();
	}</pre></td>
                </tr>
            </table>
        </a>
    </body>
</html>
