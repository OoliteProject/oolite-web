<html>
    <head>
        <title>Expansion Hard Eject</title>
        <link rel="stylesheet" href="../style.css">
    </head>
    <body>
        <table border="0" width="100%">
            <tr>
                <td>Back to <a href='../index.html'>Index</a></td>
                <td align="right"><small>Page generated: Oct 11, 2023, 3:16:49 PM</small></td>
            </tr>
        </table>

        <h1>Expansion Hard Eject</h1>

        <h2>Content</h2>
        <ul>
          <li><a href="#warnings">Warnings</a></li>
          <li><a href="#manifest">Manifest</a></li>
          <li><a href="#documentation">Documentation</a></li>
          <li><a href="#equipment">0 Equipment</a></li>
          <li><a href="#ships">0 Ships</a></li>
          <li><a href="#models">0 Models</a></li>
          <li><a href="#scripts">1 Scripts</a></li>
        </ul>

          <a name="warnings">
            <h2>Warnings</h2>
            <ol>
                <li>Tags mismatch between OXP Manifest and Expansion Manager at character position 0002 (RIGHT SQUARE BRACKET vs LATIN SMALL LETTER E)(&#39;[]&#39; vs &#39;[ejection, equipment, ship]&#39;)</li>
                <li>Conflict Expansions mismatch between OXP Manifest and Expansion Manager at character position 0064 (DIGIT ZERO vs LATIN SMALL LETTER N)</li>
            </ol>
          </a>

        <a name="manifest">
        <h2>Manifest</h2>
            <table border="1">
                <tr>
                    <th></th>
                    <th>from Expansion Manager's OXP list</th>
                    <th>from Expansion Manifest</th>
                </tr>
                <tr>
                    <td>Description</td>
                    <td>New insurance rules gives you after ejection ship in basic configuration. All lost upgrades displays on F5 screen as damaged. You may restore lost upgrades immediately if system TL allows it or later in system with adequate TL. Insurance covers 50% of lost equipment price.</td>
                    <td>New insurance rules gives you after ejection ship in basic configuration. All lost upgrades displays on F5 screen as damaged. You may restore lost upgrades immediately if system TL allows it or later in system with adequate TL. Insurance covers 50% of lost equipment price.</td>
                </tr>
                <tr>
                    <td>Identifier</td>
                    <td>oolite.oxp.stranger.HardEject</td>
                    <td>oolite.oxp.stranger.HardEject</td>
                </tr>
                <tr>
                    <td>Title</td>
                    <td>Hard Eject</td>
                    <td>Hard Eject</td>
                </tr>
                <tr>
                    <td>Category</td>
                    <td>Mechanics</td>
                    <td>Mechanics</td>
                </tr>
                <tr>
                    <td>Author</td>
                    <td>stranger</td>
                    <td>stranger</td>
                </tr>
                <tr>
                    <td>Version</td>
                    <td>0.4.1</td>
                    <td>0.4.1</td>
                </tr>
                <tr>
                    <td>Tags</td>
                    <td></td>
                    <td>ejection, equipment, ship</td>
                </tr>
                <tr>
                    <td>Required Oolite Version</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Maximum Oolite Version</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Required Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Optional Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Conflict Expansions</td>
                    <td>
                            <li>oolite.oxp.phkb.ShipRepurchase:0</li>
                            <li>oolite.oxp.Thargoid.RepairBots:0</li>
                    </td>
                    <td>
                            <li>oolite.oxp.phkb.ShipRepurchase:</li>
                            <li>oolite.oxp.Thargoid.RepairBots:</li>
                    </td>
                </tr>
                <tr>
                    <td>Information URL</td>
                    <td><a target="_blank" href="http://aegidian.org/bb/viewtopic.php?f=4&amp;t=19581">http://aegidian.org/bb/viewtopic.php?f=4&amp;t=19581</a></td>
                    <td><a target="_blank" href="">n/a</a></td>
                </tr>
                <tr>
                    <td>Download URL</td>
                    <td><a target="_blank" href="https://wiki.alioth.net/img_auth.php/e/e1/HardEject.oxz">https://wiki.alioth.net/img_auth.php/e/e1/HardEject.oxz</a></td>
                    <td><a target="_blank" href="">n/a</a></td>
                </tr>
                <tr>
                    <td>License</td>
                    <td>CC-BY-NC-SA 3.0</td>
                    <td>CC-BY-NC-SA 3.0</td>
                </tr>
                <tr>
                    <td>File Size</td>
                    <td>n/a</td>
                </tr>
                <tr>
                    <td>Upload date</td>
                    <td>1610873492</td>
                </tr>
            </table>
                </a>

        <a name="documentation">
        <h2>Documentation</h2>
        <p>Also read <a href='http://wiki.alioth.net/index.php/Hard%20Eject'>http://wiki.alioth.net/index.php/Hard%20Eject</a></p>
        <h3>ReadMe &amp; License.txt</h3>
        <pre>Hard Eject OXP by Stranger

This OXP is released under the Creative Commons Attribution - Non-Commercial - Share Alike 3.0 license.
You are free to use and distribute this OXP on non-commercial basis. 
Rebundling of this OXP within another distribution is permitted as long as it is unchanged.
Any mods/derivatives of this OXP must be distributed under another names.
The license information (either as this file or merged into a larger one) must be included in the OXP.

--------------------------------------------------------------

This OXP changes game mechanics by implementing more strong (and more realistic!) rules of ship insurance.
By default ejection from ship in escape capsule leads only to loss of cargo (and escape capsule itself). New ship inherits all functional equipment from lost ship regardless of system TL - you get ship fully equipped with high tech gadgets anywhere in low tech systems!
New insurance rules gives you ship in basic configuration. All lost upgrades displays on F5 screen as damaged. You may restore lost upgrades immediately if system TL allows it or later in system with adequate TL. In both cases insurance covers 50% of lost equipment price.
Galactic hyperdrive remains in inventory to prevent trap in isolated systems.
All standard lasers are removed from inventory and replaced with front pulse laser (or miner laser in case of miner scenario).
All pylon mounted items (missiles, mines, extra fuel tanks, pylon mounted galactic hyperdrive pods etc) are removed without compensation.
Extra items, gathered as awards in missions (cloaking device for example) are removed from inventory without compensation.

List of extra items, removed from inventory without compensation:

Military Jammer aka MASC&#39;M
Military Scanner Filtering
Naval Cloaking Device
Naval Energy Unit
Shield Enhancers

To achieve 50% insurance fee you must have CLEAR legal status and do not have ANY installed second-hand (salvaged) equipment!

Enjoy!

--------------------------------------------------------------

COMPATIBILITY ISSUES

This OXP is not compatible with Ship Repurchase OXP (author phkb).
This OXP is not compatible with Repair Bots (author Thargoid) or any such OXP, restoring damaged equipment in flight.

______________________________________________________________

Version history:

13.02.2019 - Version 0.4.1	Converted onto OXZ.
14.04.2018 - Version 0.4	In case of miner scenario ship remains mining laser in front port.
				manifest.plist added.
31.03.2018 - Version 0.3	Script rewritten to dynamically process additional OXP equipment.
03.12.2013 - Version 0.2.	Script modified to prevent infinite loop in case of nonstandard pylon mounted equipment (obsolete, now I have better decision).
				Pylon mounted Galactic Drive pods removed from inventory without compensation.
22.11.2013 - Version 0.1.	Initial release.</pre>
        </a>

        <a name="equipment">          
        <h2>Equipment</h2>
            This expansion declares no equipment. This may be related to warnings.
        </a>

        <a name="ships">    
        <h2>Ships</h2>
            This expansion declares no ships. This may be related to warnings.
        </a>

        <a name="models">    
        <h2>Models</h2>
            This expansion declares no models. This may be related to warnings.
        </a>

        <a name="scripts">    
        <h2>Scripts</h2>
            <table>
                <tr>
                    <th>Path</th>
                </tr>
                <tr>
                    <td valign="top">Scripts/hard_eject.js</td>
                    <td><pre>&quot;use strict&quot;;
this.name                   = &quot;Hard Eject&quot;;
this.author                 = &quot;Stranger&quot;;
this.copyright				= &quot;Creative Commons: attribution, non-commercial, sharealike with clauses - see readme.txt&quot;;
this.description			= &quot;Script for simulating payment for lost equipment after ejecting in escape capsule.&quot;;
this.version				= &quot;0.4.1&quot;;

//this equipment remove in any case
this.$equipment_remove = new Array(
    &quot;EQ_CLOAKING_DEVICE&quot;,
    &quot;EQ_MILITARY_JAMMER&quot;,
    &quot;EQ_MILITARY_SCANNER_FILTER&quot;,
    &quot;EQ_NAVAL_ENERGY_UNIT&quot;,
    &quot;EQ_SHIELD_ENHANCER&quot;
);

this.shipLaunchedFromStation = function()
	{
    this.$escapeFlag = 0;        // reset eject history
    }

this.shipLaunchedEscapePod = function()
    {
    this.$escapeFlag = 1;        // eject recorded
    }

this.shipDockedWithStation = function()
	{
    if (this.$escapeFlag == 1)    // eject detected
        {        
        for (var i = 0; i &lt; this.$equipment_remove.length; i++)
            {
            player.ship.removeEquipment(this.$equipment_remove[i]);
            }
        var shipRoleInfo = player.ship.shipClassName;
        if (shipRoleInfo.indexOf(&quot;Mining&quot;) != -1 || shipRoleInfo.indexOf(&quot;Bushmaster&quot;) != -1)
            {
            player.ship.forwardWeapon = &quot;EQ_WEAPON_MINING_LASER&quot;;   // miner scenario
            }
        else
            {
            player.ship.forwardWeapon = &quot;EQ_WEAPON_PULSE_LASER&quot;;    // generic scenario
            }
        player.ship.aftWeapon = &quot;EQ_WEAPON_NONE&quot;;        
        player.ship.portWeapon = &quot;EQ_WEAPON_NONE&quot;;
        player.ship.starboardWeapon = &quot;EQ_WEAPON_NONE&quot;;
        player.ship.awardEquipment(&quot;EQ_MISSILE_REMOVAL&quot;);

        var eqList = player.ship.equipment;
        // check player legal status AND unlicensed equipment
        if (player.bounty == 0 &amp;&amp; (!missionVariables.anarchies_salvaged_equipment || missionVariables.anarchies_salvaged_equipment == 0))         
            {
            for (var i = 0; i &lt; eqList.length; i++)
                {
                var eq = eqList[i];
                // processing any remaining equipment with exception of Breakable Equipment AND Galactic Hyperdrive
                if (player.ship.equipmentStatus(eq.equipmentKey) == &quot;EQUIPMENT_OK&quot; &amp;&amp; eq.equipmentKey.indexOf(&quot;EQ_BREAKABLE&quot;) &lt; 0 &amp;&amp; eq.equipmentKey != &quot;EQ_GAL_DRIVE&quot; &amp;&amp; eq.damageProbability &gt; 0)
                    {
                    player.ship.setEquipmentStatus(eq.equipmentKey, &quot;EQUIPMENT_DAMAGED&quot;);
                    }    
                }          
            }
        else
            {
            for (var i = 0; i &lt; eqList.length; i++)
                {
                var eq = eqList[i];
                if (eq.equipmentKey.indexOf(&quot;EQ_BREAKABLE&quot;) &lt; 0 &amp;&amp; eq.equipmentKey != &quot;EQ_GAL_DRIVE&quot;)
                    {
                    player.ship.removeEquipment(eq.equipmentKey);
                    }
                }
            missionVariables.anarchies_salvaged_equipment = 0;  // erase salvaged equipment history
            }
        }
    }
</pre></td>
                </tr>
            </table>
        </a>
    </body>
</html>
