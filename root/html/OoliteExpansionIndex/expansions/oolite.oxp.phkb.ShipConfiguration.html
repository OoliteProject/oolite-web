<html>
    <head>
        <title>Expansion Ship Configuration</title>
        <link rel="stylesheet" href="../style.css">
    </head>
    <body>
        <table border="0" width="100%">
            <tr>
                <td>Back to <a href='../index.html'>Index</a></td>
                <td align="right"><small>Page generated: Oct 11, 2023, 3:16:49 PM</small></td>
            </tr>
        </table>

        <h1>Expansion Ship Configuration</h1>

        <h2>Content</h2>
        <ul>
          <li><a href="#warnings">Warnings</a></li>
          <li><a href="#manifest">Manifest</a></li>
          <li><a href="#documentation">Documentation</a></li>
          <li><a href="#equipment">298 Equipment</a></li>
          <li><a href="#ships">1 Ships</a></li>
          <li><a href="#models">0 Models</a></li>
          <li><a href="#scripts">12 Scripts</a></li>
        </ul>

          <a name="warnings">
            <h2>Warnings</h2>
            <ol>
                <li>Required Expansions mismatch between OXP Manifest and Expansion Manager at character position 0066 (DIGIT ZERO vs LATIN SMALL LETTER N)</li>
                <li>Optional Expansions mismatch between OXP Manifest and Expansion Manager at character position 0075 (DIGIT ZERO vs LATIN SMALL LETTER N)</li>
                <li>Conflict Expansions mismatch between OXP Manifest and Expansion Manager at character position 0075 (DIGIT ZERO vs LATIN SMALL LETTER N)</li>
                <li>Information URL mismatch between OXP Manifest and Expansion Manager string length at character position 0</li>
            </ol>
          </a>

        <a name="manifest">
        <h2>Manifest</h2>
            <table border="1">
                <tr>
                    <th></th>
                    <th>from Expansion Manager's OXP list</th>
                    <th>from Expansion Manifest</th>
                </tr>
                <tr>
                    <td>Description</td>
                    <td>Gives all equipment space and weight, and allows ships to be configuration into different roles.</td>
                    <td>Gives all equipment space and weight, and allows ships to be configuration into different roles.</td>
                </tr>
                <tr>
                    <td>Identifier</td>
                    <td>oolite.oxp.phkb.ShipConfiguration</td>
                    <td>oolite.oxp.phkb.ShipConfiguration</td>
                </tr>
                <tr>
                    <td>Title</td>
                    <td>Ship Configuration</td>
                    <td>Ship Configuration</td>
                </tr>
                <tr>
                    <td>Category</td>
                    <td>Mechanics</td>
                    <td>Mechanics</td>
                </tr>
                <tr>
                    <td>Author</td>
                    <td>phkb</td>
                    <td>phkb</td>
                </tr>
                <tr>
                    <td>Version</td>
                    <td>1.4.2</td>
                    <td>1.4.2</td>
                </tr>
                <tr>
                    <td>Tags</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Required Oolite Version</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Maximum Oolite Version</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Required Expansions</td>
                    <td>
                            <li>oolite.oxp.phkb.EquipmentStorage:0</li>
                    </td>
                    <td>
                            <li>oolite.oxp.phkb.EquipmentStorage:</li>
                    </td>
                </tr>
                <tr>
                    <td>Optional Expansions</td>
                    <td>
                            <li>oolite.oxp.CaptMurphy.BreakableTorusDrive:0</li>
                    </td>
                    <td>
                            <li>oolite.oxp.CaptMurphy.BreakableTorusDrive:</li>
                    </td>
                </tr>
                <tr>
                    <td>Conflict Expansions</td>
                    <td>
                            <li>oolite.oxp.CaptMurphy.BreakableEnergyUnit:0</li>
                            <li>oolite.oxp.CaptMurphy.BreakableWitchDrive:0</li>
                            <li>oolite.oxp.CaptMurphy.BreakableShieldGenerators:0</li>
                            <li>oolite.oxp.CaptMurphy.BreakableEngines:0</li>
                            <li>oolite.oxp.redspear.equipment_by_ship_class:0</li>
                            <li>oolite.oxp.redspear.masslock_compensator:0</li>
                            <li>oolite.oxp.redspear.power_to_engines:0</li>
                            <li>oolite.oxp.stranger.HardWay:0</li>
                    </td>
                    <td>
                            <li>oolite.oxp.CaptMurphy.BreakableEnergyUnit:</li>
                            <li>oolite.oxp.CaptMurphy.BreakableWitchDrive:</li>
                            <li>oolite.oxp.CaptMurphy.BreakableShieldGenerators:</li>
                            <li>oolite.oxp.CaptMurphy.BreakableEngines:</li>
                            <li>oolite.oxp.redspear.equipment_by_ship_class:</li>
                            <li>oolite.oxp.redspear.masslock_compensator:</li>
                            <li>oolite.oxp.redspear.power_to_engines:</li>
                            <li>oolite.oxp.stranger.HardWay:</li>
                    </td>
                </tr>
                <tr>
                    <td>Information URL</td>
                    <td><a target="_blank" href=""></a></td>
                    <td><a target="_blank" href="">n/a</a></td>
                </tr>
                <tr>
                    <td>Download URL</td>
                    <td><a target="_blank" href="https://wiki.alioth.net/img_auth.php/8/81/ShipConfiguration.oxz">https://wiki.alioth.net/img_auth.php/8/81/ShipConfiguration.oxz</a></td>
                    <td><a target="_blank" href="">n/a</a></td>
                </tr>
                <tr>
                    <td>License</td>
                    <td>CC-BY-NC-SA 3.0</td>
                    <td>CC-BY-NC-SA 3.0</td>
                </tr>
                <tr>
                    <td>File Size</td>
                    <td>n/a</td>
                </tr>
                <tr>
                    <td>Upload date</td>
                    <td>1691986945</td>
                </tr>
            </table>
                </a>

        <a name="documentation">
        <h2>Documentation</h2>
        <p>Also read <a href='http://wiki.alioth.net/index.php/Ship%20Configuration'>http://wiki.alioth.net/index.php/Ship%20Configuration</a></p>
        <h3>readme.txt</h3>
        <pre>Ship Configuration
By Nick Rogers

Thanks to Redspear, Norby, Devium, Venator Dha, Day, Ngalo, Astrobe, tsoj, DataPacRat and yangoip for their excellent suggestions and testing reports.
Special thanks to Capt Murphy for his excellent set of Breakable equipment OXP&#39;s, the logic for some of which I have incorporated in this OXP.
Also thanks go to Thargoid for his IronHide armour code, which I&#39;ve borrowed code from, as well as CommonSenseOTB&#39;s Custom Shields.

Overview
========
This OXP aims to make the process of configuring your ship more deliberate. Instead of just adding more and more equipment without any implications, equipment will now use space, and the total weight of all equipment and cargo will have a bearing on performance. Decisions can now be made about how to best configure your ship for the role you want to play. If you want to configure your ship for trading, do you sacrifice engine performance or energy for cargo space? If you want to be a bounty hunter, what equipment do you swap out to make room for better shields, or do you change down to a beam laser to lighten the ship? Almost all equipment (including OXP equipment items) have space and weight considerations, and it is up to you to work out the best balance for the role you want to take.

Heat also plays a more important role in gameplay. Firing your lasers continually will slowly heat up your ship, as will using your injectors, using the cloaking device, and being hit with a laser blast when your shields are down. Care needs to be taken so that your ship doesn&#39;t overheat. For instance, attempting to run away from an enemy ship on full injectors will heat up your ship to the point where you will begin to take damage.

Important Note for New Players
==============================
When you first load a saved game with this OXP installed, the calculated space for your installed equipment may require cargo space allocation. In this situation, any cargo in your hold may be removed. If the cargo needs to be removed to make way for equipment, it will be sold and the credits refunded to you.

Equipment Space and Cargo Space
===============================
Each ship has a standard amount of equipment space available to it, with a maximum of 40t in the largest ships. Once that space is filled, some cargo space can be re-allocated as equipment space. In ships with small cargo holds (less than 10t) all the cargo space can be reallocated as equipment space. For larger vessels, up to 75% of their cargo hold can be allocated, to a maximum of 40t. The process of allocating cargo space to equipment space is automatic - when you install a piece of equipment that exceeds the standard equipment space, cargo space will automatically be allocated. The following table provides details on how much equipment space is available:

                    Standard    Reallocated
                    Equipment   Cargo
Ship type           Space       Space       Total
-------------------------------------------------
Adder               15t         2t          17t
Anaconda            40t         40t         80t
Asp Mark II         30t         0t          30t
Boa                 30t         40t         70t
Boa Class Cruiser   35t         40t         75t
Cobra Mark I        15t         10t         25t
Cobra Mark III+     20t         15t         35t
Cobra Mark III*     20t         26t         46t
Fer-de-Lance        20t         12t         32t
Gecko               15t         3t          18t
Krait               15t         2t          17t
Mamba               15t         4t          19t
Moray Star Boat     15t         7t          22t
Moray Medical Boat* 15t         11t         26t
Python              24t         40t         64t
Orbital Shuttle     15t         22t         37t
Sidewinder          15t         0t          15t
Transporter         15t         12t         27t
Worm                15t         5t          20t

+ Note: without cargo bay extension installed
* Note: with cargo bay extension installed.

The &quot;Ship Comparison&quot; OXP will display the equipment space and convertible cargo space values for most ships in the game.

Ship Configuration Screen
=========================
To make changes to the configuration of your ship, go to the F3 Equip Ship screen and select the &quot;Ship Configuration&quot; item from the list.

At the top of the screen are a number of values which will change as you make configuration choices via the menus:

Cash                        This is your current credit balance
Equipment space             The first number is the total amount of equipment space currently in use.
                            The amount in brackets is the total amount of equipment space currently available on the ship.
Cargo space allocation      The first number is the amount of cargo space currently being partitioned for equipment use.
                            The amount in brackets is how much of the cargo hold can be partitioned for equipment use.
Total equipment weight      This is the total weight of all installed equipment items plus cargo.
Bus overload chance			This is the chance of encountering a bus overload situation with your current equipment loadout.

Thrust                      This is the estimated maximum thrust your ship can achieve based on the current weight profile of your ship.
                            The number in brackets is the standard thrust value for this ship as declared by the manufacturer.
Speed                       This is the estimated maximum speed your ship can achieve based on the current weight profile of your ship.
                            The number in brackets is the standard maximum speed value for this ship as declared by the manufacturer.
Pitch                       This is the estimated maximum pitch value your ship can achieve based on the current weight profile of your ship.
                            The number in brackets is the standard pitch value for this ship as declared by the manufacturer.
Roll                        This is the estimated maximum roll value your ship can achieve based on the current weight profile of your ship.
                            The number in brackets is the standard roll value for this ship as declared by the manufacturer.

As you make changes to various parts of your ship the values at the top of the screen will change to reflect the estimated performance.

The configuration of your ship is divided up into 13 main areas: Engines, Hyperdrive, Thrusters, Boosters, Energy, Shields (forward and aft), Fuel Injection, Heat Shields, Armour (forward and aft) and Electrical. The electrical system comprises of the main electrical bus, plus couplings for engines, hyperdrive, thrusters, boosters, energy banks, and forward and aft shields. Weapons are still installed via the F3 Equip Ship interfaces, but as you will see, your weapon choices will have a bearing on the performance of your ship.

Items in the list colored orange can be installed.
Items in the list colored green are the ones currently installed. The negative value in the &quot;Cost&quot; column indicates the refund you will receive when this item is swapped out for another.
Items in the list colored red are the ones currently installed, but are damaged. You should get this item repaired as soon as possible. You will only get 50% of the cost of the item if you replace it.
Items in the list colored light grey can be installed, but are above the class level of the electrical coupling currently installed for that subsystem. There would be a risk of bus overload by installing this item.
Items in the list colored dark grey can be installed only when the electrical coupling for that subsystem is upgraded.

Please note that you must have sufficient credit to purchase a new item before any refund for existing equipment can be applied. The purchase happens before the refund, so you need to have enough credit for the purchase.

Note that some configurations are not possible at some stations. The techlevel for each configuration item is noted below.

Engines
-------
Your engines control how fast your ship flies in normal space. Your level of thrust and maximum speed are dependant on your engines. When damaged, your thrust and speed will be reduced.

Your engines are linked to the fuel injector system - if your engines are damaged, your fuel injectors will not function.

There are 42 different classes of engine:
    Class 1A    -20% thrust, -7% speed below manufacturers specs, but only uses 1t of space, weighs 1t. (TL1)
    Class 1B    -30% thrust, -3% speed below manufacturers specs, but only uses 1t of space, weighs 1t. (TL1)
    Class 1C    -10% thrust, -10% speed below manufacturers specs, but only uses 1t of space, weighs 1t. (TL1)
    Class 1D    -20% thrust, -7% speed below manufacturers specs, but only uses 0.5t of space, weighs 1t. (TL3)
    Class 1E    -30% thrust, -3% speed below manufacturers specs, but only uses 0.5t of space, weighs 1t. (TL3)
    Class 1F    -10% thrust, -10% speed below manufacturers specs, but only uses 0.5t of space, weighs 1t. (TL3)
    Class 2A    Standard factory-fitted engines, achieves published levels of speed and thrust, uses 2t of space, weighs 2t. (TL1)
    Class 2B    -10% thrust, +4% speed over manufacturers specs, uses 2t of space, weighs 2t. (TL1)
    Class 2C    +10% thrust, -4% speed on manufacturers specs, uses 2t of space, weighs 2t. (TL1)
    Class 2D    Standard levels of speed and thrust, uses 1t of space, weighs 1.5t. (TL5)
    Class 2E    -10% thrust, +4% speed over manufacturers specs, uses 1t of space, weighs 1.5t. (TL5)
    Class 2F    +10% thrust, -4% speed on manufacturers specs, uses 1t of space, weighs 1.5t. (TL5)
    Class 3A    Standard levels of thrust, +7% speed over manufacturers specs, uses 3t of space, weighs 3t. (TL4)
    Class 3B    -10% thrust, +12% speed over manufacturers specs, uses 3t of space, weighs 3t. (TL4)
    Class 3C    +10% thrust, +3% speed over manufacturers specs, uses 3t of space, weighs 3t. (TL4)
    Class 3D    Standard levels of thrust, +7% speed over manufacturers specs, uses 1.5t of space, weighs 2t. (TL6)
    Class 3E    -10% thrust, +12% speed over manufacturers specs, uses 1.5t of space, weighs 2t. (TL6)
    Class 3F    +10% thrust, +3% speed over manufacturers specs, uses 1.5t of space, weighs 2t. (TL6)
    Class 4A    +20% thrust, +10% speed over manufacturers specs, uses 4t of space, weighs 3.5t. (TL5)
    Class 4B    +10% thrust, +15% speed over manufacturers specs, uses 4t of space, weighs 3.5t. (TL5)
    Class 4C    +30% thrust, +5% speed over manufacturers specs, uses 4t of space, weighs 3.5t. (TL5)
    Class 4D    +20% thrust, +10% speed over manufacturers specs, uses 2t of space, weighs 3t. (TL8)
    Class 4E    +10% thrust, +15% speed over manufacturers specs, uses 2t of space, weighs 3t. (TL8)
    Class 4F    +30% thrust, +5% speed over manufacturers specs, uses 2t of space, weighs 3t. (TL8)
    Class 5A    +20% thrust, +15% speed over manufacturers specs, uses 6t of space, weighs 4t. (TL6)
    Class 5B    +10% thrust, +20% speed over manufacturers specs, uses 6t of space, weighs 4t. (TL6)
    Class 5C    +30% thrust, +10% speed over manufacturers specs, uses 6t of space, weighs 4t. (TL6)
    Class 5D    +20% thrust, +15% speed over manufacturers specs, uses 3t of space, weighs 3.5t. (TL10)
    Class 5E    +10% thrust, +20% speed over manufacturers specs, uses 3t of space, weighs 3.5t. (TL10)
    Class 5F    +30% thrust, +10% speed over manufacturers specs, uses 3t of space, weighs 3.5t. (TL10)
    Class 6A    +40% thrust, +20% speed over manufacturers specs, uses 8t of space, weighs 5t. (TL7)
    Class 6B    +30% thrust, +25% speed over manufacturers specs, uses 8t of space, weighs 5t. (TL7)
    Class 6C    +50% thrust, +15% speed over manufacturers specs, uses 8t of space, weighs 5t. (TL7)
    Class 6D    +40% thrust, +20% speed over manufacturers specs, uses 4t of space, weighs 4t. (TL12)
    Class 6E    +30% thrust, +25% speed over manufacturers specs, uses 4t of space, weighs 4t. (TL12)
    Class 6F    +50% thrust, +15% speed over manufacturers specs, uses 4t of space, weighs 4t. (TL12)
    Class 7A    +40% thrust, +30% speed over manufacturers specs, uses 10t of space, weighs 6t. (TL9)
    Class 7B    +30% thrust, +35% speed over manufacturers specs, uses 10t of space, weighs 6t. (TL9)
    Class 7C    +50% thrust, +25% speed over manufacturers specs, uses 10t of space, weighs 6t. (TL9)
    Class 7D    +40% thrust, +30% speed over manufacturers specs, uses 5t of space, weighs 5t. (TL14)
    Class 7E    +30% thrust, +35% speed over manufacturers specs, uses 5t of space, weighs 5t. (TL14)
    Class 7F    +50% thrust, +25% speed over manufacturers specs, uses 5t of space, weighs 5t. (TL14)

Engines of class D, E and F will also contribute to cabin heat.

Hyperdrive
----------
Hyperdrives control your ability to jump to other systems. When damaged the hyperdrive might start leaking fuel, or it may fail to engage, or if it does engage it might cause a mis-jump.

There are 4 different classes of hyperdrive:
    Class 1    Takes only 1t of space, but takes 30 seconds to initiate a jump. (TL1)
    Class 2    Standard issue hyperdrive. Takes 2t of space, and takes 15 seconds to jump. (TL1)
    Class 3    Takes 5t of space, and takes 10 seconds to jump. (TL7)
    Class 4    Takes 8t of space, but only takes 5 seconds to jump. (TL13)

Thrusters
---------
Your thrusters control your manoeuvrability, how fast your ship can pitch and roll. When damaged, your pitch and roll rates will be reduced.

There are 37 different classes of thrusters:
    Class 1     -5% pitch, -3% roll below manufacturers specs, but uses no space and only weighs 1t. (TL1)
    Class 2A    Standard factory-fitted thrusters, uses 1t of space, weighs 2t. (TL1)
    Class 2B    +2% pitch, -2% roll on manufacturers specs, uses 1t of space, weighs 2t. (TL1)
    Class 2C    -2% pitch, +2% roll on manufacturers specs, uses 1t of space, weighs 2t. (TL1)
    Class 2D    Standard factory-fitted thrusters, uses 0.5t of space, weighs 1t. (TL3)
    Class 2E    +2% pitch, -2% roll on manufacturers specs, uses 0.5t of space, weighs 1t. (TL3)
    Class 2F    -2% pitch, +2% roll on manufacturers specs, uses 0.5t of space, weighs 1t. (TL3)
    Class 3A    +5% pitch, +5% roll over manufacturers specs, uses 2t of space, weighs 3t. (TL5)
    Class 3B    +7% pitch, +3% roll over manufacturers specs, uses 2t of space, weighs 3t. (TL5)
    Class 3C    +3% pitch, +7% roll over manufacturers specs, uses 2t of space, weighs 3t. (TL5)
    Class 3D    +5% pitch, +5% roll over manufacturers specs, uses 1t of space, weighs 2t. (TL7)
    Class 3E    +7% pitch, +3% roll over manufacturers specs, uses 1t of space, weighs 2t. (TL7)
    Class 3F    +3% pitch, +7% roll over manufacturers specs, uses 1t of space, weighs 2t. (TL7)
    Class 4A    +8% pitch, +8% roll over manufacturers specs, uses 3t of space, weighs 3.5t. (TL7)
    Class 4B    +10% pitch, +6% roll over manufacturers specs, uses 3t of space, weighs 3.5t. (TL7)
    Class 4C    +6% pitch, +10% roll over manufacturers specs, uses 3t of space, weighs 3.5t. (TL7)
    Class 4D    +8% pitch, +8% roll over manufacturers specs, uses 1.5t of space, weighs 2.5t. (TL9)
    Class 4E    +10% pitch, +6% roll over manufacturers specs, uses 1.5t of space, weighs 2.5t. (TL9)
    Class 4F    +6% pitch, +10% roll over manufacturers specs, uses 1.5t of space, weighs 2.5t. (TL9)
    Class 5A    +12% pitch, +12% roll over manufacturers specs, uses 4t of space, weighs 4t. (TL8)
    Class 5B    +14% pitch, +10% roll over manufacturers specs, uses 4t of space, weighs 4t. (TL8)
    Class 5C    +10% pitch, +14% roll over manufacturers specs, uses 4t of space, weighs 4t. (TL8)
    Class 5D    +12% pitch, +12% roll over manufacturers specs, uses 2t of space, weighs 3t. (TL10)
    Class 5E    +14% pitch, +10% roll over manufacturers specs, uses 2t of space, weighs 3t. (TL10)
    Class 5F    +10% pitch, +14% roll over manufacturers specs, uses 2t of space, weighs 3t. (TL10)
    Class 6A    +18% pitch, +18% roll over manufacturers specs, uses 6t of space, weighs 4.5t. (TL9)
    Class 6B    +20% pitch, +16% roll over manufacturers specs, uses 6t of space, weighs 4.5t. (TL9)
    Class 6C    +16% pitch, +20% roll over manufacturers specs, uses 6t of space, weighs 4.5t. (TL9)
    Class 6D    +18% pitch, +18% roll over manufacturers specs, uses 3t of space, weighs 3.5t. (TL12)
    Class 6E    +20% pitch, +16% roll over manufacturers specs, uses 3t of space, weighs 3.5t. (TL12)
    Class 6F    +16% pitch, +20% roll over manufacturers specs, uses 3t of space, weighs 3.5t. (TL12)
    Class 7A    +24% pitch, +24% roll over manufacturers specs, uses 8t of space, weighs 5t. (TL11)
    Class 7B    +26% pitch, +22% roll over manufacturers specs, uses 8t of space, weighs 5t. (TL11)
    Class 7C    +22% pitch, +26% roll over manufacturers specs, uses 8t of space, weighs 5t. (TL11)
    Class 7D    +24% pitch, +24% roll over manufacturers specs, uses 4t of space, weighs 4t. (TL14)
    Class 7E    +26% pitch, +22% roll over manufacturers specs, uses 4t of space, weighs 4t. (TL14)
    Class 7F    +22% pitch, +26% roll over manufacturers specs, uses 4t of space, weighs 4t. (TL14)

Thrusters of class D, E and F will also contribute to cabin heat.

Boosters
--------
Boosters provide a performance increase to both your engines and thrusters. The downside is that you risk overheating your ship if you run over a certain percentage of your maximum speed. For instance, if you have Class 2 boosters installed, which build up heat from 93% of your throttle, then running your engines at more than 93% of their maximum speed will result in your cabin temperature rising. A warning tone will sound and a console message will be displayed when your reach this point during acceleration. When damaged any increase to engine or thruster performance will be lost.

Boosters are only available from hi-tech worlds, and their cost is considerable.

There are 7 different classes of boosters:
	Class 1		+3% to speed, roll and pitch, uses 1t of space, heat buildup from 97% of throttle. (TL9)
	Class 2		+6% to speed, roll and pitch, uses 2t of space, heat buildup from 93% of throttle. (TL10)
	Class 3		+9% to speed, roll and pitch, uses 3t of space, heat buildup from 90% of throttle. (TL11)
	Class 4		+12% to speed, roll and pitch, uses 4t of space, heat buildup from 87% of throttle. (TL12)
	Class 5		+15% to speed, roll and pitch, uses 5t of space, heat buildup from 83% of throttle. (TL13)
	Class 6		+18% to speed, roll and pitch, uses 6t of space, heat buildup from 80% of throttle. (TL14)
	Class 7		+20% to speed, roll and pitch, uses 7t of space, heat buildup from 77% of throttle. (TL15)

Energy
------
Your ship uses energy to fire lasers, operate the ECM system, and powers a number of other systems on your ship. When your energy falls to zero and your ship is hit by an unshielded laser or missile, your ship will be destroyed. More energy means the ability to absorb more damage before destruction. If your energy banks are damaged, items like the naval energy unit and the extra energy unit (both of which control how fast your energy banks are recharged) will not function. When your energy banks are damaged they will begin to drain until you have only emergency reserves remaining. You should dock immediately for repairs.

Because energy banks are just additional energy storage compartments, and there are few complications with the technology, they can be installed and repaired at any station.

You can install up to 25 energy banks in your ship, if you have space. Standard class energy banks take up 1t of space per bank, and weight 1t per bank.

Class &quot;A&quot; energy banks are available at TL13 stations or higher, for around double the cost of their standard class cousins. These energy banks utilise high-yield components to reduce the space required for each energy bank by half. That is, if a Class 9 energy bank uses 9t of space, a Class 9A energy bank will only use 4.5. The units will have the same weight, however.

Also, cabin heat will be increased when using Class &quot;A&quot; energy banks.

It is not possible to &quot;mix-and-match&quot; energy banks. You cannot have 1 set of class 4 energy banks, and another set of class 4A energy banks. They must all be of one type.

The &quot;Extra Energy Unit&quot; equipment item increases the rate at which your energy banks recharge. It uses 3t of space.
The &quot;Naval Energy Unit&quot; equipment item also increases the rate at which your energy banks recharge. It uses 5t of space.

Shields (Forward and Aft)
-------------------------
Shields absorb energy from lasers and missiles. Without shields lasers and missiles can damage and cripple your ship. Stronger shields means you can deflect more attacks, but stronger shields take more space. If your shields are damaged, the shield booster or military shield enhancement will not function, and the benefits they supply (stronger shields that recharge faster) will be lost. If your shield is damaged, the energy will drain away until there is no shield strength at all.

However, you may decide to forgo the protection shields provide and remove them entirely. THIS IS NOT RECOMMENDED! GalCop advises all pilots to install shields as part of their standard setup. If you have either of the shield boosting equipment items installed, you will not be able to remove your shields. If you decide to remove your shields it is highly recommended that some form of armour is installed to compensate.

Apart from the option of removing your shields entirely, there are 5 different classes of shields:
    Class 1    Takes 64 points off the standard level of shields, but also reduces space to just 1t. (TL1)
    Class 2    Standard, factory-fitted shields, uses 2t of space. (TL1)
    Class 3    Adds 64 points to standard level of shields, uses 3t of space. (TL6)
    Class 4    Adds 128 points to standard level of shields, uses 4t of space. (TL9)
    Class 5    Adds 192 points to standard level of shields, uses 5t of space. (TL12)

The &quot;Shield Booster&quot; equipment item adds 128 points to the shield strength. It uses 4t of space.
The &quot;Military Shield Enhancement&quot; equipment item adds a further 128 points to the shields, and increases the rate at which they recharge. It uses 6t of space.

Note that while the &quot;Shield Booster&quot; and &quot;Military Shield Enhancement&quot; have a cumulative effect (that is, if both are installed the total increase to the shields is 256 points), the various shield classes provide a single increase.

Fuel Injection
--------------
Fuel injection systems dump unused Quirium fuel into your engines, giving you a massive boost in speed. If your engines are damaged any fuel injection system will not function.

There are 4 different classes of fuel injection systems:
    Class 1    Burns 50% more fuel per second, and only provides half the speed boost of standard Class 2 injectors. Uses 0.5t of space. (TL5)
    Class 2    Achieves manufacturers declared specifications with regard to fuel burn rate and speed boost. Uses 1t of space. (TL11)
    Class 3    Burns 40% less fuel per second, and gives a 20% speed improvement over standard Class 2 injectors. Uses 2t of space. (TL12)
    Class 4    Burns 60% less fuel per second, and gives a 40% speed improvement over standard Class 2 injectors. But uses 4t of space. (TL13)

Fuel Scoops
-----------
Fuel scoops give pilots a means of replenishing their fuel supply by scooping fuel gasses from the corona of the sun. Each fuel scoop contains an &#39;accumulator&#39;. The fuel scoop accumulator is the storage area inside the scoop where gasses are held prior to being converted into fuel. The larger the accumulator, the faster fuel is scooped.

There are 4 classes of fuel scoop available, each one having a different accumulator size:
    Class 1     0.10 ly accumulator. Weighs 2t. This is the standard type of fuel scoop. (TL6)
    Class 2     0.15 ly accumulator. Weigh6 4t. (TL7)
    Class 3     0.20 ly accumulator. Weighs 6t. (TL9)
    Class 4     0.25 ly accumulator. Weight 8t. (TL11)

Heat Shields
------------
Heat shielding protects your ship when flying close to the sun when skimming fuel. Without shielding your ship will heat up quickly and equipment and cargo can be damaged. Heat shielding will keep your ship cooler for longer, allowing you to easily skim fuel without needing to retreat to a safe distance too often. If your heat shield is damaged your ship will be unprotected from the heat of the sun.

There are 4 different classes of heat shielding, none of which provide any protection from laser or missile attacks, but all of which add weight to your ship.
    Class 1    Adds 0.5 points to the ships base level of protection, but only adds 1t of weight. (TL3)
    Class 2    Adds 1.0 point to the ships base level of protection. This is the general standard level of heat shielding. Adds 3t of weight. (TL5)
    Class 3    Adds 1.5 points to the ships base level of protection. Adds 6t of weight. (TL8)
    Class 4    Adds 2.0 points to the ships base level of protection. Adds 9t of weight. (TL11)
    Class 5    Adds 2.5 points to the ships base level of protection. Adds 12t of weight. (TL12)
    Class 6    Adds 3.0 points to the ships base level of protection. Adds 16t of weight. (TL13)

Note: If your ship comes equipped with manufacturer-fitted heat insulation above the industry standard level of 1.0, then installing additional heat shielding will effectively increase your total value. For instance, if your ship comes with a standard level of 3, and you install class 4 heat shields, your effective heat insulation rating is 5.

Armour (Forward and Aft)
------------------------
Adding armour to your ship can help protect the sensitive equipment contained within when your shields have fallen. Armour can be added to either the front or aft sections of your ship, and you can install different classes of armour in each section.

In total, there are 7 classes of armour you can add to your ship, each with difference weight, strength and damage points.
    Class 1    Lightweight carbon-polymer coating. Armour strength of 100, damage point 85%. Weighs only 2t. (TL3)
    Class 2    Lightweight aluminium plating. Armour strength 125, damage point 80%. Weighs 7t. (TL5)
    Class 3    Polycarbonate casing. Armour strength 150, damage point 75%. Weighs 15t. (TL6)
    Class 4    Composite material. Armour strength 175, damage point 70%. Weighs 25t. (TL8)
    Class 5    Plasteel plating. Armour strength 200, damage point 60%. Weighs 40t. (TL9)
    Class 6    Durasteel plating. Armour strength 300, damage point 50%. Weighs 52t. (TL11)
    Class 7    Titanium plating. Armour strength 400, damage point 40%. Weighs 70t. (TL13)

The strength of the armour defines how well the armour will stand up to attack. When lasers strike unshielded armour, the strength value defines how much of the armour will be depleted. Higher strength values will mean less armour is removed.

The damage point of the armour is the point at which damage to internal components will potentially start to occur. A rating of 85% means that the armour can withstand 15% of damage with no chance that damage will be passed on to equipment. When damage falls below 85%, the chance that equipment will be damaged increases.

Electrical
----------
The electrical subsystem of your ship consists of a main electrical bus, onto which each secondary system connects via a coupling. There are 7 classes of main bus, and different classes of coupling for each secondary system.

High class level electrical buses are expensive and weigh a considerable amount. Most ships come equipped with at least class 2 electrical buses as standard.

Electrical bus items cannot be damaged. If inappropriate couplings and buses are used and bus overload occurs, damage is instead passed through to any equipment using the bus.

Fuel injectors are powered through the main engine, the engine&#39;s power coupling applies to the fuel injectors.
Heat shields are not powered, so do not require a coupling to the electrical system.

There are 7 different classes of main electrical bus:
    Class 1    Can service class 1 couplings. No additional space requirements, and weighs only 1t. (TL1)
    Class 2    Can service up to class 2 couplings. No additional space requirements, weighs 4t. (TL1)
    Class 3    Can service up to class 3 couplings. Uses 2t of space, weighs 7t. (TL5)
    Class 4    Can service up to class 4 couplings. Uses 4t of space, weighs 12t. (TL7)
    Class 5    Can service up to class 5 couplings. Uses 6t of space, weighs 17t. (TL9)
    Class 6    Can service up to class 6 couplings. Uses 8t of space, weighs 23t. (TL11)
    Class 7    Can service up to class 7/8 couplings. Uses 10t of space, weighs 30t. (TL13)

Engine Power Couplings:
    Class 1    Can service class 1 engines. Weighs 0.1t. (TL1)
    Class 2    Can service up to class 2 engines. Weighs 0.2t. (TL1)
    Class 3    Can service up to class 3 engines. Weighs 0.3t. (TL4)
    Class 4    Can service up to class 4 engines. Weighs 0.4t. (TL5)
    Class 5    Can service up to class 5 engines. Weighs 0.5t. (TL6)
    Class 6    Can service up to class 6 engines. Weighs 0.6t. (TL7)
    Class 7    Can service up to class 7 engines. Weighs 0.7t. (TL9)

Hyperdrive Power Couplings:
    Class 1    Can service class 1 hyperdrives. Weighs 0.1t. (TL1)
    Class 2    Can service up to class 2 hyperdrives. Weighs 0.2t. (TL1)
    Class 3    Can service up to class 3 hyperdrives. Weighs 0.3t. (TL7)
    Class 4    Can service up to class 4 hyperdrives. Weighs 0.4t. (TL12)

Thruster Power Couplings:
    Class 1    Can service class 1 thrusters. Weighs 0.1t. (TL1)
    Class 2    Can service up to class 2 thrusters. Weighs 0.2t. (TL1)
    Class 3    Can service up to class 3 thrusters. Weighs 0.3t. (TL5)
    Class 4    Can service up to class 4 thrusters. Weighs 0.4t. (TL7)
    Class 5    Can service up to class 5 thrusters. Weighs 0.5t. (TL8)
    Class 6    Can service up to class 6 thrusters. Weighs 0.6t. (TL9)
    Class 7    Can service up to class 7 thrusters. Weighs 0.7t. (TL11)

Booster Power Couplings:
    Class 1    Can service class 1 boosters. Weighs 0.1t. (TL1)
    Class 2    Can service up to class 2 boosters. Weighs 0.2t. (TL1)
    Class 3    Can service up to class 3 boosters. Weighs 0.3t. (TL5)
    Class 4    Can service up to class 4 boosters. Weighs 0.4t. (TL7)
    Class 5    Can service up to class 5 boosters. Weighs 0.5t. (TL8)
    Class 6    Can service up to class 6 boosters. Weighs 0.6t. (TL9)
    Class 7    Can service up to class 7 boosters. Weighs 0.7t. (TL11)

Energy Bank Power Couplings:
    Class 1    Can service up to class 4 energy banks. Weighs 0.1t. (TL1)
    Class 2    Can service up to class 7 energy banks. Weighs 0.2t. (TL1)
    Class 3    Can service up to class 10 energy banks. Weighs 0.3t. (TL1)
    Class 4    Can service up to class 13 energy banks. Weighs 0.4t. (TL1)
    Class 5    Can service up to class 16 energy banks. Weighs 0.5t. (TL1)
    Class 6    Can service up to class 19 energy banks. Weighs 0.6t. (TL1)
    Class 7    Can service up to class 22 energy banks. Weighs 0.7t. (TL1)
    Class 8    Can service up to class 25 energy banks. Weighs 0.8t. (TL1)

Forward/Aft Shield Power Couplings:
    Class 1    Can service class 1 shields. Weighs 0.1t. (TL1)
    Class 2    Can service up to class 2 shields. Weighs 0.2t. (TL1)
    Class 3    Can service up to class 3 shields. Weighs 0.3t. (TL6)
    Class 4    Can service up to class 4 shields. Weighs 0.4t. (TL9)
    Class 5    Can service up to class 5 shields. Weighs 0.5t. (TL12)

Bus Overload
------------
You can install equipment at +1 class level over the level of the coupling, which in turn can be +1 class level over your main bus. However, running equipment over the coupling or bus class levels runs the risk of energy damage being passed through to equipment, even with full shield strength. If a bus overload occurs, damage can be passed on to *any* equipment item, not just the core systems.

Equipment Space Extensions
--------------------------
In high-tech worlds you can purchase an equipment space extension that does not use cargo space. This involves some reconfiguration of existing equipment racks to allow the extension to be fitted. Only small-to-medium-sized ships can have these extensions fitted, and while more than one can be fitted, there is a maximum allowance of two extensions in any ship.

The extensions come in the following sizes:
	1t			Adds 3t of weight (TL11)
	2t			Adds 5t of weight (TL12)
	5t			Adds 10t of weight (TL13)

Note: Because equipment extensions result in a more tightly arranged configuration of your equipment, there will be a noticable increase in cabin temperature when these items are installed.

Selling Equipment
=================
An interface has been provided where all equipment that takes space or weight can be sold and removed from your ship. Only equipment items that do not have dependant items can be sold (eg. you can&#39;t sell the Extra Energy Unit if you have the Naval Energy Unit installed, you can&#39;t sell a passenger berth if you have a passenger inside it). Selling equipment can reduce the equipment space required as well as reducing weight profile of your ship. The sale price of equipment is 85% of the original price.

Storing Equipment and Cargo
===========================
As an alternative to selling the equipment, every main station has a self-storage facility into which your excess equipment can be transferred. If you choose to store equipment, an F4 interface screen, &quot;Storage facility management&quot;, will be available that will show you all the equipment you have stored at this station or any other station. Equipment stored in the current station can be either sold or reinstalled. Equipment stored in other stations can be sold or transferred to the current station, after paying a transfer fee, but depending on the length of the trip and the number of dangerous systems the transfer ship must take to reach the current system, you may end up losing the equipment.

Most cargo can also be stored in the facilities, and transferred between them. After selecting &quot;Storage facility management&quot;, you will have an option to move cargo from your hold into the facility.

Note: Storage facilities are only available at the main station in each system. If you dock at any other station the F4 interface screen will instead read &quot;Storage facility information&quot; and will provide details of what equipment and cargo you have in storage at the main station.

Note: It is not possible to store upgrades to engines, thrusters, boosters, hyperdrive, shields, or any electrical equipment. Storage of these items is prohibited by station authorities due to safety considerations, as some untrained and unskilled pilots have taken it upon themselves to reinstall their equipment outside of station oversight with unfortunate results.

Note: Slaves, firearms and narcotics cannot be stored in any facility, by GalCop law.

Current Equipment List
======================
This option lists all items installed in your ship that have either a space or weight requirement on your ship. The list is ordered with the largest items at the top, so you can always see what equipment is taking up the most space.

Equipment Specifications
========================
A new interface is now available on the F4 screen, entitled &quot;View equipment specifications&quot;. This interface screen lists all possible equipment items available to the player, and the tech level, space and weight requirements of each item. Note, however, these items may or may not be available for purchase at your station, or indeed even in the system. These items are purely available somewhere in the galaxy, and the list explains what you can expect in terms of space and weight.

The following table lists all the standard equipment and the space/weight requirements for each:

Equipment Item               Space   Weight
-------------------------------------------
Standard Missile             0.0t    0.1t
ECM-hardened Missile         0.0t    0.3t
Quirium Cascade Mine         0.0t    0.2t
Pulse Laser                  0.0t    1.0t
Beam Laser                   0.0t    2.0t
Mining Laser                 0.0t    1.5t
Military Laser               0.0t    3.0t
E.C.M. System                1.0t    1.0t
Large Cargo Bay              0.0t    5.0t
Fuel Scoops                  0.0t    2.0t
Escape Pod                   0.0t    1.0t
Extra Energy Unit            3.0t    3.0t
Naval Energy Unit            5.0t    5.0t
Docking Computer             1.0t    1.0t
Galactic Hyperdrive          1.0t    1.0t
Cloaking Device              1.0t    1.0t
Advanced Space Compass       0.0t    1.0t
Wormhole Scanner             0.0t    1.0t
Shield Boosters              4.0t    4.0t
Military Shield Enhancement  6.0t    6.0t

Any standard equipment item not in this list will have zero space and weight requirements.

Most OXP equipment has been categorised individually. If an item is not recognised by the system, it will assume a value of 1t of space, and 1t of weight. The spreadsheet file provided with the game package, &quot;EquipmentSpecifications.ods&quot; (OpenDocument format) contains a list of all known OXP equipment item keys and related space/weight requirements, as well as a list of all equipment keys that are considered to have no space/weight factor at all.

Cabin Temperature and Heat Sinks
================================
A number of different activities and events will now impact on cabin temperature. These are:
	- Use of your hyperdrive
	- Laser temperature
	- Use of fuel injectors
	- Use of cloaking device
	- Laser hits on an unshielded hull
	- Running your ship with an overloaded electrical bus
	- Installing equipment extensions

Each of these things on their own probably won&#39;t cook your ship, but if you combine two or three of them at the same time you can expect to see your cabin temperature reach dangerous levels quickly.

Therefore care must be taken to (a) select appropriate lasers, engines and thrusters for the roles you want to perform, and (b) be careful how you use your lasers, fuel injectors and the cloaking device to avoid overheating your cabin and potentially causing catastrophic damage to your ship.

Note: Entering hyperspace with high levels of heat increases your chance of having a misjump.

To help with controlling cabin temperature, heat sinks can be purchased at all tech level 2 systems and above. You can purchase several heat sinks, but each one takes up 1t of cargo space, and adds 2t of weight.

To deploy a heat sink, first prime the &quot;Heat Sink Control&quot; item by using the Shift-N key sequence, then press &quot;N&quot; to activate it. Up to approximately 40% of your cabin temperature can be jettisoned in this way, dependant on the size of your ship. For larger ships this value will be closer to 10%.

You can also set the heat sink control to automatically deploy heat sinks whenever your cabin temperature reaches 75% of maximum. To do this, prime the &quot;Heat Sink Control&quot; and then select &quot;B&quot; to change the mode from &quot;Manual control&quot; to &quot;Automatic control&quot;.

Heat sinks can be damaged, and cannot be used when in a damaged state.

Heat Shields also help with cabin heat. Higher levels of heat shield will slow the rate at which cabin temperature builds up.

Heat sinks can be purchased at TL2 systems, for 30 Cr.

3rd Party Interfaces
====================
Purchase notification callbacks
-------------------------------
To have Ship Config callback a function when equipment is purchased, use this interface:

    var sc = worldScripts.ShipConfiguration_Core;
    if (sc) {
        sc.$addCallBack(this.MyFunctionName.bind(this));
    }

In this example, the function &quot;MyFunctionName&quot; will be caused, with the context set to the functions&#39; JS file.

Ships
-----
Equipment Space and Power to Weight ratio:
	Overriding the calculation of equipment space and the power to weight ratio for a particular ship can be done in two ways.

	1. Via Javascript
	To add an override for a particular ship type, add the code to a &quot;startUp&quot; script similar to the following:

		var sc = worldScripts.ShipConfiguration_Core;
		if (sc) {
			sc._shipSpaceExceptions[&quot;Fer-de-Lance&quot;] = [18];
			sc._shipPowerToWeight[&quot;Fer-de-Lance&quot;] = [1.5];
		}


	2. Via scriptInfo in shipdata.plist
	To add an override directly in the shipdata.plist file, add the following lines to the &quot;script_info&quot; section:

		&quot;script_info&quot; = {
			&quot;equipment_space&quot; = 18; // how much default equipment space the ship has
			&quot;power_to_weight&quot; = 1.5; // how powerful is the ship compared to its weight? default of 1, values of 2 or above will mean weight doesn&#39;t have as much effect
		};

	(You can change the &quot;18&quot; and &quot;1.5&quot; to whatever value is appropriate for the ship).

Non-standard primary roles:
	If your ship is only defined with a non-standard role (ie. your ship doesn&#39;t have one of the core roles attached to it when it is spawned), by default the ship will be given the standard, default level of equipment. However, you can still have the appropriate level of equipment for your ship by adding your ship role to the translation list in either of the following ways:

	1. Via Javascript
	To add a translation for your primary role, add this code to a &quot;startUp&quot; script similar to the following:

		var sc = worldScripts.ShipConfiguration_Core;
		if (sc) {
			// make the primary role &quot;my_ship_role&quot; be equivalent to the core role &quot;trader&quot;
			sc._NPCEquivalents[&quot;my_ship_role&quot;] = &quot;trader&quot;;
		}

	2. Via scriptInfo in shipdata.plist
	To add an override directly in the shipdata.plist file, add the following lines to the &quot;script_info&quot; section:

		&quot;script_info&quot; = {
			// make the primary role &quot;my_ship_role&quot; be equivalent to the core role &quot;trader&quot;
			&quot;role_translation&quot; = &quot;my_ship_role|trader&quot;;
		};


Equipment
---------
Overriding the definition of equipment space and weight for a particular piece of equipment can be done in two ways.

1. Via Javascript
Add the following code to a &quot;startUp&quot; script:

    var sc = worldScripts.ShipConfiguration_Core;
    if (sc) sc._equipmentMatrix[&quot;EQ_MY_EQUIPMENT_KEY&quot;] = [2.0,2.0];

The first value is space, the second is weight, both in tons.

2. Via scriptInfo in equipment.plist
To add an override directly in the equipment.plist file, add the following lines to the &quot;script_info&quot; section:

    &quot;script_info&quot; = {
        &quot;equipment_space&quot; = 2.0; // value in tons
        &quot;equipment_weight&quot; = 2.0; // value in tons
    };

Setting both values to zero will mean the equipment is ignored by the system.

Standard logic:
    Missiles take no space, but weigh at least 0.1t.
    Pylon mounted items take no space, but add weight.
    Equipment that uses cargo space won&#39;t use equipment space, but weight might not be 1:1. That is, a 5t cargo spot might weigh 8t.
    Weapons (lasers) generally take no space, but increasing power and/or range means more weight. Uber weapons (designed for capital ships) may actually use equipment or cargo space.

Equipment Heat
--------------
It is possible to add a heat value into the heat calculation for when OXP equipment is in operation by using the &quot;player.ship.script.thirdPartyHeat&quot; property. The following script should be used as a template for OXP equipment scripts:

	&quot;use strict&quot;;
	this.name        = &quot;MyEquipmentOXP_ScriptName&quot;;
	this.description = &quot;Activation and control script for equipment with heat properties.&quot;;
	this.licence     = &quot;CC BY-NC-SA 3.0&quot;;

	this._inOperation = false;  // the equipment may use a different method for determining when it is engaged or not.
	this._heatAmount = 0.8;		// centralised value for heat exchange delta.
								// 0.8 will make the cabin temp rise very slowly. lower numbers may not be visible on their own.
								// ie if this is the only piece of equipment generating heat.
								// higher numbers will make heat rise more quickly.

	this.playerWillEnterWitchspace = function() {
		// assuming the equipment will cease operation during a jump
		if (this._inOperation == true) {
			this._inOperation = false;
			if (player.ship.script.thirdPartyHeat &gt; 0) player.ship.script.thirdPartyHeat -= this._heatAmount;
		}
	}

	this.equipmentDamaged = function(equipKey) {
		if (equipKey == &quot;EQ_MY_EQUIPMENT_KEY&quot; &amp;&amp; this._inOperation == true &amp;&amp; player.ship.script.thirdPartyHeat &gt; 0) {
			this._inOperation = false;
			if (player.ship.script.thirdPartyHeat &gt; 0) player.ship.script.thirdPartyHeat -= this._heatAmount;
		}
	}

	this.activated = function() {
		// assuming the equipment is started and stopped by the &quot;n&quot; Activate key
		if (this._InOperation == true) {
			this._inOperation = false;
			if (player.ship.script.thirdPartyHeat &gt; 0) player.ship.script.thirdPartyHeat -= this._heatAmount;
			return;
		}
		this._inOperation = true;
		if (player.ship.script.thirdPartyHeat &gt;= 0) player.ship.script.thirdPartyHeat += this._heatAmount;
	}

Also see the &quot;shipconfig_witchdriveheat.js&quot; file for another example of applying cabin heat.

Special Note
============
Parts of this OXP borrows heavily from Capt Murphy&#39;s set of &quot;Breakable equipment&quot; OXP&#39;s, specifically:
    Breakable Energy Unit
    Breakable Engines
    Breakable Shield Generators
    Breakable Witchdrive
Most of the logic from those OXP&#39;s is incorporated in this OXP, and therefore those OXP&#39;s have been flagged as incompatible with this one. To use this OXP you must remove those OXP&#39;s from your AddOns folder, or via the in-game manager.

Additionally, redspears &quot;Masslock Compensators&quot; and &quot;Power to Engines&quot; OXP&#39;s, as well as strangers &quot;Hard Way&quot; OXP, manipulate the speed of the ship at different times after launch, which interferes with the functionality of this OXP. They have been flagged as incompatible for the moment until a solution can be implemented.

Requirements
============
The Equipment Storage OXP is a requirement for this pack.

License
=======
This OXP is released under the Creative Commons Attribution - Non-Commercial - Share Alike 3.0 license. To view a copy of this license, visit http://creativecommons.org/licenses/by-nc-sa/3.0/

Some code borrowed from Thargoids &quot;IronHide Armour&quot; OXP, and from CommonSenseOTB&#39;s &quot;Custom Shields&quot; OXP.

Rocket image from http://simpleicon.com/rocket.html
Thermometer image from http://simpleicon.com/temperature_3.html
Chat image from http://simpleicon.com/chat-2.html.
Grating image courtesy of Milosh Andrich (Iratemus@yahoo.com) from http://milosh--andrich.deviantart.com/art/Sci-fi-Texure-pack-05-335817650
Heat sink deployed sound from &quot;Big Door Closed&quot; MP3, sourced from http://soundbible.com/1586-Big-Door-Closed.html Public Domain.
Booster heat warning sound from &quot;School Fire Alarm&quot; MP3, sourced from http://soundbible.com/2022-School-Fire-Alarm.html Attribution 3.0

Discussion
==========
This OXP is discussed at this forum link: http://aegidian.org/bb/viewtopic.php?f=4&amp;t=17842

Version History
===============
1.4.2
- Added some additional items to the ignore equipment list.

1.4.1
- Fixed issue for ships of mass &gt; 500000, where dumping heat sinks would increase cabin temp instead of reducing it.

1.4.0
- Added check for situation where the heat sync control mode becomes out of sync with the associate equipment item.
- Added two missing flags from config options to save game, so they will be restored on game load.
- Overridden default equipment items (Fuel Scoops, Heat Shields and Fuel Injectors), when added by other means, were not getting the additional Ship Configuration item at the same time.
- Fix for code that calculates the weight of weapons when no predefined weight is set (Oolite 1.90 now required).
- Moved core equipment overrides into defined plist.
- Added interface to allow 3rd party functions to be called back when Ship Config equipment is purchased.
- Bug fixes.

1.3.8
- Added ShipVersion equipment items to exclusion lists.
- Fixed some issues where JS errors could occur if the player ship was destroyed.

1.3.7
- Corrected compatibility issue with Email system and armour repair items being recorded as equipment removals.

1.3.6
- Deploying the last heatsink was causing Oolite to crash.
- Fixed issue where HUD was not being restored after viewing the Ship Configuration screen.

1.3.5
- Tweaks to the control of the F3 HUD for simpler integration with Xenon HUD (and any other HUD that might want to integrate with Ship Config).
- Identified &quot;Masslock Compensators&quot; and &quot;Power to Engines&quot; OXP&#39;s as conflicting, and marked them in the manifest.

1.3.4
- Better use of new functions available in later versions of Oolite.

1.3.3
- Correction to cabin heat buildup calculation broken by update 1.3.2 :(

1.3.2
- Adjusted what happens to cabin heat in a nova system, to make it less deadly.
- More fixes for improved compatibility with Coluber CH01 HUD.

1.3.1
- Fixed issue with the F3 HUD occasionally causing issues with Xenon UI and the Coluber CH01 HUD.
- Tweaks to some equipment item names to prevent text overlapping on the F5 screen.

1.3.0
- Equipment storage system made into separate OXP, which is required by this one.

1.2.8
- Bug fixes.

1.2.7
- Ship energy is set to ship max energy whenever this value is updated.
- Tweaks to info string for settings in Library Config, to prevent text truncation.
- Updates to some zoom override values.
- Improved script protection for when the player ejects.
- Improved compatibility with Fuel Injection Cruise Control OXP.

1.2.6
- Starting the docking computer while a hyperspace countdown is active will now successfully disengage the heat buildup.
- Cancelling and then restarting a jump countdown will now display the correct restart time value immediately when restarted.
- Fixed issue with current page number on equipment specifications screen.
- Fixed issue where selling equipment from storage was giving player a credit bonus in some circumstances.
- Fixed issue with &quot;%%&quot; appearing in messages relating to transferred equipment being lost to pirates.
- Fixed issue where selling equipment was not applying correct refund percentage.
- Added missing &quot;+heat&quot; notice for Class 19A energy banks.
- Location of stored equipment was not being displayed correctly after equipment transferred to local system.
- Added flag to Library Config to control whether restrictions will be applied to NPC ships.

1.2.5
- Specialised HUD for the F3 screen will now only update the two custom HUD properties when the F3 screen is displayed.

1.2.4
- Equipment that cannot be sold at a station because of its equivalent tech level will now be displayed in the sell equipment list, but unselectable and with &quot;Low TL&quot; in the cost column.
- Equipment that cannot be sold because other equipment depends on it will now be displayed in the sell equipment list, but unselectable and with &quot;Required&quot; in the cost column.
- Fixed bug with assessing cargo space of unknown equipment items that take up cargo space.
- More script protection for when the player ship is destroyed.
- Code refactoring.

1.2.3
- Adjusted equipment space of Night Adder.

1.2.1
- Removed debug message when selling equipment.
- Fixed HUD switching issue when using HUD Selector.

1.2.0
- Improved handling of player ship death scenarios.
- Added extra equipment items to the ignore equipment list.
- Added specialised HUD for the F3 screen to show equipment and cargo space remaining. Can be disabled via Library Config.
- Updated EquipmentSpecifications.ods file with all current equipment keys specifically recognised.
- Value for &quot;Disable booster sound&quot; setting now saved between sessions.

1.1.3
- Fixed transmit date on Storage Facility payment emails.
- Bug fixes.

1.1.2
- Fixed issue with missing header text on Ship Configuration main menu.
- Adjusted default equipment space for Fer-de-Lance.
- Fixed some invalid ship reference errors during an escape pod sequence.
- Extended the length of time cabin heat warning messages are displayed for.
- Storing equipment for the first time at a station will now incur a deposit fee.
- Fixed issue with cargo weight/space not being including in storage costs.
- Fixed issue with incorrect/misleading labels on cargo storage menu items.
- Code refactoring.

1.1.1
- Fixed bug that was preventing weapon in a starboard mount from being sold.

1.1.0
- Fixed bugs with incorrect amounts being refunded to the player when equipment is sold.
- Fixed issue with incorrect refund amounts being displayed to the player on the &quot;Sell Equipment&quot; page.
- Fixed issue where the ship size price factor was being incorrectly applied to fuel scoops, injectors and heat shields, and all other standard or OXP equipment items on the &quot;Sell Equipment&quot; page.
- Equipment items can only be sold at stations where the can actually be bought as well.
- Non-removable Ship Config equipment (eg Engines, Thrusters), when swapped for another unit, will only refund the price of that unit at the main station, to prevent exploitation.
- Station equipment price factor was not being correctly applied to equipment buy/sell prices.
- Better handling of player ship destruction.
- Tweaks to weight values of engines, thrusters and electrical bus.
- Corrected equipment space values for Adder and Krait in readme and on Wiki page.
- Changed default equipment refund percentage back to 85%.

1.0.0
- Scripted equipment damage was being aggressively repaired by the armour.
- Bus overload timer was being reset while running.

0.9.2
- New equipment items (ie. equipment purchased but not yet exposed to space travel) that are sold/exchanged will now be refunded at 100% of their cost, rather than the default 90%. This means you can swap items in and out to see the impact on ship stats, without having to take a loss on every exchange.
- When setting a course to a target system, F7 screen will now display the new destination.
- Equipment specification interface screen now includes TL required for purchasing equipment, and all equipment items are now being shown (not just the ones available in the current system). Also removed some unnecessary items from the list.

0.9.1
- Adjustment to Ore Processor equipment space requirements.
- Added missing equipment items from Ore Processor OXP.
- Added additional equipment items to the ignore list.
- Code refactoring.

0.9.0
- Forward and aft armour can now be different classes.
- Fixed issue with the armour equipment item not being removed when 100% damaged.
- Purchasing other ship armour (eg IronHide) will now refund the cost of any existing Ship Config armour before removing it.
- Improved code for processing expended heat sinks.
- Added some additional OXP equipment items.
- Bug fixes.

0.8.2
- Corrected minor issue with equipment.plist and fuel scoops.
- Fixed issue with heat not being applied to NPC ships correctly. 
- Consistency adjustments to equipment.plist.
- Added &quot;display_color&quot; property to some equipment items (Oolite v1.85/86 only).
- Bug fixes.

0.8.1
- Fixed issued with cargo not being able to be scooped.

0.8.0
- Added fuel scoop classes 1-4 to configuration menu.
- Armour repairs now won&#39;t generate an &quot;Equipment removed&quot; email.
- Code refactoring.
- Bug fixes.

0.7.2
- Custom scripts will now be attached correctly when a new ship is purchased.

0.7.1
- Fixed faulty LMSS integration.

0.7.0
- Added ability to sell laser weapons from the &quot;Sell Equipment&quot; page.
- Added ability to put laser weapons into storage.
- Fixed script error that could occur when player ejects.
- Tweaked the amount of heat dumped with a heat sink.
- Fixed an issue with large player ships where heat could be added, rather than dumped, when a heat sink is deployed.

0.6.7
- Fixed issue where the core &quot;EQ_HEAT_SHIELD&quot; equipment item was not being added to the ship, meaning that any equipment item that required a heat shield was not able to be installed via the F3 screen (eg PlanetFall Landing Capability).
- Adjusted the heat insulation factors for the heat shielding equipment.

0.6.6
- Updated method for determining player&#39;s next target system, to use new property &quot;nextSystem&quot; (when available in 1.85/6).
- Bus overload chance will slowly decrease during flight the longer the player goes without being hit.
- Tweaked what happens when a bus overload occurs, making it less likely that 3-5 items are damaged almost all at once.
- Added ship roles from Keeper&#39;s YAH Haulers to NPC configuration.
- Added ship roles from YAH to NPC configuration.
- Added equipment from In-System Taxi OXP.
- Fixed issue with equipment items that take up cargo space causing mis-calculations of the available cargo space.
- Checking for an overloaded state now happens more frequently when docked, to cater for scenarios where equipment is added outside the equip ship screen (F3).
- Code refactoring and bug fixes.

0.6.5
- Improvements to the heat sink deployment method.
- Correction to issues with the timer for heat sink detonation control.

0.6.4
- Adjusted space/weight components of UPS Police Scanner and UPS Universal Scanner.
- Fixed issue with core heat shield equipment not being added in the background whenever one of the new heat shield items is purchased.

0.6.3
- Removed some debug messages.
- Removed all unnecessary debug-mode checks.
- Added equipment items from &quot;Vector&quot; OXP.
- Added equipment items from &quot;Ring Racers&quot; OXP.
- Prevented sale of any equipment item that has a zero cost amount (as they are likely to be mission-OXP-related).

0.6.2
- Added logic for NPC&#39;s to turn off cloaking devices if their cabin temperature gets too high.
- Added logic to check whether installing stored equipment has worked before removing it from the storage array.
- Fixed incorrect monkey patching on shipDied and shipRemoved events.

0.6.1
- More equipment items can be transferred to storage, including things like MFD&#39;s and targeting enhancements.
- Removed incorrect restriction for the military shield enhancement (it is not actually dependant on the standard shield boosters).
- Added equipment space override for Asp Mark II Special.
- Armour repair amounts are now in-line with the original cost of the item.
- Fixed issue with equipment price in some OXP stations being ludicrously expensive.

0.6.0
- Added class &quot;A&quot; energy banks, that only take half the space of standard units, but also increase cabin heat.
- Added class &quot;D&quot;, &quot;E&quot; and &quot;F&quot; engines that only take half the space of class &quot;A&quot;, &quot;B&quot; and &quot;C&quot; engines, but they also increase cabin heat.
- Added class &quot;D&quot;, &quot;E&quot; and &quot;F&quot; thrusters that only take half the space of class &quot;A&quot;, &quot;B&quot; and &quot;C&quot; thrusters, but they also increase cabin heat.
- Fixed Javascript error when escape pod is used.
- If the Email System is present, adjusted method used to send emails when selling equipment.
- Changed the equipment space setting for escape pods, as these would be built into the architecture of the ship, not in the equipment racks.
- Added a tech level factor to equipment prices, so equipment should be cheaper in hi-tech systems, and more expensive in low-tech systems.
- Adjusted the used equipment sale reduction from 15% to 10%.
- Adjusted the heat build up from using hyperdrives to be variable based on the class level of hyperdrive.
- Added conflicting status with Redspear&#39;s Equipment by Ship Class OXP.
- Made compatible with Hyperspace Hanger OXP.
- Shields, Shield Boosters and Military Shield Enhancement can now be damaged in any order.
- Fixed issue with multiple passenger berths not being correctly reflected in weight calculations or display screens.
- Fixed issue where damaged shields would continue to decharge even after repairing them.
- Fixed issue where, if the Military Shield Enhancement and the Shield Boosters were damaged, you couldn&#39;t repair the former without repairing the latter, but time and credits would be deducted if you tried.
- Fixed equipment naming convention issue.
- Bug fixes.

0.5.0
- Added equipment space extensions to allow for more equipment without using cargo space, but with weight and cabin temp penalties.
- Adjusted equipment space settings for fuel injectors.
- Turned off some debug messages.
- Toned down colour of storage facility background overlay image.
- Fixed further compatibility issues with Ship Respray.
- Fixed further compatibility issues with Combat Simulator.
- Changed background overlay image during sell negotiations.

0.4.4
- The impact of damaged boosters was not being applied correctly. It wasn&#39;t making any difference if they were damaged.
- Determination of player&#39;s hyperspace destination now considers the presence of the ANA.
- Fixed error when not checking if a timer exists before trying to turn it off.
- Adjusted weight/space settings for boosters.
- Made compatible with &quot;Hyperdrives&quot; OXP.
- Really really fixed the issue with the HUD disappearing after viewing the config screens.

0.4.3
- Was not correctly reading values in script_info from shipdata.

0.4.2
- Fixed spelling error in manifest.plist.

0.4.1
- Fixed small bug that could occur if the amount of used equipment space exactly equals the available space.
- Removed debug message when purchasing a new ship.
- Fixed issue with HUD not becoming visible again when launching while viewing the ship configuration screen..

0.4.0
- Adjusted heat shielding insulation strength for type 3 and 4 heat shields, making them more useful, particularly for sun-skimmers. Also added types 5 and 6 for additional heat shield options.
- Fixed issue where the default level of heat insulation was being reset if heat shield equipment was not specifically installed on a ship.
- Adjustments to manifest.plist.
- Changed short range chart selection range to 7.5ly, rather than 15.
- Better handling of interstellar space conditions.
- Disabled ship configuration F3 item at police/navy stations (repairs are still possible at these stations, though).
- Fixed issue with emails sent when selling equipment not displaying the correct refund amount.
- F3 &quot;Ship configuration&quot; item now has a cost of 0 (zero).
- Added the possibility of having a mis-jump when entering hyperspace with high heat levels.
- Fixed issue with equipment overload state when returning from a combat simulation.

0.3.0
- Included the ability to store most equipment items in a local storage centre, and then retrieve that item at a later date. Also includes ability to sell equipment items directly from storage, or to transfer equipment items between storage facilities.
- Cargo can also be stored in the main station storage facility, and transferred between facilities.
- Included the ability to sell the cloaking device, or any equipment item that has an effective tech level &gt;= 16, through a negotiation process.
- Added warning sounds/notifications when ship temperature reaches critical levels.
- Improved compatibility with the Single-Use witchdrive OXP.
- Added a random element to the process of adding equipment to NPC&#39;s, so not all ships of the same role will have the same equipment.
- Fixed issue where some column headings were not appearing correctly on the main Ship Config screen and the Electrical Bus sub-menu.
- Fixed issue with invalid reference error when energy equipment is damaged.
- Fixed issue with selling of passenger berths not working.
- Removed the Breakable Torus Drive code and the incompatibility flag, moved OXP reference to &quot;optional_oxps&quot;. If you like this feature you can install that OXP directly.
- Removed the station equipmentPriceFactor from equipment price calculations, to avoid the loophole of buying equipment at the main station and selling it at a Rock Hermit for massive profits.
- Fixed bug with armour damage-point calculations that was preventing any damage to equipment from taking place until armour was mostly gone.
- Prevented smuggling compartments from being stored.
- Added some additional role translations.
- Changed &quot;==&quot; comparisons to &quot;===&quot; for performance improvements.
- Equipment refund price set to 85% of original price.
- Turned off free upgrades, turned on equipment installation time.
- Added SniperLock equipment to ignore list.

0.2.0
- Added new equipment configuration item &quot;Boosters&quot; which give a boost to engines and thrusters (allowing your ship to reach higher speeds), but also generate cabin heat.
- Now compatible with Ngalo&#39;s NShields and NPC Equipment Damage OXP&#39;s.
- Fixed issue where buying a new ship was not resetting the stored equipment values on the configuration display.
- Adjusted the weights of the electrical buses.
- NPC fuel injectors now won&#39;t be upgraded if the auto-weapons routine didn&#39;t install them in the first place.
- Added equipment items from Solar Harvester OXP and Single-Use Witchdrive OXP.
- Improved the equipment space calculation, so that ships with more than 35t of cargo space will get at least 20t of equipment space, plus some extra.
- Added means by which non-standard primary roles can be translated into core roles so that appropriate equipment is applied to each ship, rather than just the default equipment.
- Added some additional equipment space exceptions.
- Added some additional zoom factors for various ship types.
- Turned off debug messages.
- Adjustments to code design to allow for NPC equipment failure.
- Bug fixes.

0.1.3
- Further adjustments to Separated Lasers and Sniper Gun space and weight amounts as supplied by Norby.
- Added more NPC config possibilities.
- Removed the &quot;playerRescuedEscapePod&quot; event, because it was unnecessary and it wasn&#39;t firing when I thought it would anyway.
- Fixed spelling mistake on F3 screen description.
- Added ability to allow third party OXP equipment to add their own heat delta value into the cabin heat calculation when in operation.
- Added witchdrive jump heat buildup to heat calculations.

0.1.2
- Fixed issue with cabin temp when heat shield is damaged.
- Adjusted &quot;Separated Lasers&quot; weight values.
- Fixed issue with ships that have 0 cargo (eg Asp) attempting to be given EQ_EQUIPSPACE_0.
- Fixed issue with &quot;thrust&quot; not being set along with &quot;maxThrust&quot;.
- Fixed issue with JS objects not being available when player ejects.

0.1.1
- Added some additional equipment items to the &quot;No equipment space&quot; list.
- Added equipment items from Separated Lasers, Multiple Lasers, Sniper Gun, Trail Detector, Tionisla Reporter, Headlights, FarPlanets.
- Configured the heat sink and the breakable torus drive entity to not get ship configuration.
- Adding in missing JS file for the breakable torus drive.
- Fixed issue with the cleanup routine for heatsinks causing a Javascript error.
- Added missing &quot;;&quot; in shipdata.plist.
- Code improvements.

0.1.0
- Fixed display issues on config screen where one header line was being overwritten.
- Fixed NPC shield mechanics.
- Added a flag to allow use of previous NPC config setup, based on role inclusion. To switch back to using role inclusion, set &quot;this._useExclusions = false&quot; in &quot;shipconfig_npc.js&quot;.
- Selling damaged equipment items will now only refund half the cost of the item.
- Added bus overload chance to ship configuration screen.
- Included fuel injector class level in bus overload calculation, as they use the engines electrical bus.
- Added bus overload factor to temperature calculation.
- Added additional energy bank options, now going up to 25 banks.
- Rebalanced energy bank power couplings, reducing the number of classes to 8 (approx 3 banks per coupling level).
- Updated space/weight definition for Missile Machine from Armoury.oxp to better reflect what this device is.
- Tweaked TL availability for Class 4 Hyperdrives.

0.0.13
- Fixes to NPC equipment routines and heat sink parameter location for consistency with player and NPC ships.

0.0.12
- Config is now applied to all ships, including ones with &quot;auto_weapons&quot; set to false. Config can be switched off for a ship by adding a &quot;no_config = &#39;yes&#39;&quot; to the script info for a ship.
- Laser use, laser strikes, fuel injector use and cloaking device use will now heat up the cabin, which applies to NPC&#39;s as well. New equipment &quot;Heat Sinks&quot; allow for a percentage of cabin temperature to be dumped.
- Added 7 classes of armour that will absorb damage before equipment. If IronHide armour or HardShips armour is installed, Ship Configuration armour items will not be available.
- Added integration with Custom Shields and NPC Shields.
- Fixed spelling mistake on &quot;Equipment Specification&quot; screen.
- Adjusted space/weight requirements for gravity scanners and small and large dishes, from Telescope OXP, based on descriptions.
- Moved most static text to descriptions.plist.
- Fixed missing variable declaration in bus overload code.
- Fixed issue on configuration screen where incorrect text was being displayed when no fuel injectors or heat shields were installed.
- Removed all the &quot;EQ_*_REPAIR&quot; items from equipment.plist, as I figured out how to make the core repair items display properly.
- Fixed issue with &quot;getCargoCapacity&quot; routine, which would return a &quot;NaN&quot; value for some ships.
- Fixed issue with &quot;Unknown escape code in string&quot; errors appearing in log file.
- Configured NPC equipment system, and created templates for most roles.
- Further fixes to the issue where equipment items that take up cargo space were throwing out the available space calculations.
- Updated screenID&#39;s to enable BGS background sounds.
- Cleaned up sound function to avoid the need to check for BGS.
- Updated check for &quot;Allow Big GUI&quot;.
- Toned down overlay images.
- Code refactoring.

0.0.11
- Fixed Java script bug when dumping cargo.
- Added police roles to NPC list.
- Fixed spelling mistake for the heat shield when applying base equipment.
- Fixed issue where equipment items that take cargo space were incorrectly adjusting the maximum cargo space available for equipment.
- Added hyperdrive names, courtesy of Redspear.
- Added passenger berth equipment item to matrix (although it isn&#39;t necessary now that the bugs above have been fixed).
- Damaged core items now appear red on the Ship Configuration main menu.
- Code refactoring and cleanup.

0.0.10
- Fixed issue with equipment space overload status showing with &quot;0t&quot; used cargo space.
- Fixed issue where, after purchasing class 3 or above fuel injectors or heat shields, then saving and loading the game, class 2 items would also be installed.
- Fixed issue where cargo space was being returned to the player after a save/load sequence.

0.0.9
- Added more plumbing for doing specific NPC role configurations.
- Reworked the power to weight ratios to make larger ships harder to move, and smaller ships easier to move. So you can still put everything into an Anaconda, but you won&#39;t turn it into a Cobra.
- Fixed issue with adding default equipment, where the calculation for the engine power coupling was in some situations returning invalid configurations.

0.0.8
- Fixed bug in $addEquipmentDataFromScriptInfo routine that was applying equipment weight value from script_info to equipment space and overwriting whatever had been entered for space.
- Fixed issue where some Cobra Mark III models have a different mass.
- Fixed issue with Ship Respray, where cargo space was disappearing when a respray was purchased.
- Added current class levels to main menu items to make current installed items more visible.

0.0.7
- In an &quot;overloaded&quot; state, you can now switch between selling equipment and changing configuration in order to free up space.
- Fixed issue with the installed equipment list, where player ships with no missiles defined was causing an error.
- Fixed issue where you could install a much lower power coupling regardless of the equipment attached to it.
- Adjusted layout of interface screen.
- Adjusted position of &quot;Ship Configuration&quot; item on F3 screen so that fuel will come before it.
- Adjusted the thruster percentages to give them more range.

0.0.6
- Fixed issue where NPC&#39;s were not getting adjustments applied, and where occasionally the wrong piece of kit was showing up on the player.
- Changed minimum techlevel for doing configuration changes to 2, so you can&#39;t do config changes at Rock Hermits.
- Fixed incorrect text on repair item for breakable torus drive.
- Code refactoring.

0.0.5
- Added equipment items from &quot;Laser Cannons&quot;.
- Added better checking for unknown lasers.

0.0.4
- Really fixed the energy draining away issue.

0.0.3
- Disabled the &quot;overheating engine&quot; code as it wasn&#39;t working as intended.
- Fixed issue (hopefully this time for sure!) where energy was being drained away.
- Fixed issue (hopefully) with being able to purchase multiple items of the same type.
- Adjusted engine upgrade speed values.
- Fixed missing &quot;;&quot; in shipdata.plist.

0.0.2
- Price of upgrades now scaled to ship size (so an engine upgrade for a Boa costs more than an engine upgrade for a Transporter).
- Changed layout of ship config screen to be more intuitive.
- Added a flag to make all upgrades free during testing period.
- Fixed issue (hopefully!) where energy was being drained away on launch.
- Adjusted thrust and speed values for engine upgrades to be more noticeable.
- When cargo is removed to make space for equipment, it will now be sold, rather than just removed.
- Changed power-to-weight ratio for Transporters.
- Changed shield upgrades to be in multiples of 64.
- Changed Class 4 hyperdrive spin time to 5 seconds.
- Moved salvaged equipment (from Anarchies OXP) into the ignore list, as these items are removed on purchase anyway.
- IF BGS is in use, now using the BGS hull bang noise when damage occurs.
- Added logic to cool engines down if you&#39;ve run them in overload for a period of time.
- Bug fixes.
- Code refactoring.

0.0.1
- Initial Alpha release
</pre>
        </a>

        <a name="equipment">          
        <h2>Equipment</h2>
            <table>
                <tr>
                    <th>Name</th>
                    <th>Visible</th>
                    <th>Cost [deci-credits]</th>
                    <th>Tech-Level</th>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_AFT_SHIELD_COUPLING_TYPE1.html">Aft Shields Power Coupling Class 1</a></td>
                    <td>yes</td>
                    <td align="right">5500</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_AFT_SHIELD_COUPLING_TYPE2.html">Aft Shields Power Coupling Class 2</a></td>
                    <td>yes</td>
                    <td align="right">12500</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_AFT_SHIELD_COUPLING_TYPE3.html">Aft Shields Power Coupling Class 3</a></td>
                    <td>yes</td>
                    <td align="right">22500</td>
                    <td align="center">6+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_AFT_SHIELD_COUPLING_TYPE4.html">Aft Shields Power Coupling Class 4</a></td>
                    <td>yes</td>
                    <td align="right">38500</td>
                    <td align="center">9+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_AFT_SHIELD_COUPLING_TYPE5.html">Aft Shields Power Coupling Class 5</a></td>
                    <td>yes</td>
                    <td align="right">53100</td>
                    <td align="center">12+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_AFT_SHIELD_TYPE1.html">Aft Shields Class 1</a></td>
                    <td>yes</td>
                    <td align="right">25000</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_AFT_SHIELD_TYPE2.html">Aft Shields Class 2</a></td>
                    <td>yes</td>
                    <td align="right">55000</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_AFT_SHIELD_TYPE3.html">Aft Shields Class 3</a></td>
                    <td>yes</td>
                    <td align="right">71000</td>
                    <td align="center">6+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_AFT_SHIELD_TYPE4.html">Aft Shields Class 4</a></td>
                    <td>yes</td>
                    <td align="right">125000</td>
                    <td align="center">9+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_AFT_SHIELD_TYPE5.html">Aft Shields Class 5</a></td>
                    <td>yes</td>
                    <td align="right">225000</td>
                    <td align="center">12+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ARMOUR_AFT_TYPE1.html">Aft Armour Plating Class 1</a></td>
                    <td>yes</td>
                    <td align="right">12000</td>
                    <td align="center">3+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ARMOUR_AFT_TYPE1_REPAIR.html">Repair: Aft Armour Plating Class 1</a></td>
                    <td>no</td>
                    <td align="right">600</td>
                    <td align="center">2+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ARMOUR_AFT_TYPE2.html">Aft Armour Plating Class 2</a></td>
                    <td>yes</td>
                    <td align="right">25000</td>
                    <td align="center">5+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ARMOUR_AFT_TYPE2_REPAIR.html">Repair: Aft Armour Plating Class 2</a></td>
                    <td>no</td>
                    <td align="right">1250</td>
                    <td align="center">4+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ARMOUR_AFT_TYPE3.html">Aft Armour Plating Class 3</a></td>
                    <td>yes</td>
                    <td align="right">41000</td>
                    <td align="center">6+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ARMOUR_AFT_TYPE3_REPAIR.html">Repair: Aft Armour Plating Class 3</a></td>
                    <td>no</td>
                    <td align="right">2050</td>
                    <td align="center">5+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ARMOUR_AFT_TYPE4.html">Aft Armour Plating Class 4</a></td>
                    <td>yes</td>
                    <td align="right">77000</td>
                    <td align="center">8+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ARMOUR_AFT_TYPE4_REPAIR.html">Repair: Aft Armour Plating Class 4</a></td>
                    <td>no</td>
                    <td align="right">3850</td>
                    <td align="center">7+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ARMOUR_AFT_TYPE5.html">Aft Armour Plating Class 5</a></td>
                    <td>yes</td>
                    <td align="right">156000</td>
                    <td align="center">9+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ARMOUR_AFT_TYPE5_REPAIR.html">Repair: Aft Armour Plating Class 5</a></td>
                    <td>no</td>
                    <td align="right">7800</td>
                    <td align="center">8+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ARMOUR_AFT_TYPE6.html">Aft Armour Plating Class 6</a></td>
                    <td>yes</td>
                    <td align="right">238000</td>
                    <td align="center">11+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ARMOUR_AFT_TYPE6_REPAIR.html">Repair: Aft Armour Plating Class 6</a></td>
                    <td>no</td>
                    <td align="right">11900</td>
                    <td align="center">10+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ARMOUR_AFT_TYPE7.html">Aft Armour Plating Class 7</a></td>
                    <td>yes</td>
                    <td align="right">538000</td>
                    <td align="center">13+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ARMOUR_AFT_TYPE7_REPAIR.html">Repair: Aft Armour Plating Class 7</a></td>
                    <td>no</td>
                    <td align="right">26900</td>
                    <td align="center">12+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ARMOUR_FORWARD_TYPE1.html">Fwd Armour Plating Class 1</a></td>
                    <td>yes</td>
                    <td align="right">12000</td>
                    <td align="center">3+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ARMOUR_FORWARD_TYPE1_REPAIR.html">Repair: Forward Armour Plating Class 1</a></td>
                    <td>no</td>
                    <td align="right">600</td>
                    <td align="center">2+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ARMOUR_FORWARD_TYPE2.html">Fwd Armour Plating Class 2</a></td>
                    <td>yes</td>
                    <td align="right">25000</td>
                    <td align="center">5+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ARMOUR_FORWARD_TYPE2_REPAIR.html">Repair: Forward Armour Plating Class 2</a></td>
                    <td>no</td>
                    <td align="right">1250</td>
                    <td align="center">4+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ARMOUR_FORWARD_TYPE3.html">Fwd Armour Plating Class 3</a></td>
                    <td>yes</td>
                    <td align="right">41000</td>
                    <td align="center">6+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ARMOUR_FORWARD_TYPE3_REPAIR.html">Repair: Forward Armour Plating Class 3</a></td>
                    <td>no</td>
                    <td align="right">2050</td>
                    <td align="center">5+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ARMOUR_FORWARD_TYPE4.html">Fwd Armour Plating Class 4</a></td>
                    <td>yes</td>
                    <td align="right">77000</td>
                    <td align="center">8+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ARMOUR_FORWARD_TYPE4_REPAIR.html">Repair: Forward Armour Plating Class 4</a></td>
                    <td>no</td>
                    <td align="right">3850</td>
                    <td align="center">7+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ARMOUR_FORWARD_TYPE5.html">Fwd Armour Plating Class 5</a></td>
                    <td>yes</td>
                    <td align="right">156000</td>
                    <td align="center">9+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ARMOUR_FORWARD_TYPE5_REPAIR.html">Repair: Forward Armour Plating Class 5</a></td>
                    <td>no</td>
                    <td align="right">7800</td>
                    <td align="center">8+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ARMOUR_FORWARD_TYPE6.html">Fwd Armour Plating Class 6</a></td>
                    <td>yes</td>
                    <td align="right">238000</td>
                    <td align="center">11+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ARMOUR_FORWARD_TYPE6_REPAIR.html">Repair: Forward Armour Plating Class 6</a></td>
                    <td>no</td>
                    <td align="right">11900</td>
                    <td align="center">10+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ARMOUR_FORWARD_TYPE7.html">Fwd Armour Plating Class 7</a></td>
                    <td>yes</td>
                    <td align="right">538000</td>
                    <td align="center">13+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ARMOUR_FORWARD_TYPE7_REPAIR.html">Repair: Forward Armour Plating Class 7</a></td>
                    <td>no</td>
                    <td align="right">26900</td>
                    <td align="center">12+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ARMOUR_TYPE1.html">Armour Plating Class 1</a></td>
                    <td>no</td>
                    <td align="right">12000</td>
                    <td align="center">3+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ARMOUR_TYPE2.html">Armour Plating Class 2</a></td>
                    <td>no</td>
                    <td align="right">25000</td>
                    <td align="center">5+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ARMOUR_TYPE3.html">Armour Plating Class 3</a></td>
                    <td>no</td>
                    <td align="right">41000</td>
                    <td align="center">6+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ARMOUR_TYPE4.html">Armour Plating Class 4</a></td>
                    <td>no</td>
                    <td align="right">77000</td>
                    <td align="center">8+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ARMOUR_TYPE5.html">Armour Plating Class 5</a></td>
                    <td>no</td>
                    <td align="right">156000</td>
                    <td align="center">9+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ARMOUR_TYPE6.html">Armour Plating Class 6</a></td>
                    <td>no</td>
                    <td align="right">238000</td>
                    <td align="center">11+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ARMOUR_TYPE7.html">Armour Plating Class 7</a></td>
                    <td>no</td>
                    <td align="right">538000</td>
                    <td align="center">13+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_BOOSTERS_COUPLING_TYPE1.html">Boosters Power Coupling Class 1</a></td>
                    <td>yes</td>
                    <td align="right">4000</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_BOOSTERS_COUPLING_TYPE2.html">Boosters Power Coupling Class 2</a></td>
                    <td>yes</td>
                    <td align="right">16000</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_BOOSTERS_COUPLING_TYPE3.html">Boosters Power Coupling Class 3</a></td>
                    <td>yes</td>
                    <td align="right">21000</td>
                    <td align="center">4+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_BOOSTERS_COUPLING_TYPE4.html">Boosters Power Coupling Class 4</a></td>
                    <td>yes</td>
                    <td align="right">28000</td>
                    <td align="center">5+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_BOOSTERS_COUPLING_TYPE5.html">Boosters Power Coupling Class 5</a></td>
                    <td>yes</td>
                    <td align="right">38000</td>
                    <td align="center">6+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_BOOSTERS_COUPLING_TYPE6.html">Boosters Power Coupling Class 6</a></td>
                    <td>yes</td>
                    <td align="right">42000</td>
                    <td align="center">7+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_BOOSTERS_COUPLING_TYPE7.html">Boosters Power Coupling Class 7</a></td>
                    <td>yes</td>
                    <td align="right">58000</td>
                    <td align="center">9+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_BOOSTERS_TYPE1.html">Boosters Class 1</a></td>
                    <td>yes</td>
                    <td align="right">55000</td>
                    <td align="center">9+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_BOOSTERS_TYPE2.html">Boosters Class 2</a></td>
                    <td>yes</td>
                    <td align="right">122000</td>
                    <td align="center">10+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_BOOSTERS_TYPE3.html">Boosters Class 3</a></td>
                    <td>yes</td>
                    <td align="right">197000</td>
                    <td align="center">11+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_BOOSTERS_TYPE4.html">Boosters Class 4</a></td>
                    <td>yes</td>
                    <td align="right">284000</td>
                    <td align="center">12+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_BOOSTERS_TYPE5.html">Boosters Class 5</a></td>
                    <td>yes</td>
                    <td align="right">386000</td>
                    <td align="center">13+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_BOOSTERS_TYPE6.html">Boosters Class 6</a></td>
                    <td>yes</td>
                    <td align="right">511000</td>
                    <td align="center">14+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_BOOSTERS_TYPE7.html">Boosters Class 7</a></td>
                    <td>yes</td>
                    <td align="right">727000</td>
                    <td align="center">15+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ELEC_BUS_TYPE1.html">Main Electrical Bus Class 1</a></td>
                    <td>yes</td>
                    <td align="right">15000</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ELEC_BUS_TYPE2.html">Main Electrical Bus Class 2</a></td>
                    <td>yes</td>
                    <td align="right">48000</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ELEC_BUS_TYPE3.html">Main Electrical Bus Class 3</a></td>
                    <td>yes</td>
                    <td align="right">152000</td>
                    <td align="center">5+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ELEC_BUS_TYPE4.html">Main Electrical Bus Class 4</a></td>
                    <td>yes</td>
                    <td align="right">325000</td>
                    <td align="center">7+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ELEC_BUS_TYPE5.html">Main Electrical Bus Class 5</a></td>
                    <td>yes</td>
                    <td align="right">563000</td>
                    <td align="center">9+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ELEC_BUS_TYPE6.html">Main Electrical Bus Class 6</a></td>
                    <td>yes</td>
                    <td align="right">894000</td>
                    <td align="center">11+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ELEC_BUS_TYPE7.html">Main Electrical Bus Class 7</a></td>
                    <td>yes</td>
                    <td align="right">1225000</td>
                    <td align="center">13+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENERGYBANK_COUPLING_TYPE1.html">Energy Bank Power Coupling Class 1</a></td>
                    <td>yes</td>
                    <td align="right">3000</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENERGYBANK_COUPLING_TYPE2.html">Energy Bank Power Coupling Class 2</a></td>
                    <td>yes</td>
                    <td align="right">8000</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENERGYBANK_COUPLING_TYPE3.html">Energy Bank Power Coupling Class 3</a></td>
                    <td>yes</td>
                    <td align="right">14000</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENERGYBANK_COUPLING_TYPE4.html">Energy Bank Power Coupling Class 4</a></td>
                    <td>yes</td>
                    <td align="right">18000</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENERGYBANK_COUPLING_TYPE5.html">Energy Bank Power Coupling Class 5</a></td>
                    <td>yes</td>
                    <td align="right">23000</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENERGYBANK_COUPLING_TYPE6.html">Energy Bank Power Coupling Class 6</a></td>
                    <td>yes</td>
                    <td align="right">29000</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENERGYBANK_COUPLING_TYPE7.html">Energy Bank Power Coupling Class 7</a></td>
                    <td>yes</td>
                    <td align="right">35000</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENERGYBANK_COUPLING_TYPE8.html">Energy Bank Power Coupling Class 8</a></td>
                    <td>yes</td>
                    <td align="right">42000</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENERGYBANK_TYPE1.html">Energy Banks Class 1</a></td>
                    <td>yes</td>
                    <td align="right">5000</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENERGYBANK_TYPE10.html">Energy Banks Class 10</a></td>
                    <td>yes</td>
                    <td align="right">192220</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENERGYBANK_TYPE10A.html">Energy Banks Class 10A</a></td>
                    <td>yes</td>
                    <td align="right">384440</td>
                    <td align="center">13+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENERGYBANK_TYPE11.html">Energy Banks Class 11</a></td>
                    <td>yes</td>
                    <td align="right">288330</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENERGYBANK_TYPE11A.html">Energy Banks Class 11A</a></td>
                    <td>yes</td>
                    <td align="right">576660</td>
                    <td align="center">13+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENERGYBANK_TYPE12.html">Energy Banks Class 12</a></td>
                    <td>yes</td>
                    <td align="right">432490</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENERGYBANK_TYPE12A.html">Energy Banks Class 12A</a></td>
                    <td>yes</td>
                    <td align="right">864980</td>
                    <td align="center">13+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENERGYBANK_TYPE13.html">Energy Banks Class 13</a></td>
                    <td>yes</td>
                    <td align="right">648740</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENERGYBANK_TYPE13A.html">Energy Banks Class 13A</a></td>
                    <td>yes</td>
                    <td align="right">1297480</td>
                    <td align="center">13+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENERGYBANK_TYPE14.html">Energy Banks Class 14</a></td>
                    <td>yes</td>
                    <td align="right">973110</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENERGYBANK_TYPE14A.html">Energy Banks Class 14A</a></td>
                    <td>yes</td>
                    <td align="right">1946220</td>
                    <td align="center">13+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENERGYBANK_TYPE15.html">Energy Banks Class 15</a></td>
                    <td>yes</td>
                    <td align="right">1459670</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENERGYBANK_TYPE15A.html">Energy Banks Class 15A</a></td>
                    <td>yes</td>
                    <td align="right">2919340</td>
                    <td align="center">13+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENERGYBANK_TYPE16.html">Energy Banks Class 16</a></td>
                    <td>yes</td>
                    <td align="right">1751600</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENERGYBANK_TYPE16A.html">Energy Banks Class 16A</a></td>
                    <td>yes</td>
                    <td align="right">3503200</td>
                    <td align="center">13+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENERGYBANK_TYPE17.html">Energy Banks Class 17</a></td>
                    <td>yes</td>
                    <td align="right">2101920</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENERGYBANK_TYPE17A.html">Energy Banks Class 17A</a></td>
                    <td>yes</td>
                    <td align="right">4203840</td>
                    <td align="center">13+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENERGYBANK_TYPE18.html">Energy Banks Class 18</a></td>
                    <td>yes</td>
                    <td align="right">2522300</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENERGYBANK_TYPE18A.html">Energy Banks Class 18A</a></td>
                    <td>yes</td>
                    <td align="right">5044600</td>
                    <td align="center">13+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENERGYBANK_TYPE19.html">Energy Banks Class 19</a></td>
                    <td>yes</td>
                    <td align="right">3026770</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENERGYBANK_TYPE19A.html">Energy Banks Class 19A</a></td>
                    <td>yes</td>
                    <td align="right">6053540</td>
                    <td align="center">13+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENERGYBANK_TYPE1A.html">Energy Banks Class 1A</a></td>
                    <td>yes</td>
                    <td align="right">10000</td>
                    <td align="center">13+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENERGYBANK_TYPE2.html">Energy Banks Class 2</a></td>
                    <td>yes</td>
                    <td align="right">7500</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENERGYBANK_TYPE20.html">Energy Banks Class 20</a></td>
                    <td>yes</td>
                    <td align="right">3632120</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENERGYBANK_TYPE20A.html">Energy Banks Class 20A</a></td>
                    <td>yes</td>
                    <td align="right">7264240</td>
                    <td align="center">13+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENERGYBANK_TYPE21.html">Energy Banks Class 21</a></td>
                    <td>yes</td>
                    <td align="right">3995330</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENERGYBANK_TYPE21A.html">Energy Banks Class 21A</a></td>
                    <td>yes</td>
                    <td align="right">7990660</td>
                    <td align="center">13+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENERGYBANK_TYPE22.html">Energy Banks Class 22</a></td>
                    <td>yes</td>
                    <td align="right">4394870</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENERGYBANK_TYPE22A.html">Energy Banks Class 22A</a></td>
                    <td>yes</td>
                    <td align="right">8789740</td>
                    <td align="center">13+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENERGYBANK_TYPE23.html">Energy Banks Class 23</a></td>
                    <td>yes</td>
                    <td align="right">4834350</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENERGYBANK_TYPE23A.html">Energy Banks Class 23A</a></td>
                    <td>yes</td>
                    <td align="right">9668700</td>
                    <td align="center">13+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENERGYBANK_TYPE24.html">Energy Banks Class 24</a></td>
                    <td>yes</td>
                    <td align="right">5317790</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENERGYBANK_TYPE24A.html">Energy Banks Class 24A</a></td>
                    <td>yes</td>
                    <td align="right">10635580</td>
                    <td align="center">13+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENERGYBANK_TYPE25.html">Energy Banks Class 25</a></td>
                    <td>yes</td>
                    <td align="right">5849570</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENERGYBANK_TYPE25A.html">Energy Banks Class 25A</a></td>
                    <td>yes</td>
                    <td align="right">11699140</td>
                    <td align="center">13+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENERGYBANK_TYPE2A.html">Energy Banks Class 2A</a></td>
                    <td>yes</td>
                    <td align="right">15000</td>
                    <td align="center">13+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENERGYBANK_TYPE3.html">Energy Banks Class 3</a></td>
                    <td>yes</td>
                    <td align="right">11250</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENERGYBANK_TYPE3A.html">Energy Banks Class 3A</a></td>
                    <td>yes</td>
                    <td align="right">22500</td>
                    <td align="center">13+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENERGYBANK_TYPE4.html">Energy Banks Class 4</a></td>
                    <td>yes</td>
                    <td align="right">16870</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENERGYBANK_TYPE4A.html">Energy Banks Class 4A</a></td>
                    <td>yes</td>
                    <td align="right">33740</td>
                    <td align="center">13+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENERGYBANK_TYPE5.html">Energy Banks Class 5</a></td>
                    <td>yes</td>
                    <td align="right">25310</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENERGYBANK_TYPE5A.html">Energy Banks Class 5A</a></td>
                    <td>yes</td>
                    <td align="right">50620</td>
                    <td align="center">13+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENERGYBANK_TYPE6.html">Energy Banks Class 6</a></td>
                    <td>yes</td>
                    <td align="right">37970</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENERGYBANK_TYPE6A.html">Energy Banks Class 6A</a></td>
                    <td>yes</td>
                    <td align="right">75940</td>
                    <td align="center">13+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENERGYBANK_TYPE7.html">Energy Banks Class 7</a></td>
                    <td>yes</td>
                    <td align="right">56950</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENERGYBANK_TYPE7A.html">Energy Banks Class 7A</a></td>
                    <td>yes</td>
                    <td align="right">113900</td>
                    <td align="center">13+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENERGYBANK_TYPE8.html">Energy Banks Class 8</a></td>
                    <td>yes</td>
                    <td align="right">85430</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENERGYBANK_TYPE8A.html">Energy Banks Class 8A</a></td>
                    <td>yes</td>
                    <td align="right">170860</td>
                    <td align="center">13+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENERGYBANK_TYPE9.html">Energy Banks Class 9</a></td>
                    <td>yes</td>
                    <td align="right">128140</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENERGYBANK_TYPE9A.html">Energy Banks Class 9A</a></td>
                    <td>yes</td>
                    <td align="right">256280</td>
                    <td align="center">13+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENGINE_COUPLING_TYPE1.html">Engine Power Coupling Class 1</a></td>
                    <td>yes</td>
                    <td align="right">4000</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENGINE_COUPLING_TYPE2.html">Engine Power Coupling Class 2</a></td>
                    <td>yes</td>
                    <td align="right">16000</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENGINE_COUPLING_TYPE3.html">Engine Power Coupling Class 3</a></td>
                    <td>yes</td>
                    <td align="right">21000</td>
                    <td align="center">4+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENGINE_COUPLING_TYPE4.html">Engine Power Coupling Class 4</a></td>
                    <td>yes</td>
                    <td align="right">28000</td>
                    <td align="center">5+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENGINE_COUPLING_TYPE5.html">Engine Power Coupling Class 5</a></td>
                    <td>yes</td>
                    <td align="right">38000</td>
                    <td align="center">6+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENGINE_COUPLING_TYPE6.html">Engine Power Coupling Class 6</a></td>
                    <td>yes</td>
                    <td align="right">42000</td>
                    <td align="center">7+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENGINE_COUPLING_TYPE7.html">Engine Power Coupling Class 7</a></td>
                    <td>yes</td>
                    <td align="right">58000</td>
                    <td align="center">9+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENGINE_TYPE1A.html">Engine Class 1A</a></td>
                    <td>yes</td>
                    <td align="right">12000</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENGINE_TYPE1B.html">Engine Class 1B</a></td>
                    <td>yes</td>
                    <td align="right">11500</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENGINE_TYPE1C.html">Engine Class 1C</a></td>
                    <td>yes</td>
                    <td align="right">11700</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENGINE_TYPE1D.html">Engine Class 1D</a></td>
                    <td>yes</td>
                    <td align="right">24000</td>
                    <td align="center">3+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENGINE_TYPE1E.html">Engine Class 1E</a></td>
                    <td>yes</td>
                    <td align="right">23000</td>
                    <td align="center">3+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENGINE_TYPE1F.html">Engine Class 1F</a></td>
                    <td>yes</td>
                    <td align="right">23400</td>
                    <td align="center">3+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENGINE_TYPE2A.html">Engine Class 2A</a></td>
                    <td>yes</td>
                    <td align="right">34000</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENGINE_TYPE2B.html">Engine Class 2B</a></td>
                    <td>yes</td>
                    <td align="right">32000</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENGINE_TYPE2C.html">Engine Class 2C</a></td>
                    <td>yes</td>
                    <td align="right">33000</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENGINE_TYPE2D.html">Engine Class 2D</a></td>
                    <td>yes</td>
                    <td align="right">68000</td>
                    <td align="center">5+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENGINE_TYPE2E.html">Engine Class 2E</a></td>
                    <td>yes</td>
                    <td align="right">64000</td>
                    <td align="center">5+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENGINE_TYPE2F.html">Engine Class 2F</a></td>
                    <td>yes</td>
                    <td align="right">66000</td>
                    <td align="center">5+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENGINE_TYPE3A.html">Engine Class 3A</a></td>
                    <td>yes</td>
                    <td align="right">55500</td>
                    <td align="center">4+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENGINE_TYPE3B.html">Engine Class 3B</a></td>
                    <td>yes</td>
                    <td align="right">54500</td>
                    <td align="center">4+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENGINE_TYPE3C.html">Engine Class 3C</a></td>
                    <td>yes</td>
                    <td align="right">54300</td>
                    <td align="center">4+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENGINE_TYPE3D.html">Engine Class 3D</a></td>
                    <td>yes</td>
                    <td align="right">111000</td>
                    <td align="center">4+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENGINE_TYPE3E.html">Engine Class 3E</a></td>
                    <td>yes</td>
                    <td align="right">109000</td>
                    <td align="center">4+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENGINE_TYPE3F.html">Engine Class 3F</a></td>
                    <td>yes</td>
                    <td align="right">108600</td>
                    <td align="center">4+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENGINE_TYPE4A.html">Engine Class 4A</a></td>
                    <td>yes</td>
                    <td align="right">85000</td>
                    <td align="center">5+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENGINE_TYPE4B.html">Engine Class 4B</a></td>
                    <td>yes</td>
                    <td align="right">85200</td>
                    <td align="center">5+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENGINE_TYPE4C.html">Engine Class 4C</a></td>
                    <td>yes</td>
                    <td align="right">87800</td>
                    <td align="center">5+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENGINE_TYPE4D.html">Engine Class 4D</a></td>
                    <td>yes</td>
                    <td align="right">170000</td>
                    <td align="center">8+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENGINE_TYPE4E.html">Engine Class 4E</a></td>
                    <td>yes</td>
                    <td align="right">170400</td>
                    <td align="center">8+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENGINE_TYPE4F.html">Engine Class 4F</a></td>
                    <td>yes</td>
                    <td align="right">175600</td>
                    <td align="center">8+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENGINE_TYPE5A.html">Engine Class 5A</a></td>
                    <td>yes</td>
                    <td align="right">126000</td>
                    <td align="center">6+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENGINE_TYPE5B.html">Engine Class 5B</a></td>
                    <td>yes</td>
                    <td align="right">125000</td>
                    <td align="center">6+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENGINE_TYPE5C.html">Engine Class 5C</a></td>
                    <td>yes</td>
                    <td align="right">124000</td>
                    <td align="center">6+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENGINE_TYPE5D.html">Engine Class 5D</a></td>
                    <td>yes</td>
                    <td align="right">252000</td>
                    <td align="center">10+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENGINE_TYPE5E.html">Engine Class 5E</a></td>
                    <td>yes</td>
                    <td align="right">250000</td>
                    <td align="center">10+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENGINE_TYPE5F.html">Engine Class 5F</a></td>
                    <td>yes</td>
                    <td align="right">248000</td>
                    <td align="center">10+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENGINE_TYPE6A.html">Engine Class 6A</a></td>
                    <td>yes</td>
                    <td align="right">189000</td>
                    <td align="center">7+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENGINE_TYPE6B.html">Engine Class 6B</a></td>
                    <td>yes</td>
                    <td align="right">187000</td>
                    <td align="center">7+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENGINE_TYPE6C.html">Engine Class 6C</a></td>
                    <td>yes</td>
                    <td align="right">183000</td>
                    <td align="center">7+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENGINE_TYPE6D.html">Engine Class 6D</a></td>
                    <td>yes</td>
                    <td align="right">387000</td>
                    <td align="center">12+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENGINE_TYPE6E.html">Engine Class 6E</a></td>
                    <td>yes</td>
                    <td align="right">374000</td>
                    <td align="center">12+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENGINE_TYPE6F.html">Engine Class 6F</a></td>
                    <td>yes</td>
                    <td align="right">366000</td>
                    <td align="center">12+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENGINE_TYPE7A.html">Engine Class 7A</a></td>
                    <td>yes</td>
                    <td align="right">262000</td>
                    <td align="center">9+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENGINE_TYPE7B.html">Engine Class 7B</a></td>
                    <td>yes</td>
                    <td align="right">269000</td>
                    <td align="center">9+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENGINE_TYPE7C.html">Engine Class 7C</a></td>
                    <td>yes</td>
                    <td align="right">262000</td>
                    <td align="center">9+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENGINE_TYPE7D.html">Engine Class 7D</a></td>
                    <td>yes</td>
                    <td align="right">524000</td>
                    <td align="center">14+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENGINE_TYPE7E.html">Engine Class 7E</a></td>
                    <td>yes</td>
                    <td align="right">538000</td>
                    <td align="center">14+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_ENGINE_TYPE7F.html">Engine Class 7F</a></td>
                    <td>yes</td>
                    <td align="right">523000</td>
                    <td align="center">14+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_EQUIPSPACE_1.html">EquipmentSpace1</a></td>
                    <td>no</td>
                    <td align="right">1</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_EQUIPSPACE_10.html">EquipmentSpace10</a></td>
                    <td>no</td>
                    <td align="right">1</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_EQUIPSPACE_11.html">EquipmentSpace11</a></td>
                    <td>no</td>
                    <td align="right">1</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_EQUIPSPACE_12.html">EquipmentSpace12</a></td>
                    <td>no</td>
                    <td align="right">1</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_EQUIPSPACE_13.html">EquipmentSpace13</a></td>
                    <td>no</td>
                    <td align="right">1</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_EQUIPSPACE_14.html">EquipmentSpace14</a></td>
                    <td>no</td>
                    <td align="right">1</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_EQUIPSPACE_15.html">EquipmentSpace15</a></td>
                    <td>no</td>
                    <td align="right">1</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_EQUIPSPACE_16.html">EquipmentSpace16</a></td>
                    <td>no</td>
                    <td align="right">1</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_EQUIPSPACE_17.html">EquipmentSpace17</a></td>
                    <td>no</td>
                    <td align="right">1</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_EQUIPSPACE_18.html">EquipmentSpace18</a></td>
                    <td>no</td>
                    <td align="right">1</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_EQUIPSPACE_19.html">EquipmentSpace19</a></td>
                    <td>no</td>
                    <td align="right">1</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_EQUIPSPACE_2.html">EquipmentSpace2</a></td>
                    <td>no</td>
                    <td align="right">1</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_EQUIPSPACE_20.html">EquipmentSpace20</a></td>
                    <td>no</td>
                    <td align="right">1</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_EQUIPSPACE_21.html">EquipmentSpace21</a></td>
                    <td>no</td>
                    <td align="right">1</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_EQUIPSPACE_22.html">EquipmentSpace22</a></td>
                    <td>no</td>
                    <td align="right">1</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_EQUIPSPACE_23.html">EquipmentSpace23</a></td>
                    <td>no</td>
                    <td align="right">1</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_EQUIPSPACE_24.html">EquipmentSpace24</a></td>
                    <td>no</td>
                    <td align="right">1</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_EQUIPSPACE_25.html">EquipmentSpace25</a></td>
                    <td>no</td>
                    <td align="right">1</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_EQUIPSPACE_26.html">EquipmentSpace26</a></td>
                    <td>no</td>
                    <td align="right">1</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_EQUIPSPACE_27.html">EquipmentSpace27</a></td>
                    <td>no</td>
                    <td align="right">1</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_EQUIPSPACE_28.html">EquipmentSpace28</a></td>
                    <td>no</td>
                    <td align="right">1</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_EQUIPSPACE_29.html">EquipmentSpace29</a></td>
                    <td>no</td>
                    <td align="right">1</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_EQUIPSPACE_3.html">EquipmentSpace3</a></td>
                    <td>no</td>
                    <td align="right">1</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_EQUIPSPACE_30.html">EquipmentSpace30</a></td>
                    <td>no</td>
                    <td align="right">1</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_EQUIPSPACE_31.html">EquipmentSpace31</a></td>
                    <td>no</td>
                    <td align="right">1</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_EQUIPSPACE_32.html">EquipmentSpace32</a></td>
                    <td>no</td>
                    <td align="right">1</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_EQUIPSPACE_33.html">EquipmentSpace33</a></td>
                    <td>no</td>
                    <td align="right">1</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_EQUIPSPACE_34.html">EquipmentSpace34</a></td>
                    <td>no</td>
                    <td align="right">1</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_EQUIPSPACE_35.html">EquipmentSpace35</a></td>
                    <td>no</td>
                    <td align="right">1</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_EQUIPSPACE_36.html">EquipmentSpace36</a></td>
                    <td>no</td>
                    <td align="right">1</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_EQUIPSPACE_37.html">EquipmentSpace37</a></td>
                    <td>no</td>
                    <td align="right">1</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_EQUIPSPACE_38.html">EquipmentSpace38</a></td>
                    <td>no</td>
                    <td align="right">1</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_EQUIPSPACE_39.html">EquipmentSpace39</a></td>
                    <td>no</td>
                    <td align="right">1</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_EQUIPSPACE_4.html">EquipmentSpace4</a></td>
                    <td>no</td>
                    <td align="right">1</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_EQUIPSPACE_40.html">EquipmentSpace40</a></td>
                    <td>no</td>
                    <td align="right">1</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_EQUIPSPACE_5.html">EquipmentSpace5</a></td>
                    <td>no</td>
                    <td align="right">1</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_EQUIPSPACE_6.html">EquipmentSpace6</a></td>
                    <td>no</td>
                    <td align="right">1</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_EQUIPSPACE_7.html">EquipmentSpace7</a></td>
                    <td>no</td>
                    <td align="right">1</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_EQUIPSPACE_8.html">EquipmentSpace8</a></td>
                    <td>no</td>
                    <td align="right">1</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_EQUIPSPACE_9.html">EquipmentSpace9</a></td>
                    <td>no</td>
                    <td align="right">1</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_EXTENSION_1.html">1t Equipment Space Extension</a></td>
                    <td>yes</td>
                    <td align="right">20000</td>
                    <td align="center">11+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_EXTENSION_2.html">2t Equipment Space Extension</a></td>
                    <td>yes</td>
                    <td align="right">50000</td>
                    <td align="center">12+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_EXTENSION_5.html">5t Equipment Space Extension</a></td>
                    <td>yes</td>
                    <td align="right">100000</td>
                    <td align="center">13+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_FORWARD_SHIELD_COUPLING_TYPE1.html">Fwd Shields Power Coupling Class 1</a></td>
                    <td>yes</td>
                    <td align="right">5500</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_FORWARD_SHIELD_COUPLING_TYPE2.html">Fwd Shields Power Coupling Class 2</a></td>
                    <td>yes</td>
                    <td align="right">12500</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_FORWARD_SHIELD_COUPLING_TYPE3.html">Fwd Shields Power Coupling Class 3</a></td>
                    <td>yes</td>
                    <td align="right">22500</td>
                    <td align="center">6+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_FORWARD_SHIELD_COUPLING_TYPE4.html">Fwd Shields Power Coupling Class 4</a></td>
                    <td>yes</td>
                    <td align="right">38500</td>
                    <td align="center">9+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_FORWARD_SHIELD_COUPLING_TYPE5.html">Fwd Shields Power Coupling Class 5</a></td>
                    <td>yes</td>
                    <td align="right">53100</td>
                    <td align="center">12+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_FORWARD_SHIELD_TYPE1.html">Fwd Shields Class 1</a></td>
                    <td>yes</td>
                    <td align="right">25000</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_FORWARD_SHIELD_TYPE2.html">Fwd Shields Class 2</a></td>
                    <td>yes</td>
                    <td align="right">55000</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_FORWARD_SHIELD_TYPE3.html">Fwd Shields Class 3</a></td>
                    <td>yes</td>
                    <td align="right">71000</td>
                    <td align="center">6+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_FORWARD_SHIELD_TYPE4.html">Fwd Shields Class 4</a></td>
                    <td>yes</td>
                    <td align="right">125000</td>
                    <td align="center">9+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_FORWARD_SHIELD_TYPE5.html">Fwd Shields Class 5</a></td>
                    <td>yes</td>
                    <td align="right">225000</td>
                    <td align="center">12+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_FUEL_INJECTION_TYPE1.html">Witchdrive Fuel Injectors Class 1</a></td>
                    <td>yes</td>
                    <td align="right">2000</td>
                    <td align="center">5+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_FUEL_INJECTION_TYPE2.html">Witchdrive Fuel Injectors Class 2</a></td>
                    <td>yes</td>
                    <td align="right">6000</td>
                    <td align="center">11+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_FUEL_INJECTION_TYPE3.html">Witchdrive Fuel Injectors Class 3</a></td>
                    <td>yes</td>
                    <td align="right">12500</td>
                    <td align="center">12+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_FUEL_INJECTION_TYPE4.html">Witchdrive Fuel Injectors Class 4</a></td>
                    <td>yes</td>
                    <td align="right">35000</td>
                    <td align="center">13+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_FUEL_SCOOPS_TYPE1.html">Fuel Scoops Class 1</a></td>
                    <td>yes</td>
                    <td align="right">5250</td>
                    <td align="center">6+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_FUEL_SCOOPS_TYPE2.html">Fuel Scoops Class 2</a></td>
                    <td>yes</td>
                    <td align="right">6780</td>
                    <td align="center">7+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_FUEL_SCOOPS_TYPE3.html">Fuel Scoops Class 3</a></td>
                    <td>yes</td>
                    <td align="right">22000</td>
                    <td align="center">9+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_FUEL_SCOOPS_TYPE4.html">Fuel Scoops Class 4</a></td>
                    <td>yes</td>
                    <td align="right">42500</td>
                    <td align="center">11+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_HEAT_SHIELD_TYPE1.html">External Heat Shielding Class 1</a></td>
                    <td>yes</td>
                    <td align="right">8000</td>
                    <td align="center">3+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_HEAT_SHIELD_TYPE2.html">External Heat Shielding Class 2</a></td>
                    <td>yes</td>
                    <td align="right">15000</td>
                    <td align="center">5+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_HEAT_SHIELD_TYPE3.html">External Heat Shielding Class 3</a></td>
                    <td>yes</td>
                    <td align="right">34000</td>
                    <td align="center">8+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_HEAT_SHIELD_TYPE4.html">External Heat Shielding Class 4</a></td>
                    <td>yes</td>
                    <td align="right">52000</td>
                    <td align="center">11+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_HEAT_SHIELD_TYPE5.html">External Heat Shielding Class 5</a></td>
                    <td>yes</td>
                    <td align="right">76000</td>
                    <td align="center">12+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_HEAT_SHIELD_TYPE6.html">External Heat Shielding Class 6</a></td>
                    <td>yes</td>
                    <td align="right">89000</td>
                    <td align="center">13+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_HEAT_SINK.html">Heat Sink</a></td>
                    <td>yes</td>
                    <td align="right">300</td>
                    <td align="center">2+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_HEAT_SINK_CONTROL.html">Heat Sink Control</a></td>
                    <td>yes</td>
                    <td align="right">3200</td>
                    <td align="center">2+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_HEAT_SINK_CONTROL_PASSIVE.html">Heat Sink Control</a></td>
                    <td>yes</td>
                    <td align="right">3200</td>
                    <td align="center">2+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_HYPERDRIVE_COUPLING_TYPE1.html">Hyperdrive Power Coupling Class 1</a></td>
                    <td>yes</td>
                    <td align="right">5000</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_HYPERDRIVE_COUPLING_TYPE2.html">Hyperdrive Power Coupling Class 2</a></td>
                    <td>yes</td>
                    <td align="right">17500</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_HYPERDRIVE_COUPLING_TYPE3.html">Hyperdrive Power Coupling Class 3</a></td>
                    <td>yes</td>
                    <td align="right">25000</td>
                    <td align="center">7+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_HYPERDRIVE_COUPLING_TYPE4.html">Hyperdrive Power Coupling Class 4</a></td>
                    <td>yes</td>
                    <td align="right">67000</td>
                    <td align="center">12+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_HYPERDRIVE_TYPE1.html">AM18 Hyperdrive (Class 1)</a></td>
                    <td>yes</td>
                    <td align="right">15000</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_HYPERDRIVE_TYPE2.html">Prosset Hyperdrive (Class 2)</a></td>
                    <td>yes</td>
                    <td align="right">32000</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_HYPERDRIVE_TYPE3.html">CK40 V Ames Drive (Class 3)</a></td>
                    <td>yes</td>
                    <td align="right">56000</td>
                    <td align="center">7+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_HYPERDRIVE_TYPE4.html">Titronix Intersun Hyperdrive (Class 4)</a></td>
                    <td>yes</td>
                    <td align="right">112000</td>
                    <td align="center">13+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_NO_AFT_SHIELD.html">Remove Aft Shields</a></td>
                    <td>no</td>
                    <td align="right">1000</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_NO_FORWARD_SHIELD.html">Remove Forward Shields</a></td>
                    <td>no</td>
                    <td align="right">1000</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_SHIPCONFIG.html">Ship Configuration</a></td>
                    <td>no</td>
                    <td align="right">0</td>
                    <td align="center">2+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_THRUSTERS_COUPLING_TYPE1.html">Thruster Power Coupling Class 1</a></td>
                    <td>yes</td>
                    <td align="right">3500</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_THRUSTERS_COUPLING_TYPE2.html">Thruster Power Coupling Class 2</a></td>
                    <td>yes</td>
                    <td align="right">10000</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_THRUSTERS_COUPLING_TYPE3.html">Thruster Power Coupling Class 3</a></td>
                    <td>yes</td>
                    <td align="right">14000</td>
                    <td align="center">5+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_THRUSTERS_COUPLING_TYPE4.html">Thruster Power Coupling Class 4</a></td>
                    <td>yes</td>
                    <td align="right">21000</td>
                    <td align="center">7+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_THRUSTERS_COUPLING_TYPE5.html">Thruster Power Coupling Class 5</a></td>
                    <td>yes</td>
                    <td align="right">28000</td>
                    <td align="center">8+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_THRUSTERS_COUPLING_TYPE6.html">Thruster Power Coupling Class 6</a></td>
                    <td>yes</td>
                    <td align="right">34000</td>
                    <td align="center">9+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_THRUSTERS_COUPLING_TYPE7.html">Thruster Power Coupling Class 7</a></td>
                    <td>yes</td>
                    <td align="right">44000</td>
                    <td align="center">11+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_THRUSTERS_TYPE1.html">Manoeuvring Thrusters Class 1</a></td>
                    <td>yes</td>
                    <td align="right">5000</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_THRUSTERS_TYPE2A.html">Manoeuvring Thrusters Class 2A</a></td>
                    <td>yes</td>
                    <td align="right">14000</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_THRUSTERS_TYPE2B.html">Manoeuvring Thrusters Class 2B</a></td>
                    <td>yes</td>
                    <td align="right">15000</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_THRUSTERS_TYPE2C.html">Manoeuvring Thrusters Class 2C</a></td>
                    <td>yes</td>
                    <td align="right">13000</td>
                    <td align="center">1+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_THRUSTERS_TYPE2D.html">Manoeuvring Thrusters Class 2D</a></td>
                    <td>yes</td>
                    <td align="right">28000</td>
                    <td align="center">3+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_THRUSTERS_TYPE2E.html">Manoeuvring Thrusters Class 2E</a></td>
                    <td>yes</td>
                    <td align="right">30000</td>
                    <td align="center">3+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_THRUSTERS_TYPE2F.html">Manoeuvring Thrusters Class 2F</a></td>
                    <td>yes</td>
                    <td align="right">26000</td>
                    <td align="center">3+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_THRUSTERS_TYPE3A.html">Manoeuvring Thrusters Class 3A</a></td>
                    <td>yes</td>
                    <td align="right">32000</td>
                    <td align="center">5+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_THRUSTERS_TYPE3B.html">Manoeuvring Thrusters Class 3B</a></td>
                    <td>yes</td>
                    <td align="right">31000</td>
                    <td align="center">5+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_THRUSTERS_TYPE3C.html">Manoeuvring Thrusters Class 3C</a></td>
                    <td>yes</td>
                    <td align="right">33000</td>
                    <td align="center">5+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_THRUSTERS_TYPE3D.html">Manoeuvring Thrusters Class 3D</a></td>
                    <td>yes</td>
                    <td align="right">64000</td>
                    <td align="center">7+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_THRUSTERS_TYPE3E.html">Manoeuvring Thrusters Class 3E</a></td>
                    <td>yes</td>
                    <td align="right">62000</td>
                    <td align="center">7+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_THRUSTERS_TYPE3F.html">Manoeuvring Thrusters Class 3F</a></td>
                    <td>yes</td>
                    <td align="right">66000</td>
                    <td align="center">7+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_THRUSTERS_TYPE4A.html">Manoeuvring Thrusters Class 4A</a></td>
                    <td>yes</td>
                    <td align="right">73000</td>
                    <td align="center">7+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_THRUSTERS_TYPE4B.html">Manoeuvring Thrusters Class 4B</a></td>
                    <td>yes</td>
                    <td align="right">74500</td>
                    <td align="center">7+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_THRUSTERS_TYPE4C.html">Manoeuvring Thrusters Class 4C</a></td>
                    <td>yes</td>
                    <td align="right">75800</td>
                    <td align="center">7+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_THRUSTERS_TYPE4D.html">Manoeuvring Thrusters Class 4D</a></td>
                    <td>yes</td>
                    <td align="right">146000</td>
                    <td align="center">7+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_THRUSTERS_TYPE4E.html">Manoeuvring Thrusters Class 4E</a></td>
                    <td>yes</td>
                    <td align="right">149000</td>
                    <td align="center">9+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_THRUSTERS_TYPE4F.html">Manoeuvring Thrusters Class 4F</a></td>
                    <td>yes</td>
                    <td align="right">151600</td>
                    <td align="center">9+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_THRUSTERS_TYPE5A.html">Manoeuvring Thrusters Class 5A</a></td>
                    <td>yes</td>
                    <td align="right">114000</td>
                    <td align="center">8+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_THRUSTERS_TYPE5B.html">Manoeuvring Thrusters Class 5B</a></td>
                    <td>yes</td>
                    <td align="right">111000</td>
                    <td align="center">8+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_THRUSTERS_TYPE5C.html">Manoeuvring Thrusters Class 5C</a></td>
                    <td>yes</td>
                    <td align="right">118000</td>
                    <td align="center">8+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_THRUSTERS_TYPE5D.html">Manoeuvring Thrusters Class 5D</a></td>
                    <td>yes</td>
                    <td align="right">226000</td>
                    <td align="center">10+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_THRUSTERS_TYPE5E.html">Manoeuvring Thrusters Class 5E</a></td>
                    <td>yes</td>
                    <td align="right">222000</td>
                    <td align="center">10+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_THRUSTERS_TYPE5F.html">Manoeuvring Thrusters Class 5F</a></td>
                    <td>yes</td>
                    <td align="right">236000</td>
                    <td align="center">10+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_THRUSTERS_TYPE6A.html">Manoeuvring Thrusters Class 6A</a></td>
                    <td>yes</td>
                    <td align="right">159000</td>
                    <td align="center">9+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_THRUSTERS_TYPE6B.html">Manoeuvring Thrusters Class 6B</a></td>
                    <td>yes</td>
                    <td align="right">159200</td>
                    <td align="center">9+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_THRUSTERS_TYPE6C.html">Manoeuvring Thrusters Class 6C</a></td>
                    <td>yes</td>
                    <td align="right">159300</td>
                    <td align="center">9+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_THRUSTERS_TYPE6D.html">Manoeuvring Thrusters Class 6D</a></td>
                    <td>yes</td>
                    <td align="right">318000</td>
                    <td align="center">12+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_THRUSTERS_TYPE6E.html">Manoeuvring Thrusters Class 6E</a></td>
                    <td>yes</td>
                    <td align="right">318400</td>
                    <td align="center">12+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_THRUSTERS_TYPE6F.html">Manoeuvring Thrusters Class 6F</a></td>
                    <td>yes</td>
                    <td align="right">318600</td>
                    <td align="center">12+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_THRUSTERS_TYPE7A.html">Manoeuvring Thrusters Class 7A</a></td>
                    <td>yes</td>
                    <td align="right">219000</td>
                    <td align="center">11+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_THRUSTERS_TYPE7B.html">Manoeuvring Thrusters Class 7B</a></td>
                    <td>yes</td>
                    <td align="right">219200</td>
                    <td align="center">11+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_THRUSTERS_TYPE7C.html">Manoeuvring Thrusters Class 7C</a></td>
                    <td>yes</td>
                    <td align="right">219300</td>
                    <td align="center">11+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_THRUSTERS_TYPE7D.html">Manoeuvring Thrusters Class 7D</a></td>
                    <td>yes</td>
                    <td align="right">438000</td>
                    <td align="center">14+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_THRUSTERS_TYPE7E.html">Manoeuvring Thrusters Class 7E</a></td>
                    <td>yes</td>
                    <td align="right">438400</td>
                    <td align="center">14+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_THRUSTERS_TYPE7F.html">Manoeuvring Thrusters Class 7F</a></td>
                    <td>yes</td>
                    <td align="right">438600</td>
                    <td align="center">14+</td>
                </tr>
            </table>
        </a>

        <a name="ships">    
        <h2>Ships</h2>
            <table>
                <tr>
                    <th>Name</th>
                </tr>
                <tr>
                    <td><a href="../ships/heatsink.html">Expended Heat Sink</a></td>
                </tr>
            </table>
        </a>

        <a name="models">    
        <h2>Models</h2>
            This expansion declares no models. This may be related to warnings.
        </a>

        <a name="scripts">    
        <h2>Scripts</h2>
            <table>
                <tr>
                    <th>Path</th>
                </tr>
                <tr>
                    <td valign="top">Scripts/sc_heatsink.js</td>
                    <td><pre>&quot;use strict&quot;;
this.name = &quot;Heatsink Ship Script&quot;;
this.author = &quot;phkb&quot;;
this.copyright = &quot;2016 phkb&quot;;
this.description = &quot;Routines to automate heatsink destruction&quot;;
this.licence = &quot;CC BY-NC-SA 3.0&quot;;

//-------------------------------------------------------------------------------------------------------------
this.shipSpawned = function() {
    this.ship.script._hsTimer = new Timer(this, this.ship.script.$cleanUpHeatSink.bind(this), 5, 0);
}

//-------------------------------------------------------------------------------------------------------------
this.$cleanUpHeatSink = function $cleanUpHeatSink() {
	this.ship.explode();
}
</pre></td>
                </tr>
                <tr>
                    <td valign="top">Scripts/shipconfig_armour.js</td>
                    <td><pre>&quot;use strict&quot;;
this.name = &quot;ShipConfiguration_Armour&quot;;
this.author = &quot;phkb&quot;;
this.copyright = &quot;2016 phkb&quot;;
this.description = &quot;Routines for armour control&quot;;
this.licence = &quot;CC BY-NC-SA 3.0&quot;;

// Code borrowed heavily from Thargoids &quot;IronHide Armour&quot; OXP and CSotB&#39;s &quot;Custom Shields&quot; OXP.

this._debug = false;
this._override = false; // flag to override the equipment damage routine.
this._armourList = [];
this._frontArmourList = [];
this._aftArmourList = [];
this._altArmour = null;
this._holdArmour = {};
this._simRunning = false;

//-------------------------------------------------------------------------------------------------------------
this.startUpComplete = function () {
	if (worldScripts.ShipConfiguration_Core._disabled) {
		delete this.playerWillSaveGame;
		delete this.shipLaunchedFromStation;
		delete this.shipTakingDamage;
		delete this.equipmentDamaged;
		delete this.equipmentRemoved;
		delete this.equipmentAdded;
		delete this.playerBoughtEquipment;
		delete this.guiScreenWillChange;
		delete this.startUpComplete;
		return;
	}

	var ps = player.ship.script;
	if (missionVariables.ShipConfig_ArmourFront) ps._armourFront = missionVariables.ShipConfig_ArmourFront;
	if (missionVariables.ShipConfig_ArmourAft) ps._armourAft = missionVariables.ShipConfig_ArmourAft;
	this.$grabLocalData();

	if (worldScripts.ShipRespray) {
		var sr = worldScripts.ShipRespray;
		if (sr.$addPreSprayCall) {
			sr.$addPreSprayCall(this.name, &quot;$preResprayFunction&quot;);
			sr.$addPostSprayCall(this.name, &quot;$postResprayFunction&quot;);
		}
	}
}

//-------------------------------------------------------------------------------------------------------------
this.playerWillSaveGame = function () {
	missionVariables.ShipConfig_ArmourFront = player.ship.script._armourFront;
	missionVariables.ShipConfig_ArmourAft = player.ship.script._armourAft;
}

//-------------------------------------------------------------------------------------------------------------
this.shipLaunchedFromStation = function (station) {
	// get the damage percent for any armour we have in place
	var p = player.ship;
	var ps = p.script;
	var sc = worldScripts.ShipConfiguration_Core;
	if (sc.$simulatorRunning()) {
		this._simRunning = true;
		this.$preResprayFunction();
	}

	ps._frontArmourType = sc.$equipmentItemInUse(&quot;frontarmour&quot;, p);
	if (ps._frontArmourType != &quot;&quot;) {
		var info = EquipmentInfo.infoForKey(ps._frontArmourType);
		ps._frontDamagePoint = info.scriptInfo.damage_point;
		ps._frontArmourStrength = info.scriptInfo.armour_strength;
	}
	ps._aftArmourType = sc.$equipmentItemInUse(&quot;aftarmour&quot;, p);
	if (ps._aftArmourType != &quot;&quot;) {
		var info = EquipmentInfo.infoForKey(ps._aftArmourType);
		ps._aftDamagePoint = info.scriptInfo.damage_point;
		ps._aftArmourStrength = info.scriptInfo.armour_strength;
	}
	ps.$resetFlag = this.$resetFlag;
	ps.$damageDirection = this.$damageDirection;
	ps._frontDamageWarning = false;
	ps._aftDamageWarning = false;
	ps._shipDamage = false;

	this.$updateBattleDamage();
}

//-------------------------------------------------------------------------------------------------------------
this.shipTakingDamage = function (amount, whom, type) {

	// if whom isn&#39;t valid, don&#39;t do anything
	if (!whom || whom.isValid === false) return;

	var p = player.ship;
	var ps = p.script;
	if (!p || !ps) return;
	
	// start a timer to reset the shipDamage flag, so we can know what&#39;s damaged from here, and what&#39;s scripted from elsewhere
	if (ps._checkTimer == null || ps._checkTimer.isRunning === false) {
		if (!ps.$resetFlag) ps.$resetFlag = this.$resetFlag; // need to check this here for combat simulator
		ps._checkTimer = new Timer(ps, ps.$resetFlag, 1, 0);
	}

	// don&#39;t go any further if we don&#39;t have ShipConfig armour installed
	if (ps._frontArmourType === &quot;&quot; &amp;&amp; ps._aftArmourType === &quot;&quot;) return;

	ps._shipDamage = true;

	// record where the last damage came from. True = front, false = aft
	ps._lastDamageDirection = ps.$damageDirection(player.ship, whom);
	if (ps._lastDamageDirection === true) {
		ps._lastDamageDirectionArmour = ps._armourFront;
	} else {
		ps._lastDamageDirectionArmour = ps._armourAft;
	}
	//if (this._debug) log(this.name, type + &quot; &quot; + amount + &quot; hit from &quot; + (this._lastDamageDirection === true ? &quot;front&quot; : &quot;aft&quot;) + &quot; &quot; + whom);

	if (amount &amp;&amp; amount &gt; 0 &amp;&amp; type === &quot;energy damage&quot;) { // if we have energy damage
		var shield = 0;
		if (ps._lastDamageDirection === true) {
			shield = ps._frontArmourStrength * (ps._armourFront / 100);
		} else {
			shield = ps._aftArmourStrength * (ps._armourAft / 100);
		}

		//if (this._debug) log(this.name, &quot;amount = &quot; + amount + &quot;, front = &quot; + this._armourFront + &quot;, aft = &quot; + this._armourAft + &quot;, shield = &quot; + shield + &quot;, energy = &quot; + player.ship.energy + &quot;, maxEnergy = &quot; + player.ship.maxEnergy);
		if (amount &lt; shield &amp;&amp; shield &gt; 0) {
			if ((p.energy + amount) &lt; p.maxEnergy) {
				p.energy += amount;
				//if (this._debug) log(this.name, &quot;armour absorbed hit - returning &quot; + amount + &quot; to energy &quot; + player.ship.energy + &quot;, &quot; + amount + &quot;, &quot; + shield);
			} else {
				//if (this._debug) log(this.name, &quot;armour absorbed hit - returning to energy to max &quot; + player.ship.energy + &quot;, &quot; + amount + &quot;, &quot; + shield);
				p.energy = p.maxEnergy;
			}

			if (ps._lastDamageDirection === true) {
				ps._armourFront -= Math.floor(100 * (amount / ps._frontArmourStrength));
				if (ps._armourFront &lt; 100) {
					player.consoleMessage(&quot;Forward armour down to &quot; + ps._armourFront + &quot;%&quot;);
					//if (this._debug) log(this.name, &quot;Forward armour down to &quot; + this._armourFront + &quot;%&quot;);
					if (ps._armourFront &lt; ps._frontDamagePoint &amp;&amp; ps._frontDamageWarning === false) {
						ps._frontDamageWarning = true;
						player.consoleMessage(&quot;Damage point on forward armour reached! Equipment damage may occur!&quot;);
						//if (this._debug) log(this.name, &quot;Damage point on forward armour reached! Equipment damage may occur!&quot;);
					}
				}
			} else {
				ps._armourAft -= Math.floor(100 * (amount / ps._aftArmourStrength));
				if (ps._armourAft &lt; 100) {
					player.consoleMessage(&quot;Aft armour down to &quot; + ps._armourAft + &quot;%&quot;);
					//if (this._debug) log(this.name, &quot;Aft armour down to &quot; + this._armourAft + &quot;%&quot;);
					if (ps._armourAft &lt; ps._aftDamagePoint &amp;&amp; ps._aftDamageWarning === false) {
						ps._aftDamageWarning = true;
						player.consoleMessage(&quot;Damage point on aft armour reached! Equipment damage may occur!&quot;);
						//if (this._debug) log(this.name, &quot;Damage point on aft armour reached! Equipment damage may occur!&quot;);
					}
				}
			}
		} else {
			if (shield &gt; 0) p.energy += shield;
			if (ps._lastDamageDirection === true) {
				ps._armourFront = 0;
			} else {
				ps._armourAft = 0;
			}
		}
	}
	// check to see if the armour has been completely destroyed
	if (ps._armourFront &lt;= 0 &amp;&amp; p.equipmentStatus(ps._frontArmourType) === &quot;EQUIPMENT_OK&quot;) {
		// if the armour is destroyed by damage
		p.removeEquipment(ps._frontArmourType);
		delete worldScripts.ShipConfiguration_Core._current[&quot;frontarmour&quot;];
		player.consoleMessage(&quot;Forward armour has been destroyed!&quot;, 6);
	}
	if (ps._armourAft &lt;= 0 &amp;&amp; p.equipmentStatus(ps._aftArmourType) === &quot;EQUIPMENT_OK&quot;) {
		// if the armour is destroyed by damage
		p.removeEquipment(ps._aftArmourType);
		delete worldScripts.ShipConfiguration_Core._current[&quot;aftarmour&quot;];
		player.consoleMessage(&quot;Aft armour has been destroyed!&quot;, 6);
	}
}

//-------------------------------------------------------------------------------------------------------------
// returns true if hit is from the front, otherwise false
// from CSotB&#39;s Custom Shields OXP
this.$damageDirection = function (ship, whom) {

	if (!ship || ship.isValid === false || !whom || whom.isValid === false) return true;

	var shipSpeedCollisionRadiusAdjustment = (ship.maxSpeed / 350) * 8;
	//added for shield collision issue caused by using solid models which are needed to work correctly in 1.76, applies to advanced and basic npcs also
	if (ship.speed &gt; ship.maxSpeed) {
		var collisionRadiusAdjustment = (ship.speed / ship.maxSpeed) * shipSpeedCollisionRadiusAdjustment;
	} else {
		var collisionRadiusAdjustment = 0;
	}

	var impactRadiusFactor = ((3 * (1500 / (ship.position.distanceTo(whom)))) + 16);
	var range = whom.position.distanceTo(ship) - (ship.collisionRadius + 1 + collisionRadiusAdjustment);
	var dist = ship.collisionRadius + collisionRadiusAdjustment + impactRadiusFactor;
	var impactLocation = whom.position.add(whom.vectorForward.multiply(range)); //determine possible forward weapon hit location
	//too far from ship because of delay to hit from plasma weapon or off vector angle because of thargoid laser
	if ((ship.position.distanceTo(impactLocation)) &gt; dist) {
		impactLocation = whom.position.add(whom.vectorForward.multiply(-(range))); //determine possible aft weapon hit location
		//too far from ship because of delay to hit from plasma weapon or off vector angle because of thargoid laser
		if ((ship.position.distanceTo(impactLocation)) &gt; dist) {
			impactLocation = whom.position.add(whom.vectorRight.multiply(range)); //determine possible starboard weapon hit location
			//too far from ship because of delay to hit from plasma weapon or off vector angle because of thargoid laser
			if ((ship.position.distanceTo(impactLocation)) &gt; dist) {
				impactLocation = whom.position.add(whom.vectorRight.multiply(-(range))); //determine possible port weapon hit location
				//too far from ship because of delay to hit from plasma weapon or off vector angle because of thargoid laser
				if ((ship.position.distanceTo(impactLocation)) &gt; dist) {
					var impactInterpolation = ((ship.collisionRadius + 1 + collisionRadiusAdjustment) / (ship.position.distanceTo(whom)));
					impactLocation = Vector3D.interpolate(ship.position, whom.position, impactInterpolation); //interpolate weapon hit directly between ship and attacker as a fallback position
				}
			}
		}
	}
	var impactdirection = impactLocation.subtract(ship.position).direction();
	var impactangle = ship.heading.angleTo(impactdirection);

	if (impactangle &lt;= 1.57) {
		return true;
	} else {
		return false;
	}
}

//-------------------------------------------------------------------------------------------------------------
this.equipmentDamaged = function (equipment) {
	var p = player.ship;
	var ps = p.script;
	if (!p || !ps) return;
	// as it doesn&#39;t make sense for the armour to be inoperable-damaged
	if (this._armourList &amp;&amp; this._armourList.indexOf(equipment) &gt;= 0) {
		player.ship.setEquipmentStatus(equipment, &quot;EQUIPMENT_OK&quot;);
		return;
	}
	// if we&#39;re specifically overriding the damage report routine, exit now
	if (this._override === true) return;
	// only continue if damage is coming from shipTakingDamage - if not, it&#39;s probably a scripted damage which we want to leave alone
	if (ps._shipDamage === false) return;

	var dp = 0;
	if (ps._lastDamageDirection === true) {
		ps._lastDamageDirectionArmour = ps._armourFront;
		dp = ps._frontDamagePoint;
		// how much armour do we have left? if there&#39;s less than the percentage set for each type of armour there&#39;s a chance the damage will stay
		if (ps._lastDamageDirectionArmour === 0 &amp;&amp; ps._armourFront &gt; 95) ps._lastDamageDirectionArmour = 100;
	} else {
		ps._lastDamageDirectionArmour = ps._armourAft;
		dp = ps._aftDamagePoint;
		// how much armour do we have left? if there&#39;s less than the percentage set for each type of armour there&#39;s a chance the damage will stay
		if (ps._lastDamageDirectionArmour === 0 &amp;&amp; ps._armourAft &gt; 95) ps._lastDamageDirectionArmour = 100;
	}

	//if (this._debug) log(this.name, &quot;Equipment damaged: &quot; + equipment);
	if (ps._lastDamageDirectionArmour &lt;= dp) {
		// the more damaged the armour is, the more change there is of taking equipment damage
		//var diff = (this._lastDamageDirectionArmour / (this._damagePoint + (100 - this._lastDamageDirection)));
		var diff = (ps._lastDamageDirectionArmour / (dp + (dp - ps._lastDamageDirectionArmour)));
		//if (this._debug) log(this.name, &quot;Armour = &quot; + this._lastDamageDirectionArmour + &quot;, diff = &quot; + diff);
		// the less armour we have the greater the chance the damage will stay
		if (Math.random() &lt; diff) {
			p.setEquipmentStatus(equipment, &quot;EQUIPMENT_OK&quot;);
			//if (this._debug) log(this.name, &quot;Armour took hit instead - equipment repaired&quot;)
		}
	} else {
		// if we still have armour above the damage point, equipment shouldn&#39;t get damaged
		p.setEquipmentStatus(equipment, &quot;EQUIPMENT_OK&quot;);
		//if (this._debug) log(this.name, &quot;Armour still OK - equipment repaired&quot;);
	}
}

//-------------------------------------------------------------------------------------------------------------
this.equipmentRemoved = function (equipment) {
	if (this._frontArmourList &amp;&amp; this._frontArmourList.indexOf(equipment) &gt;= 0 &amp;&amp; player.ship.isInSpace === false) {
		var ps = player.ship.script;
		ps._frontArmourType = &quot;&quot;;
		ps._armourFront = 0;
		this.$updateManifest();
	}
	if (this._aftArmourList &amp;&amp; this._aftArmourList.indexOf(equipment) &gt;= 0 &amp;&amp; player.ship.isInSpace === false) {
		var ps = player.ship.script;
		ps._aftArmourType = &quot;&quot;;
		ps._armourAft = 0;
		this.$updateManifest();
	}
}

//-------------------------------------------------------------------------------------------------------------
this.equipmentAdded = function (equipment) {
	if (this._frontArmourList &amp;&amp; this._frontArmourList.indexOf(equipment) &gt;= 0 &amp;&amp; player.ship.isInSpace === false) {
		var ps = player.ship.script;
		ps._armourFront = 100;
		ps._frontArmourType = equipment;
	}
	if (this._aftArmourList &amp;&amp; this._aftArmourList.indexOf(equipment) &gt;= 0 &amp;&amp; player.ship.isInSpace === false) {
		var ps = player.ship.script;
		ps._armourAft = 100;
		ps._aftArmourType = equipment;
	}
}

//-------------------------------------------------------------------------------------------------------------
this.playerBoughtEquipment = function (equipment) {
	var p = player.ship;
	var ps = p.script;
	this.$grabLocalData();
	// if the player installs some alternative armour, remove our one (if installed), so as to not double up
	if (this._altArmour.indexOf(equipment) &gt;= 0) {
		if (ps._frontArmourType != &quot;&quot;) {
			// refund the cost 
			var info = EquipmentInfo.infoForKey(ps._frontArmourType);
			var dam = p.equipmentStatus(ps._frontArmourType);
			var refund = (info.price / 10) * worldScripts.ShipConfiguration_Core._refundPct; //stn.equipmentPriceFactor;
			if (dam === &quot;EQUIPMENT_DAMAGED&quot;) refund *= 0.5;
			player.credits += refund;

			p.removeEquipment(ps._frontArmourType);
		}
		if (ps._aftArmourType != &quot;&quot;) {
			// refund the cost 
			var info = EquipmentInfo.infoForKey(ps._aftArmourType);
			var dam = p.equipmentStatus(ps._aftArmourType);
			var refund = (info.price / 10) * worldScripts.ShipConfiguration_Core._refundPct; //stn.equipmentPriceFactor;
			if (dam === &quot;EQUIPMENT_DAMAGED&quot;) refund *= 0.5;
			player.credits += refund;

			p.removeEquipment(ps._aftArmourType);
		}
	}
	// check for repair to armour
	if (equipment.indexOf(&quot;_REPAIR&quot;) &gt;= 0) {
		// repair the armour
		if (equipment.indexOf(ps._frontArmourType) &gt;= 0 &amp;&amp; ps._armourFront &lt; 100) {
			p.removeEquipment(equipment);
			ps._armourFront = 100;
		}
		if (equipment.indexOf(ps._aftArmourType) &gt;= 0 &amp;&amp; ps._armourAft &lt; 100) {
			p.removeEquipment(equipment);
			ps._armourAft = 100;
		}
	}
}

//-------------------------------------------------------------------------------------------------------------
this.guiScreenWillChange = function (to, from) {
	if (to === &quot;GUI_SCREEN_MANIFEST&quot;) {
		this.$updateManifest();
	}
	if (to === &quot;GUI_SCREEN_STATUS&quot; &amp;&amp; this._simRunning === true) {
		this._simRunning = false;
		this.$postResprayFunction();
	}
}

//-------------------------------------------------------------------------------------------------------------
this.$updateManifest = function $updateManifest() {
	var ps = player.ship.script;
	var eqtype_fr = worldScripts.ShipConfiguration_Core.$equipmentItemInUse(&quot;frontarmour&quot;, player.ship);
	var eqtype_af = worldScripts.ShipConfiguration_Core.$equipmentItemInUse(&quot;aftarmour&quot;, player.ship);
	if (player.ship.equipmentStatus(eqtype_fr) === &quot;EQUIPMENT_OK&quot; || player.ship.equipmentStatus(eqtype_af) === &quot;EQUIPMENT_OK&quot;) {
		var sep = &quot;, &quot;;
		var front_type = &quot;Class &quot; + (this._frontArmourList.indexOf(eqtype_fr) + 1) + &quot; Forward Armour&quot;;
		var front_desc = &quot; Strength: &quot;;
		var front_val = ps._armourFront + &quot;%%&quot;;
		if (eqtype_fr === &quot;&quot;) {
			front_type = &quot;&quot;;
			front_desc = &quot;&quot;;
			front_val = &quot;&quot;;
			sep = &quot;&quot;;
		}
		var aft_type = &quot;Class &quot; + (this._aftArmourList.indexOf(eqtype_af) + 1) + &quot; Aft Armour&quot;;
		var aft_desc = &quot; Strength: &quot;;
		var aft_val = ps._armourAft + &quot;%%&quot;;
		if (eqtype_af === &quot;&quot;) {
			aft_type = &quot;&quot;;
			aft_desc = &quot;&quot;;
			aft_val = &quot;&quot;;
			sep = &quot;&quot;;
		}
		mission.setInstructions(expandDescription(&quot;[armour_manifest]&quot;, {
			front_armour_type: front_type,
			front_armour_desc: front_desc,
			armour_front: front_val,
			armour_sep: sep,
			aft_armour_type: aft_type,
			aft_armour_desc: aft_desc,
			armour_aft: aft_val
		}), this.name);
	} else {
		mission.setInstructions(null, this.name);
	}
}

//-------------------------------------------------------------------------------------------------------------
this.$resetFlag = function $resetFlag() {
	if (player.ship &amp;&amp; player.ship.script) {
		delete player.ship.script._checkTimer;
		player.ship.script._shipDamage = false;
	}
}

//-------------------------------------------------------------------------------------------------------------
// if &quot;BattleDamage&quot; is installed, we want to update the shipTakingDamage routine to take into consideration how much armour we have left
// so we&#39;ll patch BattleDamage to add the extra logic
this.$updateBattleDamage = function $updateBattleDamage() {
	if (worldScripts[&quot;Battle Damage&quot;]) {
		var bd = worldScripts[&quot;Battle Damage&quot;];
		delete bd.shipTakingDamage;
		//bd.$sc_shipTakingDamage = bg.shipTakingDamage;
		bd.shipTakingDamage = this.$newBD_shipTakingDamage;
	}
}

//-------------------------------------------------------------------------------------------------------------
// New &quot;shipTakingDamage&quot; routine for BattleDamage
this.$newBD_shipTakingDamage = function $newBD_shipTakingDamage(amount, whom, type) {
	if (amount === 0) return;
	else if (missionVariables.BattleDamage_status === &quot;DAMAGED&quot;) {
		player.consoleMessage(&quot;Hull taking further damage.&quot;, 1);
	} else {
		var skip = false;
		var ps = player.ship.script;
		if (ps &amp;&amp; ps._lastDamageDirectionArmour &gt; 0) {
			if (ps._lastDamageDirectionArmour &lt; ps._damagePoint) {
				// the less armour we have the greater the chance the damage will stay
				if (Math.random() &lt; (ps._lastDamageDirectionArmour / ps._damagePoint)) skip = true;
			} else {
				skip = true;
			}
		}
		if (skip === false) {
			player.ship.removeEquipment(&quot;EQ_HULL_REPAIR&quot;); //remove &#39;repair&#39; to allow &#39;repair&#39; to be applied again. This should happen before any risk of damage to &#39;repair&#39;
			missionVariables.BattleDamage_status = &quot;DAMAGED&quot;; // set to damaged
			player.consoleMessage(&quot;WARNING! HULL DAMAGE&quot;, 6);
		}
	}
}

//-------------------------------------------------------------------------------------------------------------
this.$preResprayFunction = function $preResprayFunction() {
	this._holdArmour[&quot;front&quot;] = player.ship.script._armourFront;
	this._holdArmour[&quot;aft&quot;] = player.ship.script._armourAft;
}

//-------------------------------------------------------------------------------------------------------------
this.$postResprayFunction = function $postResprayFunction() {
	player.ship.script._armourFront = this._holdArmour[&quot;front&quot;];
	player.ship.script._armourAft = this._holdArmour[&quot;aft&quot;];
	this._holdArmour = {};
}

//-------------------------------------------------------------------------------------------------------------
this.$grabLocalData = function $grabLocalData() {
	var sc = worldScripts.ShipConfiguration_Core;
	var ps = player.ship.script;
	ps._frontArmourType = sc.$equipmentItemInUse(&quot;frontarmour&quot;, player.ship);
	if (ps._frontArmourType != &quot;&quot;) {
		var info = EquipmentInfo.infoForKey(ps._frontArmourType);
		ps._frontDamagePoint = info.scriptInfo.damage_point;
		ps._frontArmourStrength = info.scriptInfo.armour_strength;
	}
	ps._aftArmourType = sc.$equipmentItemInUse(&quot;aftarmour&quot;, player.ship);
	if (ps._aftArmourType != &quot;&quot;) {
		var info = EquipmentInfo.infoForKey(ps._aftArmourType);
		ps._aftDamagePoint = info.scriptInfo.damage_point;
		ps._aftArmourStrength = info.scriptInfo.armour_strength;
	}

	// grab a local reference to the armour arrays, so we don&#39;t have to keep two lists, but don&#39;t need to keep references to the other module
	this._armourList = sc._armour;
	this._frontArmourList = sc._frontarmour;
	this._aftArmourList = sc._aftarmour;
	this._altArmour = sc._altArmour;
}</pre></td>
                </tr>
                <tr>
                    <td valign="top">Scripts/shipconfig_boosterheat.js</td>
                    <td><pre>&quot;use strict&quot;;
this.name = &quot;ShipConfiguration_BoosterHeat&quot;;
this.author = &quot;phkb&quot;;
this.copyright = &quot;2016 phkb&quot;;
this.description = &quot;Process of adding cabin heat at certain throttle levels when boosters are installed&quot;;
this.licence = &quot;CC BY-NC-SA 3.0&quot;;

this._boostHeatDelta = 0.93;
this._fcbBoost = 0;

//-------------------------------------------------------------------------------------------------------------
this.startUpComplete = function () {
	if (worldScripts.ShipConfiguration_Core._disabled) {
		delete this.shipLaunchedFromStation;
		delete this.shipWillDockWithStation;
		delete this.shipDied;
		delete this.startUpComplete;
		return;
	}
}

//-------------------------------------------------------------------------------------------------------------
this.shipLaunchedFromStation = function (station) {
	var p = player.ship;
	if (p.script._boosterHeatPoint != 0) {
		p.script._boosterHeatEnabled = false;
		p.script._boosterHeatDelta = this._boostHeatDelta;
		if (this._fcbBoost === 0) {
			// set up our frame callback
			this._fcbBoost = addFrameCallback(function (delta) {
				if (delta === 0) return;
				var p = player.ship;
				var ps = p.script;
				if (!ps) return; // probably player has died.
				if (ps._boosterHeatPoint === 0) {
					if (ps._boosterHeatEnabled === true) {
						ps._boosterHeatEnabled = false;
						ps.thirdPartyHeat -= ps._boosterHeatDelta;
						if (ps.thirdPartyHeat &lt; 0) ps.thirdPartyHeat = 0;
					}
					return;
				}
				// only apply the heat element if the ship speed is under the max speed value (ie not while injectors or torus drive are in use)
				var disable = false;
				if (p.speed &lt;= p.maxSpeed) {
					// what is the percentage of speed
					if ((p.speed / p.maxSpeed) &gt; ps._boosterHeatPoint) {
						if (ps._boosterHeatEnabled === true) {
							// just return if booster heat is already on
							return;
						} else {
							// turn on booster heat
							ps._boosterHeatEnabled = true;
							ps.thirdPartyHeat += ps._boosterHeatDelta;
							player.consoleMessage(&quot;Heat now being generated by boosters.&quot;, 2);
							worldScripts.ShipConfiguration_Core.$playSound(&quot;booster_warning&quot;);
						}
					} else {
						// disable if the ship is going less than the booster heat point
						disable = true;
					}
				} else {
					// disable booster heat if the ship is going faster than their max speed (injectors or torus)
					disable = true;
				}
				if (disable === true) {
					if (ps._boosterHeatEnabled === true) {
						ps._boosterHeatEnabled = false;
						ps.thirdPartyHeat -= ps._boosterHeatDelta;
						if (ps.thirdPartyHeat &lt; 0) ps.thirdPartyHeat = 0;
					}
				}
			});
		}
	} else {
		// in case the booster gets damaged while heat is enabled
		if (p.script._boosterHeatEnabled === true) {
			p.script._boosterHeatEnabled = false;
			p.script.thirdPartyHeat -= p.script._boosterHeatDelta;
		}
	}
}

//-------------------------------------------------------------------------------------------------------------
this.shipWillDockWithStation = function (station) {
	this.$stopTimers();
}

//-------------------------------------------------------------------------------------------------------------
this.shipDied = function (whom, why) {
	this.$stopTimers();
}

//-------------------------------------------------------------------------------------------------------------
this.$stopTimers = function $stopTimers() {
	if (this._fcbBoost != 0) {
		if (isValidFrameCallback(this._fcbBoost)) removeFrameCallback(this._fcbBoost);
		this._fcbBoost = 0;
	}
}</pre></td>
                </tr>
                <tr>
                    <td valign="top">Scripts/shipconfig_conditions.js</td>
                    <td><pre>&quot;use strict&quot;;
this.name = &quot;ShipConfiguration_Conditions&quot;;
this.author = &quot;phkb&quot;;
this.copyright = &quot;2016 phkb&quot;;
this.description = &quot;Condition script for equipment.&quot;;
this.licence = &quot;CC BY-NC-SA 3.0&quot;;

//-------------------------------------------------------------------------------------------------------------
this.allowAwardEquipment = function (equipment, ship, context) {

	if (context === &quot;scripted&quot;) return true;
	if (context === &quot;npc&quot;) return true;
	if (equipment.indexOf(&quot;EQ_EQUIPSPACE&quot;) &gt;= 0) return false;

	// is this item damaged?
	var p = player.ship;
	if (p.equipmentStatus(equipment) === &quot;EQUIPMENT_DAMAGED&quot;) {
		// return true so that the &quot;Repair&quot; item is displayed.
		return true;
	}

	if (equipment === &quot;EQ_HEAT_SINK_CONTROL&quot; || equipment === &quot;EQ_HEAT_SINK_CONTROL_PASSIVE&quot;) return false;

	var sc = worldScripts.ShipConfiguration_Core;

	if (sc._disabled) return false;

	if (equipment === &quot;EQ_HEAT_SINK&quot;) {
		if (sc._heatControl === false) {
			return false;
		} else {
			return true;
		}
	}

	if (equipment === &quot;EQ_SHIPCONFIG&quot; &amp;&amp; sc._disabled === false) return true;

	// check for damaged equipment items
	if (equipment.indexOf(&quot;EQ_ARMOUR_FORWARD&quot;) &gt;= 0 &amp;&amp; equipment.indexOf(&quot;_REPAIR&quot;) &gt;= 0) {
		var result = false;
		if (p.script._armourFront &lt; 100) {
			if (equipment === sc.$equipmentItemInUse(&quot;frontarmour&quot;, p) + &quot;_REPAIR&quot;) result = true;
		}
		return result;
	}
	if (equipment.indexOf(&quot;EQ_ARMOUR_AFT&quot;) &gt;= 0 &amp;&amp; equipment.indexOf(&quot;_REPAIR&quot;) &gt;= 0) {
		var result = false;
		if (p.script._armourAft &lt; 100) {
			if (equipment === sc.$equipmentItemInUse(&quot;aftarmour&quot;, p) + &quot;_REPAIR&quot;) result = true;
		}
		return result;
	}

	if (equipment.indexOf(&quot;EQ_EXTENSION&quot;) &gt;= 0) {
		// small ships can&#39;t get 5t extension
		var mss = sc.$getShipMass(ship);
		if (EquipmentInfo.infoForKey(equipment).scriptInfo.equipment_extension &gt;= 5 &amp;&amp; mss &lt; 50000) return false
		// large ships can&#39;t get any
		if (mss &gt; 400000) return false
		// maximum of 2 extensions can be installed at the same time
		var count = this.$countExtensionsInShip(ship);
		if (count === 2) return false;
		return true;
	}

	if (context === &quot;purchase&quot;) return false;

	return true;
}

//-------------------------------------------------------------------------------------------------------------
this.updateEquipmentPrice = function (equipment, price) {
	var sc = worldScripts.ShipConfiguration_Core;
	var p = player.ship;
	var newprice = price;
	if (equipment.indexOf(&quot;EQ_ARMOUR_FORWARD&quot;) &gt;= 0 &amp;&amp; equipment.indexOf(&quot;_REPAIR&quot;) &gt;= 0) {
		var amt = p.script._armourFront;
		// calculate percentage of damage
		var cur = Math.floor((100 - amt) / 10);
		// get the pricing factor for our ship
		var priceFactor = sc.$equipmentPriceFactor(p.shipClassName, sc.$getShipMass(p));
		// apply the price factor to the percentage of repair, to get a more realistic price
		// otherwise, a repair bill could be way more expensive than a new installation.
		cur = parseInt(cur * priceFactor);
		if (cur &gt; 9) cur = 9;
		if (p.script._armourFront &lt; 100 &amp;&amp; cur === 0) cur = 1;
		newprice = price * cur;
	}
	if (equipment.indexOf(&quot;EQ_ARMOUR_AFT&quot;) &gt;= 0 &amp;&amp; equipment.indexOf(&quot;_REPAIR&quot;) &gt;= 0) {
		var amt = p.script._armourAft;
		// calculate percentage of damage
		var cur = Math.floor((100 - amt) / 10);
		// get the pricing factor for our ship
		var priceFactor = sc.$equipmentPriceFactor(p.shipClassName, sc.$getShipMass(p));
		// apply the price factor to the percentage of repair, to get a more realistic price
		// otherwise, a repair bill could be way more expensive than a new installation.
		cur = parseInt(cur * priceFactor);
		if (cur &gt; 9) cur = 9;
		if (p.script._armourAft &lt; 100 &amp;&amp; cur === 0) cur = 1;
		newprice = price * cur;
	}
	return newprice;
}

//-------------------------------------------------------------------------------------------------------------
// counts the number of equipment extensions current installed
this.$countExtensionsInShip = function $countExtensionsInShip(ship) {
	var eq = ship.equipment;
	var count = 0;
	for (var i = 0; i &lt; eq.length; i++) {
		if (eq[i].equipmentKey.indexOf(&quot;EQ_EXTENSION&quot;) &gt;= 0) count += 1;
	}
	return count;
}</pre></td>
                </tr>
                <tr>
                    <td valign="top">Scripts/shipconfig_core.js</td>
                    <td><pre>&quot;use strict&quot;;
this.name = &quot;ShipConfiguration_Core&quot;;
this.author = &quot;phkb&quot;;
this.copyright = &quot;2016 phkb&quot;;
this.description = &quot;Core routines for ShipConfiguration.&quot;;
this.licence = &quot;CC BY-NC-SA 3.0&quot;;

/*
	This OXP adds the concept of equipment space and weight: equipment space is limited, meaning you can&#39;t install everything at once, and having a lot of equipment installed will
	change the performance stats of the ship.

	Please read the &quot;readme.txt&quot; file - there&#39;s a lot of important info in there that&#39;s worth reading in order to make the most of this OXP.

	Borrows code from Capt Murphy&#39;s Breakable Energy Unit OXP, Breakable Engines OXP, Breakable Shield Generators OXP, and Breakable Witchdrive OXP
	Because of this, those OXP&#39;s are incompatible with this one, and the manifest has the incompatibilities flagged.

	TODO:
	- work out how to calculate and display ship heat profile (ie what units will generate heat with use and how much, and what units will increase cabin temp and how much)

*/

this._disabled = false; // quick way to disable entire OXP
this._debug = false; // turns on/off logging messages
this._disableBoosterSound = false; // turns on/off the warning sound when boosters start generating heat
this._disableF3HUD = false; // turns on/off the specialised F3 HUD (showing equipment &amp; cargo space allocations)
this._heatControl = true; // indicates that the heat transfer system is in use (ie laser temp adds to cabin temp, inclusion of heat sinks etc)
this._installationTime = true; // flag that controls whether changing ship config also takes time
this._freeUpgrades = false; // flag to make all upgrades free (yay!) for testing period only (boo!)
this._refundPct = 0.85; // value between 0 and 1 that indicates how much refund you get on equipment sold. 0 = no refund, 1 = refund full original price
this._weightFactor = 2; // increase to make ship weight have less weight (!) when doing adjustment calculations
this._applyToNPC = true; // flag to indicate whether NPC ships will have same weight performance calculations applied to their ships
this._shipModel = true; // flag to turn on player ship model on configuration screens.

this._busOverloadLimit = 20; // at what point the electrical bus overloads (counter value trigger)
this._shipRespray = false; // indicates that the Ship Respray OXP is installed
this._resprayActive = false; // indicates that a respray is happening right now
this._holdEquipSpace = &quot;&quot;;
this._torusSync = false; // indicates that the Synchronised Torus OXP is installed
this._menuColor = &quot;orangeColor&quot;; // color of general menu items
this._itemColor = &quot;yellowColor&quot;; // color of special menu items (eg exit menu items)
this._installedColor = &quot;greenColor&quot;; // color of installed equipment items
this._damagedColor = &quot;redColor&quot;; // color of damaged equipment items
this._disabledColor = &quot;darkGrayColor&quot;; // color of disabled equipment items
this._riskColor = &quot;0.8 0.8 0.8 1&quot;; // color of risky equipment items (items installed over the recommended power coupling/bus level)
this._defaultHeatShieldHSFactor = 1.7; // default heat sink factor if no heat shield installed
this._configScreen = false; // flag to indicate the config screen is active
this._simulator = false; // holding variable to work out whether this launch/dock routine was part of a simulator run
this._OXPHyperdrives = false; // indicates the Hyperdrives OXP is installed
this._hyperHangar = false; // indicates the Hyperspace Hangar OXP is installed
this._hyperHangarActive = false; // indicates that Hyperspace Hangar is active
this._hyperHangarTimer = null; // timer to update hyperhangar&#39;s stored ship image

this._current = {}; // dictionary of current list of installed options
this._startUp = true; // flag to indicate startup procedures are underway
this._initialSetup = false; // flag to indicate that initial equipment setup is necessary
this._promptPlayer = false; // flag to indicate that the player needs to be prompted about equipment (overload)
this._page = 0; // current page of the active display
this._display = 0; // indicates which display is being shown
this._source = &quot;&quot;; // source location string, set when various mission screens are shown and used by the choice handler to determine what screen to return to
this._adding = false; // flag to indicate that the &quot;equipmentAdded&quot; routine is underway, in order to prevent endless loops
this._removing = false; // flag to indicate that the &quot;equipmentRemoved&quot; routine is underway, in order to prevent endless loops
this._damaging = false; // flag to indicate that the &quot;equipmentDamaged&quot; routine is underway, in order to prevent endless loops
this._repairing = false; // flag to indicate that the &quot;equipmentRepaired&quot; routine is underway, in order to prevent endless loops
this._sellEquipExitScreen = &quot;GUI_SCREEN_STATUS&quot;; // which screen sell equipment mission screen will exit to
this._counter = 0; // counter used in the energy depletion routine
this._busOverload = 0; // calculated value that indicates the players chance of receiving a bus overload
this._busOverloadCounter = 0; // counter used in the bus overload routine. Counts number of times damage received, events triggered when
this._busMessageCounter = 0; // counter used in the bus overload routine
this._busOverloadResetTimer = null;
this._busProcessing = false;
this._energyRechargeRate_Stored = 0; // stored value of the energy recharge rate
this._forwardShieldRechargeRate_Stored = 0; // stored value of the forward shield recharge rate
this._aftRechargeRate_Stored = 0; // stored value of the aft shield recharge rate
this._lastChoice = [&quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;]; // players last selection on each mission screen
this._trueValues = [&quot;yes&quot;, &quot;1&quot;, 1, &quot;true&quot;, true];
this._currEquip = [];
this._callbacks = [];

// configuration settings for use in Lib_Config
this._scConfig = {
	Name: this.name,
	Alias: &quot;Ship Configuration&quot;,
	Display: &quot;Config&quot;,
	Alive: &quot;_scConfig&quot;,
	Bool: {
		B0: {
			Name: &quot;_disableBoosterSound&quot;,
			Def: false,
			Desc: &quot;Disable booster sound&quot;
		},
		B1: {
			Name: &quot;_disableF3HUD&quot;,
			Def: false,
			Desc: &quot;Disable special F3 HUD&quot;
		},
		B2: {
			Name: &quot;_installationTime&quot;,
			Def: true,
			Desc: &quot;Equipment install time&quot;
		},
		B3: {
			Name: &quot;_freeUpgrades&quot;,
			Def: false,
			Desc: &quot;Free upgrades&quot;
		},
		B4: {
			Name: &quot;_applyToNPC&quot;,
			Def: true,
			Desc: &quot;Apply to NPC ships&quot;
		},
		Info: &quot;0 - Disables the warning sound when boosters in use.\n1 - Disables specialised F3 HUD (displays equip space info)\n2 - Installing equipment uses game time.\n3 - All upgrades are free.\n4 - Indicates if NPC ships will have restrictions applied.&quot;
	}
};

// for when the calculations need manual tweaking...
this._shipSpaceExceptions = {
	&quot;Asp Mark II&quot;: 30, // ex-military design, so more equipment space available to make up for no cargo space.
	&quot;Asp Mark II Special&quot;: 35,
	&quot;Boa Class Cruiser&quot;: 35,
	&quot;Boa&quot;: 30,
	&quot;Cobra Mark III-XT&quot;: 23,
	&quot;Constrictor&quot;: 30,
	&quot;Fer-de-Lance&quot;: 20,
	&quot;GalCop Viper Interceptor&quot;: 25,
	&quot;GalCop Viper&quot;: 20,
	&quot;Night Adder&quot;: 20,
	&quot;Yasen-N &#39;Advanced&#39;&quot;: 30,
};

// provides consistency for ship mass calculations
// really only applies to ships that have multiple installation variations, where the mass value might return a slightly different number
this._shipMassExceptions = {
	&quot;Cobra Mark III&quot;: 214737.6875,
};

// higher numbers mean equipment weight will have less impact on ship performance (better power to weight ratio)
this._shipPowerToWeight = {
	&quot;Boa Class Cruiser&quot;: 0.8,
	&quot;Boa&quot;: 0.7,
	&quot;Cobra Mark III&quot;: 1.5,
	&quot;Constrictor&quot;: 8,
	&quot;Fer-de-Lance&quot;: 1.5,
	&quot;Mining Transporter&quot;: 3,
	&quot;Orbital Shuttle&quot;: 3,
	&quot;Pitviper Mark II&quot;: 1,
	&quot;Pitviper&quot;: 1,
	&quot;Transporter&quot;: 3,
};

// not in use atm
this._shipHeatRateExceptions = {
	&quot;Boa&quot;: 0.97,
	&quot;Boa Class Cruiser&quot;: 0.94,
};

// default zoom is 3.6 - higher values mean smaller view, lower values mean bigger view
// these values make ships look bigger or smaller, as appropriate
this._zoomOverride = {
	&quot;Adder&quot;: 4.6,
	&quot;Anaconda&quot;: 2.3,
	&quot;Anaconda MMS&quot;: 2.3,
	&quot;Aphid&quot;: 3.2,
	&quot;Arafura&quot;: 3,
	&quot;Boa Class Cruiser&quot;: 2.5,
	&quot;Boa Class Cruiser MMS&quot;: 2.5,
	&quot;Boa&quot;: 2.5,
	&quot;Boa MMS&quot;: 2.5,
	&quot;Bug&quot;: 4.4,
	&quot;Chameleon&quot;: 3.3,
	&quot;Chopped Cobra&quot;: 3,
	&quot;Cobra Mark I&quot;: 4.6,
	&quot;Cobra Mark II-X&quot;: 4,
	&quot;Cobra Mark III&quot;: 3,
	&quot;Cobra Mark III MMS&quot;: 3,
	&quot;Cobra Mark III-XT&quot;: 3,
	&quot;Cobra Mark IV&quot;: 2.9,
	&quot;Cobra Mark IV MMS&quot;: 2.9,
	&quot;Cobra Rapier&quot;: 3,
	&quot;Copperhead Mk2&quot;: 3,
	&quot;Cruzer&quot;: 3,
	&quot;D.T.T. Atlas&quot;: 2.5,
	&quot;D.T.T. Cyclops&quot;: 2.5,
	&quot;D.T.T. Kraken&quot;: 2.8,
	&quot;D.T.T. MK-1&quot;: 3.4,
	&quot;D.T.T. Snake Charmer&quot;: 2.7,
	&quot;D.T.T. War Lance&quot;: 3.3,
	&quot;Fer-de-Lance&quot;: 3.3,
	&quot;Gecko&quot;: 4.2,
	&quot;Griffin Mk I&quot;: 3.3,
	&quot;Griff Boa Prototype&quot;: 2.5,
	&quot;Hognose&quot;: 4.3,
	&quot;Iguana&quot;: 3.2,
	&quot;Krait&quot;: 4.2,
	&quot;Lira&quot;: 1.9,
	&quot;Mamba Escort&quot;: 4.2,
	&quot;Mamba&quot;: 4.2,
	&quot;Miner Cobra Mark III&quot;: 3,
	&quot;Mining Transporter&quot;: 4.6,
	&quot;Monitor Mark II&quot;: 3,
	&quot;Monitor&quot;: 3,
	&quot;Moray Medical Boat&quot;: 4.2,
	&quot;Moray Star Boat&quot;: 4.2,
	&quot;Mussurana&quot;: 3,
	&quot;Night Adder&quot;: 4.2,
	&quot;Ophidian&quot;: 3,
	&quot;Orbital Shuttle&quot;: 4.6,
	&quot;Pitviper&quot;: 3.4,
	&quot;Pitviper (Vindicator)&quot;: 3.4,
	&quot;Pitviper (Buccaneer)&quot;: 3.4,
	&quot;Pitviper (Bountyhunter)&quot;: 3.4,
	&quot;Pitviper S.E. Beast&quot;: 3.4,
	&quot;Pitviper Mark II&quot;: 3,
	&quot;Python Class Cruiser&quot;: 2.5,
	&quot;Python ET Special&quot;: 2.6,
	&quot;Python ET Special MMS&quot;: 2.6,
	&quot;Python&quot;: 2.5,
	&quot;Python MMS&quot;: 2.5,
	&quot;Python SG&quot;: 2.5,
	&quot;Python SG-MMS&quot;: 2.5,
	&quot;Python BattleCruiser MMS&quot;: 2.5,
	&quot;Serpent Class Cruiser&quot;: 2.5,
	&quot;Sidewinder Scout Ship&quot;: 4.5,
	&quot;Sidewinder Special&quot;: 4.3,
	&quot;Skat&quot;: 3.4,
	&quot;Taxi Cab&quot;: 4.6,
	&quot;Tembo&quot;: 2.2,
	&quot;Transporter&quot;: 4.6,
	&quot;Worm&quot;: 4.6,
	&quot;Yasen-N&quot;: 3.2,
	&quot;Yasen-N &#39;Advanced&#39; variant 1&quot;: 3.2,
	&quot;Yasen-N &#39;Advanced&#39; variant 2&quot;: 3.2,
	&quot;Yasen-N &#39;Advanced&#39; variant 3&quot;: 3.2,
	&quot;YellOo Cab&quot;: 4.4,
};

// dictionary of npc equivalent roles for translation purposes
this._NPCEquivalents = {
	&quot;ftzpirate&quot;: &quot;pirate&quot;,
	&quot;ftzhauler&quot;: &quot;trader&quot;,
	&quot;jaguar_company_patrol&quot;: &quot;hunter-medium&quot;,
	&quot;jaguar_company_ship_splinter&quot;: &quot;hunter&quot;,
	&quot;jaguar_company_tug&quot;: &quot;shuttle&quot;,
	&quot;jaguar_company_miner&quot;: &quot;miner&quot;,
	&quot;bigTrader&quot;: &quot;trader&quot;,
	&quot;trident&quot;: &quot;shuttle&quot;,
	&quot;strelka&quot;: &quot;trader&quot;,
	&quot;random_hits_big_boss_fighter&quot;: &quot;pirate&quot;,
	&quot;random_hits_big_boss&quot;: &quot;pirate-heavy-fighter&quot;,
	&quot;random_hits_patrol&quot;: &quot;hunter-medium&quot;,
	&quot;random_hits_mining_hopper&quot;: &quot;miner&quot;,
	&quot;blackmonk_gunship&quot;: &quot;hunter-heavy&quot;,
	&quot;clipper-rescueship&quot;: &quot;trader&quot;,
	&quot;dredgershuttle_up&quot;: &quot;shuttle&quot;,
	&quot;dredgershuttle&quot;: &quot;shuttle&quot;,
	&quot;wildShips_tanker&quot;: &quot;trader&quot;,
	&quot;defense_ship&quot;: &quot;police&quot;,
	&quot;ups_shuttle&quot;: &quot;shuttle&quot;,
	&quot;ups-sun-police&quot;: &quot;police&quot;,
	&quot;rrs-escort&quot;: &quot;escort&quot;,
	&quot;anarchies_salvager_tugger&quot;: &quot;scavenger&quot;,
	&quot;con-a-hauler&quot;: &quot;trader&quot;,
	&quot;con-a-haulret&quot;: &quot;trader&quot;,
	&quot;con-b-hauler&quot;: &quot;trader&quot;,
	&quot;con-b-haulret&quot;: &quot;trader&quot;,
	&quot;con-c-hauler&quot;: &quot;trader&quot;,
	&quot;con-c-haulret&quot;: &quot;trader&quot;,
	&quot;con-d-hauler&quot;: &quot;trader&quot;,
	&quot;con-d-haulret&quot;: &quot;trader&quot;,
	&quot;con-e-hauler&quot;: &quot;trader&quot;,
	&quot;con-e-haulret&quot;: &quot;trader&quot;,
	&quot;con-f-hauler&quot;: &quot;trader&quot;,
	&quot;con-f-haulret&quot;: &quot;trader&quot;,
	&quot;con-g-hauler&quot;: &quot;trader&quot;,
	&quot;con-g-haulret&quot;: &quot;trader&quot;,
	&quot;starsecurity&quot;: &quot;escort&quot;,
	&quot;pi42security&quot;: &quot;escort&quot;,
	&quot;tescoosecurity&quot;: &quot;escort&quot;,
	&quot;mallwartsecurity&quot;: &quot;escort&quot;,
	&quot;gmartsecurity&quot;: &quot;escort&quot;,
	&quot;sainsboorysecurity&quot;: &quot;escort&quot;,
	&quot;oodlessecurity&quot;: &quot;escort&quot;,
};

/*
	NPC configuration item definition:
		{primaryRole:&quot;&quot;, minSpace:X, maxSpace:Y, equipmentList:[]}
				primaryRole     role to which this definition applies (eg &quot;assassin-light&quot;)
				minSpace		equipment space of ship must be greater than or equal to this value
				maxSpace		equipment space of ship must be less than or equal to this value
				equipmentlist   array of equipment areas with a number that indicates how far over default to go
								can be a generic name or a specific equipment item
								generic names: engines, thrusters, energy, frontshields, aftdhields, heatshields, fuelinjectors, fuelscoops
								specific name example: EQ_ENGINE_TYPE3C, EQ_THRUSTERS_TYPE3B

	eg 	{primaryRole:&quot;assassin-light&quot;, minSpace:0, maxSpace:20, equipmentList:[&quot;engines:1&quot;, &quot;thrusters:2&quot;, &quot;energy:2&quot;, &quot;EQ_HEAT_SHIELD_TYPE4&quot;],
		this would translate as:
			for assassin-light roles, where the equipment space is between 0 and 20, put engines 1 over default, thrusters 2 over default, energy banks 2 over default, and give the ship type 4 heat shields.

	ships not conforming to items in this list will receive default equipment
	Please note: these values are open for discussion! Please let me know if you think some other settings would be more appropriate.
*/
this._NPCConfig = [{
		primaryRole: &quot;assassin-light&quot;,
		minSpace: 0,
		maxSpace: 20,
		equipmentList: [&quot;EQ_ENGINE_TYPE3C&quot;, &quot;EQ_THRUSTERS_TYPE3A&quot;, &quot;EQ_ELEC_BUS_TYPE3&quot;, &quot;EQ_HEAT_SHIELD_TYPE4&quot;, &quot;heatsinks:1&quot;]
	}, // Krait
	{
		primaryRole: &quot;assassin-light&quot;,
		minSpace: 21,
		maxSpace: 30,
		equipmentList: [&quot;EQ_ENGINE_TYPE4B&quot;, &quot;EQ_THRUSTERS_TYPE4A&quot;, &quot;EQ_ELEC_BUS_TYPE4&quot;, &quot;EQ_HEAT_SHIELD_TYPE4&quot;, &quot;heatsinks:2&quot;]
	}, // Cobra I, Moray Starboat
	{
		primaryRole: &quot;assassin-light&quot;,
		minSpace: 31,
		maxSpace: 40,
		equipmentList: [&quot;EQ_ENGINE_TYPE5B&quot;, &quot;EQ_THRUSTERS_TYPE5A&quot;, &quot;EQ_ELEC_BUS_TYPE5&quot;, &quot;EQ_HEAT_SHIELD_TYPE4&quot;, &quot;heatsinks:3&quot;]
	}, //
	{
		primaryRole: &quot;assassin-medium&quot;,
		minSpace: 0,
		maxSpace: 20,
		equipmentList: [&quot;EQ_ENGINE_TYPE3C&quot;, &quot;EQ_THRUSTERS_TYPE3A&quot;, &quot;EQ_ELEC_BUS_TYPE3&quot;, &quot;EQ_FUEL_INJECTION_TYPE2&quot;, &quot;EQ_HEAT_SHIELD_TYPE4&quot;, &quot;heatsinks:1&quot;]
	}, //
	{
		primaryRole: &quot;assassin-medium&quot;,
		minSpace: 21,
		maxSpace: 30,
		equipmentList: [&quot;EQ_ENGINE_TYPE4B&quot;, &quot;EQ_THRUSTERS_TYPE4A&quot;, &quot;EQ_ELEC_BUS_TYPE4&quot;, &quot;EQ_FUEL_INJECTION_TYPE3&quot;, &quot;EQ_HEAT_SHIELD_TYPE4&quot;, &quot;heatsinks:2&quot;]
	}, // Fer-de-Lance
	{
		primaryRole: &quot;assassin-medium&quot;,
		minSpace: 31,
		maxSpace: 40,
		equipmentList: [&quot;EQ_ENGINE_TYPE5B&quot;, &quot;EQ_THRUSTERS_TYPE5A&quot;, &quot;EQ_ELEC_BUS_TYPE5&quot;, &quot;EQ_FUEL_INJECTION_TYPE3&quot;, &quot;EQ_HEAT_SHIELD_TYPE4&quot;, &quot;heatsinks:2&quot;]
	}, // Cobra III (no cargo extension)
	{
		primaryRole: &quot;assassin-medium&quot;,
		minSpace: 41,
		maxSpace: 50,
		equipmentList: [&quot;EQ_ENGINE_TYPE6B&quot;, &quot;EQ_THRUSTERS_TYPE6A&quot;, &quot;EQ_ELEC_BUS_TYPE6&quot;, &quot;EQ_FUEL_INJECTION_TYPE4&quot;, &quot;EQ_HEAT_SHIELD_TYPE4&quot;, &quot;heatsinks:2&quot;]
	}, // Cobra III
	{
		primaryRole: &quot;assassin-heavy&quot;,
		minSpace: 0,
		maxSpace: 20,
		equipmentList: [&quot;EQ_ENGINE_TYPE4B&quot;, &quot;EQ_THRUSTERS_TYPE4A&quot;, &quot;heatsinks:1&quot;]
	},
	{
		primaryRole: &quot;assassin-heavy&quot;,
		minSpace: 21,
		maxSpace: 30,
		equipmentList: [&quot;EQ_ENGINE_TYPE5B&quot;, &quot;EQ_THRUSTERS_TYPE5A&quot;, &quot;energy:2&quot;, &quot;EQ_ELEC_BUS_TYPE5&quot;, &quot;EQ_FUEL_INJECTION_TYPE2&quot;, &quot;EQ_HEAT_SHIELD_TYPE4&quot;, &quot;heatsinks:2&quot;]
	}, // Asp Mark II
	{
		primaryRole: &quot;assassin-heavy&quot;,
		minSpace: 31,
		maxSpace: 40,
		equipmentList: [&quot;EQ_ENGINE_TYPE6B&quot;, &quot;EQ_THRUSTERS_TYPE6A&quot;, &quot;energy:2&quot;, &quot;EQ_ELEC_BUS_TYPE6&quot;, &quot;EQ_FUEL_INJECTION_TYPE3&quot;, &quot;EQ_HEAT_SHIELD_TYPE4&quot;, &quot;heatsinks:3&quot;]
	}, //
	{
		primaryRole: &quot;assassin-heavy&quot;,
		minSpace: 41,
		maxSpace: 60,
		equipmentList: [&quot;EQ_ENGINE_TYPE6B&quot;, &quot;EQ_THRUSTERS_TYPE6A&quot;, &quot;energy:4&quot;, &quot;EQ_ELEC_BUS_TYPE6&quot;, &quot;EQ_FUEL_INJECTION_TYPE4&quot;, &quot;EQ_HEAT_SHIELD_TYPE4&quot;, &quot;heatsinks:4&quot;]
	}, //
	{
		primaryRole: &quot;assassin-heavy&quot;,
		minSpace: 61,
		maxSpace: 80,
		equipmentList: [&quot;EQ_ENGINE_TYPE7B&quot;, &quot;EQ_THRUSTERS_TYPE7A&quot;, &quot;energy:4&quot;, &quot;EQ_ELEC_BUS_TYPE7&quot;, &quot;EQ_FUEL_INJECTION_TYPE4&quot;, &quot;EQ_HEAT_SHIELD_TYPE4&quot;, &quot;heatsinks:4&quot;]
	},
	{
		primaryRole: &quot;hunter&quot;,
		minSpace: 0,
		maxSpace: 20,
		equipmentList: [&quot;EQ_ENGINE_TYPE3B&quot;, &quot;EQ_ELEC_BUS_TYPE3&quot;, &quot;HEAT_SHIELD_TYPE4&quot;, &quot;heatsinks:1&quot;]
	}, // gecko, krait, mamba, sidewinder
	{
		primaryRole: &quot;hunter&quot;,
		minSpace: 21,
		maxSpace: 30,
		equipmentList: [&quot;EQ_ENGINE_TYPE3B&quot;, &quot;EQ_ELEC_BUS_TYPE3&quot;, &quot;energy:1&quot;, &quot;frontshields:1&quot;, &quot;aftshields:1&quot;, &quot;HEAT_SHIELD_TYPE4&quot;, &quot;heatsinks:2&quot;]
	}, //
	{
		primaryRole: &quot;hunter&quot;,
		minSpace: 31,
		maxSpace: 40,
		equipmentList: [&quot;EQ_ENGINE_TYPE3B&quot;, &quot;EQ_ELEC_BUS_TYPE3&quot;, &quot;energy:2&quot;, &quot;frontshields:1&quot;, &quot;aftshields:1&quot;, &quot;HEAT_SHIELD_TYPE4&quot;, &quot;heatsinks:3&quot;]
	}, //
	{
		primaryRole: &quot;hunter-medium&quot;,
		minSpace: 0,
		maxSpace: 20,
		equipmentList: [&quot;EQ_ENGINE_TYPE3B&quot;, &quot;EQ_ELEC_BUS_TYPE3&quot;, &quot;energy:1&quot;, &quot;HEAT_SHIELD_TYPE4&quot;, &quot;heatsinks:1&quot;]
	}, //
	{
		primaryRole: &quot;hunter-medium&quot;,
		minSpace: 21,
		maxSpace: 30,
		equipmentList: [&quot;EQ_ENGINE_TYPE4B&quot;, &quot;EQ_ELEC_BUS_TYPE4&quot;, &quot;energy:2&quot;, &quot;HEAT_SHIELD_TYPE4&quot;, &quot;heatsinks:2&quot;]
	}, // asp mark II, cobra I, fer-de-lance, moray starboat
	{
		primaryRole: &quot;hunter-medium&quot;,
		minSpace: 31,
		maxSpace: 40,
		equipmentList: [&quot;EQ_ENGINE_TYPE5B&quot;, &quot;EQ_ELEC_BUS_TYPE5&quot;, &quot;energy:2&quot;, &quot;frontshields:1&quot;, &quot;aftshields:1&quot;, &quot;HEAT_SHIELD_TYPE4&quot;, &quot;heatsinks:3&quot;]
	}, // cobra III (std model)
	{
		primaryRole: &quot;hunter-medium&quot;,
		minSpace: 41,
		maxSpace: 80,
		equipmentList: [&quot;EQ_ENGINE_TYPE6B&quot;, &quot;EQ_ELEC_BUS_TYPE6&quot;, &quot;energy:3&quot;, &quot;frontshields:2&quot;, &quot;aftshields:2&quot;, &quot;HEAT_SHIELD_TYPE4&quot;, &quot;heatsinks:3&quot;]
	}, // cobra III (+ extra cargo)
	{
		primaryRole: &quot;hunter-heavy&quot;,
		minSpace: 0,
		maxSpace: 20,
		equipmentList: [&quot;EQ_ENGINE_TYPE3B&quot;, &quot;EQ_ELEC_BUS_TYPE3&quot;, &quot;HEAT_SHIELD_TYPE4&quot;, &quot;heatsinks:1&quot;]
	}, //
	{
		primaryRole: &quot;hunter-heavy&quot;,
		minSpace: 21,
		maxSpace: 30,
		equipmentList: [&quot;EQ_ENGINE_TYPE4B&quot;, &quot;EQ_ELEC_BUS_TYPE4&quot;, &quot;HEAT_SHIELD_TYPE4&quot;, &quot;heatsinks:2&quot;]
	}, // asp mark II, fer-de-lance
	{
		primaryRole: &quot;hunter-heavy&quot;,
		minSpace: 31,
		maxSpace: 40,
		equipmentList: [&quot;EQ_ENGINE_TYPE5B&quot;, &quot;EQ_ELEC_BUS_TYPE5&quot;, &quot;energy:1&quot;, &quot;frontshields:1&quot;, &quot;aftshields:1&quot;, &quot;HEAT_SHIELD_TYPE4&quot;, &quot;heatsinks:3&quot;]
	}, // cobra III (std model)
	{
		primaryRole: &quot;hunter-heavy&quot;,
		minSpace: 41,
		maxSpace: 50,
		equipmentList: [&quot;EQ_ENGINE_TYPE6B&quot;, &quot;EQ_ELEC_BUS_TYPE6&quot;, &quot;energy:1&quot;, &quot;frontshields:2&quot;, &quot;aftshields:2&quot;, &quot;EQ_FUEL_INJECTION_TYPE4&quot;, &quot;HEAT_SHIELD_TYPE4&quot;, &quot;heatsinks:4&quot;]
	}, // cobra III (+ extra cargo)
	{
		primaryRole: &quot;hunter-heavy&quot;,
		minSpace: 51,
		maxSpace: 80,
		equipmentList: [&quot;EQ_ENGINE_TYPE6B&quot;, &quot;EQ_ELEC_BUS_TYPE6&quot;, &quot;energy:2&quot;, &quot;frontshields:2&quot;, &quot;aftshields:2&quot;, &quot;EQ_FUEL_INJECTION_TYPE4&quot;, &quot;HEAT_SHIELD_TYPE4&quot;, &quot;heatsinks:5&quot;]
	}, // cobra III (+ extra cargo)
	{
		primaryRole: &quot;trader&quot;,
		minSpace: 0,
		maxSpace: 20,
		equipmentList: [&quot;energy:1&quot;, &quot;frontshields:1&quot;, &quot;aftshields:1&quot;, &quot;HEAT_SHIELD_TYPE2&quot;, &quot;heatsinks:1&quot;]
	}, // adder
	{
		primaryRole: &quot;trader&quot;,
		minSpace: 21,
		maxSpace: 30,
		equipmentList: [&quot;energy:2&quot;, &quot;frontshields:1&quot;, &quot;aftshields:1&quot;, &quot;HEAT_SHIELD_TYPE3&quot;, &quot;heatsinks:2&quot;]
	}, // cobra I, fer-de-lance, moray star boat, moray medical boat
	{
		primaryRole: &quot;trader&quot;,
		minSpace: 31,
		maxSpace: 40,
		equipmentList: [&quot;energy:3&quot;, &quot;frontshields:1&quot;, &quot;aftshields:1&quot;, &quot;HEAT_SHIELD_TYPE3&quot;, &quot;heatsinks:3&quot;]
	}, //
	{
		primaryRole: &quot;trader&quot;,
		minSpace: 41,
		maxSpace: 50,
		equipmentList: [&quot;energy:3&quot;, &quot;frontshields:2&quot;, &quot;aftshields:2&quot;, &quot;HEAT_SHIELD_TYPE3&quot;, &quot;EQ_ARMOUR_FORWARD_TYPE2&quot;, &quot;EQ_ARMOUR_AFT_TYPE2&quot;, &quot;heatsinks:4&quot;]
	}, //
	{
		primaryRole: &quot;trader&quot;,
		minSpace: 51,
		maxSpace: 60,
		equipmentList: [&quot;energy:4&quot;, &quot;frontshields:2&quot;, &quot;aftshields:2&quot;, &quot;HEAT_SHIELD_TYPE4&quot;, &quot;EQ_ARMOUR_FORWARD_TYPE3&quot;, &quot;EQ_ARMOUR_AFT_TYPE3&quot;, &quot;heatsinks:5&quot;]
	}, //
	{
		primaryRole: &quot;trader&quot;,
		minSpace: 61,
		maxSpace: 70,
		equipmentList: [&quot;energy:4&quot;, &quot;frontshields:3&quot;, &quot;aftshields:3&quot;, &quot;HEAT_SHIELD_TYPE4&quot;, &quot;EQ_ARMOUR_FORWARD_TYPE4&quot;, &quot;EQ_ARMOUR_AFT_TYPE4&quot;, &quot;heatsinks:6&quot;]
	}, // boa, python
	{
		primaryRole: &quot;trader&quot;,
		minSpace: 71,
		maxSpace: 80,
		equipmentList: [&quot;energy:5&quot;, &quot;frontshields:3&quot;, &quot;aftshields:3&quot;, &quot;HEAT_SHIELD_TYPE4&quot;, &quot;EQ_ARMOUR_FORWARD_TYPE4&quot;, &quot;EQ_ARMOUR_AFT_TYPE4&quot;, &quot;heatsinks:7&quot;]
	}, // anaconda, boa cc
	{
		primaryRole: &quot;trader-courier&quot;,
		minSpace: 0,
		maxSpace: 20,
		equipmentList: [&quot;EQ_ENGINE_TYPE3B&quot;, &quot;EQ_ELEC_BUS_TYPE3&quot;, &quot;energy:1&quot;, &quot;HEAT_SHIELD_TYPE2&quot;, &quot;heatsinks:1&quot;]
	}, // adder
	{
		primaryRole: &quot;trader-courier&quot;,
		minSpace: 21,
		maxSpace: 30,
		equipmentList: [&quot;EQ_ENGINE_TYPE3B&quot;, &quot;EQ_ELEC_BUS_TYPE3&quot;, &quot;energy:2&quot;, &quot;frontshields:1&quot;, &quot;aftshields:1&quot;, &quot;HEAT_SHIELD_TYPE3&quot;, &quot;heatsinks:2&quot;]
	}, // asp mark II, fer-de-lance, moray starboat
	{
		primaryRole: &quot;trader-courier&quot;,
		minSpace: 31,
		maxSpace: 40,
		equipmentList: [&quot;EQ_ENGINE_TYPE4B&quot;, &quot;EQ_ELEC_BUS_TYPE4&quot;, &quot;energy:2&quot;, &quot;frontshields:1&quot;, &quot;aftshields:1&quot;, &quot;HEAT_SHIELD_TYPE3&quot;, &quot;heatsinks:3&quot;]
	}, // cobra III (std model)
	{
		primaryRole: &quot;trader-courier&quot;,
		minSpace: 41,
		maxSpace: 50,
		equipmentList: [&quot;EQ_ENGINE_TYPE4B&quot;, &quot;EQ_ELEC_BUS_TYPE4&quot;, &quot;energy:3&quot;, &quot;frontshields:1&quot;, &quot;aftshields:1&quot;, &quot;HEAT_SHIELD_TYPE4&quot;, &quot;EQ_ARMOUR_FORWARD_TYPE2&quot;, &quot;EQ_ARMOUR_AFT_TYPE2&quot;, &quot;heatsinks:3&quot;]
	}, // cobra III (+ extra cargo)
	{
		primaryRole: &quot;trader-courier&quot;,
		minSpace: 51,
		maxSpace: 60,
		equipmentList: [&quot;EQ_ENGINE_TYPE5B&quot;, &quot;EQ_ELEC_BUS_TYPE5&quot;, &quot;energy:4&quot;, &quot;frontshields:1&quot;, &quot;aftshields:1&quot;, &quot;HEAT_SHIELD_TYPE4&quot;, &quot;EQ_ARMOUR_FORWARD_TYPE3&quot;, &quot;EQ_ARMOUR_AFT_TYPE3&quot;, &quot;heatsinks:4&quot;]
	}, //
	{
		primaryRole: &quot;trader-courier&quot;,
		minSpace: 61,
		maxSpace: 70,
		equipmentList: [&quot;EQ_ENGINE_TYPE5B&quot;, &quot;EQ_ELEC_BUS_TYPE5&quot;, &quot;energy:4&quot;, &quot;frontshields:2&quot;, &quot;aftshields:2&quot;, &quot;HEAT_SHIELD_TYPE4&quot;, &quot;EQ_ARMOUR_FORWARD_TYPE4&quot;, &quot;EQ_ARMOUR_AFT_TYPE4&quot;, &quot;heatsinks:5&quot;]
	}, //
	{
		primaryRole: &quot;trader-courier&quot;,
		minSpace: 71,
		maxSpace: 80,
		equipmentList: [&quot;EQ_ENGINE_TYPE6B&quot;, &quot;EQ_ELEC_BUS_TYPE6&quot;, &quot;energy:4&quot;, &quot;frontshields:2&quot;, &quot;aftshields:2&quot;, &quot;HEAT_SHIELD_TYPE4&quot;, &quot;EQ_ARMOUR_FORWARD_TYPE4&quot;, &quot;EQ_ARMOUR_AFT_TYPE4&quot;, &quot;heatsinks:6&quot;]
	}, // anaconda, boa cc
	{
		primaryRole: &quot;trader-smuggler&quot;,
		minSpace: 0,
		maxSpace: 20,
		equipmentList: [&quot;EQ_ENGINE_TYPE3B&quot;, &quot;EQ_ELEC_BUS_TYPE3&quot;, &quot;energy:1&quot;, &quot;HEAT_SHIELD_TYPE2&quot;, &quot;heatsinks:1&quot;]
	}, // adder,
	{
		primaryRole: &quot;trader-smuggler&quot;,
		minSpace: 21,
		maxSpace: 30,
		equipmentList: [&quot;EQ_ENGINE_TYPE3B&quot;, &quot;EQ_ELEC_BUS_TYPE3&quot;, &quot;energy:2&quot;, &quot;frontshields:1&quot;, &quot;aftshields:1&quot;, &quot;HEAT_SHIELD_TYPE3&quot;, &quot;heatsinks:2&quot;]
	}, // cobra I, fer-de-lance, moray starboat
	{
		primaryRole: &quot;trader-smuggler&quot;,
		minSpace: 31,
		maxSpace: 40,
		equipmentList: [&quot;EQ_ENGINE_TYPE4B&quot;, &quot;EQ_ELEC_BUS_TYPE4&quot;, &quot;energy:2&quot;, &quot;frontshields:1&quot;, &quot;aftshields:1&quot;, &quot;HEAT_SHIELD_TYPE3&quot;, &quot;heatsinks:3&quot;]
	}, // cobra III (std model)
	{
		primaryRole: &quot;trader-smuggler&quot;,
		minSpace: 41,
		maxSpace: 50,
		equipmentList: [&quot;EQ_ENGINE_TYPE4B&quot;, &quot;EQ_ELEC_BUS_TYPE4&quot;, &quot;energy:3&quot;, &quot;frontshields:1&quot;, &quot;aftshields:1&quot;, &quot;HEAT_SHIELD_TYPE4&quot;, &quot;EQ_ARMOUR_FORWARD_TYPE2&quot;, &quot;EQ_ARMOUR_AFT_TYPE2&quot;, &quot;heatsinks:3&quot;]
	}, // cobra III (+ extra cargo)
	{
		primaryRole: &quot;trader-smuggler&quot;,
		minSpace: 51,
		maxSpace: 60,
		equipmentList: [&quot;EQ_ENGINE_TYPE5B&quot;, &quot;EQ_ELEC_BUS_TYPE5&quot;, &quot;energy:4&quot;, &quot;frontshields:1&quot;, &quot;aftshields:1&quot;, &quot;HEAT_SHIELD_TYPE4&quot;, &quot;EQ_ARMOUR_FORWARD_TYPE3&quot;, &quot;EQ_ARMOUR_AFT_TYPE3&quot;, &quot;heatsinks:4&quot;]
	}, //
	{
		primaryRole: &quot;trader-smuggler&quot;,
		minSpace: 61,
		maxSpace: 70,
		equipmentList: [&quot;EQ_ENGINE_TYPE5B&quot;, &quot;EQ_ELEC_BUS_TYPE5&quot;, &quot;energy:4&quot;, &quot;frontshields:2&quot;, &quot;aftshields:2&quot;, &quot;HEAT_SHIELD_TYPE4&quot;, &quot;EQ_ARMOUR_FORWARD_TYPE4&quot;, &quot;EQ_ARMOUR_AFT_TYPE4&quot;, &quot;heatsinks:5&quot;]
	}, // python
	{
		primaryRole: &quot;trader-smuggler&quot;,
		minSpace: 71,
		maxSpace: 80,
		equipmentList: [&quot;EQ_ENGINE_TYPE6B&quot;, &quot;EQ_ELEC_BUS_TYPE6&quot;, &quot;energy:4&quot;, &quot;frontshields:2&quot;, &quot;aftshields:2&quot;, &quot;HEAT_SHIELD_TYPE4&quot;, &quot;EQ_ARMOUR_FORWARD_TYPE4&quot;, &quot;EQ_ARMOUR_AFT_TYPE4&quot;, &quot;heatsinks:6&quot;]
	}, //
	{
		primaryRole: &quot;pirate&quot;,
		minSpace: 0,
		maxSpace: 20,
		equipmentList: [&quot;EQ_ENGINE_TYPE3B&quot;, &quot;energy:1&quot;, &quot;heatsinks:1&quot;]
	}, // adder, gecko, krait, mamba, sidewinder
	{
		primaryRole: &quot;pirate&quot;,
		minSpace: 21,
		maxSpace: 30,
		equipmentList: [&quot;EQ_ENGINE_TYPE3B&quot;, &quot;energy:2&quot;, &quot;heatsinks:1&quot;]
	}, // cobra I, fer-de-lance, moray starboat
	{
		primaryRole: &quot;pirate&quot;,
		minSpace: 31,
		maxSpace: 40,
		equipmentList: [&quot;EQ_ENGINE_TYPE3B&quot;, &quot;energy:2&quot;, &quot;heatsinks:2&quot;]
	}, // cobra III (std model)
	{
		primaryRole: &quot;pirate&quot;,
		minSpace: 41,
		maxSpace: 50,
		equipmentList: [&quot;EQ_ENGINE_TYPE4B&quot;, &quot;energy:2&quot;, &quot;heatsinks:2&quot;]
	}, // cobra III (+ extra cargo)
	{
		primaryRole: &quot;pirate&quot;,
		minSpace: 51,
		maxSpace: 60,
		equipmentList: [&quot;EQ_ENGINE_TYPE4B&quot;, &quot;energy:3&quot;, &quot;heatsinks:3&quot;]
	}, //
	{
		primaryRole: &quot;pirate&quot;,
		minSpace: 61,
		maxSpace: 70,
		equipmentList: [&quot;EQ_ENGINE_TYPE4B&quot;, &quot;energy:3&quot;, &quot;thrusters:2&quot;, &quot;frontshields:1&quot;, &quot;aftshields:1&quot;, &quot;heatsinks:4&quot;]
	}, // python
	{
		primaryRole: &quot;pirate&quot;,
		minSpace: 71,
		maxSpace: 80,
		equipmentList: [&quot;EQ_ENGINE_TYPE4B&quot;, &quot;energy:4&quot;, &quot;thrusters:2&quot;, &quot;frontshields:1&quot;, &quot;aftshields:1&quot;, &quot;heatsinks:4&quot;]
	}, //
	{
		primaryRole: &quot;pirate-light-fighter&quot;,
		minSpace: 0,
		maxSpace: 20,
		equipmentList: [&quot;EQ_ENGINE_TYPE3B&quot;, &quot;energy:1&quot;, &quot;heatsinks:1&quot;]
	}, // adder, gecko, krait, mamba, sidewinder
	{
		primaryRole: &quot;pirate-light-fighter&quot;,
		minSpace: 21,
		maxSpace: 30,
		equipmentList: [&quot;EQ_ENGINE_TYPE3B&quot;, &quot;energy:2&quot;, &quot;heatsinks:2&quot;]
	}, //
	{
		primaryRole: &quot;pirate-light-fighter&quot;,
		minSpace: 31,
		maxSpace: 40,
		equipmentList: [&quot;EQ_ENGINE_TYPE4B&quot;, &quot;energy:3&quot;, &quot;heatsinks:2&quot;]
	}, //
	{
		primaryRole: &quot;pirate-light-fighter&quot;,
		minSpace: 41,
		maxSpace: 50,
		equipmentList: [&quot;EQ_ENGINE_TYPE4B&quot;, &quot;energy:4&quot;, &quot;heatsinks:3&quot;]
	}, //
	{
		primaryRole: &quot;pirate-medium-fighter&quot;,
		minSpace: 0,
		maxSpace: 20,
		equipmentList: [&quot;EQ_ENGINE_TYPE3B&quot;, &quot;energy:1&quot;, &quot;heatsinks:1&quot;]
	}, // gecko
	{
		primaryRole: &quot;pirate-medium-fighter&quot;,
		minSpace: 21,
		maxSpace: 30,
		equipmentList: [&quot;EQ_ENGINE_TYPE3B&quot;, &quot;energy:2&quot;, &quot;heatsinks:2&quot;]
	}, // asp mark II, cobra I, fer-de-lance, moray starboat
	{
		primaryRole: &quot;pirate-medium-fighter&quot;,
		minSpace: 31,
		maxSpace: 40,
		equipmentList: [&quot;EQ_ENGINE_TYPE4B&quot;, &quot;energy:3&quot;, &quot;frontshields:1&quot;, &quot;aftshields:1&quot;, &quot;heatsinks:2&quot;]
	}, //
	{
		primaryRole: &quot;pirate-medium-fighter&quot;,
		minSpace: 41,
		maxSpace: 50,
		equipmentList: [&quot;EQ_ENGINE_TYPE4B&quot;, &quot;energy:4&quot;, &quot;frontshields:1&quot;, &quot;aftshields:1&quot;, &quot;heatsinks:3&quot;]
	}, //
	{
		primaryRole: &quot;pirate-medium-fighter&quot;,
		minSpace: 51,
		maxSpace: 60,
		equipmentList: [&quot;EQ_ENGINE_TYPE5B&quot;, &quot;energy:5&quot;, &quot;frontshields:2&quot;, &quot;aftshields:2&quot;, &quot;heatsinks:3&quot;]
	}, //
	{
		primaryRole: &quot;pirate-heavy-fighter&quot;,
		minSpace: 0,
		maxSpace: 20,
		equipmentList: [&quot;EQ_ENGINE_TYPE3B&quot;, &quot;energy:1&quot;, &quot;heatsinks:1&quot;]
	}, //
	{
		primaryRole: &quot;pirate-heavy-fighter&quot;,
		minSpace: 21,
		maxSpace: 30,
		equipmentList: [&quot;EQ_ENGINE_TYPE4B&quot;, &quot;energy:2&quot;, &quot;heatsinks:2&quot;]
	}, // asp mark II, fer-de-lance,
	{
		primaryRole: &quot;pirate-heavy-fighter&quot;,
		minSpace: 31,
		maxSpace: 40,
		equipmentList: [&quot;EQ_ENGINE_TYPE4B&quot;, &quot;energy:3&quot;, &quot;heatsinks:2&quot;]
	}, // cobra III (std model)
	{
		primaryRole: &quot;pirate-heavy-fighter&quot;,
		minSpace: 41,
		maxSpace: 50,
		equipmentList: [&quot;EQ_ENGINE_TYPE5B&quot;, &quot;energy:4&quot;, &quot;frontshields:1&quot;, &quot;aftshields:1&quot;, &quot;heatsinks:2&quot;]
	}, // cobra III (+ extra cargo)
	{
		primaryRole: &quot;pirate-heavy-fighter&quot;,
		minSpace: 51,
		maxSpace: 60,
		equipmentList: [&quot;EQ_ENGINE_TYPE5B&quot;, &quot;energy:5&quot;, &quot;frontshields:1&quot;, &quot;aftshields:1&quot;, &quot;heatsinks:3&quot;]
	}, //
	{
		primaryRole: &quot;pirate-heavy-fighter&quot;,
		minSpace: 61,
		maxSpace: 70,
		equipmentList: [&quot;EQ_ENGINE_TYPE6B&quot;, &quot;energy:6&quot;, &quot;frontshields:2&quot;, &quot;aftshields:2&quot;, &quot;heatsinks:3&quot;]
	}, //
	{
		primaryRole: &quot;pirate-heavy-fighter&quot;,
		minSpace: 71,
		maxSpace: 80,
		equipmentList: [&quot;EQ_ENGINE_TYPE6B&quot;, &quot;energy:7&quot;, &quot;frontshields:2&quot;, &quot;aftshields:2&quot;, &quot;heatsinks:4&quot;]
	}, //
	{
		primaryRole: &quot;pirate-interceptor&quot;,
		minSpace: 0,
		maxSpace: 20,
		equipmentList: [&quot;EQ_ENGINE_TYPE4A&quot;, &quot;heatsinks:1&quot;]
	}, //
	{
		primaryRole: &quot;pirate-interceptor&quot;,
		minSpace: 21,
		maxSpace: 30,
		equipmentList: [&quot;EQ_ENGINE_TYPE5A&quot;, &quot;heatsinks:1&quot;]
	}, // asp mark II, fer-de-lance, moray starboat
	{
		primaryRole: &quot;pirate-interceptor&quot;,
		minSpace: 31,
		maxSpace: 40,
		equipmentList: [&quot;EQ_ENGINE_TYPE6A&quot;, &quot;heatsinks:2&quot;]
	}, // cobra III (std model)
	{
		primaryRole: &quot;pirate-interceptor&quot;,
		minSpace: 41,
		maxSpace: 80,
		equipmentList: [&quot;EQ_ENGINE_TYPE7A&quot;, &quot;heatsinks:3&quot;]
	}, // cobra III (+ extra cargo)
	{
		primaryRole: &quot;pirate-aegis-raider&quot;,
		minSpace: 0,
		maxSpace: 20,
		equipmentList: [&quot;EQ_ENGINE_TYPE3A&quot;, &quot;heatsinks:1&quot;]
	}, //
	{
		primaryRole: &quot;pirate-aegis-raider&quot;,
		minSpace: 21,
		maxSpace: 30,
		equipmentList: [&quot;EQ_ENGINE_TYPE4A&quot;, &quot;heatsinks:1&quot;]
	}, // asp mark II, fer-de-lance
	{
		primaryRole: &quot;pirate-aegis-raider&quot;,
		minSpace: 31,
		maxSpace: 40,
		equipmentList: [&quot;EQ_ENGINE_TYPE4B&quot;, &quot;heatsinks:2&quot;]
	}, // cobra III (std model)
	{
		primaryRole: &quot;pirate-aegis-raider&quot;,
		minSpace: 41,
		maxSpace: 80,
		equipmentList: [&quot;EQ_ENGINE_TYPE5A&quot;, &quot;heatsinks:3&quot;]
	}, // cobra III (+ extra cargo)
	{
		primaryRole: &quot;pirate-light-freighter&quot;,
		minSpace: 0,
		maxSpace: 20,
		equipmentList: [&quot;EQ_ENGINE_TYPE3B&quot;, &quot;energy:1&quot;, &quot;heatsinks:1&quot;]
	}, //
	{
		primaryRole: &quot;pirate-light-freighter&quot;,
		minSpace: 21,
		maxSpace: 30,
		equipmentList: [&quot;EQ_ENGINE_TYPE3B&quot;, &quot;energy:1&quot;, &quot;heatsinks:1&quot;]
	}, // cobra I, moray starboat
	{
		primaryRole: &quot;pirate-light-freighter&quot;,
		minSpace: 31,
		maxSpace: 40,
		equipmentList: [&quot;EQ_ENGINE_TYPE3B&quot;, &quot;energy:2&quot;, &quot;heatsinks:2&quot;]
	}, // cobra III (std model)
	{
		primaryRole: &quot;pirate-light-freighter&quot;,
		minSpace: 41,
		maxSpace: 50,
		equipmentList: [&quot;EQ_ENGINE_TYPE4B&quot;, &quot;energy:2&quot;, &quot;frontshields:1&quot;, &quot;aftshields:1&quot;, &quot;heatsinks:2&quot;]
	}, // cobra III (+ extra cargo)
	{
		primaryRole: &quot;pirate-light-freighter&quot;,
		minSpace: 51,
		maxSpace: 60,
		equipmentList: [&quot;EQ_ENGINE_TYPE4B&quot;, &quot;energy:3&quot;, &quot;frontshields:1&quot;, &quot;aftshields:1&quot;, &quot;EQ_ARMOUR_FORWARD_TYPE2&quot;, &quot;EQ_ARMOUR_AFT_TYPE2&quot;, &quot;heatsinks:3&quot;]
	}, //
	{
		primaryRole: &quot;pirate-light-freighter&quot;,
		minSpace: 61,
		maxSpace: 70,
		equipmentList: [&quot;EQ_ENGINE_TYPE4B&quot;, &quot;energy:3&quot;, &quot;frontshields:2&quot;, &quot;aftshields:2&quot;, &quot;EQ_ARMOUR_FORWARD_TYPE3&quot;, &quot;EQ_ARMOUR_AFT_TYPE3&quot;, &quot;heatsinks:4&quot;]
	}, // python
	{
		primaryRole: &quot;pirate-medium-freighter&quot;,
		minSpace: 0,
		maxSpace: 20,
		equipmentList: []
	}, // shouldn&#39;t get many ships in this bracket
	{
		primaryRole: &quot;pirate-medium-freighter&quot;,
		minSpace: 21,
		maxSpace: 30,
		equipmentList: [&quot;EQ_ENGINE_TYPE3B&quot;, &quot;energy:1&quot;, &quot;heatsinks:2&quot;]
	}, //
	{
		primaryRole: &quot;pirate-medium-freighter&quot;,
		minSpace: 31,
		maxSpace: 40,
		equipmentList: [&quot;EQ_ENGINE_TYPE3B&quot;, &quot;energy:1&quot;, &quot;heatsinks:2&quot;]
	}, // cobra III (std model)
	{
		primaryRole: &quot;pirate-medium-freighter&quot;,
		minSpace: 41,
		maxSpace: 50,
		equipmentList: [&quot;EQ_ENGINE_TYPE3B&quot;, &quot;energy:2&quot;, &quot;frontshields:1&quot;, &quot;aftshields:1&quot;, &quot;heatsinks:3&quot;]
	}, // cobra III (+ extra cargo)
	{
		primaryRole: &quot;pirate-medium-freighter&quot;,
		minSpace: 51,
		maxSpace: 60,
		equipmentList: [&quot;EQ_ENGINE_TYPE4B&quot;, &quot;energy:2&quot;, &quot;frontshields:1&quot;, &quot;aftshields:1&quot;, &quot;EQ_ARMOUR_FORWARD_TYPE2&quot;, &quot;EQ_ARMOUR_AFT_TYPE2&quot;, &quot;heatsinks:4&quot;]
	}, //
	{
		primaryRole: &quot;pirate-medium-freighter&quot;,
		minSpace: 61,
		maxSpace: 70,
		equipmentList: [&quot;EQ_ENGINE_TYPE4B&quot;, &quot;energy:3&quot;, &quot;frontshields:2&quot;, &quot;aftshields:2&quot;, &quot;EQ_ARMOUR_FORWARD_TYPE2&quot;, &quot;EQ_ARMOUR_AFT_TYPE2&quot;, &quot;heatsinks:5&quot;]
	}, // python
	{
		primaryRole: &quot;pirate-medium-freighter&quot;,
		minSpace: 71,
		maxSpace: 80,
		equipmentList: [&quot;EQ_ENGINE_TYPE4B&quot;, &quot;energy:3&quot;, &quot;frontshields:2&quot;, &quot;aftshields:2&quot;, &quot;EQ_ARMOUR_FORWARD_TYPE3&quot;, &quot;EQ_ARMOUR_AFT_TYPE3&quot;, &quot;heatsinks:6&quot;]
	}, // boa
	{
		primaryRole: &quot;pirate-heavy-freighter&quot;,
		minSpace: 0,
		maxSpace: 20,
		equipmentList: []
	}, // shouldn&#39;t get many ships in these brackets
	{
		primaryRole: &quot;pirate-heavy-freighter&quot;,
		minSpace: 21,
		maxSpace: 30,
		equipmentList: []
	}, //
	{
		primaryRole: &quot;pirate-heavy-freighter&quot;,
		minSpace: 31,
		maxSpace: 40,
		equipmentList: [&quot;EQ_ENGINE_TYPE3B&quot;, &quot;energy:1&quot;, &quot;heatsinks:3&quot;]
	}, //
	{
		primaryRole: &quot;pirate-heavy-freighter&quot;,
		minSpace: 41,
		maxSpace: 50,
		equipmentList: [&quot;EQ_ENGINE_TYPE3B&quot;, &quot;energy:2&quot;, &quot;frontshields:1&quot;, &quot;aftshields:1&quot;, &quot;heatsinks:3&quot;]
	}, //
	{
		primaryRole: &quot;pirate-heavy-freighter&quot;,
		minSpace: 51,
		maxSpace: 60,
		equipmentList: [&quot;EQ_ENGINE_TYPE4B&quot;, &quot;energy:2&quot;, &quot;frontshields:2&quot;, &quot;aftshields:2&quot;, &quot;EQ_ARMOUR_FORWARD_TYPE2&quot;, &quot;EQ_ARMOUR_AFT_TYPE2&quot;, &quot;heatsinks:4&quot;]
	}, //
	{
		primaryRole: &quot;pirate-heavy-freighter&quot;,
		minSpace: 61,
		maxSpace: 70,
		equipmentList: [&quot;EQ_ENGINE_TYPE4B&quot;, &quot;energy:3&quot;, &quot;frontshields:3&quot;, &quot;aftshields:3&quot;, &quot;EQ_ARMOUR_FORWARD_TYPE3&quot;, &quot;EQ_ARMOUR_AFT_TYPE3&quot;, &quot;heatsinks:5&quot;]
	}, // boa, python
	{
		primaryRole: &quot;pirate-heavy-freighter&quot;,
		minSpace: 71,
		maxSpace: 80,
		equipmentList: [&quot;EQ_ENGINE_TYPE4B&quot;, &quot;energy:3&quot;, &quot;frontshields:4&quot;, &quot;aftshields:4&quot;, &quot;EQ_ARMOUR_FORWARD_TYPE4&quot;, &quot;EQ_ARMOUR_AFT_TYPE4&quot;, &quot;heatsinks:6&quot;]
	}, // anaconda, boa cc
	{
		primaryRole: &quot;escort&quot;,
		minSpace: 0,
		maxSpace: 20,
		equipmentList: [&quot;EQ_ENGINE_TYPE3B&quot;]
	},
	{
		primaryRole: &quot;escort&quot;,
		minSpace: 21,
		maxSpace: 30,
		equipmentList: [&quot;EQ_ENGINE_TYPE3B&quot;]
	},
	{
		primaryRole: &quot;escort&quot;,
		minSpace: 31,
		maxSpace: 40,
		equipmentList: [&quot;EQ_ENGINE_TYPE4B&quot;]
	},
	{
		primaryRole: &quot;escort&quot;,
		minSpace: 41,
		maxSpace: 50,
		equipmentList: [&quot;EQ_ENGINE_TYPE4B&quot;]
	},
	{
		primaryRole: &quot;escort&quot;,
		minSpace: 51,
		maxSpace: 60,
		equipmentList: [&quot;EQ_ENGINE_TYPE5B&quot;]
	},
	{
		primaryRole: &quot;escort-medium&quot;,
		minSpace: 0,
		maxSpace: 20,
		equipmentList: [&quot;EQ_ENGINE_TYPE3B&quot;]
	},
	{
		primaryRole: &quot;escort-medium&quot;,
		minSpace: 21,
		maxSpace: 30,
		equipmentList: [&quot;EQ_ENGINE_TYPE4B&quot;, &quot;heatsinks:2&quot;]
	},
	{
		primaryRole: &quot;escort-medium&quot;,
		minSpace: 31,
		maxSpace: 40,
		equipmentList: [&quot;EQ_ENGINE_TYPE4B&quot;, &quot;heatsinks:2&quot;]
	},
	{
		primaryRole: &quot;escort-medium&quot;,
		minSpace: 41,
		maxSpace: 50,
		equipmentList: [&quot;EQ_ENGINE_TYPE5B&quot;, &quot;heatsinks:3&quot;]
	},
	{
		primaryRole: &quot;escort-medium&quot;,
		minSpace: 51,
		maxSpace: 60,
		equipmentList: [&quot;EQ_ENGINE_TYPE5B&quot;, &quot;heatsinks:3&quot;]
	},
	{
		primaryRole: &quot;escort-medium&quot;,
		minSpace: 61,
		maxSpace: 70,
		equipmentList: [&quot;EQ_ENGINE_TYPE6B&quot;, &quot;heatsinks:4&quot;]
	},
	{
		primaryRole: &quot;escort-heavy&quot;,
		minSpace: 0,
		maxSpace: 20,
		equipmentList: [&quot;EQ_ENGINE_TYPE3B&quot;]
	},
	{
		primaryRole: &quot;escort-heavy&quot;,
		minSpace: 21,
		maxSpace: 30,
		equipmentList: [&quot;EQ_ENGINE_TYPE4B&quot;, &quot;heatsinks:2&quot;]
	},
	{
		primaryRole: &quot;escort-heavy&quot;,
		minSpace: 31,
		maxSpace: 40,
		equipmentList: [&quot;EQ_ENGINE_TYPE4B&quot;, &quot;heatsinks:2&quot;]
	},
	{
		primaryRole: &quot;escort-heavy&quot;,
		minSpace: 41,
		maxSpace: 50,
		equipmentList: [&quot;EQ_ENGINE_TYPE5B&quot;, &quot;heatsinks:3&quot;]
	},
	{
		primaryRole: &quot;escort-heavy&quot;,
		minSpace: 51,
		maxSpace: 60,
		equipmentList: [&quot;EQ_ENGINE_TYPE5B&quot;, &quot;heatsinks:3&quot;]
	},
	{
		primaryRole: &quot;escort-heavy&quot;,
		minSpace: 61,
		maxSpace: 70,
		equipmentList: [&quot;EQ_ENGINE_TYPE6B&quot;, &quot;heatsinks:4&quot;]
	},
	{
		primaryRole: &quot;escort-heavy&quot;,
		minSpace: 71,
		maxSpace: 80,
		equipmentList: [&quot;EQ_ENGINE_TYPE6B&quot;, &quot;heatsinks:4&quot;]
	},
	{
		primaryRole: &quot;shuttle&quot;,
		minSpace: 0,
		maxSpace: 20,
		equipmentList: [&quot;EQ_ENGINE_TYPE3B&quot;, &quot;EQ_ARMOUR_FORWARD_TYPE2&quot;, &quot;EQ_ARMOUR_AFT_TYPE2&quot;, &quot;EQ_HEAT_SHIELD_TYPE3&quot;]
	},
	{
		primaryRole: &quot;shuttle&quot;,
		minSpace: 21,
		maxSpace: 30,
		equipmentList: [&quot;EQ_ENGINE_TYPE3B&quot;, &quot;EQ_ARMOUR_FORWARD_TYPE2&quot;, &quot;EQ_ARMOUR_AFT_TYPE2&quot;, &quot;EQ_HEAT_SHIELD_TYPE3&quot;]
	},
	{
		primaryRole: &quot;shuttle&quot;,
		minSpace: 31,
		maxSpace: 40,
		equipmentList: [&quot;EQ_ENGINE_TYPE3B&quot;, &quot;EQ_ARMOUR_FORWARD_TYPE2&quot;, &quot;EQ_ARMOUR_AFT_TYPE2&quot;, &quot;EQ_HEAT_SHIELD_TYPE3&quot;]
	},
	{
		primaryRole: &quot;shuttle&quot;,
		minSpace: 41,
		maxSpace: 80,
		equipmentList: [&quot;EQ_ENGINE_TYPE4B&quot;, &quot;EQ_ARMOUR_FORWARD_TYPE3&quot;, &quot;EQ_ARMOUR_AFT_TYPE3&quot;, &quot;EQ_HEAT_SHIELD_TYPE3&quot;]
	},
	{
		primaryRole: &quot;police&quot;,
		minSpace: 0,
		maxSpace: 80,
		equipmentList: [&quot;engines:2&quot;, &quot;energy:1&quot;, &quot;thrusters:2&quot;]
	},
	{
		primaryRole: &quot;police-station-patrol&quot;,
		minSpace: 0,
		maxSpace: 80,
		equipmentList: [&quot;engines:2&quot;, &quot;energy:1&quot;, &quot;thrusters:2&quot;]
	},
	{
		primaryRole: &quot;police-witchpoint-patrol&quot;,
		minSpace: 0,
		maxSpace: 80,
		equipmentList: [&quot;engines:3&quot;, &quot;energy:2&quot;, &quot;thrusters:3&quot;]
	},
	{
		primaryRole: &quot;wingman&quot;,
		minSpace: 0,
		maxSpace: 80,
		equipmentList: [&quot;engines:2&quot;, &quot;energy:1&quot;, &quot;thrusters:2&quot;]
	},
	{
		primaryRole: &quot;miner&quot;,
		minSpace: 0,
		maxSpace: 80,
		equipmentList: [&quot;EQ_ARMOUR_TYPE2&quot;]
	},
	{
		primaryRole: &quot;scavenger&quot;,
		minSpace: 0,
		maxSpace: 80,
		equipmentList: [&quot;EQ_ARMOUR_TYPE2&quot;]
	},
];

// these equipment items don&#39;t take up space or weight, or can just be ignored altogether
this._ignoreEquip = [&quot;EQ_FUEL&quot;, &quot;EQ_SCANNER_SHOW_MISSILE_TARGET&quot;, &quot;EQ_MULTI_TARGET&quot;, &quot;EQ_ADVANCED_NAVIGATIONAL_ARRAY&quot;, &quot;EQ_INTEGRATED_TARGETING_SYSTEM&quot;, &quot;EQ_REVOVATION&quot;,
	&quot;EQ_TARGET_MEMORY&quot;, &quot;EQ_SMUGGLING_PHASE_ADJUSTMENT&quot;, &quot;EQ_SDC_HACK_CHIP&quot;, &quot;EQ_IG_INSURANCE&quot;, &quot;EQ_IG_LEGAL_HACK&quot;, &quot;EQ_LMSS_ACTUATOR&quot;, &quot;EQ_ESCORTCONTRACTS&quot;, &quot;EQ_TEA_MAKER&quot;, &quot;EQ_TEAPOT&quot;,
	&quot;EQ_RENOVATION&quot;, &quot;EQ_COMMSLOGMFD&quot;, &quot;EQ_COMMSLOGMFD_PASSIVE&quot;, &quot;EQ_BROADCASTCOMMSMFD&quot;, &quot;EQ_DAMAGE_REPORT_MFD&quot;, &quot;EQ_DAMAGE_REPORT_MFD_PASSIVE&quot;, &quot;EQ_COMBATMFD&quot;, &quot;EQ_NAVIGATION_MFD&quot;,
	&quot;EQ_WEAPON_NONE&quot;, &quot;EQ_APRIL_INVENTORY&quot;, &quot;EQ_APRIL_TRANSFER&quot;, &quot;EQ_APRIL_UNLOAD&quot;, &quot;EQ_AMS_1&quot;, &quot;EQ_AMS_2&quot;, &quot;EQ_AMS_3&quot;, &quot;EQ_AMS_4&quot;, &quot;EQ_GLARE_FILTER&quot;, &quot;EQ_GLARE_FILTER_REPLACE&quot;,
	&quot;EQ_RRS_FUEL&quot;, &quot;EQ_AMS_5&quot;, &quot;EQ_AMS_6&quot;, &quot;EQ_AUTO_EJECT&quot;, &quot;EQ_BOUNTY_INFORMER&quot;, &quot;EQ_CARGOSPOTTER&quot;, &quot;EQ_ELITE_RANK&quot;, &quot;EQ_RESERVE_TANK_EMPTY&quot;, &quot;EQ_AUX_TANK_EMPTY&quot;,
	&quot;EQ_WEAPON_GATLING_LASER_COOLER&quot;, &quot;EQ_NDC_AUTODOCK&quot;, &quot;EQ_OXPDevHelper&quot;, &quot;EQ_HUDSELECTOR&quot;, &quot;EQ_MARKET_INQUIRER_MFD&quot;, &quot;EQ_TROPHY_MFD&quot;, &quot;EQ_UPS_IDCLEANER&quot;, &quot;EQ_UPS_PRIVATE_ESCORT&quot;,
	&quot;EQ_MULTIPASS&quot;, &quot;EQ_MULTIPASSED_ID&quot;, &quot;EQ_HARDWIRE_ORE_PROCESSOR&quot;, &quot;EQ_SCANNER_SHOW_MISSILE_TARGET_SALVAGED&quot;, &quot;EQ_MULTI_TARGET_SALVAGED&quot;, &quot;EQ_ADVANCED_NAVIGATIONAL_ARRAY_SALVAGED&quot;,
	&quot;EQ_TARGETSELECTOR&quot;, &quot;EQ_HULL_REPAIR&quot;, &quot;EQ_SHIPS_CAT_1&quot;, &quot;EQ_SHIPS_CAT_2&quot;, &quot;EQ_SHIPS_CAT_3&quot;, &quot;EQ_SHIPS_CAT_4&quot;, &quot;EQ_SHIPS_CAT_5&quot;, &quot;EQ_SHIPS_CAT_6&quot;, &quot;EQ_SHIPS_CAT_7&quot;, &quot;EQ_SHIPS_CAT_8&quot;,
	&quot;EQ_SHIPS_CAT_9&quot;, &quot;EQ_TARGET_MEMORY_SALVAGED&quot;, &quot;EQ_CTE_TRADERNET&quot;, &quot;EQ_CTE_TRADERNET_RENEWAL&quot;, &quot;EQ_CAMERA_DRONES&quot;, &quot;EQ_HOLY_FUEL&quot;, &quot;EQ_WPH_ASC_UPGRADE&quot;, &quot;EQ_RRS_ANA&quot;,
	&quot;EQ_RRS_FLIGHTFORM&quot;, &quot;EQ_RRS_FLIGHTFORM_DISCOUNT&quot;, &quot;EQ_RRS_SERVICE&quot;, &quot;EQ_RRS_ESCORT_TARGETING_SYSTEM&quot;, &quot;EQ_RRS_ESCORT_TARGETING_SYSTEM_WAYSTATION&quot;,
	&quot;EQ_RRS_ESCORT_TARGETING_SYSTEM_DISCOUNT&quot;, &quot;EQ_RRS_SCANNER_SHOW_MISSILE_TARGET&quot;, &quot;EQ_RRS_SCANNER_SHOW_MISSILE_TARGET_DISCOUNT&quot;, &quot;EQ_RRS_FULLEQUIP&quot;, &quot;EQ_BREAKABLE_HUD_IFF_SCANNER&quot;,
	&quot;EQ_ESCORTDECK&quot;, &quot;EQ_ESCORTDECKXL&quot;, &quot;EQ_ESCORTDECK_adder&quot;, &quot;EQ_ESCORTDECK_asp&quot;, &quot;EQ_ESCORTDECK_gecko&quot;, &quot;EQ_ESCORTDECK_sidewinder&quot;, &quot;EQ_ESCORTDECK_viper&quot;, &quot;EQ_ESCORTDECK_ophidian&quot;,
	&quot;EQ_ESCORTDECK_ghavial&quot;, &quot;EQ_ESCORTDECK_wolf&quot;, &quot;EQ_ESCORTDECK_arachnid&quot;, &quot;EQ_ESCORTDECK_s8&quot;, &quot;EQ_ESCORTDECK_sniper-wolf&quot;, &quot;EQ_ESCORTDECK_sniper-arachnid&quot;, &quot;EQ_ESCORTDECK_sniper-s8&quot;,
	&quot;EQ_HYPER_RADIO&quot;, &quot;EQ_HYPER_RADIO_ADD&quot;, &quot;EQ_HYPER_RADIO_PIRATE&quot;, &quot;EQ_HIREDGUN_HIGH&quot;, &quot;EQ_HIREDGUN_MID&quot;, &quot;EQ_HIREDGUN_LOW&quot;, &quot;EQ_ILS&quot;, &quot;EQ_WEAPON_LASER_COOLER&quot;, &quot;EQ_MANIFEST_MFD&quot;,
	&quot;EQ_RMB_CHAFF_MINE&quot;, &quot;EQ_POLICE_SCANNER_UPGRADE&quot;, &quot;EQ_Q-CHARGER_MESS&quot;, &quot;EQ_REPAIRBOTS_RECHARGE&quot;, &quot;EQ_SAFETYCATCH&quot;, &quot;EQ_SAFETY_MINE&quot;, &quot;EQ_SCANNER_ALERTING_ENHANCEMENT&quot;,
	&quot;EQ_SC_MANUAL_CONFIGURATOR_BASIC&quot;, &quot;EQ_SC_MANUAL_CONFIGURATOR_STANDARD&quot;, &quot;EQ_SC_MANUAL_CONFIGURATOR_ADVANCED&quot;, &quot;EQ_SC_SC_REPAIR&quot;, &quot;EQ_ENEMY_TARGETER_UPGRADE&quot;,
	&quot;EQ_TELESCOPE_REPAIR&quot;, &quot;EQ_TELESCOPE_FULLREPAIR&quot;, &quot;EQ_TELESCOPEEXT&quot;, &quot;EQ_GRAVSCANNER_REPAIR&quot;, &quot;EQ_GRAVSCANNER_FULLREPAIR&quot;, &quot;EQ_GRAVSCANNER2_REPAIR&quot;, &quot;EQ_GRAVSCANNER2_FULLREPAIR&quot;,
	&quot;EQ_SMALLDISH_REPAIR&quot;, &quot;EQ_SMALLDISH_FULLREPAIR&quot;, &quot;EQ_LARGEDISH_REPAIR&quot;, &quot;EQ_LARGEDISH_FULLREPAIR&quot;, &quot;EQ_TORUSTOSUN&quot;, &quot;EQ_TRACKER&quot;, &quot;EQ_TRACKERCAM_LINK&quot;, &quot;EQ_TWS_GALACTICSATNAV&quot;,
	&quot;EQ_WELCOME_MAT&quot;, &quot;EQ_SMUGGLING_COMPARTMENT_REPAIR_1&quot;, &quot;EQ_SMUGGLING_COMPARTMENT_REPAIR_2&quot;, &quot;EQ_SMUGGLING_COMPARTMENT_REPAIR_3&quot;, &quot;EQ_SMUGGLING_COMPARTMENT_REPAIR_4&quot;,
	&quot;EQ_SMUGGLING_COMPARTMENT_REPAIR_5&quot;, &quot;EQ_SMUGGLING_COMPARTMENT_REPAIR_6&quot;, &quot;EQ_SMUGGLING_COMPARTMENT_REPAIR_7&quot;, &quot;EQ_SMUGGLING_COMPARTMENT_REPAIR_8&quot;,
	&quot;EQ_SMUGGLING_COMPARTMENT_REPAIR_9&quot;, &quot;EQ_SMUGGLING_COMPARTMENT_REPAIR_10&quot;, &quot;EQ_SMUGGLING_COMPARTMENT_REPAIR_11&quot;, &quot;EQ_SMUGGLING_COMPARTMENT_REPAIR_12&quot;,
	&quot;EQ_SMUGGLING_COMPARTMENT_REPAIR_13&quot;, &quot;EQ_SMUGGLING_COMPARTMENT_REPAIR_14&quot;, &quot;EQ_SMUGGLING_COMPARTMENT_REPAIR_15&quot;, &quot;EQ_SMUGGLING_COMPARTMENT_REPAIR_16&quot;,
	&quot;EQ_SMUGGLING_COMPARTMENT_REPAIR_17&quot;, &quot;EQ_SMUGGLING_COMPARTMENT_REPAIR_18&quot;, &quot;EQ_SMUGGLING_COMPARTMENT_REPAIR_19&quot;, &quot;EQ_SMUGGLING_COMPARTMENT_REPAIR_20&quot;, &quot;EQ_FHUD_OOLITE&quot;,
	&quot;EQ_BREAKABLE_LIFE_SUPPORT_SYSTEM&quot;, &quot;EQ_SHIPCONFIG&quot;, &quot;EQ_FUEL_INJECTION&quot;, &quot;EQ_HEAT_SHIELD&quot;, &quot;EQ_RAILGUN_1_AMMUNITION&quot;, &quot;EQ_RAILGUN_2_AMMUNITION&quot;, &quot;EQ_XS_SELLPYLON_BASEDEQUIPMENT&quot;,
	&quot;EQ_RAILGUN_3_AMMUNITION&quot;, &quot;EQ_RAILGUN_4_AMMUNITION&quot;, &quot;EQ_COTBS_RESTORE&quot;, &quot;EQ_GAL_DRIVE_MOD&quot;, &quot;EQ_CATACLYSM_ALL_INCLUSIVE&quot;, &quot;EQ_SALON_CONTROL&quot;, &quot;EQ_SNIPER_SCOPE&quot;,
	&quot;EQ_SYSTEM_MARKET_WATCH&quot;, &quot;EQ_AUTOECM&quot;, &quot;EQ_FS_CLOAK_PLACEHOLDER&quot;, &quot;EQ_FS_BOMB_PLACEHOLDER&quot;, &quot;EQ_FS_INJECTION_PLACEHOLDER&quot;, &quot;EQ_GALAXY_INFO&quot;, &quot;EQ_LONG_RANGE_SCANNER_JUMP&quot;,
	&quot;EQ_RETICLE_TARGET_SENSITIVE&quot;, &quot;EQ_SELL_ENERGY_GRID&quot;, &quot;EQ_ECM_SALVAGED&quot;, &quot;EQ_FUEL_SCOOPS_SALVAGED&quot;, &quot;EQ_ESCAPE_POD_SALVAGED&quot;, &quot;EQ_ENERGY_BOMB_SALVAGED&quot;, &quot;EQ_ENERGY_UNIT_SALVAGED&quot;,
	&quot;EQ_NAVAL_ENERGY_UNIT_SALVAGED&quot;, &quot;EQ_DOCK_COMP_SALVAGED&quot;, &quot;EQ_GAL_DRIVE_SALVAGED&quot;, &quot;EQ_FUEL_INJECTION_SALVAGED&quot;, &quot;EQ_ADVANCED_COMPASS_SALVAGED&quot;, &quot;EQ_SHIELD_BOOSTER_SALVAGED&quot;,
	&quot;EQ_NAVAL_SHIELD_BOOSTER_SALVAGED&quot;, &quot;EQ_HEAT_SHIELD_SALVAGED&quot;, &quot;EQ_WORMHOLE_SCANNER_SALVAGED&quot;, &quot;EQ_OXPCONFIG_COLORS&quot;, &quot;EQ_OXPCONFIG_M0&quot;, &quot;EQ_OXPCONFIG_M1&quot;, &quot;EQ_OXPCONFIG_M2&quot;,
	&quot;EQ_OXPCONFIG_M3&quot;, &quot;EQ_OXPCONFIG_M4&quot;, &quot;EQ_OXPCONFIG_M5&quot;, &quot;EQ_OXPCONFIG_W0&quot;, &quot;EQ_DTADAM&quot;, &quot;EQ_DTADER&quot;, &quot;EQ_DTAWEA&quot;, &quot;EQ_CCL_OXPS_MINE&quot;, &quot;EQ_CABAL_COMMON_SPECIALMARKETS&quot;,
	&quot;EQ_CABAL_COMMON_COMM&quot;, &quot;EQ_MANIF_SCANNERX&quot;, &quot;EQ_MC_DESCRAMBLER&quot;, &quot;EQ_MURPH_THARGOID_DRIVE_TOFIT&quot;, &quot;EQ_MURPH_THARGOID_DRIVE_QUOTE&quot;, &quot;EQ_SHIP_RESPRAY&quot;, &quot;EQ_SHIP_RESPRAY_180&quot;,
	&quot;EQ_HEAT_SINK_CONTROL&quot;, &quot;EQ_HEAT_SINK_CONTROL_PASSIVE&quot;, &quot;EQ_SYNC_TORUS&quot;, &quot;EQ_AI_TRADING_ASSISTANT&quot;, &quot;EQ_AUTO_CROSSHAIRS&quot;, &quot;EQ_SELECTABLE_CROSSHAIRS&quot;, &quot;EQ_TRAIL_DETECTOR&quot;,
	&quot;EQ_EREHWON_PHOTOCAMERA&quot;, &quot;EQ_ENEMY_TARGETER_UPGRADE&quot;, &quot;EQ_SNIPERLOCK&quot;, &quot;EQ_VECTOR_PAD&quot;, &quot;EQ_RINGRACER&quot;, &quot;EQ_IN_SYSTEM_TAXI_LICENCE&quot;, &quot;EQ_NS_MINING_SCANNER_UPGRADE&quot;,
	&quot;EQ_LUCKYCHARM&quot;, &quot;EQ_PIRATE_FUEL&quot;, &quot;EQ_FUEL_ALT1&quot;, &quot;EQ_FUEL_ALT2&quot;, &quot;EQ_FUEL_ALT3&quot;, &quot;EQ_FUEL_ALT4&quot;, &quot;EQ_FUEL_ALT5&quot;, &quot;EQ_FUEL_ALT6&quot;, &quot;EQ_SHIPS_LIBRARY&quot;, &quot;EQ_ALMANAC_UNIT_MFD&quot;,
	&quot;EQ_VIMANA_TARGET_MODULE&quot;, &quot;EQ_VIMANA_TRAVEL_MODULE&quot;, &quot;EQ_VIMANA_SHIP_MODULE&quot;, &quot;EQ_VIMANAX_TARGET_MODULE&quot;, &quot;EQ_VIMANAX_TRAVEL_MODULE&quot;, &quot;EQ_VIMANAX_SHIP_MODULE&quot;,
	&quot;EQ_SHIP_VERSION_10&quot;, &quot;EQ_SHIP_VERSION_11&quot;, &quot;EQ_SHIP_VERSION_12&quot;, &quot;EQ_SHIP_VERSION_13&quot;, &quot;EQ_SHIP_VERSION_14&quot;, 
	&quot;EQ_SHIP_VERSION_15&quot;, &quot;EQ_SHIP_VERSION_16&quot;, &quot;EQ_SHIP_VERSION_17&quot;, &quot;EQ_SHIP_VERSION_18&quot;, &quot;EQ_SHIP_VERSION_19&quot;, 
	&quot;EQ_SHIP_VERSION_20&quot;, &quot;EQ_SHIP_VERSION_21&quot;, &quot;EQ_SHIP_VERSION_22&quot;, &quot;EQ_SHIP_VERSION_23&quot;, &quot;EQ_SHIP_VERSION_24&quot;, 
	&quot;EQ_SHIP_VERSION_25&quot;, &quot;EQ_SHIP_VERSION_26&quot;, &quot;EQ_SHIP_VERSION_27&quot;, &quot;EQ_SHIP_VERSION_28&quot;, &quot;EQ_SHIP_VERSION_29&quot;, 
	&quot;EQ_SHIP_VERSION_30&quot;, &quot;EQ_SHIP_VERSION_31&quot;, &quot;EQ_SHIP_VERSION_32&quot;, &quot;EQ_SHIP_VERSION_33&quot;, &quot;EQ_SHIP_VERSION_34&quot;, 
	&quot;EQ_SHIP_VERSION_35&quot;, &quot;EQ_SHIP_VERSION_36&quot;, &quot;EQ_SHIP_VERSION_37&quot;, &quot;EQ_SHIP_VERSION_38&quot;, &quot;EQ_SHIP_VERSION_39&quot;, 
	&quot;EQ_SHIP_VERSION_40&quot;, &quot;EQ_SHIP_VERSION_41&quot;, &quot;EQ_SHIP_VERSION_42&quot;, &quot;EQ_SHIP_VERSION_43&quot;, &quot;EQ_SHIP_VERSION_44&quot;, 
	&quot;EQ_SHIP_VERSION_45&quot;, &quot;EQ_SHIP_VERSION_46&quot;, &quot;EQ_SHIP_VERSION_47&quot;, &quot;EQ_SHIP_VERSION_48&quot;, &quot;EQ_SHIP_VERSION_49&quot;, 
	&quot;EQ_SHIP_VERSION_50&quot;, &quot;EQ_SHIP_VERSION_51&quot;, &quot;EQ_SHIP_VERSION_52&quot;, &quot;EQ_SHIP_VERSION_53&quot;, &quot;EQ_SHIP_VERSION_54&quot;, 
	&quot;EQ_SHIP_VERSION_55&quot;, &quot;EQ_SHIP_VERSION_56&quot;, &quot;EQ_SHIP_VERSION_57&quot;, &quot;EQ_SHIP_VERSION_58&quot;, &quot;EQ_SHIP_VERSION_59&quot;, 
	&quot;EQ_SHIP_VERSION_60&quot;, &quot;EQ_SHIP_VERSION_61&quot;, &quot;EQ_SHIP_VERSION_62&quot;, &quot;EQ_SHIP_VERSION_63&quot;, &quot;EQ_SHIP_VERSION_64&quot;, 
	&quot;EQ_SHIP_VERSION_65&quot;, &quot;EQ_SHIP_VERSION_66&quot;, &quot;EQ_SHIP_VERSION_67&quot;, &quot;EQ_SHIP_VERSION_68&quot;, &quot;EQ_SHIP_VERSION_69&quot;, 
	&quot;EQ_SHIP_VERSION_70&quot;, &quot;EQ_SHIP_VERSION_71&quot;, &quot;EQ_SHIP_VERSION_72&quot;, &quot;EQ_SHIP_VERSION_73&quot;, &quot;EQ_SHIP_VERSION_74&quot;, 
	&quot;EQ_SHIP_VERSION_75&quot;, &quot;EQ_SHIP_VERSION_76&quot;, &quot;EQ_SHIP_VERSION_77&quot;, &quot;EQ_SHIP_VERSION_78&quot;, &quot;EQ_SHIP_VERSION_79&quot;, 
	&quot;EQ_SHIP_VERSION_80&quot;, &quot;EQ_SHIP_VERSION_81&quot;, &quot;EQ_SHIP_VERSION_82&quot;, &quot;EQ_SHIP_VERSION_83&quot;, &quot;EQ_SHIP_VERSION_84&quot;, 
	&quot;EQ_SHIP_VERSION_85&quot;, &quot;EQ_SHIP_VERSION_86&quot;, &quot;EQ_SHIP_VERSION_87&quot;, &quot;EQ_SHIP_VERSION_88&quot;, &quot;EQ_SHIP_VERSION_89&quot;, 
	&quot;EQ_SHIP_VERSION_90&quot;, &quot;EQ_SHIP_VERSION_91&quot;, &quot;EQ_SHIP_VERSION_92&quot;, &quot;EQ_SHIP_VERSION_93&quot;, &quot;EQ_SHIP_VERSION_94&quot;, 
	&quot;EQ_SHIP_VERSION_95&quot;, &quot;EQ_SHIP_VERSION_96&quot;, &quot;EQ_SHIP_VERSION_97&quot;, &quot;EQ_SHIP_VERSION_98&quot;, &quot;EQ_SHIP_VERSION_99&quot;, 
	&quot;EQ_SHIP_VERSION_100&quot;,
	&quot;EQ_SERVICE_LEVEL_75&quot;, &quot;EQ_SERVICE_LEVEL_76&quot;, &quot;EQ_SERVICE_LEVEL_77&quot;, &quot;EQ_SERVICE_LEVEL_78&quot;, &quot;EQ_SERVICE_LEVEL_79&quot;, 
	&quot;EQ_SERVICE_LEVEL_80&quot;, &quot;EQ_SERVICE_LEVEL_81&quot;, &quot;EQ_SERVICE_LEVEL_82&quot;, &quot;EQ_SERVICE_LEVEL_83&quot;, &quot;EQ_SERVICE_LEVEL_84&quot;, 
	&quot;EQ_SERVICE_LEVEL_85&quot;, &quot;EQ_SERVICE_LEVEL_86&quot;, &quot;EQ_SERVICE_LEVEL_87&quot;, &quot;EQ_SERVICE_LEVEL_88&quot;, &quot;EQ_SERVICE_LEVEL_89&quot;, 
	&quot;EQ_SERVICE_LEVEL_90&quot;, &quot;EQ_SERVICE_LEVEL_91&quot;, &quot;EQ_SERVICE_LEVEL_92&quot;, &quot;EQ_SERVICE_LEVEL_93&quot;, &quot;EQ_SERVICE_LEVEL_94&quot;, 
	&quot;EQ_SERVICE_LEVEL_95&quot;, &quot;EQ_SERVICE_LEVEL_96&quot;, &quot;EQ_SERVICE_LEVEL_97&quot;, &quot;EQ_SERVICE_LEVEL_98&quot;, &quot;EQ_SERVICE_LEVEL_99&quot;, 
	&quot;EQ_SERVICE_LEVEL_100&quot;
];

this._filler = [&quot;EQ_EQUIPSPACE_1&quot;, &quot;EQ_EQUIPSPACE_2&quot;, &quot;EQ_EQUIPSPACE_3&quot;, &quot;EQ_EQUIPSPACE_4&quot;, &quot;EQ_EQUIPSPACE_5&quot;, &quot;EQ_EQUIPSPACE_6&quot;, &quot;EQ_EQUIPSPACE_7&quot;, &quot;EQ_EQUIPSPACE_8&quot;,
	&quot;EQ_EQUIPSPACE_9&quot;, &quot;EQ_EQUIPSPACE_10&quot;, &quot;EQ_EQUIPSPACE_11&quot;, &quot;EQ_EQUIPSPACE_12&quot;, &quot;EQ_EQUIPSPACE_13&quot;, &quot;EQ_EQUIPSPACE_14&quot;, &quot;EQ_EQUIPSPACE_15&quot;, &quot;EQ_EQUIPSPACE_16&quot;,
	&quot;EQ_EQUIPSPACE_17&quot;, &quot;EQ_EQUIPSPACE_18&quot;, &quot;EQ_EQUIPSPACE_19&quot;, &quot;EQ_EQUIPSPACE_20&quot;, &quot;EQ_EQUIPSPACE_21&quot;, &quot;EQ_EQUIPSPACE_22&quot;, &quot;EQ_EQUIPSPACE_23&quot;, &quot;EQ_EQUIPSPACE_24&quot;,
	&quot;EQ_EQUIPSPACE_25&quot;, &quot;EQ_EQUIPSPACE_26&quot;, &quot;EQ_EQUIPSPACE_27&quot;, &quot;EQ_EQUIPSPACE_28&quot;, &quot;EQ_EQUIPSPACE_29&quot;, &quot;EQ_EQUIPSPACE_30&quot;, &quot;EQ_EQUIPSPACE_31&quot;, &quot;EQ_EQUIPSPACE_32&quot;,
	&quot;EQ_EQUIPSPACE_33&quot;, &quot;EQ_EQUIPSPACE_34&quot;, &quot;EQ_EQUIPSPACE_35&quot;, &quot;EQ_EQUIPSPACE_36&quot;, &quot;EQ_EQUIPSPACE_37&quot;, &quot;EQ_EQUIPSPACE_38&quot;, &quot;EQ_EQUIPSPACE_39&quot;, &quot;EQ_EQUIPSPACE_40&quot;
];

this._engines = [&quot;EQ_ENGINE_TYPE1A&quot;, &quot;EQ_ENGINE_TYPE1B&quot;, &quot;EQ_ENGINE_TYPE1C&quot;, &quot;EQ_ENGINE_TYPE1D&quot;, &quot;EQ_ENGINE_TYPE1E&quot;, &quot;EQ_ENGINE_TYPE1F&quot;,
	&quot;EQ_ENGINE_TYPE2A&quot;, &quot;EQ_ENGINE_TYPE2B&quot;, &quot;EQ_ENGINE_TYPE2C&quot;, &quot;EQ_ENGINE_TYPE2D&quot;, &quot;EQ_ENGINE_TYPE2E&quot;, &quot;EQ_ENGINE_TYPE2F&quot;,
	&quot;EQ_ENGINE_TYPE3A&quot;, &quot;EQ_ENGINE_TYPE3B&quot;, &quot;EQ_ENGINE_TYPE3C&quot;, &quot;EQ_ENGINE_TYPE3D&quot;, &quot;EQ_ENGINE_TYPE3E&quot;, &quot;EQ_ENGINE_TYPE3F&quot;,
	&quot;EQ_ENGINE_TYPE4A&quot;, &quot;EQ_ENGINE_TYPE4B&quot;, &quot;EQ_ENGINE_TYPE4C&quot;, &quot;EQ_ENGINE_TYPE4D&quot;, &quot;EQ_ENGINE_TYPE4E&quot;, &quot;EQ_ENGINE_TYPE4F&quot;,
	&quot;EQ_ENGINE_TYPE5A&quot;, &quot;EQ_ENGINE_TYPE5B&quot;, &quot;EQ_ENGINE_TYPE5C&quot;, &quot;EQ_ENGINE_TYPE5D&quot;, &quot;EQ_ENGINE_TYPE5E&quot;, &quot;EQ_ENGINE_TYPE5F&quot;,
	&quot;EQ_ENGINE_TYPE6A&quot;, &quot;EQ_ENGINE_TYPE6B&quot;, &quot;EQ_ENGINE_TYPE6C&quot;, &quot;EQ_ENGINE_TYPE6D&quot;, &quot;EQ_ENGINE_TYPE6E&quot;, &quot;EQ_ENGINE_TYPE6F&quot;,
	&quot;EQ_ENGINE_TYPE7A&quot;, &quot;EQ_ENGINE_TYPE7B&quot;, &quot;EQ_ENGINE_TYPE7C&quot;, &quot;EQ_ENGINE_TYPE7D&quot;, &quot;EQ_ENGINE_TYPE7E&quot;, &quot;EQ_ENGINE_TYPE7F&quot;
];
this._boosters = [&quot;EQ_BOOSTERS_TYPE1&quot;, &quot;EQ_BOOSTERS_TYPE2&quot;, &quot;EQ_BOOSTERS_TYPE3&quot;, &quot;EQ_BOOSTERS_TYPE4&quot;, &quot;EQ_BOOSTERS_TYPE5&quot;, &quot;EQ_BOOSTERS_TYPE6&quot;, &quot;EQ_BOOSTERS_TYPE7&quot;];
this._hyperdrive = [&quot;EQ_HYPERDRIVE_TYPE1&quot;, &quot;EQ_HYPERDRIVE_TYPE2&quot;, &quot;EQ_HYPERDRIVE_TYPE3&quot;, &quot;EQ_HYPERDRIVE_TYPE4&quot;];
this._thrusters = [&quot;EQ_THRUSTERS_TYPE1&quot;, &quot;EQ_THRUSTERS_TYPE2A&quot;, &quot;EQ_THRUSTERS_TYPE2B&quot;, &quot;EQ_THRUSTERS_TYPE2C&quot;, &quot;EQ_THRUSTERS_TYPE2D&quot;, &quot;EQ_THRUSTERS_TYPE2E&quot;, &quot;EQ_THRUSTERS_TYPE2F&quot;,
	&quot;EQ_THRUSTERS_TYPE3A&quot;, &quot;EQ_THRUSTERS_TYPE3B&quot;, &quot;EQ_THRUSTERS_TYPE3C&quot;, &quot;EQ_THRUSTERS_TYPE3D&quot;, &quot;EQ_THRUSTERS_TYPE3E&quot;, &quot;EQ_THRUSTERS_TYPE3F&quot;,
	&quot;EQ_THRUSTERS_TYPE4A&quot;, &quot;EQ_THRUSTERS_TYPE4B&quot;, &quot;EQ_THRUSTERS_TYPE4C&quot;, &quot;EQ_THRUSTERS_TYPE4D&quot;, &quot;EQ_THRUSTERS_TYPE4E&quot;, &quot;EQ_THRUSTERS_TYPE4F&quot;,
	&quot;EQ_THRUSTERS_TYPE5A&quot;, &quot;EQ_THRUSTERS_TYPE5B&quot;, &quot;EQ_THRUSTERS_TYPE5C&quot;, &quot;EQ_THRUSTERS_TYPE5D&quot;, &quot;EQ_THRUSTERS_TYPE5E&quot;, &quot;EQ_THRUSTERS_TYPE5F&quot;,
	&quot;EQ_THRUSTERS_TYPE6A&quot;, &quot;EQ_THRUSTERS_TYPE6B&quot;, &quot;EQ_THRUSTERS_TYPE6C&quot;, &quot;EQ_THRUSTERS_TYPE6D&quot;, &quot;EQ_THRUSTERS_TYPE6E&quot;, &quot;EQ_THRUSTERS_TYPE6F&quot;,
	&quot;EQ_THRUSTERS_TYPE7A&quot;, &quot;EQ_THRUSTERS_TYPE7B&quot;, &quot;EQ_THRUSTERS_TYPE7C&quot;, &quot;EQ_THRUSTERS_TYPE7D&quot;, &quot;EQ_THRUSTERS_TYPE7E&quot;, &quot;EQ_THRUSTERS_TYPE7F&quot;
];
this._energy = [&quot;EQ_ENERGYBANK_TYPE1&quot;, &quot;EQ_ENERGYBANK_TYPE2&quot;, &quot;EQ_ENERGYBANK_TYPE3&quot;, &quot;EQ_ENERGYBANK_TYPE4&quot;, &quot;EQ_ENERGYBANK_TYPE5&quot;, &quot;EQ_ENERGYBANK_TYPE6&quot;,
	&quot;EQ_ENERGYBANK_TYPE7&quot;, &quot;EQ_ENERGYBANK_TYPE8&quot;, &quot;EQ_ENERGYBANK_TYPE9&quot;, &quot;EQ_ENERGYBANK_TYPE10&quot;, &quot;EQ_ENERGYBANK_TYPE11&quot;, &quot;EQ_ENERGYBANK_TYPE12&quot;,
	&quot;EQ_ENERGYBANK_TYPE13&quot;, &quot;EQ_ENERGYBANK_TYPE14&quot;, &quot;EQ_ENERGYBANK_TYPE15&quot;, &quot;EQ_ENERGYBANK_TYPE16&quot;, &quot;EQ_ENERGYBANK_TYPE17&quot;, &quot;EQ_ENERGYBANK_TYPE18&quot;,
	&quot;EQ_ENERGYBANK_TYPE19&quot;, &quot;EQ_ENERGYBANK_TYPE20&quot;, &quot;EQ_ENERGYBANK_TYPE21&quot;, &quot;EQ_ENERGYBANK_TYPE22&quot;, &quot;EQ_ENERGYBANK_TYPE23&quot;, &quot;EQ_ENERGYBANK_TYPE24&quot;,
	&quot;EQ_ENERGYBANK_TYPE25&quot;,
	&quot;EQ_ENERGYBANK_TYPE1A&quot;, &quot;EQ_ENERGYBANK_TYPE2A&quot;, &quot;EQ_ENERGYBANK_TYPE3A&quot;, &quot;EQ_ENERGYBANK_TYPE4A&quot;, &quot;EQ_ENERGYBANK_TYPE5A&quot;, &quot;EQ_ENERGYBANK_TYPE6A&quot;,
	&quot;EQ_ENERGYBANK_TYPE7A&quot;, &quot;EQ_ENERGYBANK_TYPE8A&quot;, &quot;EQ_ENERGYBANK_TYPE9A&quot;, &quot;EQ_ENERGYBANK_TYPE10A&quot;, &quot;EQ_ENERGYBANK_TYPE11A&quot;, &quot;EQ_ENERGYBANK_TYPE12A&quot;,
	&quot;EQ_ENERGYBANK_TYPE13A&quot;, &quot;EQ_ENERGYBANK_TYPE14A&quot;, &quot;EQ_ENERGYBANK_TYPE15A&quot;, &quot;EQ_ENERGYBANK_TYPE16A&quot;, &quot;EQ_ENERGYBANK_TYPE17A&quot;, &quot;EQ_ENERGYBANK_TYPE18A&quot;,
	&quot;EQ_ENERGYBANK_TYPE19A&quot;, &quot;EQ_ENERGYBANK_TYPE20A&quot;, &quot;EQ_ENERGYBANK_TYPE21A&quot;, &quot;EQ_ENERGYBANK_TYPE22A&quot;, &quot;EQ_ENERGYBANK_TYPE23A&quot;, &quot;EQ_ENERGYBANK_TYPE24A&quot;,
	&quot;EQ_ENERGYBANK_TYPE25A&quot;
];
this._frontshields = [&quot;EQ_NO_FORWARD_SHIELD&quot;, &quot;EQ_FORWARD_SHIELD_TYPE1&quot;, &quot;EQ_FORWARD_SHIELD_TYPE2&quot;, &quot;EQ_FORWARD_SHIELD_TYPE3&quot;, &quot;EQ_FORWARD_SHIELD_TYPE4&quot;, &quot;EQ_FORWARD_SHIELD_TYPE5&quot;];
this._aftshields = [&quot;EQ_NO_AFT_SHIELD&quot;, &quot;EQ_AFT_SHIELD_TYPE1&quot;, &quot;EQ_AFT_SHIELD_TYPE2&quot;, &quot;EQ_AFT_SHIELD_TYPE3&quot;, &quot;EQ_AFT_SHIELD_TYPE4&quot;, &quot;EQ_AFT_SHIELD_TYPE5&quot;];
this._heatshields = [&quot;EQ_HEAT_SHIELD_TYPE1&quot;, &quot;EQ_HEAT_SHIELD_TYPE2&quot;, &quot;EQ_HEAT_SHIELD_TYPE3&quot;, &quot;EQ_HEAT_SHIELD_TYPE4&quot;, &quot;EQ_HEAT_SHIELD_TYPE5&quot;, &quot;EQ_HEAT_SHIELD_TYPE6&quot;];
this._fuelinjectors = [&quot;EQ_FUEL_INJECTION_TYPE1&quot;, &quot;EQ_FUEL_INJECTION_TYPE2&quot;, &quot;EQ_FUEL_INJECTION_TYPE3&quot;, &quot;EQ_FUEL_INJECTION_TYPE4&quot;];
this._fuelscoops = [&quot;EQ_FUEL_SCOOPS_TYPE1&quot;, &quot;EQ_FUEL_SCOOPS_TYPE2&quot;, &quot;EQ_FUEL_SCOOPS_TYPE3&quot;, &quot;EQ_FUEL_SCOOPS_TYPE4&quot;];
this._armour = [];
this._frontarmour = [&quot;EQ_ARMOUR_FORWARD_TYPE1&quot;, &quot;EQ_ARMOUR_FORWARD_TYPE2&quot;, &quot;EQ_ARMOUR_FORWARD_TYPE3&quot;, &quot;EQ_ARMOUR_FORWARD_TYPE4&quot;, &quot;EQ_ARMOUR_FORWARD_TYPE5&quot;,
	&quot;EQ_ARMOUR_FORWARD_TYPE6&quot;, &quot;EQ_ARMOUR_FORWARD_TYPE7&quot;
];
this._aftarmour = [&quot;EQ_ARMOUR_AFT_TYPE1&quot;, &quot;EQ_ARMOUR_AFT_TYPE2&quot;, &quot;EQ_ARMOUR_AFT_TYPE3&quot;, &quot;EQ_ARMOUR_AFT_TYPE4&quot;, &quot;EQ_ARMOUR_AFT_TYPE5&quot;, &quot;EQ_ARMOUR_AFT_TYPE6&quot;,
	&quot;EQ_ARMOUR_AFT_TYPE7&quot;
];
this._electricalbus = [&quot;EQ_ELEC_BUS_TYPE1&quot;, &quot;EQ_ELEC_BUS_TYPE2&quot;, &quot;EQ_ELEC_BUS_TYPE3&quot;, &quot;EQ_ELEC_BUS_TYPE4&quot;, &quot;EQ_ELEC_BUS_TYPE5&quot;, &quot;EQ_ELEC_BUS_TYPE6&quot;, &quot;EQ_ELEC_BUS_TYPE7&quot;];
this._hdCoupling = [&quot;EQ_HYPERDRIVE_COUPLING_TYPE1&quot;, &quot;EQ_HYPERDRIVE_COUPLING_TYPE2&quot;, &quot;EQ_HYPERDRIVE_COUPLING_TYPE3&quot;, &quot;EQ_HYPERDRIVE_COUPLING_TYPE4&quot;];
this._enCoupling = [&quot;EQ_ENGINE_COUPLING_TYPE1&quot;, &quot;EQ_ENGINE_COUPLING_TYPE2&quot;, &quot;EQ_ENGINE_COUPLING_TYPE3&quot;, &quot;EQ_ENGINE_COUPLING_TYPE4&quot;, &quot;EQ_ENGINE_COUPLING_TYPE5&quot;,
	&quot;EQ_ENGINE_COUPLING_TYPE6&quot;, &quot;EQ_ENGINE_COUPLING_TYPE7&quot;
];
this._bsCoupling = [&quot;EQ_BOOSTERS_COUPLING_TYPE1&quot;, &quot;EQ_BOOSTERS_COUPLING_TYPE2&quot;, &quot;EQ_BOOSTERS_COUPLING_TYPE3&quot;, &quot;EQ_BOOSTERS_COUPLING_TYPE4&quot;, &quot;EQ_BOOSTERS_COUPLING_TYPE5&quot;,
	&quot;EQ_BOOSTERS_COUPLING_TYPE6&quot;, &quot;EQ_BOOSTERS_COUPLING_TYPE7&quot;
];
this._ebCoupling = [&quot;EQ_ENERGYBANK_COUPLING_TYPE1&quot;, &quot;EQ_ENERGYBANK_COUPLING_TYPE2&quot;, &quot;EQ_ENERGYBANK_COUPLING_TYPE3&quot;, &quot;EQ_ENERGYBANK_COUPLING_TYPE4&quot;, &quot;EQ_ENERGYBANK_COUPLING_TYPE5&quot;,
	&quot;EQ_ENERGYBANK_COUPLING_TYPE6&quot;, &quot;EQ_ENERGYBANK_COUPLING_TYPE7&quot;, &quot;EQ_ENERGYBANK_COUPLING_TYPE8&quot;
];
this._thCoupling = [&quot;EQ_THRUSTERS_COUPLING_TYPE1&quot;, &quot;EQ_THRUSTERS_COUPLING_TYPE2&quot;, &quot;EQ_THRUSTERS_COUPLING_TYPE3&quot;, &quot;EQ_THRUSTERS_COUPLING_TYPE4&quot;, &quot;EQ_THRUSTERS_COUPLING_TYPE5&quot;,
	&quot;EQ_THRUSTERS_COUPLING_TYPE6&quot;, &quot;EQ_THRUSTERS_COUPLING_TYPE7&quot;
];
this._fsCoupling = [&quot;EQ_FORWARD_SHIELD_COUPLING_TYPE1&quot;, &quot;EQ_FORWARD_SHIELD_COUPLING_TYPE2&quot;, &quot;EQ_FORWARD_SHIELD_COUPLING_TYPE3&quot;, &quot;EQ_FORWARD_SHIELD_COUPLING_TYPE4&quot;,
	&quot;EQ_FORWARD_SHIELD_COUPLING_TYPE5&quot;
];
this._asCoupling = [&quot;EQ_AFT_SHIELD_COUPLING_TYPE1&quot;, &quot;EQ_AFT_SHIELD_COUPLING_TYPE2&quot;, &quot;EQ_AFT_SHIELD_COUPLING_TYPE3&quot;, &quot;EQ_AFT_SHIELD_COUPLING_TYPE4&quot;, &quot;EQ_AFT_SHIELD_COUPLING_TYPE5&quot;];
// these items will have a ship-size based price factor applied to their purchase price
this._priceFactor = [].concat(this._engines).concat(this._boosters).concat(this._hyperdrive).concat(this._thrusters)
	.concat(this._energy).concat(this._frontshields).concat(this._aftshields).concat(this._frontarmour).concat(this._aftarmour)
	.concat(this._electricalbus).concat(this._hdCoupling).concat(this._enCoupling).concat(this._bsCoupling).concat(this._ebCoupling)
	.concat(this._thCoupling).concat(this._fsCoupling).concat(this._asCoupling);

this._equipCouplingBus = {
	&quot;EQ_THRUSTERS_TYPE1&quot;: &quot;EQ_THRUSTERS_COUPLING_TYPE1&quot;,
	&quot;EQ_THRUSTERS_TYPE2A&quot;: &quot;EQ_THRUSTERS_COUPLING_TYPE2&quot;,
	&quot;EQ_THRUSTERS_TYPE2B&quot;: &quot;EQ_THRUSTERS_COUPLING_TYPE2&quot;,
	&quot;EQ_THRUSTERS_TYPE2C&quot;: &quot;EQ_THRUSTERS_COUPLING_TYPE2&quot;,
	&quot;EQ_THRUSTERS_TYPE2D&quot;: &quot;EQ_THRUSTERS_COUPLING_TYPE2&quot;,
	&quot;EQ_THRUSTERS_TYPE2E&quot;: &quot;EQ_THRUSTERS_COUPLING_TYPE2&quot;,
	&quot;EQ_THRUSTERS_TYPE2F&quot;: &quot;EQ_THRUSTERS_COUPLING_TYPE2&quot;,
	&quot;EQ_THRUSTERS_TYPE3A&quot;: &quot;EQ_THRUSTERS_COUPLING_TYPE3&quot;,
	&quot;EQ_THRUSTERS_TYPE3B&quot;: &quot;EQ_THRUSTERS_COUPLING_TYPE3&quot;,
	&quot;EQ_THRUSTERS_TYPE3C&quot;: &quot;EQ_THRUSTERS_COUPLING_TYPE3&quot;,
	&quot;EQ_THRUSTERS_TYPE3D&quot;: &quot;EQ_THRUSTERS_COUPLING_TYPE3&quot;,
	&quot;EQ_THRUSTERS_TYPE3E&quot;: &quot;EQ_THRUSTERS_COUPLING_TYPE3&quot;,
	&quot;EQ_THRUSTERS_TYPE3F&quot;: &quot;EQ_THRUSTERS_COUPLING_TYPE3&quot;,
	&quot;EQ_THRUSTERS_TYPE4A&quot;: &quot;EQ_THRUSTERS_COUPLING_TYPE4&quot;,
	&quot;EQ_THRUSTERS_TYPE4B&quot;: &quot;EQ_THRUSTERS_COUPLING_TYPE4&quot;,
	&quot;EQ_THRUSTERS_TYPE4C&quot;: &quot;EQ_THRUSTERS_COUPLING_TYPE4&quot;,
	&quot;EQ_THRUSTERS_TYPE4D&quot;: &quot;EQ_THRUSTERS_COUPLING_TYPE4&quot;,
	&quot;EQ_THRUSTERS_TYPE4E&quot;: &quot;EQ_THRUSTERS_COUPLING_TYPE4&quot;,
	&quot;EQ_THRUSTERS_TYPE4F&quot;: &quot;EQ_THRUSTERS_COUPLING_TYPE4&quot;,
	&quot;EQ_THRUSTERS_TYPE5A&quot;: &quot;EQ_THRUSTERS_COUPLING_TYPE5&quot;,
	&quot;EQ_THRUSTERS_TYPE5B&quot;: &quot;EQ_THRUSTERS_COUPLING_TYPE5&quot;,
	&quot;EQ_THRUSTERS_TYPE5C&quot;: &quot;EQ_THRUSTERS_COUPLING_TYPE5&quot;,
	&quot;EQ_THRUSTERS_TYPE5D&quot;: &quot;EQ_THRUSTERS_COUPLING_TYPE5&quot;,
	&quot;EQ_THRUSTERS_TYPE5E&quot;: &quot;EQ_THRUSTERS_COUPLING_TYPE5&quot;,
	&quot;EQ_THRUSTERS_TYPE5F&quot;: &quot;EQ_THRUSTERS_COUPLING_TYPE5&quot;,
	&quot;EQ_THRUSTERS_TYPE6A&quot;: &quot;EQ_THRUSTERS_COUPLING_TYPE6&quot;,
	&quot;EQ_THRUSTERS_TYPE6B&quot;: &quot;EQ_THRUSTERS_COUPLING_TYPE6&quot;,
	&quot;EQ_THRUSTERS_TYPE6C&quot;: &quot;EQ_THRUSTERS_COUPLING_TYPE6&quot;,
	&quot;EQ_THRUSTERS_TYPE6D&quot;: &quot;EQ_THRUSTERS_COUPLING_TYPE6&quot;,
	&quot;EQ_THRUSTERS_TYPE6E&quot;: &quot;EQ_THRUSTERS_COUPLING_TYPE6&quot;,
	&quot;EQ_THRUSTERS_TYPE6F&quot;: &quot;EQ_THRUSTERS_COUPLING_TYPE6&quot;,
	&quot;EQ_THRUSTERS_TYPE7A&quot;: &quot;EQ_THRUSTERS_COUPLING_TYPE7&quot;,
	&quot;EQ_THRUSTERS_TYPE7B&quot;: &quot;EQ_THRUSTERS_COUPLING_TYPE7&quot;,
	&quot;EQ_THRUSTERS_TYPE7C&quot;: &quot;EQ_THRUSTERS_COUPLING_TYPE7&quot;,
	&quot;EQ_THRUSTERS_TYPE7D&quot;: &quot;EQ_THRUSTERS_COUPLING_TYPE7&quot;,
	&quot;EQ_THRUSTERS_TYPE7E&quot;: &quot;EQ_THRUSTERS_COUPLING_TYPE7&quot;,
	&quot;EQ_THRUSTERS_TYPE7F&quot;: &quot;EQ_THRUSTERS_COUPLING_TYPE7&quot;,
	&quot;EQ_ENERGYBANK_TYPE1&quot;: &quot;EQ_ENERGYBANK_COUPLING_TYPE1&quot;,
	&quot;EQ_ENERGYBANK_TYPE2&quot;: &quot;EQ_ENERGYBANK_COUPLING_TYPE1&quot;,
	&quot;EQ_ENERGYBANK_TYPE3&quot;: &quot;EQ_ENERGYBANK_COUPLING_TYPE1&quot;,
	&quot;EQ_ENERGYBANK_TYPE4&quot;: &quot;EQ_ENERGYBANK_COUPLING_TYPE1&quot;,
	&quot;EQ_ENERGYBANK_TYPE5&quot;: &quot;EQ_ENERGYBANK_COUPLING_TYPE2&quot;,
	&quot;EQ_ENERGYBANK_TYPE6&quot;: &quot;EQ_ENERGYBANK_COUPLING_TYPE2&quot;,
	&quot;EQ_ENERGYBANK_TYPE7&quot;: &quot;EQ_ENERGYBANK_COUPLING_TYPE2&quot;,
	&quot;EQ_ENERGYBANK_TYPE8&quot;: &quot;EQ_ENERGYBANK_COUPLING_TYPE3&quot;,
	&quot;EQ_ENERGYBANK_TYPE9&quot;: &quot;EQ_ENERGYBANK_COUPLING_TYPE3&quot;,
	&quot;EQ_ENERGYBANK_TYPE10&quot;: &quot;EQ_ENERGYBANK_COUPLING_TYPE3&quot;,
	&quot;EQ_ENERGYBANK_TYPE11&quot;: &quot;EQ_ENERGYBANK_COUPLING_TYPE4&quot;,
	&quot;EQ_ENERGYBANK_TYPE12&quot;: &quot;EQ_ENERGYBANK_COUPLING_TYPE4&quot;,
	&quot;EQ_ENERGYBANK_TYPE13&quot;: &quot;EQ_ENERGYBANK_COUPLING_TYPE4&quot;,
	&quot;EQ_ENERGYBANK_TYPE14&quot;: &quot;EQ_ENERGYBANK_COUPLING_TYPE5&quot;,
	&quot;EQ_ENERGYBANK_TYPE15&quot;: &quot;EQ_ENERGYBANK_COUPLING_TYPE5&quot;,
	&quot;EQ_ENERGYBANK_TYPE16&quot;: &quot;EQ_ENERGYBANK_COUPLING_TYPE5&quot;,
	&quot;EQ_ENERGYBANK_TYPE17&quot;: &quot;EQ_ENERGYBANK_COUPLING_TYPE6&quot;,
	&quot;EQ_ENERGYBANK_TYPE18&quot;: &quot;EQ_ENERGYBANK_COUPLING_TYPE6&quot;,
	&quot;EQ_ENERGYBANK_TYPE19&quot;: &quot;EQ_ENERGYBANK_COUPLING_TYPE6&quot;,
	&quot;EQ_ENERGYBANK_TYPE20&quot;: &quot;EQ_ENERGYBANK_COUPLING_TYPE7&quot;,
	&quot;EQ_ENERGYBANK_TYPE21&quot;: &quot;EQ_ENERGYBANK_COUPLING_TYPE7&quot;,
	&quot;EQ_ENERGYBANK_TYPE22&quot;: &quot;EQ_ENERGYBANK_COUPLING_TYPE7&quot;,
	&quot;EQ_ENERGYBANK_TYPE23&quot;: &quot;EQ_ENERGYBANK_COUPLING_TYPE8&quot;,
	&quot;EQ_ENERGYBANK_TYPE24&quot;: &quot;EQ_ENERGYBANK_COUPLING_TYPE8&quot;,
	&quot;EQ_ENERGYBANK_TYPE25&quot;: &quot;EQ_ENERGYBANK_COUPLING_TYPE8&quot;,
	&quot;EQ_ENERGYBANK_TYPE1A&quot;: &quot;EQ_ENERGYBANK_COUPLING_TYPE1&quot;,
	&quot;EQ_ENERGYBANK_TYPE2A&quot;: &quot;EQ_ENERGYBANK_COUPLING_TYPE1&quot;,
	&quot;EQ_ENERGYBANK_TYPE3A&quot;: &quot;EQ_ENERGYBANK_COUPLING_TYPE1&quot;,
	&quot;EQ_ENERGYBANK_TYPE4A&quot;: &quot;EQ_ENERGYBANK_COUPLING_TYPE1&quot;,
	&quot;EQ_ENERGYBANK_TYPE5A&quot;: &quot;EQ_ENERGYBANK_COUPLING_TYPE2&quot;,
	&quot;EQ_ENERGYBANK_TYPE6A&quot;: &quot;EQ_ENERGYBANK_COUPLING_TYPE2&quot;,
	&quot;EQ_ENERGYBANK_TYPE7A&quot;: &quot;EQ_ENERGYBANK_COUPLING_TYPE2&quot;,
	&quot;EQ_ENERGYBANK_TYPE8A&quot;: &quot;EQ_ENERGYBANK_COUPLING_TYPE3&quot;,
	&quot;EQ_ENERGYBANK_TYPE9A&quot;: &quot;EQ_ENERGYBANK_COUPLING_TYPE3&quot;,
	&quot;EQ_ENERGYBANK_TYPE10A&quot;: &quot;EQ_ENERGYBANK_COUPLING_TYPE3&quot;,
	&quot;EQ_ENERGYBANK_TYPE11A&quot;: &quot;EQ_ENERGYBANK_COUPLING_TYPE4&quot;,
	&quot;EQ_ENERGYBANK_TYPE12A&quot;: &quot;EQ_ENERGYBANK_COUPLING_TYPE4&quot;,
	&quot;EQ_ENERGYBANK_TYPE13A&quot;: &quot;EQ_ENERGYBANK_COUPLING_TYPE4&quot;,
	&quot;EQ_ENERGYBANK_TYPE14A&quot;: &quot;EQ_ENERGYBANK_COUPLING_TYPE5&quot;,
	&quot;EQ_ENERGYBANK_TYPE15A&quot;: &quot;EQ_ENERGYBANK_COUPLING_TYPE5&quot;,
	&quot;EQ_ENERGYBANK_TYPE16A&quot;: &quot;EQ_ENERGYBANK_COUPLING_TYPE5&quot;,
	&quot;EQ_ENERGYBANK_TYPE17A&quot;: &quot;EQ_ENERGYBANK_COUPLING_TYPE6&quot;,
	&quot;EQ_ENERGYBANK_TYPE18A&quot;: &quot;EQ_ENERGYBANK_COUPLING_TYPE6&quot;,
	&quot;EQ_ENERGYBANK_TYPE19A&quot;: &quot;EQ_ENERGYBANK_COUPLING_TYPE6&quot;,
	&quot;EQ_ENERGYBANK_TYPE20A&quot;: &quot;EQ_ENERGYBANK_COUPLING_TYPE7&quot;,
	&quot;EQ_ENERGYBANK_TYPE21A&quot;: &quot;EQ_ENERGYBANK_COUPLING_TYPE7&quot;,
	&quot;EQ_ENERGYBANK_TYPE22A&quot;: &quot;EQ_ENERGYBANK_COUPLING_TYPE7&quot;,
	&quot;EQ_ENERGYBANK_TYPE23A&quot;: &quot;EQ_ENERGYBANK_COUPLING_TYPE8&quot;,
	&quot;EQ_ENERGYBANK_TYPE24A&quot;: &quot;EQ_ENERGYBANK_COUPLING_TYPE8&quot;,
	&quot;EQ_ENERGYBANK_TYPE25A&quot;: &quot;EQ_ENERGYBANK_COUPLING_TYPE8&quot;,
};
this._extensions = [&quot;EQ_EXTENSION_1&quot;, &quot;EQ_EXTENSION_2&quot;, &quot;EQ_EXTENSION_5&quot;];
this._equipHeatList = {
	&quot;EQ_ENERGYBANK_TYPE1A&quot;: 0.004,
	&quot;EQ_ENERGYBANK_TYPE2A&quot;: 0.008,
	&quot;EQ_ENERGYBANK_TYPE3A&quot;: 0.012,
	&quot;EQ_ENERGYBANK_TYPE4A&quot;: 0.016,
	&quot;EQ_ENERGYBANK_TYPE5A&quot;: 0.02,
	&quot;EQ_ENERGYBANK_TYPE6A&quot;: 0.024,
	&quot;EQ_ENERGYBANK_TYPE7A&quot;: 0.028,
	&quot;EQ_ENERGYBANK_TYPE8A&quot;: 0.032,
	&quot;EQ_ENERGYBANK_TYPE9A&quot;: 0.036,
	&quot;EQ_ENERGYBANK_TYPE10A&quot;: 0.04,
	&quot;EQ_ENERGYBANK_TYPE11A&quot;: 0.044,
	&quot;EQ_ENERGYBANK_TYPE12A&quot;: 0.048,
	&quot;EQ_ENERGYBANK_TYPE13A&quot;: 0.052,
	&quot;EQ_ENERGYBANK_TYPE14A&quot;: 0.056,
	&quot;EQ_ENERGYBANK_TYPE15A&quot;: 0.06,
	&quot;EQ_ENERGYBANK_TYPE16A&quot;: 0.064,
	&quot;EQ_ENERGYBANK_TYPE17A&quot;: 0.068,
	&quot;EQ_ENERGYBANK_TYPE18A&quot;: 0.072,
	&quot;EQ_ENERGYBANK_TYPE19A&quot;: 0.076,
	&quot;EQ_ENERGYBANK_TYPE20A&quot;: 0.08,
	&quot;EQ_ENERGYBANK_TYPE21A&quot;: 0.084,
	&quot;EQ_ENERGYBANK_TYPE22A&quot;: 0.088,
	&quot;EQ_ENERGYBANK_TYPE23A&quot;: 0.092,
	&quot;EQ_ENERGYBANK_TYPE24A&quot;: 0.096,
	&quot;EQ_ENERGYBANK_TYPE25A&quot;: 0.1,
	&quot;EQ_ENGINE_TYPE1D&quot;: 0.02,
	&quot;EQ_ENGINE_TYPE1E&quot;: 0.02,
	&quot;EQ_ENGINE_TYPE1F&quot;: 0.02,
	&quot;EQ_ENGINE_TYPE2D&quot;: 0.04,
	&quot;EQ_ENGINE_TYPE2E&quot;: 0.04,
	&quot;EQ_ENGINE_TYPE2F&quot;: 0.04,
	&quot;EQ_ENGINE_TYPE3D&quot;: 0.06,
	&quot;EQ_ENGINE_TYPE3E&quot;: 0.06,
	&quot;EQ_ENGINE_TYPE3F&quot;: 0.06,
	&quot;EQ_ENGINE_TYPE4D&quot;: 0.08,
	&quot;EQ_ENGINE_TYPE4E&quot;: 0.08,
	&quot;EQ_ENGINE_TYPE4F&quot;: 0.08,
	&quot;EQ_ENGINE_TYPE5D&quot;: 0.1,
	&quot;EQ_ENGINE_TYPE5E&quot;: 0.1,
	&quot;EQ_ENGINE_TYPE5F&quot;: 0.1,
	&quot;EQ_ENGINE_TYPE6D&quot;: 0.12,
	&quot;EQ_ENGINE_TYPE6E&quot;: 0.12,
	&quot;EQ_ENGINE_TYPE6F&quot;: 0.12,
	&quot;EQ_ENGINE_TYPE7D&quot;: 0.14,
	&quot;EQ_ENGINE_TYPE7E&quot;: 0.14,
	&quot;EQ_ENGINE_TYPE7F&quot;: 0.14,
	&quot;EQ_THRUSTERS_TYPE2D&quot;: 0.0266,
	&quot;EQ_THRUSTERS_TYPE2E&quot;: 0.0266,
	&quot;EQ_THRUSTERS_TYPE2F&quot;: 0.0266,
	&quot;EQ_THRUSTERS_TYPE3D&quot;: 0.04,
	&quot;EQ_THRUSTERS_TYPE3E&quot;: 0.04,
	&quot;EQ_THRUSTERS_TYPE3F&quot;: 0.04,
	&quot;EQ_THRUSTERS_TYPE4D&quot;: 0.0533,
	&quot;EQ_THRUSTERS_TYPE4E&quot;: 0.0533,
	&quot;EQ_THRUSTERS_TYPE4F&quot;: 0.0533,
	&quot;EQ_THRUSTERS_TYPE5D&quot;: 0.0666,
	&quot;EQ_THRUSTERS_TYPE5E&quot;: 0.0666,
	&quot;EQ_THRUSTERS_TYPE5F&quot;: 0.0666,
	&quot;EQ_THRUSTERS_TYPE6D&quot;: 0.08,
	&quot;EQ_THRUSTERS_TYPE6E&quot;: 0.08,
	&quot;EQ_THRUSTERS_TYPE6F&quot;: 0.08,
	&quot;EQ_THRUSTERS_TYPE7D&quot;: 0.0933,
	&quot;EQ_THRUSTERS_TYPE7E&quot;: 0.0933,
	&quot;EQ_THRUSTERS_TYPE7F&quot;: 0.0933,
};

// this items will be suppressed on the &quot;Sell Equipment&quot; screen
this._noSell = [&quot;EQ_BREAKABLE_TORUSDRIVE&quot;, &quot;EQ_BREAKABLE_HUD_IFF_SCANNER&quot;];
// array of rare equipment items that will require negotiation if they are sold
this._sellNegotiate = [];

// if any of these are installed, ship config won&#39;t allow its own armour to be installed
this._altArmour = [&quot;EQ_IRONHIDE&quot;, &quot;EQ_HARDNOSE&quot;, &quot;EQ_VERYHARDNOSE&quot;, &quot;EQ_VERYVERYHARDNOSE&quot;, &quot;EQ_HARDARMOUR_III&quot;, &quot;EQ_HARDARMOUR_V&quot;, &quot;EQ_HARDARMOUR_X&quot;];

this._shieldEquipment = [&quot;EQ_SHIELD_BOOSTER&quot;, &quot;EQ_NAVAL_SHIELD_BOOSTER&quot;, &quot;EQ_NAVAL_GRID&quot;, &quot;EQ_ENERGY_GRID&quot;];

// matrix consists of: equipment key, then space required (t), weight of item (t)
// eg: &quot;EQ_EQUIPMENTITEM&quot;:[space,weight]
// items not on this list (and not in ignore list) will default to 1t space, 1t weight
this._equipmentMatrix = {
	&quot;EQ_MISSILE&quot;: [0, 0.1],
	&quot;EQ_HARDENED_MISSILE&quot;: [0, 0.3],
	&quot;EQ_QC_MINE&quot;: [0, 0.2],
	&quot;EQ_WEAPON_PULSE_LASER&quot;: [0, 1],
	&quot;EQ_WEAPON_BEAM_LASER&quot;: [0, 2],
	&quot;EQ_WEAPON_MINING_LASER&quot;: [0, 1.5],
	&quot;EQ_WEAPON_MILITARY_LASER&quot;: [0, 3],
	&quot;EQ_PASSENGER_BERTH&quot;: [0, 5],
	&quot;EQ_CARGO_BAY&quot;: [0, 5],
	&quot;EQ_ECM&quot;: [1, 1],
	&quot;EQ_FUEL_SCOOPS&quot;: [0, 0],
	&quot;EQ_ESCAPE_POD&quot;: [0, 1],
	&quot;EQ_ENERGY_UNIT&quot;: [3, 3],
	&quot;EQ_NAVAL_ENERGY_UNIT&quot;: [5, 5],
	&quot;EQ_DOCK_COMP&quot;: [1, 1],
	&quot;EQ_GAL_DRIVE&quot;: [1, 1],
	&quot;EQ_CLOAKING_DEVICE&quot;: [1, 1],
	&quot;EQ_ADVANCED_COMPASS&quot;: [1, 1],
	&quot;EQ_WORMHOLE_SCANNER&quot;: [1, 1],
	&quot;EQ_SHIELD_BOOSTER&quot;: [4, 4],
	&quot;EQ_NAVAL_SHIELD_BOOSTER&quot;: [6, 6],
	&quot;EQ_MILITARY_SCANNER_FILTER&quot;: [4, 4],
	&quot;EQ_MILITARY_JAMMER&quot;: [4, 4],

	&quot;EQ_HYPERDRIVE_TYPE1&quot;: [1, 1],
	&quot;EQ_HYPERDRIVE_TYPE2&quot;: [2, 2],
	&quot;EQ_HYPERDRIVE_TYPE3&quot;: [5, 5],
	&quot;EQ_HYPERDRIVE_TYPE4&quot;: [8, 8],
	&quot;EQ_ENGINE_TYPE1A&quot;: [1, 1],
	&quot;EQ_ENGINE_TYPE1B&quot;: [1, 1],
	&quot;EQ_ENGINE_TYPE1C&quot;: [1, 1],
	&quot;EQ_ENGINE_TYPE1D&quot;: [0.5, 1],
	&quot;EQ_ENGINE_TYPE1E&quot;: [0.5, 1],
	&quot;EQ_ENGINE_TYPE1F&quot;: [0.5, 1],
	&quot;EQ_ENGINE_TYPE2A&quot;: [2, 2],
	&quot;EQ_ENGINE_TYPE2B&quot;: [2, 2],
	&quot;EQ_ENGINE_TYPE2C&quot;: [2, 2],
	&quot;EQ_ENGINE_TYPE2D&quot;: [1, 1.5],
	&quot;EQ_ENGINE_TYPE2E&quot;: [1, 1.5],
	&quot;EQ_ENGINE_TYPE2F&quot;: [1, 1.5],
	&quot;EQ_ENGINE_TYPE3A&quot;: [3, 3],
	&quot;EQ_ENGINE_TYPE3B&quot;: [3, 3],
	&quot;EQ_ENGINE_TYPE3C&quot;: [3, 3],
	&quot;EQ_ENGINE_TYPE3D&quot;: [1.5, 2],
	&quot;EQ_ENGINE_TYPE3E&quot;: [1.5, 2],
	&quot;EQ_ENGINE_TYPE3F&quot;: [1.5, 2],
	&quot;EQ_ENGINE_TYPE4A&quot;: [4, 3.5],
	&quot;EQ_ENGINE_TYPE4B&quot;: [4, 3.5],
	&quot;EQ_ENGINE_TYPE4C&quot;: [4, 3.5],
	&quot;EQ_ENGINE_TYPE4D&quot;: [2, 3],
	&quot;EQ_ENGINE_TYPE4E&quot;: [2, 3],
	&quot;EQ_ENGINE_TYPE4F&quot;: [2, 3],
	&quot;EQ_ENGINE_TYPE5A&quot;: [6, 4],
	&quot;EQ_ENGINE_TYPE5B&quot;: [6, 4],
	&quot;EQ_ENGINE_TYPE5C&quot;: [6, 4],
	&quot;EQ_ENGINE_TYPE5D&quot;: [3, 3.5],
	&quot;EQ_ENGINE_TYPE5E&quot;: [3, 3.5],
	&quot;EQ_ENGINE_TYPE5F&quot;: [3, 3.5],
	&quot;EQ_ENGINE_TYPE6A&quot;: [8, 5],
	&quot;EQ_ENGINE_TYPE6B&quot;: [8, 5],
	&quot;EQ_ENGINE_TYPE6C&quot;: [8, 5],
	&quot;EQ_ENGINE_TYPE6D&quot;: [4, 4],
	&quot;EQ_ENGINE_TYPE6E&quot;: [4, 4],
	&quot;EQ_ENGINE_TYPE6F&quot;: [4, 4],
	&quot;EQ_ENGINE_TYPE7A&quot;: [10, 6],
	&quot;EQ_ENGINE_TYPE7B&quot;: [10, 6],
	&quot;EQ_ENGINE_TYPE7C&quot;: [10, 6],
	&quot;EQ_ENGINE_TYPE7D&quot;: [5, 5],
	&quot;EQ_ENGINE_TYPE7E&quot;: [5, 5],
	&quot;EQ_ENGINE_TYPE7F&quot;: [5, 5],
	&quot;EQ_THRUSTERS_TYPE1&quot;: [0, 1],
	&quot;EQ_THRUSTERS_TYPE2A&quot;: [1, 2],
	&quot;EQ_THRUSTERS_TYPE2B&quot;: [1, 2],
	&quot;EQ_THRUSTERS_TYPE2C&quot;: [1, 2],
	&quot;EQ_THRUSTERS_TYPE2D&quot;: [0.5, 1],
	&quot;EQ_THRUSTERS_TYPE2E&quot;: [0.5, 1],
	&quot;EQ_THRUSTERS_TYPE2F&quot;: [0.5, 1],
	&quot;EQ_THRUSTERS_TYPE3A&quot;: [2, 3],
	&quot;EQ_THRUSTERS_TYPE3B&quot;: [2, 3],
	&quot;EQ_THRUSTERS_TYPE3C&quot;: [2, 3],
	&quot;EQ_THRUSTERS_TYPE3D&quot;: [1, 2],
	&quot;EQ_THRUSTERS_TYPE3E&quot;: [1, 2],
	&quot;EQ_THRUSTERS_TYPE3F&quot;: [1, 2],
	&quot;EQ_THRUSTERS_TYPE4A&quot;: [3, 3.5],
	&quot;EQ_THRUSTERS_TYPE4B&quot;: [3, 3.5],
	&quot;EQ_THRUSTERS_TYPE4C&quot;: [3, 3.5],
	&quot;EQ_THRUSTERS_TYPE4D&quot;: [1.5, 2.5],
	&quot;EQ_THRUSTERS_TYPE4E&quot;: [1.5, 2.5],
	&quot;EQ_THRUSTERS_TYPE4F&quot;: [1.5, 2.5],
	&quot;EQ_THRUSTERS_TYPE5A&quot;: [4, 4],
	&quot;EQ_THRUSTERS_TYPE5B&quot;: [4, 4],
	&quot;EQ_THRUSTERS_TYPE5C&quot;: [4, 4],
	&quot;EQ_THRUSTERS_TYPE5D&quot;: [2, 3],
	&quot;EQ_THRUSTERS_TYPE5E&quot;: [2, 3],
	&quot;EQ_THRUSTERS_TYPE5F&quot;: [2, 3],
	&quot;EQ_THRUSTERS_TYPE6A&quot;: [6, 4.5],
	&quot;EQ_THRUSTERS_TYPE6B&quot;: [6, 4.5],
	&quot;EQ_THRUSTERS_TYPE6C&quot;: [6, 4.5],
	&quot;EQ_THRUSTERS_TYPE6D&quot;: [3, 3.5],
	&quot;EQ_THRUSTERS_TYPE6E&quot;: [3, 3.5],
	&quot;EQ_THRUSTERS_TYPE6F&quot;: [3, 3.5],
	&quot;EQ_THRUSTERS_TYPE7A&quot;: [8, 5],
	&quot;EQ_THRUSTERS_TYPE7B&quot;: [8, 5],
	&quot;EQ_THRUSTERS_TYPE7C&quot;: [8, 5],
	&quot;EQ_THRUSTERS_TYPE7D&quot;: [4, 4],
	&quot;EQ_THRUSTERS_TYPE7E&quot;: [4, 4],
	&quot;EQ_THRUSTERS_TYPE7F&quot;: [4, 4],
	&quot;EQ_BOOSTERS_TYPE1&quot;: [1, 1],
	&quot;EQ_BOOSTERS_TYPE2&quot;: [1.5, 1.5],
	&quot;EQ_BOOSTERS_TYPE3&quot;: [2, 2],
	&quot;EQ_BOOSTERS_TYPE4&quot;: [2.5, 2.5],
	&quot;EQ_BOOSTERS_TYPE5&quot;: [3, 3],
	&quot;EQ_BOOSTERS_TYPE6&quot;: [3.5, 3.5],
	&quot;EQ_BOOSTERS_TYPE7&quot;: [4, 4],
	&quot;EQ_ENERGYBANK_TYPE1&quot;: [1, 1],
	&quot;EQ_ENERGYBANK_TYPE2&quot;: [2, 2],
	&quot;EQ_ENERGYBANK_TYPE3&quot;: [3, 3],
	&quot;EQ_ENERGYBANK_TYPE4&quot;: [4, 4],
	&quot;EQ_ENERGYBANK_TYPE5&quot;: [5, 5],
	&quot;EQ_ENERGYBANK_TYPE6&quot;: [6, 6],
	&quot;EQ_ENERGYBANK_TYPE7&quot;: [7, 7],
	&quot;EQ_ENERGYBANK_TYPE8&quot;: [8, 8],
	&quot;EQ_ENERGYBANK_TYPE9&quot;: [9, 9],
	&quot;EQ_ENERGYBANK_TYPE10&quot;: [10, 10],
	&quot;EQ_ENERGYBANK_TYPE11&quot;: [11, 11],
	&quot;EQ_ENERGYBANK_TYPE12&quot;: [12, 12],
	&quot;EQ_ENERGYBANK_TYPE13&quot;: [13, 13],
	&quot;EQ_ENERGYBANK_TYPE14&quot;: [14, 14],
	&quot;EQ_ENERGYBANK_TYPE15&quot;: [15, 15],
	&quot;EQ_ENERGYBANK_TYPE16&quot;: [16, 16],
	&quot;EQ_ENERGYBANK_TYPE17&quot;: [17, 17],
	&quot;EQ_ENERGYBANK_TYPE18&quot;: [18, 18],
	&quot;EQ_ENERGYBANK_TYPE19&quot;: [19, 19],
	&quot;EQ_ENERGYBANK_TYPE20&quot;: [20, 20],
	&quot;EQ_ENERGYBANK_TYPE21&quot;: [21, 21],
	&quot;EQ_ENERGYBANK_TYPE22&quot;: [22, 22],
	&quot;EQ_ENERGYBANK_TYPE23&quot;: [23, 23],
	&quot;EQ_ENERGYBANK_TYPE24&quot;: [24, 24],
	&quot;EQ_ENERGYBANK_TYPE25&quot;: [25, 25],
	&quot;EQ_ENERGYBANK_TYPE1A&quot;: [0.5, 1],
	&quot;EQ_ENERGYBANK_TYPE2A&quot;: [1, 2],
	&quot;EQ_ENERGYBANK_TYPE3A&quot;: [1.5, 3],
	&quot;EQ_ENERGYBANK_TYPE4A&quot;: [2, 4],
	&quot;EQ_ENERGYBANK_TYPE5A&quot;: [2.5, 5],
	&quot;EQ_ENERGYBANK_TYPE6A&quot;: [3, 6],
	&quot;EQ_ENERGYBANK_TYPE7A&quot;: [3.5, 7],
	&quot;EQ_ENERGYBANK_TYPE8A&quot;: [4, 8],
	&quot;EQ_ENERGYBANK_TYPE9A&quot;: [4.5, 9],
	&quot;EQ_ENERGYBANK_TYPE10A&quot;: [5, 10],
	&quot;EQ_ENERGYBANK_TYPE11A&quot;: [5.5, 11],
	&quot;EQ_ENERGYBANK_TYPE12A&quot;: [6, 12],
	&quot;EQ_ENERGYBANK_TYPE13A&quot;: [6.5, 13],
	&quot;EQ_ENERGYBANK_TYPE14A&quot;: [7, 14],
	&quot;EQ_ENERGYBANK_TYPE15A&quot;: [7.5, 15],
	&quot;EQ_ENERGYBANK_TYPE16A&quot;: [8, 16],
	&quot;EQ_ENERGYBANK_TYPE17A&quot;: [8.5, 17],
	&quot;EQ_ENERGYBANK_TYPE18A&quot;: [9, 18],
	&quot;EQ_ENERGYBANK_TYPE19A&quot;: [9.5, 19],
	&quot;EQ_ENERGYBANK_TYPE20A&quot;: [10, 20],
	&quot;EQ_ENERGYBANK_TYPE21A&quot;: [10.5, 21],
	&quot;EQ_ENERGYBANK_TYPE22A&quot;: [11, 22],
	&quot;EQ_ENERGYBANK_TYPE23A&quot;: [11.5, 23],
	&quot;EQ_ENERGYBANK_TYPE24A&quot;: [12, 24],
	&quot;EQ_ENERGYBANK_TYPE25A&quot;: [12.5, 25],
	&quot;EQ_NO_FORWARD_SHIELD&quot;: [0, 0],
	&quot;EQ_FORWARD_SHIELD_TYPE1&quot;: [1, 1],
	&quot;EQ_FORWARD_SHIELD_TYPE2&quot;: [2, 2],
	&quot;EQ_FORWARD_SHIELD_TYPE3&quot;: [3, 3],
	&quot;EQ_FORWARD_SHIELD_TYPE4&quot;: [4, 4],
	&quot;EQ_FORWARD_SHIELD_TYPE5&quot;: [5, 5],
	&quot;EQ_NO_AFT_SHIELD&quot;: [0, 0],
	&quot;EQ_AFT_SHIELD_TYPE1&quot;: [1, 1],
	&quot;EQ_AFT_SHIELD_TYPE2&quot;: [2, 2],
	&quot;EQ_AFT_SHIELD_TYPE3&quot;: [3, 3],
	&quot;EQ_AFT_SHIELD_TYPE4&quot;: [4, 4],
	&quot;EQ_AFT_SHIELD_TYPE5&quot;: [5, 5],
	&quot;EQ_HEAT_SHIELD_TYPE1&quot;: [0, 1],
	&quot;EQ_HEAT_SHIELD_TYPE2&quot;: [0, 3],
	&quot;EQ_HEAT_SHIELD_TYPE3&quot;: [0, 6],
	&quot;EQ_HEAT_SHIELD_TYPE4&quot;: [0, 9],
	&quot;EQ_HEAT_SHIELD_TYPE5&quot;: [0, 12],
	&quot;EQ_HEAT_SHIELD_TYPE6&quot;: [0, 16],
	&quot;EQ_FUEL_INJECTION_TYPE1&quot;: [0.5, 1],
	&quot;EQ_FUEL_INJECTION_TYPE2&quot;: [1, 2],
	&quot;EQ_FUEL_INJECTION_TYPE3&quot;: [2, 3],
	&quot;EQ_FUEL_INJECTION_TYPE4&quot;: [4, 5],
	&quot;EQ_FUEL_SCOOPS_TYPE1&quot;: [0, 2],
	&quot;EQ_FUEL_SCOOPS_TYPE2&quot;: [0, 4],
	&quot;EQ_FUEL_SCOOPS_TYPE3&quot;: [0, 6],
	&quot;EQ_FUEL_SCOOPS_TYPE4&quot;: [0, 8],
	&quot;EQ_ARMOUR_TYPE1&quot;: [0, 0], // obsolete
	&quot;EQ_ARMOUR_TYPE2&quot;: [0, 0], // obsolete
	&quot;EQ_ARMOUR_TYPE3&quot;: [0, 0], // obsolete
	&quot;EQ_ARMOUR_TYPE4&quot;: [0, 0], // obsolete
	&quot;EQ_ARMOUR_TYPE5&quot;: [0, 0], // obsolete
	&quot;EQ_ARMOUR_TYPE6&quot;: [0, 0], // obsolete
	&quot;EQ_ARMOUR_TYPE7&quot;: [0, 0], // obsolete
	&quot;EQ_ARMOUR_FORWARD_TYPE1&quot;: [0, 2],
	&quot;EQ_ARMOUR_FORWARD_TYPE2&quot;: [0, 7],
	&quot;EQ_ARMOUR_FORWARD_TYPE3&quot;: [0, 15],
	&quot;EQ_ARMOUR_FORWARD_TYPE4&quot;: [0, 25],
	&quot;EQ_ARMOUR_FORWARD_TYPE5&quot;: [0, 40],
	&quot;EQ_ARMOUR_FORWARD_TYPE6&quot;: [0, 52],
	&quot;EQ_ARMOUR_FORWARD_TYPE7&quot;: [0, 70],
	&quot;EQ_ARMOUR_AFT_TYPE1&quot;: [0, 2],
	&quot;EQ_ARMOUR_AFT_TYPE2&quot;: [0, 7],
	&quot;EQ_ARMOUR_AFT_TYPE3&quot;: [0, 15],
	&quot;EQ_ARMOUR_AFT_TYPE4&quot;: [0, 25],
	&quot;EQ_ARMOUR_AFT_TYPE5&quot;: [0, 40],
	&quot;EQ_ARMOUR_AFT_TYPE6&quot;: [0, 52],
	&quot;EQ_ARMOUR_AFT_TYPE7&quot;: [0, 70],
	&quot;EQ_ELEC_BUS_TYPE1&quot;: [0, 1],
	&quot;EQ_ELEC_BUS_TYPE2&quot;: [0, 4],
	&quot;EQ_ELEC_BUS_TYPE3&quot;: [2, 7],
	&quot;EQ_ELEC_BUS_TYPE4&quot;: [4, 12],
	&quot;EQ_ELEC_BUS_TYPE5&quot;: [6, 17],
	&quot;EQ_ELEC_BUS_TYPE6&quot;: [8, 23],
	&quot;EQ_ELEC_BUS_TYPE7&quot;: [10, 30],
	&quot;EQ_HYPERDRIVE_COUPLING_TYPE1&quot;: [0, 0.1],
	&quot;EQ_HYPERDRIVE_COUPLING_TYPE2&quot;: [0, 0.2],
	&quot;EQ_HYPERDRIVE_COUPLING_TYPE3&quot;: [0, 0.3],
	&quot;EQ_HYPERDRIVE_COUPLING_TYPE4&quot;: [0, 0.4],
	&quot;EQ_ENGINE_COUPLING_TYPE1&quot;: [0, 0.1],
	&quot;EQ_ENGINE_COUPLING_TYPE2&quot;: [0, 0.2],
	&quot;EQ_ENGINE_COUPLING_TYPE3&quot;: [0, 0.3],
	&quot;EQ_ENGINE_COUPLING_TYPE4&quot;: [0, 0.4],
	&quot;EQ_ENGINE_COUPLING_TYPE5&quot;: [0, 0.5],
	&quot;EQ_ENGINE_COUPLING_TYPE6&quot;: [0, 0.6],
	&quot;EQ_ENGINE_COUPLING_TYPE7&quot;: [0, 0.7],
	&quot;EQ_BOOSTERS_COUPLING_TYPE1&quot;: [0, 0.1],
	&quot;EQ_BOOSTERS_COUPLING_TYPE2&quot;: [0, 0.2],
	&quot;EQ_BOOSTERS_COUPLING_TYPE3&quot;: [0, 0.3],
	&quot;EQ_BOOSTERS_COUPLING_TYPE4&quot;: [0, 0.4],
	&quot;EQ_BOOSTERS_COUPLING_TYPE5&quot;: [0, 0.5],
	&quot;EQ_BOOSTERS_COUPLING_TYPE6&quot;: [0, 0.6],
	&quot;EQ_BOOSTERS_COUPLING_TYPE7&quot;: [0, 0.7],
	&quot;EQ_ENERGYBANK_COUPLING_TYPE1&quot;: [0, 0.1],
	&quot;EQ_ENERGYBANK_COUPLING_TYPE2&quot;: [0, 0.2],
	&quot;EQ_ENERGYBANK_COUPLING_TYPE3&quot;: [0, 0.3],
	&quot;EQ_ENERGYBANK_COUPLING_TYPE4&quot;: [0, 0.4],
	&quot;EQ_ENERGYBANK_COUPLING_TYPE5&quot;: [0, 0.5],
	&quot;EQ_ENERGYBANK_COUPLING_TYPE6&quot;: [0, 0.6],
	&quot;EQ_ENERGYBANK_COUPLING_TYPE7&quot;: [0, 0.7],
	&quot;EQ_ENERGYBANK_COUPLING_TYPE8&quot;: [0, 0.8],
	&quot;EQ_THRUSTERS_COUPLING_TYPE1&quot;: [0, 0.1],
	&quot;EQ_THRUSTERS_COUPLING_TYPE2&quot;: [0, 0.2],
	&quot;EQ_THRUSTERS_COUPLING_TYPE3&quot;: [0, 0.3],
	&quot;EQ_THRUSTERS_COUPLING_TYPE4&quot;: [0, 0.4],
	&quot;EQ_THRUSTERS_COUPLING_TYPE5&quot;: [0, 0.5],
	&quot;EQ_THRUSTERS_COUPLING_TYPE6&quot;: [0, 0.6],
	&quot;EQ_THRUSTERS_COUPLING_TYPE7&quot;: [0, 0.7],
	&quot;EQ_FORWARD_SHIELD_COUPLING_TYPE1&quot;: [0, 0.1],
	&quot;EQ_FORWARD_SHIELD_COUPLING_TYPE2&quot;: [0, 0.2],
	&quot;EQ_FORWARD_SHIELD_COUPLING_TYPE3&quot;: [0, 0.3],
	&quot;EQ_FORWARD_SHIELD_COUPLING_TYPE4&quot;: [0, 0.4],
	&quot;EQ_FORWARD_SHIELD_COUPLING_TYPE5&quot;: [0, 0.5],
	&quot;EQ_AFT_SHIELD_COUPLING_TYPE1&quot;: [0, 0.1],
	&quot;EQ_AFT_SHIELD_COUPLING_TYPE2&quot;: [0, 0.2],
	&quot;EQ_AFT_SHIELD_COUPLING_TYPE3&quot;: [0, 0.3],
	&quot;EQ_AFT_SHIELD_COUPLING_TYPE4&quot;: [0, 0.4],
	&quot;EQ_AFT_SHIELD_COUPLING_TYPE5&quot;: [0, 0.5],

	&quot;EQ_ADDITIONAL_AFT_ARMOUR&quot;: [0, 3],
	&quot;EQ_ADDITIONAL_CORE_HULL&quot;: [0, 5],
	&quot;EQ_ADDITIONAL_FRONT_ARMOUR&quot;: [0, 3],
	&quot;EQ_ADV_NAV_COMP&quot;: [1, 1],
	&quot;EQ_AFT_SHIELD_CAPACITOR&quot;: [2, 2],
	&quot;EQ_AMS&quot;: [0, 3],
	&quot;EQ_ANTISAPPER&quot;: [3, 3],
	&quot;EQ_APRIL&quot;: [0, 2],
	&quot;EQ_APRIL_EXPANSION&quot;: [0, 2],
	&quot;EQ_APRIL_NPC_MISSILE&quot;: [0, 2],
	&quot;EQ_AQUATICS_1_GUARDIAN&quot;: [3, 3],
	&quot;EQ_AQUATICS_1_JAMMER_MINE&quot;: [0, 0.1],
	&quot;EQ_AQUATICS_1_TRIDENT_MISSILE&quot;: [0, 0.2],
	&quot;EQ_AQUATICS_CLOAK&quot;: [1, 1],
	&quot;EQ_AQUATICS_GUARDIAN&quot;: [2, 2],
	&quot;EQ_AQUATICS_JAMMER_MINE&quot;: [0, 0.1],
	&quot;EQ_AQUATICS_TRIDENT_MISSILE&quot;: [0, 0.2],
	&quot;EQ_ARMOURY_BUGBOMB_MINE&quot;: [0, 0.3],
	&quot;EQ_ARMOURY_BUZZBOMB_MINE&quot;: [0, 0.2],
	&quot;EQ_ARMOURY_CUTPURSE_MISSILE&quot;: [0, 0.2],
	&quot;EQ_ARMOURY_DECOY_MINE&quot;: [0, 0.5],
	&quot;EQ_ARMOURY_DISPLACER_MISSILE&quot;: [0, 0.3],
	&quot;EQ_ARMOURY_FIELD_MISSILE&quot;: [0, 0.3],
	&quot;EQ_ARMOURY_HARD_MISSILE&quot;: [0, 0.2],
	&quot;EQ_ARMOURY_INTERDICTOR_MINE&quot;: [0, 0.2],
	&quot;EQ_ARMOURY_KICKER_MISSILE&quot;: [0, 0.2],
	&quot;EQ_ARMOURY_MISSILEMACHINE_MINE&quot;: [0, 2],
	&quot;EQ_ARMOURY_SCREAMER_MINE&quot;: [0, 0.3],
	&quot;EQ_ARMOURY_STANDARD_MISSILE&quot;: [0, 0.1],
	&quot;EQ_ARMOURY_STUNBOMB_MINE&quot;: [0, 0.2],
	&quot;EQ_ARMOURY_TRACKER_MISSILE&quot;: [0, 0.5],
	&quot;EQ_ARMOURY_UNIBOMB_MINE&quot;: [0, 0.3],
	&quot;EQ_ATDRONE_LAUNCHER_MINE&quot;: [0, 0.2],
	&quot;EQ_AUTO_SKIMMER&quot;: [1, 1],
	&quot;EQ_AUX_TANK&quot;: [3, 3],
	&quot;EQ_BEACONLAUNCHER_MINE&quot;: [0, 0.1],
	&quot;EQ_BEACON_DEVICE&quot;: [0.5, 0.5],
	&quot;EQ_BEACON_MISSILE&quot;: [0, 0.1],
	&quot;EQ_BEERCOOLER&quot;: [0.1, 0.1],
	&quot;EQ_BIGSHCAP&quot;: [12, 12],
	&quot;EQ_BIGSHCAP2&quot;: [14, 14],
	&quot;EQ_BREAKABLE_TORUSDRIVE&quot;: [1, 1],
	&quot;EQ_CARGO_SCANNER&quot;: [1, 1],
	&quot;EQ_CARGO_SHEPHERD_MINE&quot;: [0.5, 0.5],
	&quot;EQ_CDRONE_LAUNCHER_MINE&quot;: [0, 0.2],
	&quot;EQ_CRIPPLED_CLOAKING&quot;: [1, 1],
	&quot;EQ_CT_CONVERT&quot;: [3, 3],
	&quot;EQ_CT_DRONE_1&quot;: [2, 2],
	&quot;EQ_CT_DRONE_2&quot;: [2, 2],
	&quot;EQ_CT_DRONE_3&quot;: [2, 2],
	&quot;EQ_CT_DRONE_4&quot;: [2, 2],
	&quot;EQ_CT_MINE&quot;: [0, 0.3],
	&quot;EQ_DREDGER_SALVAGE_MISSILE&quot;: [0, 0.2],
	&quot;EQ_DUMMY1&quot;: [0, 1],
	&quot;EQ_DUMMY10&quot;: [0, 10],
	&quot;EQ_DUMMY100&quot;: [0, 100],
	&quot;EQ_DUMMY5&quot;: [0, 5],
	&quot;EQ_DUMMY50&quot;: [0, 50],
	&quot;EQ_ECD_MINE&quot;: [0, 0.3],
	&quot;EQ_EEG&quot;: [1, 1],
	&quot;EQ_EEU&quot;: [3, 3],
	&quot;EQ_ELECTRONICS_BOX&quot;: [1, 3],
	&quot;EQ_ENERGY_BOMB&quot;: [0, 0.2],
	&quot;EQ_ENERGY_GRID&quot;: [3, 3],
	&quot;EQ_EQUIPMENT_BOX&quot;: [2, 5],
	&quot;EQ_ERB&quot;: [1, 1],
	&quot;EQ_ESG&quot;: [3, 3],
	&quot;EQ_FEUDAL_FLARE_MINE&quot;: [0, 0.1],
	&quot;EQ_FORWARD_SHIELD_CAPACITOR&quot;: [2, 2],
	&quot;EQ_FTL_TORUS&quot;: [3, 3],
	&quot;EQ_FTL_TORUS2&quot;: [3, 3],
	&quot;EQ_FUELTANK_MINE&quot;: [3, 3],
	&quot;EQ_GAL_DRIVE_MINE&quot;: [0, 0.1],
	&quot;EQ_GRAVSCANNER&quot;: [2, 4],
	&quot;EQ_GRAVSCANNER2&quot;: [3, 6],
	&quot;EQ_HARDARMOUR_III&quot;: [0, 5],
	&quot;EQ_HARDARMOUR_V&quot;: [0, 8],
	&quot;EQ_HARDARMOUR_X&quot;: [0, 10],
	&quot;EQ_HARDNOSE&quot;: [0, 1],
	&quot;EQ_HARDSHIELD_1&quot;: [2, 4],
	&quot;EQ_HARDSHIELD_10&quot;: [11, 22],
	&quot;EQ_HARDSHIELD_2&quot;: [3, 6],
	&quot;EQ_HARDSHIELD_3&quot;: [4, 8],
	&quot;EQ_HARDSHIELD_4&quot;: [5, 10],
	&quot;EQ_HARDSHIELD_5&quot;: [6, 12],
	&quot;EQ_HARDSHIELD_6&quot;: [7, 14],
	&quot;EQ_HARDSHIELD_7&quot;: [8, 16],
	&quot;EQ_HARDSHIELD_8&quot;: [9, 18],
	&quot;EQ_HARDSHIELD_9&quot;: [10, 20],
	&quot;EQ_HRACK_1_MISSILE&quot;: [0, 0.2],
	&quot;EQ_HRACK_2_MISSILE&quot;: [0, 0.3],
	&quot;EQ_HRACK_3_MISSILE&quot;: [0, 0.4],
	&quot;EQ_HTCAT&quot;: [2, 2],
	&quot;EQ_Headlights&quot;: [0, 0.3],
	&quot;EQ_INJECTOR_BOX&quot;: [2, 2],
	&quot;EQ_IRACK_1_MISSILE&quot;: [0, 0.2],
	&quot;EQ_IRACK_2_MISSILE&quot;: [0, 0.3],
	&quot;EQ_IRACK_3_MISSILE&quot;: [0, 0.4],
	&quot;EQ_IRONHIDE&quot;: [0, 5], // will need script to adjust for mil version
	&quot;EQ_I_MISSILE&quot;: [0, 0.3],
	&quot;EQ_KDRONE_LAUNCHER_MINE&quot;: [0, 0.3],
	&quot;EQ_LARGEDISH&quot;: [3, 10],
	&quot;EQ_LASERBOOSTER&quot;: [1, 1],
	&quot;EQ_LASERREDUCTOR&quot;: [1, 1],
	&quot;EQ_LASER_COOLER&quot;: [5, 5],
	&quot;EQ_LASER_COUPLER&quot;: [0, 2],
	&quot;EQ_LASER_STABILISER&quot;: [0, 2],
	&quot;EQ_LBOOST_BEAM_AFT&quot;: [0, 2],
	&quot;EQ_LBOOST_BEAM_FWD&quot;: [0, 2],
	&quot;EQ_LBOOST_BEAM_PORT&quot;: [0, 2],
	&quot;EQ_LBOOST_BEAM_STAR&quot;: [0, 2],
	&quot;EQ_LBOOST_MILITARY_AFT&quot;: [0, 3],
	&quot;EQ_LBOOST_MILITARY_FWD&quot;: [0, 3],
	&quot;EQ_LBOOST_MILITARY_PORT&quot;: [0, 3],
	&quot;EQ_LBOOST_MILITARY_STAR&quot;: [0, 3],
	&quot;EQ_LBOOST_MINING_AFT&quot;: [0, 1.5],
	&quot;EQ_LBOOST_MINING_FWD&quot;: [0, 1.5],
	&quot;EQ_LBOOST_MINING_PORT&quot;: [0, 1.5],
	&quot;EQ_LBOOST_MINING_STAR&quot;: [0, 1.5],
	&quot;EQ_LBOOST_PULSE_AFT&quot;: [0, 1],
	&quot;EQ_LBOOST_PULSE_FWD&quot;: [0, 1],
	&quot;EQ_LBOOST_PULSE_PORT&quot;: [0, 1],
	&quot;EQ_LBOOST_PULSE_STAR&quot;: [0, 1],
	&quot;EQ_LIFE_BOX&quot;: [3, 3],
	&quot;EQ_LMSS_ACTIVATOR&quot;: [0, 1],
	&quot;EQ_LMSS_AFT&quot;: [0, 1],
	&quot;EQ_LMSS_FRONT&quot;: [0, 1],
	&quot;EQ_LMSS_PORT&quot;: [0, 1],
	&quot;EQ_LMSS_STARBOARD&quot;: [0, 1],
	&quot;EQ_LONG_RANGE_SCANNER&quot;: [2, 2],
	&quot;EQ_MANIF_SCANNER&quot;: [1, 1],
	&quot;EQ_MICRO_G_TORUS&quot;: [2, 2],
	&quot;EQ_MICRO_G_TORUS2&quot;: [2, 2],
	&quot;EQ_MILITARYTARGETTINGSYSTEM&quot;: [1, 1],
	&quot;EQ_MIL_INJECTION&quot;: [3, 3],
	&quot;EQ_MISJUMP_ANALYSER&quot;: [1, 1],
	&quot;EQ_MISSILE_ANALYSER&quot;: [1, 1],
	&quot;EQ_MURPH_THARGOID_DRIVE&quot;: [1, 1],
	&quot;EQ_NAVAL_GRID&quot;: [5, 5],
	&quot;EQ_NEXUS_BASIC_MISSILE&quot;: [0, 0.3],
	&quot;EQ_NEXUS_BUG_MISSILE&quot;: [0, 0.4],
	&quot;EQ_NEXUS_BUG_R_MISSILE&quot;: [0, 0.4],
	&quot;EQ_NEXUS_PREMIUM_MISSILE&quot;: [0, 0.4],
	&quot;EQ_NEXUS_ULTIMATE_MISSILE&quot;: [0, 0.5],
	&quot;EQ_NRACK_1_MISSILE&quot;: [0, 0.2],
	&quot;EQ_NRACK_2_MISSILE&quot;: [0, 0.3],
	&quot;EQ_NRACK_3_MISSILE&quot;: [0, 0.4],
	&quot;EQ_OCZ_CORONALHARVESTER&quot;: [2, 0],
	&quot;EQ_ORE_PROCESSOR&quot;: [0, 5],
	&quot;EQ_ORE_SCANNER&quot;: [1, 2],
	&quot;EQ_HARDWIRE_ORE_PROCESSOR&quot;: [0, 0.1],
	&quot;EQ_PHASE_SCANNER&quot;: [2, 2],
	&quot;EQ_PLANETFALL&quot;: [0, 5],
	&quot;EQ_PROBE_LAUNCHER_MINE&quot;: [0, 0.2],
	&quot;EQ_Q-CHARGER&quot;: [2, 2],
	&quot;EQ_QTHI_AuxEnergyGenerator&quot;: [0, 4],
	&quot;EQ_QTHI_AuxEnergyGeneratorHT&quot;: [0, 4],
	&quot;EQ_QTHI_AuxEnergyGeneratorHv&quot;: [0, 6],
	&quot;EQ_QTHI_AuxEnergyGeneratorLt&quot;: [2, 2],
	&quot;EQ_RAILGUN_1&quot;: [0, 1],
	&quot;EQ_RAILGUN_2&quot;: [0, 1.5],
	&quot;EQ_RAILGUN_3&quot;: [0, 2],
	&quot;EQ_RAILGUN_4&quot;: [0, 2.5],
	&quot;EQ_REG&quot;: [1, 1],
	&quot;EQ_REPAIRBOTS_CONTROLLER&quot;: [2, 2],
	&quot;EQ_REPAIRBOTS_MINE&quot;: [0, 0.1],
	&quot;EQ_RESCUE_MISSILE&quot;: [0, 2],
	&quot;EQ_RESERVE_TANK&quot;: [1, 1],
	&quot;EQ_RETROROCKETS&quot;: [0, 3],
	&quot;EQ_RMB_CASCADE_MISSILE&quot;: [0, 0.3],
	&quot;EQ_RMB_CHAFF_LAUNCHER&quot;: [0, 0.3],
	&quot;EQ_RMB_DEFENCE_MINE&quot;: [0, 0.4],
	&quot;EQ_RMB_DISTRESS_MINE&quot;: [0, 0.2],
	&quot;EQ_RMB_FRAG_MINE&quot;: [0, 0.3],
	&quot;EQ_RMB_FRAG_MISSILE&quot;: [0, 0.3],
	&quot;EQ_RMB_INTERCEPT_MISSILE&quot;: [0, 0.2],
	&quot;EQ_RMB_LAW_MISSILE&quot;: [0, 0.3],
	&quot;EQ_RMB_OVERRIDE_MISSILE&quot;: [0, 0.3],
	&quot;EQ_RMB_REMOTE_MINE&quot;: [0, 0.5],
	&quot;EQ_RMB_THARGOID_MISSILE&quot;: [0, 0.4],
	&quot;EQ_ROCKHERMIT_SCANNER&quot;: [1, 1],
	&quot;EQ_RRS_ASC&quot;: [1, 1],
	&quot;EQ_RRS_DOCK_COMP&quot;: [1, 1],
	&quot;EQ_RRS_HEAT_SHIELD&quot;: [0, 3],
	&quot;EQ_RRS_SCOOPS&quot;: [0, 2],
	&quot;EQ_RRS_SOLAR_MINE&quot;: [0, 2],
	&quot;EQ_SAPPERMODE&quot;: [0, 1],
	&quot;EQ_SAPPERNULLIFIER&quot;: [5, 5],
	&quot;EQ_SC_SHIELD_CYCLER_ADVANCED&quot;: [3, 3],
	&quot;EQ_SC_SHIELD_CYCLER_BASIC&quot;: [1, 1],
	&quot;EQ_SC_SHIELD_CYCLER_STANDARD&quot;: [2, 2],
	&quot;EQ_SHIELD_BOX&quot;: [5, 5],
	&quot;EQ_SHIELD_EQUALIZER&quot;: [2, 2],
	&quot;EQ_SHIPMINER&quot;: [1, 1],
	&quot;EQ_SHIPMINERASSISTANT&quot;: [0.5, 0.5],
	&quot;EQ_SMALLDISH&quot;: [1, 5],
	&quot;EQ_SMUGGLING_COMPARTMENT_1&quot;: [0, 1],
	&quot;EQ_SMUGGLING_COMPARTMENT_10&quot;: [0, 5],
	&quot;EQ_SMUGGLING_COMPARTMENT_11&quot;: [0, 6],
	&quot;EQ_SMUGGLING_COMPARTMENT_12&quot;: [0, 6],
	&quot;EQ_SMUGGLING_COMPARTMENT_13&quot;: [0, 7],
	&quot;EQ_SMUGGLING_COMPARTMENT_14&quot;: [0, 7],
	&quot;EQ_SMUGGLING_COMPARTMENT_15&quot;: [0, 8],
	&quot;EQ_SMUGGLING_COMPARTMENT_16&quot;: [0, 8],
	&quot;EQ_SMUGGLING_COMPARTMENT_17&quot;: [0, 9],
	&quot;EQ_SMUGGLING_COMPARTMENT_18&quot;: [0, 9],
	&quot;EQ_SMUGGLING_COMPARTMENT_19&quot;: [0, 10],
	&quot;EQ_SMUGGLING_COMPARTMENT_2&quot;: [0, 1],
	&quot;EQ_SMUGGLING_COMPARTMENT_20&quot;: [0, 10],
	&quot;EQ_SMUGGLING_COMPARTMENT_3&quot;: [0, 2],
	&quot;EQ_SMUGGLING_COMPARTMENT_4&quot;: [0, 2],
	&quot;EQ_SMUGGLING_COMPARTMENT_5&quot;: [0, 3],
	&quot;EQ_SMUGGLING_COMPARTMENT_6&quot;: [0, 3],
	&quot;EQ_SMUGGLING_COMPARTMENT_7&quot;: [0, 4],
	&quot;EQ_SMUGGLING_COMPARTMENT_8&quot;: [0, 4],
	&quot;EQ_SMUGGLING_COMPARTMENT_9&quot;: [0, 5],
	&quot;EQ_SRACK_1_MISSILE&quot;: [0, 0.2],
	&quot;EQ_SRACK_2_MISSILE&quot;: [0, 0.3],
	&quot;EQ_SRACK_3_MISSILE&quot;: [0, 0.4],
	&quot;EQ_SUWITCHDRIVE&quot;: [2, 2],
	&quot;EQ_SUWITCHDRIVESPARECOILS&quot;: [1, 1],
	&quot;EQ_TELESCOPE&quot;: [1, 1],
	&quot;EQ_TOWBAR&quot;: [1, 1],
	&quot;EQ_TOWBARINJ&quot;: [0.5, 0.5],
	&quot;EQ_TOWBARREPAIRBOT&quot;: [0.5, 0.5],
	&quot;EQ_TOWBARSTAB_MINE&quot;: [0, 0.1],
	&quot;EQ_TRACKERCAM_MINE&quot;: [0, 0.2],
	&quot;EQ_TUGDRONE_MISSILE&quot;: [0, 0.3],
	&quot;EQ_UPS_POLICE_SCANNER&quot;: [0.3, 0.3],
	&quot;EQ_UPS_UNIVERSAL_SCANNER&quot;: [0.5, 0.5],
	&quot;EQ_VACUUM_PUMP&quot;: [0, 1],
	&quot;EQ_VERYHARDNOSE&quot;: [0, 3],
	&quot;EQ_VERYVERYHARDNOSE&quot;: [0, 5],
	&quot;EQ_WARHEAD_MINE&quot;: [0, 0.2],
	&quot;EQ_WEAPON_ANDERSON_LASER&quot;: [0, 3],
	&quot;EQ_WEAPON_ASSAULT_LASER&quot;: [0, 2],
	&quot;EQ_WEAPON_BEAM_LASER_2&quot;: [0, 4],
	&quot;EQ_WEAPON_BEAM_LASER_3&quot;: [0, 6],
	&quot;EQ_WEAPON_BEAM_LASER_4&quot;: [0, 8],
	&quot;EQ_WEAPON_BEAM_LASER_5&quot;: [0, 10],
	&quot;EQ_WEAPON_BLAST_LASER&quot;: [0, 1.5],
	&quot;EQ_WEAPON_BURST_LASER&quot;: [0, 2],
	&quot;EQ_WEAPON_CANNON_1&quot;: [0, 0.5],
	&quot;EQ_WEAPON_CANNON_10&quot;: [0, 3],
	&quot;EQ_WEAPON_CANNON_10_2&quot;: [0, 6],
	&quot;EQ_WEAPON_CANNON_10_3&quot;: [0, 9],
	&quot;EQ_WEAPON_CANNON_10_4&quot;: [0, 12],
	&quot;EQ_WEAPON_CANNON_10_5&quot;: [0, 15],
	&quot;EQ_WEAPON_CANNON_11&quot;: [1, 8],
	&quot;EQ_WEAPON_CANNON_11_2&quot;: [2, 16],
	&quot;EQ_WEAPON_CANNON_11_3&quot;: [3, 24],
	&quot;EQ_WEAPON_CANNON_11_4&quot;: [4, 32],
	&quot;EQ_WEAPON_CANNON_11_5&quot;: [5, 40],
	&quot;EQ_WEAPON_CANNON_12&quot;: [2, 10],
	&quot;EQ_WEAPON_CANNON_13&quot;: [2, 12],
	&quot;EQ_WEAPON_CANNON_14&quot;: [3, 15],
	&quot;EQ_WEAPON_CANNON_15&quot;: [3, 20],
	&quot;EQ_WEAPON_CANNON_16&quot;: [3, 15],
	&quot;EQ_WEAPON_CANNON_17&quot;: [5, 30],
	&quot;EQ_WEAPON_CANNON_18&quot;: [8, 40],
	&quot;EQ_WEAPON_CANNON_2&quot;: [0, 2],
	&quot;EQ_WEAPON_CANNON_2_2&quot;: [0, 4],
	&quot;EQ_WEAPON_CANNON_2_3&quot;: [0, 6],
	&quot;EQ_WEAPON_CANNON_2_4&quot;: [0, 8],
	&quot;EQ_WEAPON_CANNON_2_5&quot;: [0, 10],
	&quot;EQ_WEAPON_CANNON_3&quot;: [0, 3],
	&quot;EQ_WEAPON_CANNON_4&quot;: [0, 4],
	&quot;EQ_WEAPON_CANNON_4_2&quot;: [0, 8],
	&quot;EQ_WEAPON_CANNON_4_3&quot;: [0, 12],
	&quot;EQ_WEAPON_CANNON_4_4&quot;: [0, 16],
	&quot;EQ_WEAPON_CANNON_4_5&quot;: [0, 20],
	&quot;EQ_WEAPON_CANNON_5&quot;: [0, 6],
	&quot;EQ_WEAPON_CANNON_6&quot;: [0, 3],
	&quot;EQ_WEAPON_CANNON_7&quot;: [0, 3],
	&quot;EQ_WEAPON_CANNON_7_2&quot;: [0, 6],
	&quot;EQ_WEAPON_CANNON_7_3&quot;: [0, 9],
	&quot;EQ_WEAPON_CANNON_7_4&quot;: [0, 12],
	&quot;EQ_WEAPON_CANNON_7_5&quot;: [0, 15],
	&quot;EQ_WEAPON_CANNON_8&quot;: [0, 5],
	&quot;EQ_WEAPON_CANNON_9&quot;: [1, 6],
	&quot;EQ_WEAPON_CANNON_EA&quot;: [0, 5],
	&quot;EQ_WEAPON_CANNON_EA_2&quot;: [0, 10],
	&quot;EQ_WEAPON_CANNON_EA_3&quot;: [0, 15],
	&quot;EQ_WEAPON_CANNON_EA_4&quot;: [0, 20],
	&quot;EQ_WEAPON_CANNON_EA_5&quot;: [0, 25],
	&quot;EQ_WEAPON_CANNON_ECO&quot;: [0, 1],
	&quot;EQ_WEAPON_CANNON_ECO_2&quot;: [0, 2],
	&quot;EQ_WEAPON_CANNON_ECO_3&quot;: [0, 3],
	&quot;EQ_WEAPON_CANNON_ECO_4&quot;: [0, 4],
	&quot;EQ_WEAPON_CANNON_ECO_5&quot;: [0, 5],
	&quot;EQ_WEAPON_CANNON_HEAVY_SAPPER&quot;: [0, 5],
	&quot;EQ_WEAPON_CANNON_HEAVY_SNIPER_GUN&quot;: [0, 5],
	&quot;EQ_WEAPON_CANNON_HEAVY_SNIPER_GUN_2&quot;: [0, 10],
	&quot;EQ_WEAPON_CANNON_HEAVY_SNIPER_GUN_3&quot;: [0, 15],
	&quot;EQ_WEAPON_CANNON_HEAVY_SNIPER_GUN_4&quot;: [0, 20],
	&quot;EQ_WEAPON_CANNON_HEAVY_SNIPER_GUN_5&quot;: [0, 25],
	&quot;EQ_WEAPON_CANNON_SAPPER&quot;: [0, 3],
	&quot;EQ_WEAPON_CANNON_SNIPER_GUN&quot;: [0, 3],
	&quot;EQ_WEAPON_CANNON_SNIPER_GUN_2&quot;: [0, 6],
	&quot;EQ_WEAPON_CANNON_SNIPER_GUN_3&quot;: [0, 9],
	&quot;EQ_WEAPON_CANNON_SNIPER_GUN_4&quot;: [0, 12],
	&quot;EQ_WEAPON_CANNON_SNIPER_GUN_5&quot;: [0, 15],
	&quot;EQ_WEAPON_DEXM_LASER&quot;: [0, 3],
	&quot;EQ_WEAPON_DUAL_LASER&quot;: [0, 2],
	&quot;EQ_WEAPON_EBEAM_LASER&quot;: [0, 2],
	&quot;EQ_WEAPON_ECO_LASER&quot;: [0, 1],
	&quot;EQ_WEAPON_ECO_LASER_2&quot;: [0, 2],
	&quot;EQ_WEAPON_ECO_LASER_3&quot;: [0, 3],
	&quot;EQ_WEAPON_ECO_LASER_4&quot;: [0, 4],
	&quot;EQ_WEAPON_ECO_LASER_5&quot;: [0, 5],
	&quot;EQ_WEAPON_ECO_REACTOR&quot;: [0, 2],
	&quot;EQ_WEAPON_ECO_REACTOR_2&quot;: [0, 4],
	&quot;EQ_WEAPON_ECO_REACTOR_3&quot;: [0, 6],
	&quot;EQ_WEAPON_ECO_REACTOR_4&quot;: [0, 8],
	&quot;EQ_WEAPON_ECO_REACTOR_5&quot;: [0, 10],
	&quot;EQ_WEAPON_EMILITARY_LASER&quot;: [0, 3],
	&quot;EQ_WEAPON_EPULSE_LASER&quot;: [0, 1],
	&quot;EQ_WEAPON_FRONTIER_LASER&quot;: [0, 2],
	&quot;EQ_WEAPON_GATLING_LASER_1&quot;: [0, 1],
	&quot;EQ_WEAPON_GATLING_LASER_2&quot;: [0, 1.5],
	&quot;EQ_WEAPON_GATLING_LASER_3&quot;: [0, 2],
	&quot;EQ_WEAPON_GATLING_LASER_4&quot;: [0, 2.5],
	&quot;EQ_WEAPON_GATLING_LASER_5&quot;: [0, 3],
	&quot;EQ_WEAPON_HIRAD_LASER&quot;: [0, 2],
	&quot;EQ_WEAPON_HVARISCAN_LASER&quot;: [0, 1.5],
	&quot;EQ_WEAPON_JKMINING_LASER&quot;: [0, 1.5],
	&quot;EQ_WEAPON_LUCAS_LASER&quot;: [0, 2.5],
	&quot;EQ_WEAPON_MILITARY_LASER_2&quot;: [0, 6],
	&quot;EQ_WEAPON_MILITARY_LASER_3&quot;: [0, 9],
	&quot;EQ_WEAPON_MILITARY_LASER_4&quot;: [0, 12],
	&quot;EQ_WEAPON_MILITARY_LASER_5&quot;: [0, 15],
	&quot;EQ_WEAPON_PULSE_LASER_2&quot;: [0, 2],
	&quot;EQ_WEAPON_PULSE_LASER_3&quot;: [0, 3],
	&quot;EQ_WEAPON_PULSE_LASER_4&quot;: [0, 4],
	&quot;EQ_WEAPON_PULSE_LASER_5&quot;: [0, 5],
	&quot;EQ_WEAPON_QVC_LASER&quot;: [0, 3],
	&quot;EQ_WEAPON_RIMMERACE_LASER&quot;: [0, 3],
	&quot;EQ_WEAPON_STAR_LASER&quot;: [0, 2],
	&quot;EQ_WEAPON_VARISCAN_LASER&quot;: [0, 1.5],
	&quot;EQ_WEAPON_WILLIAMS_LASER&quot;: [0, 2],
	&quot;EQ_WEAPON_ZEUSCORP_LASER&quot;: [0, 2.5],
	&quot;EQ_XS_SWORD_MISSILE&quot;: [0, 0.1],
	&quot;EQ_X_SWORD_A_MISSILE&quot;: [0, 0.1],
	&quot;EQ_X_SWORD_MISSILE&quot;: [0, 0.1],
	&quot;EQ_AM18_HYPERDRIVE&quot;: [0.5, 0.5],
	&quot;EQ_HZ_HYPERDRIVE&quot;: [0.8, 0.8],
	&quot;EQ_TURBULEN_HYPEDRIVE&quot;: [1, 1],
	&quot;EQ_PROSSET_HYPERDRIVE&quot;: [2, 2],
	&quot;EQ_AMES_HYPERDRIVE&quot;: [2.5, 2.5],
	&quot;EQ_TITRONIX_HYPERDRIVE&quot;: [3, 3],
	&quot;EQ_IRRIKAN_HYPERDRIVE&quot;: [4, 4],
	&quot;EQ_CARGO_TARGETER&quot;: [0.5, 0.5],
	&quot;EQ_VECTOR_SPACELANE&quot;: [0.2, 0.2],
	&quot;EQ_VECTOR_FUNA_MISSILE&quot;: [0, 0.2],
	&quot;EQ_VECTOR_FUNB_MISSILE&quot;: [0, 0.3],
	&quot;EQ_VECTOR_FUNC_MISSILE&quot;: [0, 0.4],
	&quot;EQ_VECTOR_AREIDIS_SCANNER&quot;: [1.5, 1.5],
	&quot;EQ_VECTOR_EMP_MINE&quot;: [0, 1.5],
	&quot;EQ_VECTOR_SCOOPS&quot;: [0, 1],
	&quot;EQ_TARGET_AUTOLOCK&quot;: [0, 0],
};

//-------------------------------------------------------------------------------------------------------------
this.$addCallback = function $addCallback(obj) {
	this._callbacks.push(obj);
}

//=============================================================================================================
// system functions

//-------------------------------------------------------------------------------------------------------------
this.startUp = function () {
	if (this._disabled === true) {
		delete this.equipmentAdded;
		delete this.equipmentRemoved;
		delete this.playerBoughtEquipment;
		delete this.missionScreenOpportunity;
		delete this.missionScreenEnded;
		delete this.equipmentDamaged;
		delete this.equipmentRepaired;
		delete this.playerBoughtNewShip;
		delete this.guiScreenChanged;
		delete this.guiScreenWillChange;
		delete this.shipDockedWithStation;
		delete this.shipWillLaunchFromStation;
		delete this.shipLaunchedFromStation;
		delete this.playerStartedJumpCountdown;
		delete this.playerStartedAutoPilot;
		delete this.shipDied;
		delete this.shipTakingDamage;
		delete this.shipSpawned;
		delete this.shipFiredMissile;
		delete this.shipScoopedOther;
		delete this.playerRescuedEscapePod;
		delete this.startUpComplete;
		delete this.startUp;
		return;
	}

	this._armour = [].concat(this._frontarmour).concat(this._aftarmour);

	var p = player.ship;
	var oldarmour = [&quot;EQ_ARMOUR_TYPE1&quot;, &quot;EQ_ARMOUR_TYPE2&quot;, &quot;EQ_ARMOUR_TYPE3&quot;, &quot;EQ_ARMOUR_TYPE4&quot;, &quot;EQ_ARMOUR_TYPE5&quot;, &quot;EQ_ARMOUR_TYPE6&quot;, &quot;EQ_ARMOUR_TYPE7&quot;];
	for (var i = 0; i &lt; oldarmour.length; i++) {
		if (player.ship.equipmentStatus(oldarmour[i]) === &quot;EQUIPMENT_OK&quot;) {
			p.awardEquipment(&quot;EQ_ARMOUR_FORWARD_TYPE&quot; + (i + 1));
			p.awardEquipment(&quot;EQ_ARMOUR_AFT_TYPE&quot; + (i + 1));
			p.removeEquipment(oldarmour[i]);
		}
	}

	// look for any equipment items that have a weight/space value set in script info
	this.$addEquipmentDataFromScriptInfo();
	// look for any ships that have an equipment space or power to weight ratio set in script info
	this.$addShipDataFromScriptInfo();
	// add essential equipment to the &quot;no sell&quot; list - do it programmatically, rather than hardcoding equipment keys,
	// so if we ever expand the list they&#39;ll get added automatically
	this.$populateNoSellList();

	if (worldScripts.ShipRespray) this._shipRespray = true;
	if (worldScripts.Synchronised_Torus) this._torusSync = true;

	// if the station dock control is installed, add a callback to tell it to check for launched ships
	if (worldScripts.StationDockControl &amp;&amp; worldScripts.StationDockControl._disable == false) {
		this.$addCallback(worldScripts.StationDockControl.$checkForLaunchedShips.bind(worldScripts.StationDockControl));
	}
}

//-------------------------------------------------------------------------------------------------------------
this.startUpComplete = function () {
	// register our settings, if Lib_Config is present
	if (worldScripts.Lib_Config) worldScripts.Lib_Config._registerSet(this._scConfig);

	if (worldScripts.EmailSystem) {
		var ga = worldScripts.GalCopAdminServices;
		for (var i = 1; i &lt;= 7; i++) {
			ga._maint_repair_equip.push(&quot;EQ_ARMOUR_FORWARD_TYPE&quot; + i + &quot;_REPAIR&quot;);
			ga._maint_repair_equip.push(&quot;EQ_ARMOUR_AFT_TYPE&quot; + i + &quot;_REPAIR&quot;);
		}
	}

	var hy = worldScripts.Hyperdrives;
	if (hy) this._OXPHyperdrives = true;

	// remove the main config equip item from any new purchase emails
	var w = worldScripts.GalCopAdminServices;
	if (w) w._purchase_ignore_equip.push(&quot;EQ_SHIPCONFIG&quot;);

	if (worldScripts.NPC_Equipment_Damage) {
		var npcEq = worldScripts.NPC_Equipment_Damage
		// add in our equipmentdamaged processing event to the NPC damaged handler array
		npcEq.NPC_equipmentDamagedHandlers.push(this.$equipmentDamaged_Event);
	}

	var p = player.ship;
	// add base equipment items if this is the first time
	this._initialSetup = this.$installBaseEquipment(p);
	// check that there is space for all equipment
	// if not, we need to remove something, so load up the sell equipment screen
	this._promptPlayer = !this.$addEquipmentSpaceItem(p);

	// set up the interface screen, if required
	this.$initInterface(p.dockedStation);
	this._startUp = false;

	this.$setUpScriptConfig();

	if (this._OXPHyperdrives === true) {
		// make sure we remove any SC hyperdrives if the player has installed the Hyperdrives OXP
		for (var i = 0; i &lt; this._hyperdrive.length; i++) {
			p.removeEquipment(this._hyperdrive[i]);
		}
		for (var i = 0; i &lt; this._hdCoupling.length; i++) {
			p.removeEquipment(this._hdCoupling[i]);
		}
	}

	// tap into shipresprays pre/post function calls
	if (this._shipRespray) {
		var sr = worldScripts.ShipRespray;
		if (sr.$addPreSprayCall) {
			sr.$addPreSprayCall(this.name, &quot;$preResprayFunction&quot;);
			sr.$addPostSprayCall(this.name, &quot;$postResprayFunction&quot;);
		}
	}

	// monkey patch combat sim so we can do some pre-launch work done
	if (worldScripts[&quot;Combat Simulator&quot;]) {
		worldScripts[&quot;Combat Simulator&quot;]._startFight = this.$combatSim_startFight;
	}

	// check to see if hyperspace hangar is installed
	if (worldScripts.HyperspaceHangar) this._hyperHangar = true;

	// load up or repopulate the current equipment list (so we know what&#39;s brand new and what&#39;s used)
	if (missionVariables.ShipConfiguration_CurrentEquip) {
		this._currEquip = JSON.parse(missionVariables.ShipConfiguration_CurrentEquip);
		delete missionVariables.ShipConfiguration_CurrentEquip;
	} else {
		this._currEquip = [];
		var eq = player.ship.equipment;
		for (var i = 0; i &lt; eq.length; i++) {
			this._currEquip.push(eq[i].equipmentKey);
		}
	}
	if (missionVariables.ShipConfiguration_BoosterSound) this._disableBoosterSound = (this._trueValues.indexOf(missionVariables.ShipConfiguration_BoosterSound) &gt;= 0 ? true : false);
	if (missionVariables.ShipConfiguration_DisableF3HUD) this._disableF3HUD = (this._trueValues.indexOf(missionVariables.ShipConfiguration_DisableF3HUD) &gt;= 0 ? true : false);
	if (missionVariables.ShipConfiguration_ApplyToNPC) this._applyToNPC = (this._trueValues.indexOf(missionVariables.ShipConfiguration_ApplyToNPC) &gt;= 0 ? true : false);
	if (missionVariables.ShipConfiguration_FreeUpgrades) this._freeUpgrades = (this._trueValues.indexOf(missionVariables.ShipConfiguration_FreeUpgrades) &gt;= 0 ? true : false);
	if (missionVariables.ShipConfiguration_InstallationTime) this._installationTime = (this._trueValues.indexOf(missionVariables.ShipConfiguration_InstallationTime) &gt;= 0 ? true : false);
	
	// upgraded features in v1.84
	if (0 &lt; oolite.compareVersion(&quot;1.84&quot;)) {
		delete this.shipDumpedCargo;
	} else {
		delete this.shipSpawned;
	}
}

//-------------------------------------------------------------------------------------------------------------
this.playerWillSaveGame = function () {
	missionVariables.ShipConfiguration_CurrentEquip = JSON.stringify(this._currEquip);
	missionVariables.ShipConfiguration_BoosterSound = this._disableBoosterSound;
	missionVariables.ShipConfiguration_DisableF3HUD = this._disableF3HUD;
	missionVariables.ShipConfiguration_ApplyToNPC = this._applyToNPC;
	missionVariables.ShipConfiguration_FreeUpgrades = this._freeUpgrades;
	missionVariables.ShipConfiguration_InstallationTime = this._installationTime;
}

//-------------------------------------------------------------------------------------------------------------
this.shipDockedWithStation = function (station) {
	this.$stopTimers();
	this.$initInterface(station);

	// re-load the current equipment list so we know what&#39;s used
	this._currEquip.length = 0;
	var eq = player.ship.equipment;
	for (var i = 0; i &lt; eq.length; i++) {
		this._currEquip.push(eq[i].equipmentKey);
	}
}

//-------------------------------------------------------------------------------------------------------------
this.shipDied = function (whom, why) {
	this.$stopTimers();
}

//-------------------------------------------------------------------------------------------------------------
this.missionScreenOpportunity = function () {
	// looks like we need to ask the player to remove some equipment
	if (this._promptPlayer === true) {
		this._promptPlayer = false;
		this._page = 0;
		this.$sellEquipment();
	}
}

//-------------------------------------------------------------------------------------------------------------
this.equipmentDamaged = function (equipmentKey) {
	// we&#39;re attaching the equipmentDamaged_Event to the script object of the player, so NPC Equipment failure can be implemented more simply.
	if (player.ship &amp;&amp; player.ship.script) {
		// check to see if we&#39;ve been set up yet
		if (!player.ship.script.$equipmentDamaged_Event) this.$setUpScriptConfig();
		if (player.ship.script.$equipmentDamaged_Event) player.ship.script.$equipmentDamaged_Event(equipmentKey);
	}
}

//-------------------------------------------------------------------------------------------------------------
this.equipmentRepaired = function (equipmentKey) {

	if (this._repairing === true) return;
	if (this._damaging === true) return;

	this._repairing = true;

	// look for cases where equipment was repaired in flight
	var p = player.ship;

	if (equipmentKey === &quot;EQ_HEAT_SINK&quot;) {
		if (p.equipmentStatus(&quot;EQ_HEAT_SINK_CONTROL&quot;) != &quot;EQUIPMENT_OK&quot;) {
			if (worldScripts.ShipConfiguration_HeatSink.controlMode === 0) {
				p.awardEquipment(&quot;EQ_HEAT_SINK_CONTROL&quot;);
			} else {
				p.awardEquipment(&quot;EQ_HEAT_SINK_CONTROL_PASSIVE&quot;);
			}
		}
		this._repairing = false;
		return;
	}

	/*if (p.docked === false) {
		// can&#39;t repair shield boosters until shields are fixed
		if ((equipmentKey === &quot;EQ_NAVAL_SHIELD_BOOSTER&quot; || equipmentKey === &quot;EQ_SHIELD_BOOSTER&quot; || equipmentKey === &quot;EQ_NAVAL_GRID&quot; || equipmentKey === &quot;EQ_ENERGY_GRID&quot;)
			&amp;&amp; (p.equipmentStatus(this.$equipmentItemInUse(&quot;frontshields&quot;, p)) != &quot;EQUIPMENT_OK&quot; || p.equipmentStatus(this.$equipmentItemInUse(&quot;aftshields&quot;, p)) != &quot;EQUIPMENT_OK&quot;)) {
			this._damaging = true;
			p.setEquipmentStatus(equipmentKey, &quot;EQUIPMENT_DAMAGED&quot;);
			this._damaging = false;
			equipmentKey = &quot;&quot;;
		}
		// can&#39;t repair extra energy units until main unit is bank online
		if ((equipmentKey === &quot;EQ_ENERGY_UNIT&quot; || equipmentKey === &quot;EQ_NAVAL_ENERGY_UNIT&quot; || equipmentKey === &quot;EQ_NAVAL_GRID&quot; || equipmentKey === &quot;EQ_ENERGY_GRID&quot;)
			&amp;&amp; p.equipmentStatus(this.$equipmentItemInUse(&quot;energy&quot;, p)) != &quot;EQUIPMENT_OK&quot;) {
			this._damaging = true;
			p.setEquipmentStatus(equipmentKey, &quot;EQUIPMENT_DAMAGED&quot;);
			this._damaging = false;
			equipmentKey = &quot;&quot;;
		}
	} */
	if (this._engines.indexOf(equipmentKey) &gt;= 0) {
		p.maxSpeed = this.$calculatedValue(&quot;speed&quot;, p);
		p.maxThrust = this.$calculatedValue(&quot;thrust&quot;, p);
		p.thrust = p.maxThrust;
	}
	if (this._thrusters.indexOf(equipmentKey) &gt;= 0) {
		p.maxPitch = this.$calculatedValue(&quot;pitch&quot;, p);
		p.maxRoll = this.$calculatedValue(&quot;roll&quot;, p);
	}
	if (this._boosters.indexOf(equipmentKey) &gt;= 0) {
		var boostEq = EquipmentInfo.infoForKey(equipmentKey);
		p.script._boosterHeatPoint = boostEq.scriptInfo.heat_buildup;
		p.maxSpeed = this.$calculatedValue(&quot;speed&quot;, p);
		p.maxThrust = this.$calculatedValue(&quot;thrust&quot;, p);
		p.thrust = p.maxThrust;
		p.maxPitch = this.$calculatedValue(&quot;pitch&quot;, p);
		p.maxRoll = this.$calculatedValue(&quot;roll&quot;, p);
		p.maxYaw = this.$calculatedValue(&quot;yaw&quot;, p);
	}
	if (this._energy.indexOf(equipmentKey) &gt;= 0) {
		p.energyRechargeRate = p.script._energyRechargeRate_Stored;
		p.script._energyRechargeRate_Stored = 0;
	}
	if (this._frontshields.indexOf(equipmentKey) &gt;= 0) {
		p.forwardShieldRechargeRate = p.script._forwardShieldRechargeRate_Stored;
		p.script._forwardShieldRechargeRate_Stored = 0;
		this.$enableShieldOXPs();
	}
	if (this._aftshields.indexOf(equipmentKey) &gt;= 0) {
		p.aftShieldRechargeRate = p.script._aftshieldsRechargeRate_Stored;
		p.script._aftshieldsRechargeRate_Stored = 0;
		this.$enableShieldOXPs();
	}
	if (this._heatshields.indexOf(equipmentKey) &gt;= 0) {
		p.awardEquipment(&quot;EQ_HEAT_SHIELD&quot;);
		var info = EquipmentInfo.infoForKey(equipmentKey);
		var shipspec = Ship.shipDataForKey(p.dataKey);
		var shipdef = 1;
		if (typeof shipspec[&quot;heat_insulation&quot;] != &quot;undefined&quot;) shipdef = parseFloat(shipspec[&quot;heat_insulation&quot;]);
		p.heatInsulation = shipdef + parseFloat(info.scriptInfo.oolite_heat_insulation_strength);
	}
	if (equipmentKey === &quot;EQ_HEAT_SHIELD&quot;) {
		p.setEquipmentStatus(this.$equipmentItemInUse(&quot;heatshields&quot;, p), &quot;EQUIPMENT_OK&quot;);
		var info = EquipmentInfo.infoForKey(equipmentKey);
		p.heatInsulation += info.scriptInfo.oolite_heat_insulation_strength;
	}
	if (this._fuelinjectors.indexOf(equipmentKey) &gt;= 0) {
		// can&#39;t repair injectors until main engines are repaired
		if (p.equipmentStatus(this.$equipmentItemInUse(&quot;engines&quot;, p)) != &quot;EQUIPMENT_OK&quot;) {
			this._damaging = true;
			this._setEquipmentStatus(equipmentKey, &quot;EQUIPMENT_DAMAGED&quot;);
			this._damaging = false;
			this._repairing = false;
			return;
		}
		p.setEquipmentStatus(&quot;EQ_FUEL_INJECTION&quot;, &quot;EQUIPMENT_OK&quot;);
	}
	// special case for when an OXP repairs the fuel injectors directly
	if (equipmentKey === &quot;EQ_FUEL_INJECTION&quot;) {
		p.setEquipmentStatus(this.$equipmentItemInUse(&quot;fuelinjectors&quot;, p), &quot;EQUIPMENT_OK&quot;);
	}
	if (this._fuelscoops.indexOf(equipmentKey) &gt;= 0) {
		p.setEquipmentStatus(&quot;EQ_FUEL_SCOOPS&quot;, &quot;EQUIPMENT_OK&quot;);
	}
	// special case for when an OXP repairs the fuel scoops directly
	if (equipmentKey === &quot;EQ_FUEL_SCOOPS&quot;) {
		p.setEquipmentStatus(this.$equipmentItemInUse(&quot;fuelscoops&quot;, p), &quot;EQUIPMENT_OK&quot;);
	}

	this._repairing = false;
}

//-------------------------------------------------------------------------------------------------------------
this.playerBoughtNewShip = function (ship, price) {
	//log(this.name, &quot;playerBoughtNewShip - &quot; + ship);
	if (this._resprayActive === true) return;
	if (this._simulator === true) return;
	this.$setUpScriptConfig();
	this._current = {};
	this._startUp = true;
	var result = this.$installBaseEquipment(ship);
	this._startUp = false;
	this.equipmentAdded(&quot;&quot;);
}

//-------------------------------------------------------------------------------------------------------------
this.playerBoughtEquipment = function (equipmentKey) {
	if (equipmentKey === &quot;EQ_HEAT_SINK&quot;) {
		if (player.ship.equipmentStatus(&quot;EQ_HEAT_SINK_CONTROL&quot;) != &quot;EQUIPMENT_OK&quot;) {
			worldScripts.ShipConfiguration_HeatSink.controlMode = 0;
			player.ship.awardEquipment(&quot;EQ_HEAT_SINK_CONTROL&quot;);
		}
	}

	this._sellEquipExitScreen === &quot;GUI_SCREEN_EQUIP_SHIP&quot;;

	if (equipmentKey === &quot;EQ_SHIPCONFIG&quot;) {
		player.ship.removeEquipment(equipmentKey);
		this._lastChoice = [&quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;];
		this._source = &quot;&quot;;
		this._display = 0;
		this._page = 0;
		this.$shipConfig();
		return;
	}
	// armour repair handled in it&#39;s own script
	if (equipmentKey.indexOf(&quot;_REPAIR&quot;) &gt;= 0) return;

	if (this._promptPlayer === true) {
		this.missionScreenOpportunity();
	}
}

//-------------------------------------------------------------------------------------------------------------
this.equipmentAdded = function (equipmentKey) {

	//if (this._simulator === true) return;

	// make sure we don&#39;t end up in a perpetual loop
	if (this._startUp === true) return;
	if (this._removing === true) return;
	if (this._adding === true) return;

	// ignore any of the filler items
	if (this._filler.indexOf(equipmentKey) &gt;= 0) return;

	// ignore any removal equipment items
	if (equipmentKey.indexOf(&quot;REMOVE&quot;) &gt; 0 || equipmentKey.indexOf(&quot;REMOVAL&quot;) &gt; 0 || equipmentKey.indexOf(&quot;REFUND&quot;) &gt; 0 ||
		equipmentKey.indexOf(&quot;_DAMAGED&quot;) &gt; 0 || equipmentKey.indexOf(&quot;_REPAIR&quot;) &gt; 0) return;
	if (this._ignoreEquip.indexOf(equipmentKey) &gt;= 0) return;

	this._adding = true;

	var p = player.ship;

	// special cases for the equipment items we&#39;re overriding. If another OXP ever adds these items, we need to also add our specialised item
	if (equipmentKey === &quot;EQ_FUEL_INJECTION&quot; &amp;&amp; p.alertCondition === 0) {
		p.awardEquipment(&quot;EQ_FUEL_INJECTION_TYPE2&quot;);
		this._adding = false;
		return;
	}
	if (equipmentKey === &quot;EQ_HEAT_SHIELD&quot; &amp;&amp; p.alertCondition === 0) {
		p.awardEquipment(&quot;EQ_HEAT_SHIELD_TYPE2&quot;);
		this._adding = false;
		return;
	}
	if (equipmentKey === &quot;EQ_FUEL_SCOOPS&quot; &amp;&amp; p.alertCondition === 0) {
		p.awardEquipment(&quot;EQ_FUEL_SCOOPS_TYPE1&quot;);
		this._adding = false;
		return;
	}

	// ignore anything that&#39;s not visible
	if (equipmentKey != &quot;&quot; &amp;&amp; equipmentKey != &quot;EQ_NO_FORWARD_SHIELD&quot; &amp;&amp; equipmentKey != &quot;EQ_NO_AFT_SHIELD&quot;) {
		var eqinfo = EquipmentInfo.infoForKey(equipmentKey);
		if (eqinfo &amp;&amp; eqinfo.isVisible === false) return;
		if (!eqinfo &amp;&amp; this._debug) log(this.name, &quot;!!ERROR: No equipmentInfo for equipment key &quot; + equipmentKey);
	}
	var stn = p.dockedStation;
	var equipSpace = this.$equipmentSpaceTotal(p);
	var cargoSpace = this.$cargoSpaceAvailable(p);

	// if we&#39;re installing one of the replacement items, make a note of it so we can remove it
	var original = &quot;&quot;;
	var state = &quot;&quot;;
	var originalSpace = 0;
	var applyPF = true;

	if (this._electricalbus.indexOf(equipmentKey) &gt;= 0) {
		var check = &quot;&quot;;
		for (var i = 0; i &lt; this._electricalbus.length; i++) {
			if (this._electricalbus[i] != equipmentKey) {
				check = p.equipmentStatus(this._electricalbus[i]);
				if (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
					original = this._electricalbus[i];
					originalSpace = this._equipmentMatrix[original][0];
					state = check;
				}
			}
		}
	}

	if (this._hyperdrive.indexOf(equipmentKey) &gt;= 0) {
		var check = &quot;&quot;;
		for (var i = 0; i &lt; this._hyperdrive.length; i++) {
			if (this._hyperdrive[i] != equipmentKey) {
				check = p.equipmentStatus(this._hyperdrive[i]);
				if (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
					original = this._hyperdrive[i];
					originalSpace = this._equipmentMatrix[original][0];
					state = check;
				}
			}
		}
	}
	if (this._hdCoupling.indexOf(equipmentKey) &gt;= 0) {
		var check = &quot;&quot;;
		for (var i = 0; i &lt; this._hdCoupling.length; i++) {
			if (this._hdCoupling[i] != equipmentKey) {
				check = p.equipmentStatus(this._hdCoupling[i]);
				if (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
					original = this._hdCoupling[i];
					originalSpace = this._equipmentMatrix[original][0];
					state = check;
				}
			}
		}
	}
	if (this._engines.indexOf(equipmentKey) &gt;= 0) {
		var check = &quot;&quot;;
		for (var i = 0; i &lt; this._engines.length; i++) {
			if (this._engines[i] != equipmentKey) {
				check = p.equipmentStatus(this._engines[i]);
				if (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
					original = this._engines[i];
					originalSpace = this._equipmentMatrix[original][0];
					state = check;
				}
			}
		}
	}
	if (this._enCoupling.indexOf(equipmentKey) &gt;= 0) {
		var check = &quot;&quot;;
		for (var i = 0; i &lt; this._enCoupling.length; i++) {
			if (this._enCoupling[i] != equipmentKey) {
				check = p.equipmentStatus(this._enCoupling[i]);
				if (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
					original = this._enCoupling[i];
					originalSpace = this._equipmentMatrix[original][0];
					state = check;
				}
			}
		}
	}
	if (this._thrusters.indexOf(equipmentKey) &gt;= 0) {
		var check = &quot;&quot;;
		for (var i = 0; i &lt; this._thrusters.length; i++) {
			if (this._thrusters[i] != equipmentKey) {
				check = p.equipmentStatus(this._thrusters[i]);
				if (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
					original = this._thrusters[i];
					originalSpace = this._equipmentMatrix[original][0];
					state = check;
				}
			}
		}
	}
	if (this._thCoupling.indexOf(equipmentKey) &gt;= 0) {
		var check = &quot;&quot;;
		for (var i = 0; i &lt; this._thCoupling.length; i++) {
			if (this._thCoupling[i] != equipmentKey) {
				check = p.equipmentStatus(this._thCoupling[i]);
				if (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
					original = this._thCoupling[i];
					originalSpace = this._equipmentMatrix[original][0];
					state = check;
				}
			}
		}
	}
	if (this._boosters.indexOf(equipmentKey) &gt;= 0) {
		var check = &quot;&quot;;
		for (var i = 0; i &lt; this._boosters.length; i++) {
			if (this._boosters[i] != equipmentKey) {
				check = p.equipmentStatus(this._boosters[i]);
				if (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
					original = this._boosters[i];
					originalSpace = this._equipmentMatrix[original][0];
					state = check;
				}
			}
		}
	}
	if (this._bsCoupling.indexOf(equipmentKey) &gt;= 0) {
		var check = &quot;&quot;;
		for (var i = 0; i &lt; this._bsCoupling.length; i++) {
			if (this._bsCoupling[i] != equipmentKey) {
				check = p.equipmentStatus(this._bsCoupling[i]);
				if (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
					original = this._bsCoupling[i];
					originalSpace = this._equipmentMatrix[original][0];
					state = check;
				}
			}
		}
	}
	if (this._energy.indexOf(equipmentKey) &gt;= 0) {
		var check = &quot;&quot;;
		for (var i = 0; i &lt; this._energy.length; i++) {
			if (this._energy[i] != equipmentKey) {
				check = p.equipmentStatus(this._energy[i]);
				if (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
					original = this._energy[i];
					originalSpace = this._equipmentMatrix[original][0];
					state = check;
				}
			}
		}
	}
	if (this._ebCoupling.indexOf(equipmentKey) &gt;= 0) {
		var check = &quot;&quot;;
		for (var i = 0; i &lt; this._ebCoupling.length; i++) {
			if (this._ebCoupling[i] != equipmentKey) {
				check = p.equipmentStatus(this._ebCoupling[i]);
				if (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
					original = this._ebCoupling[i];
					originalSpace = this._equipmentMatrix[original][0];
					state = check;
				}
			}
		}
	}
	if (this._frontshields.indexOf(equipmentKey) &gt;= 0) {
		var check = &quot;&quot;;
		for (var i = 0; i &lt; this._frontshields.length; i++) {
			if (this._frontshields[i] != equipmentKey) {
				check = p.equipmentStatus(this._frontshields[i]);
				if (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
					original = this._frontshields[i];
					originalSpace = this._equipmentMatrix[original][0];
					state = check;
				}
			}
		}
	}
	if (this._fsCoupling.indexOf(equipmentKey) &gt;= 0) {
		var check = &quot;&quot;;
		for (var i = 0; i &lt; this._fsCoupling.length; i++) {
			if (this._fsCoupling[i] != equipmentKey) {
				check = p.equipmentStatus(this._fsCoupling[i]);
				if (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
					original = this._fsCoupling[i];
					originalSpace = this._equipmentMatrix[original][0];
					state = check;
				}
			}
		}
	}
	if (this._aftshields.indexOf(equipmentKey) &gt;= 0) {
		var check = &quot;&quot;;
		for (var i = 0; i &lt; this._aftshields.length; i++) {
			if (this._aftshields[i] != equipmentKey) {
				check = p.equipmentStatus(this._aftshields[i]);
				if (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
					original = this._aftshields[i];
					originalSpace = this._equipmentMatrix[original][0];
					state = check;
				}
			}
		}
	}
	if (this._asCoupling.indexOf(equipmentKey) &gt;= 0) {
		var check = &quot;&quot;;
		for (var i = 0; i &lt; this._asCoupling.length; i++) {
			if (this._asCoupling[i] != equipmentKey) {
				check = p.equipmentStatus(this._asCoupling[i]);
				if (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
					original = this._asCoupling[i];
					originalSpace = this._equipmentMatrix[original][0];
					state = check;
				}
			}
		}
	}
	if (this._heatshields.indexOf(equipmentKey) &gt;= 0) {
		applyPF = false;
		p.awardEquipment(&quot;EQ_HEAT_SHIELD&quot;);
		var check = &quot;&quot;;
		for (var i = 0; i &lt; this._heatshields.length; i++) {
			if (this._heatshields[i] != equipmentKey) {
				check = p.equipmentStatus(this._heatshields[i]);
				if (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
					original = this._heatshields[i];
					originalSpace = this._equipmentMatrix[original][0];
					state = check;
				}
			}
		}
	}
	if (this._fuelinjectors.indexOf(equipmentKey) &gt;= 0) {
		applyPF = false;
		p.awardEquipment(&quot;EQ_FUEL_INJECTION&quot;);
		var check = &quot;&quot;;
		for (var i = 0; i &lt; this._fuelinjectors.length; i++) {
			if (this._fuelinjectors[i] != equipmentKey) {
				check = p.equipmentStatus(this._fuelinjectors[i]);
				if (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
					original = this._fuelinjectors[i];
					originalSpace = this._equipmentMatrix[original][0];
					state = check;
				}
			}
		}
	}
	if (this._fuelscoops.indexOf(equipmentKey) &gt;= 0) {
		applyPF = false;
		p.awardEquipment(&quot;EQ_FUEL_SCOOPS&quot;);
		var check = &quot;&quot;;
		for (var i = 0; i &lt; this._fuelscoops.length; i++) {
			if (this._fuelscoops[i] != equipmentKey) {
				check = p.equipmentStatus(this._fuelscoops[i]);
				if (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
					original = this._fuelscoops[i];
					originalSpace = this._equipmentMatrix[original][0];
					state = check;
				}
			}
		}
	}
	if (this._frontarmour.indexOf(equipmentKey) &gt;= 0) {
		var check = &quot;&quot;;
		for (var i = 0; i &lt; this._frontarmour.length; i++) {
			if (this._frontarmour[i] != equipmentKey) {
				check = p.equipmentStatus(this._frontarmour[i]);
				if (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
					original = this._frontarmour[i];
					originalSpace = this._equipmentMatrix[original][0];
					state = check;
				}
			}
		}
	}
	if (this._aftarmour.indexOf(equipmentKey) &gt;= 0) {
		var check = &quot;&quot;;
		for (var i = 0; i &lt; this._aftarmour.length; i++) {
			if (this._aftarmour[i] != equipmentKey) {
				check = p.equipmentStatus(this._aftarmour[i]);
				if (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
					original = this._aftarmour[i];
					originalSpace = this._equipmentMatrix[original][0];
					state = check;
				}
			}
		}
	}

	// remove and refund old equipment
	if (original != &quot;&quot;) {
		// is this new or used? idx === -1 means new, otherwise any number &gt;= 0 means used
		var idx = this._currEquip.indexOf(original);
		if (idx &gt;= 0) this._currEquip.splice(idx, 1);

		if (this._freeUpgrades === false) {
			var oldinfo = EquipmentInfo.infoForKey(original);
			var priceFactor = this.$equipmentPriceFactor(p.shipClassName, this.$getShipMass(p));
			if (applyPF === false) priceFactor = 1;
			if (state === &quot;EQUIPMENT_OK&quot;) {
				player.credits += ((oldinfo.price / 10) * priceFactor) * (idx &gt;= 0 ? this._refundPct : 1) * (stn.equivalentTechLevel &gt;= oldinfo.techLevel ? stn.equipmentPriceFactor : 1);
			} else {
				// only refund half if it&#39;s damaged
				player.credits += ((oldinfo.price / 10) * priceFactor) * 0.5 * (stn.equivalentTechLevel &gt;= info.techLevel ? stn.equipmentPriceFactor : 1);
			}
		}
		if (this._debug) log(this.name, &quot;Removing &quot; + original);
		p.removeEquipment(original);
	}

	this.$checkForOverload();

	/*var used = this.$calcEquipmentSpace(p);
	if (used &gt; equipSpace) {
		// allocate cargo space to equipment space
		var diff = parseInt(used - equipSpace);
		if (diff &gt; cargoSpace) {
			// we don&#39;t have space for this
			// switch into &quot;overloaded&quot; mode so the player can choose what item to remove
			this._initialSetup = true;
			this._promptPlayer = true;
		}
	}*/

	this.$addEquipmentSpaceItem(p);
	this._adding = false;
}

//-------------------------------------------------------------------------------------------------------------
this.equipmentRemoved = function (equipmentKey) {

	//if (this._simulator === true) return;

	// make sure we don&#39;t end up in a perpetual loop
	if (this._adding === true) return;
	if (this._removing === true) return;

	// ignore any of the filler items
	if (this._filler.indexOf(equipmentKey) &gt;= 0) return;

	// special case for IronHide Armour - clear out the mission variables as well as the equipment.
	if (equipmentKey === &quot;EQ_IRONHIDE&quot;) {
		missionVariables.ironHide_percentage = 0;
		missionVariables.ironHide_milFlag = 0;
		mission.setInstructionsKey(null, &quot;IronHide Armour Script&quot;);
	}
	// ignore any removal equipment items
	if (equipmentKey.indexOf(&quot;REMOVE&quot;) &gt; 0 || equipmentKey.indexOf(&quot;REMOVAL&quot;) &gt; 0 || equipmentKey.indexOf(&quot;REFUND&quot;) &gt; 0 ||
		equipmentKey.indexOf(&quot;_DAMAGED&quot;) &gt; 0 || equipmentKey.indexOf(&quot;_REPAIR&quot;) &gt; 0) return;

	// armour handled in it&#39;s own script
	if (this._armour.indexOf(equipmentKey) &gt;= 0) return;

	if (equipmentKey === &quot;EQ_HEAT_SINK&quot;) {
		if (player.ship.equipmentStatus(&quot;EQ_HEAT_SINK&quot;) != &quot;EQUIPMENT_OK&quot;) {
			player.ship.removeEquipment(&quot;EQ_HEAT_SINK_CONTROL&quot;);
			player.ship.removeEquipment(&quot;EQ_HEAT_SINK_CONTROL_PASSIVE&quot;);
		}
	}

	// special cases for when an OXP removes these items directly
	if (equipmentKey === &quot;EQ_FUEL_INJECTION&quot; &amp;&amp; player.ship.docked) {
		this._removing = true;
		var fieq = this.$equipmentItemInUse(&quot;fuelinjectors&quot;, player.ship);
		if (fieq != &quot;&quot;) player.ship.removeEquipment(fieq);
		this._removing = false;
		return;
	}
	if (equipmentKey === &quot;EQ_FUEL_SCOOPS&quot; &amp;&amp; player.ship.docked) {
		this._removing = true;
		var fseq = this.$equipmentItemInUse(&quot;fuelscoops&quot;, player.ship);
		if (fseq != &quot;&quot;) player.ship.removeEquipment(fseq);
		this._removing = false;
		return;
	}
	if (equipmentKey === &quot;EQ_HEAT_SHIELD&quot; &amp;&amp; player.ship.docked) {
		this._removing = true;
		var hseq = this.$equipmentItemInUse(&quot;heatshields&quot;, player.ship);
		if (hseq != &quot;&quot;) player.ship.removeEquipment(hseq);
		this._removing = false;
		return;
	}

	if (this._ignoreEquip.indexOf(equipmentKey) &gt;= 0) return;
	if (equipmentKey === &quot;EQ_SHIPCONFIG&quot;) return;

	var p = player.ship;

	this._removing = true;

	// if we&#39;re removing fuel injectors, remove the core equipment item as well
	if (this._fuelinjectors.indexOf(equipmentKey) &gt;= 0) {
		p.removeEquipment(&quot;EQ_FUEL_INJECTION&quot;);
	}
	// if we&#39;re removing fuel scoops, remove the core equipment item as well
	if (this._fuelscoops.indexOf(equipmentKey) &gt;= 0) {
		p.removeEquipment(&quot;EQ_FUEL_SCOOPS&quot;);
	}
	// if we&#39;re removing the heat shield, remove the core equipment item as well
	if (this._heatshields.indexOf(equipmentKey) &gt;= 0) {
		p.removeEquipment(&quot;EQ_HEAT_SHIELD&quot;);
	}

	this.$checkForOverload();

	/*var equipSpace = this.$equipmentSpaceTotal(p);
	var cargoSpace = this.$cargoSpaceAvailable(p);// + this.$cargoEquipmentSpaceAmount(p));

	var used = this.$calcEquipmentSpace(p);
	if (used &gt; equipSpace) {
		// allocate cargo space to equipment space
		var diff = parseInt(used - equipSpace);
		if (diff &gt; cargoSpace) {
			// we don&#39;t have space for this
			// switch into &quot;overloaded&quot; mode so the player can choose what item to remove
			this._initialSetup = true;
			this._promptPlayer = true;
		}
	}*/

	this.$addEquipmentSpaceItem(p);
	this._removing = false;
}

//-------------------------------------------------------------------------------------------------------------
this.shipTakingDamage = function (amount, whom, type) {
	// pass energy damage onto the unshielded ship as a heat increase
	if (player.ship &amp;&amp; player.ship.temperature &amp;&amp; type === &quot;energy damage&quot; &amp;&amp; this._heatControl === true &amp;&amp; amount &gt; 0) {
		//if (this._debug) log(this.name, amount + &quot; ... adding to temp (&quot; + player.ship.temperature + &quot;) &quot; + (amount / (player.ship.maxEnergy * player.ship.heatInsulation)));
		var amt = amount / (player.ship.maxEnergy * player.ship.heatInsulation);
		player.ship.temperature += Math.pow((1.1 - player.ship.temperature), 4) * amt;
	}
	// check for bus overload 
	if (this._busProcessing === false &amp;&amp; player.ship &amp;&amp; amount === 0 &amp;&amp; type === &quot;energy damage&quot; &amp;&amp; this._busOverload &gt; 0 &amp;&amp; Math.random() &lt; (this._busOverload / 50)) {
		this._busProcessing = true;
		// the higher the busoverload figure, the more frequently the counter will trip and damage is taken somewhere.
		this._busOverloadCounter += this._busOverload;
		var damaged = false;
		if (this._debug) log(this.name, &quot;bus overload actvated - &quot; + this._busOverloadCounter);
		if (this._busOverloadResetTimer != null &amp;&amp; this._busOverloadResetTimer.isRunning) {
			this._busOverloadResetTimer.stop();
		}
		this._busOverloadResetTimer = new Timer(this, this.$decreaseBusOverload, 30, 30);
		if (this._busOverloadCounter &gt; this._busOverloadLimit) {
			this._busMessageCounter += 1;
			if (this._debug) log(this.name, &quot;bus overload hit limit. messagecounter = &quot; + this._busMessageCounter);
			if (this._debug) log(this.name, &quot;check val = &quot; + ((1 / this._busOverload) * 10));
			// reset the counter a bit, but not back to zero
			this._busOverloadCounter /= 2;
			player.consoleMessage(&quot;Warning! Electrical bus overload!&quot;);
			if (this._busMessageCounter &gt; ((1 / this._busOverload) * 10) &amp;&amp; Math.random() &gt; 0.1) {
				if (this._debug) log(this.name, &quot;**HIT** bus overload damage routine&quot;);
				// fully reset the counter now
				this._busMessageCounter = 0;
				// ok time to damage a piece of equipment
				var count = 0;
				var p = player.ship;
				var eq = p.equipment;
				// try 5 times to find an undamaged piece of kit that can be damaged and isn&#39;t already
				do {
					count += 1;
					var idx = Math.floor(Math.random() * eq.length);
					if (eq[idx].isVisible &amp;&amp; eq[idx].damageProbability != 0 &amp;&amp; p.equipmentStatus(eq[idx].equipmentKey) === &quot;EQUIPMENT_OK&quot;) {
						// make sure the armour doesn&#39;t auto-fix the equipment we&#39;re about to damage (it shouldn&#39;t, but just in case)
						worldScripts.ShipConfiguration_Armour._override = true;
						player.consoleMessage(&quot;Warning! Power surge! &quot; + eq[idx].name + &quot; damaged!&quot;);
						p.setEquipmentStatus(eq[idx].equipmentKey, &quot;EQUIPMENT_DAMAGED&quot;);
						if (this._debug) log(this.name, &quot;bus overload equipment damage on &quot; + eq[idx].equipmentKey);
						worldScripts.ShipConfiguration_Armour._override = false;
						break;
					}
				} while (count &lt; 5);
			}
		}
		this._busProcessing = false;
	}
}

//-------------------------------------------------------------------------------------------------------------
this.playerStartedJumpCountdown = function (type, seconds) {
	// abort the countdown if the equipment is damaged
	if (type === &quot;standard&quot;) {
		var p = player.ship;
		var hd = this.$equipmentItemInUse(&quot;hyperdrive&quot;, p);
		if (p.equipmentStatus(hd) === &quot;EQUIPMENT_DAMAGED&quot;) {
			p.hyperspaceSpinTime = 50;
			if (Math.random() &gt; 0.3) {
				// sometimes just cancel the countdown
				p.cancelHyperspaceCountdown();
				player.consoleMessage(&quot;Hyperspace countdown terminated - failed to engage.&quot;);
			} else if (Math.random() &gt; 0.3) {
				// and sometimes force a misjump
				p.scriptedMisjump = true;
			}

		// don&#39;t try to reset this here if the equipment isn&#39;t damaged
		// assume the correct spin time was set on launch
		/*} else {
			// make sure we get the right spin time for the class of drive
			// just in case something overwrites the value
			var info = EquipmentInfo.infoForKey(hd);
			p.hyperspaceSpinTime = parseInt(info.scriptInfo.spin_time);*/
		}
	}
}

//-------------------------------------------------------------------------------------------------------------
// this will adjust the specs of the player ship whenever missiles are launched (making the ship lighter),
this.shipFiredMissile = function (missile, target) {
	this.$updateShipSpecs(player.ship);
}

//-------------------------------------------------------------------------------------------------------------
// this will adjust the specs of the player ship whenever cargo or a standard escape pod is scooped (making the ship heavier),
this.shipScoopedOther = function (whom) {
	this.$updateShipSpecs(player.ship);
}

//-------------------------------------------------------------------------------------------------------------
this.shipWillLaunchFromStation = function (station) {
	var p = player.ship;
	this._counter = 0;
	this.$updateShipSpecs(p);
	var energyeq = this.$equipmentItemInUse(&quot;energy&quot;, p);
	if (energyeq != &quot;&quot; &amp;&amp; p.equipmentStatus(energyeq) === &quot;EQUIPMENT_DAMAGED&quot;) {
		//if (this._debug) log(this.name, &quot;!!ALERT: Energy equipment &quot; + energyeq + &quot; reported as damaged&quot;);
		if (!p.script._energyTimer || !p.script._energyTimer.isRunning) {
			//if (this._debug) log(this.name, &quot;!!NOTE: Starting timer to drain energy&quot;);
			p.script._energyTimer = new Timer(this, p.script.$checkRemainingEnergy, 1, 1);
		}
	}
	this._busOverload = this.$busOverloadChance(p);
	// store it in a script value for easy pickup by heat routine
	p.script._busOverload = this._busOverload;
	// store the amount of equip extensions installed as this will result in more heat as well
	p.script._equipExt = this.$getEquipmentExtensions(p);
	// store values from any equipment items that increase cabin temp
	p.script._equipmentClassHeat = 0;
	var eqlist = p.equipment;
	for (var i = 0; i &lt; eqlist.length; i++) {
		var eq = eqlist[i];
		if (this._equipHeatList[eq.equipmentKey]) p.script._equipmentClassHeat += this._equipHeatList[eq.equipmentKey];
	}
	//log(this.name, &quot;final class heat = &quot; + p.script._equipmentClassHeat);
	if (p.temperature &lt; (0.234375 + (p.script._busOverload / 100) + (p.script._equipExt / 100) + p.script._equipmentClassHeat)) {
		p.temperature = 0.234375 + (p.script._busOverload / 100) + (p.script._equipExt / 100) + p.script._equipmentClassHeat;
	}
}

//-------------------------------------------------------------------------------------------------------------
// check when the player launches if this is a simulator run
this.shipLaunchedFromStation = function (station) {
	if (this.$simulatorRunning()) this._simulator = true;
}

//-------------------------------------------------------------------------------------------------------------
this.shipWillDockWithStation = function (station) {
	if (this._simulator === true) this.$removeEquipSpaceItem();
}

//-------------------------------------------------------------------------------------------------------------
// this will adjust the specs of the player ship whenever cargo is dumped (making the ship lighter) (pre v1.84)
this.shipSpawned = function (ship) {
	// did the player just dump cargo?
	var p = player.ship;
	if (p &amp;&amp; ship &amp;&amp; ship.isCargo &amp;&amp; ship.position &amp;&amp; p.position &amp;&amp; p.position.distanceTo(ship) &lt; 300) {
		this.$updateShipSpecs(p);
	}
}

//-------------------------------------------------------------------------------------------------------------
// this will adjust the specs of the player ship whenever cargo is dumped (making the ship lighter) (post v1.84)
this.shipDumpedCargo = function(cargo) {
	this.$updateShipSpecs(player.ship);
}

//-------------------------------------------------------------------------------------------------------------
this.guiScreenChanged = function (to, from) {
	if (guiScreen === &quot;GUI_SCREEN_SHIPYARD&quot; &amp;&amp; this._hyperHangar === true) {
		this._hyperHangarTimer = new Timer(this, this.$updateHyperHangarShipImage, 1, 0);
	}
	if (guiScreen === &quot;GUI_SCREEN_MISSION&quot; &amp;&amp; mission.screenID === &quot;HyperspaceHangar&quot; &amp;&amp; this._hyperHangarActive === false) {
		this._hyperHangarActive = true;
		this.$preResprayFunction();
	}
	if (player.ship.docked === true &amp;&amp; guiScreen !== &quot;GUI_SCREEN_EQUIP_SHIP&quot;) {
		this.$checkForOverload();
	}
}

//-------------------------------------------------------------------------------------------------------------
this.guiScreenWillChange = function (to, from) {
	if (to === &quot;GUI_SCREEN_STATUS&quot; &amp;&amp; this._simulator === true) {
		this._simulator = false;
		this._startUp = true;
		this.$postResprayFunction();
	}
}

//-------------------------------------------------------------------------------------------------------------
this.missionScreenEnded = function () {
	if (this._configScreen) {
		this._configScreen = false;
		player.ship.hudHidden = false;
	}
	if (this._hyperHangarActive === true) {
		this.$postResprayFunction();
		this._hyperHangarActive = false;
	}
}

//=============================================================================================================
// interface screens

//-------------------------------------------------------------------------------------------------------------
// initialise the equipment specification list
this.$initInterface = function $initInterface(station) {
	if (station.isPolice) {
		// disable ship config at police/navy stations
		station.setInterface(this.name, null);
	} else {
		station.setInterface(this.name, {
			title: &quot;View equipment specifications&quot;,
			category: &quot;Ship Systems&quot;,
			summary: &quot;Lists all equipment and the space/weight requirements for each.&quot;,
			callback: this.$openEquipmentListing.bind(this)
		});
	}
}

//-------------------------------------------------------------------------------------------------------------
this.$openEquipmentListing = function $openEquipmentListing() {
	this._page = 0;
	this.$equipmentListing();
}

//-------------------------------------------------------------------------------------------------------------
this.$equipmentListing = function $equipmentListing() {
	function compare(a, b) {
		return ((a.name &gt; b.name) ? 1 : -1);
	}

	var list = [];
	var curChoices = {};
	var text = &quot;&quot;;
	var pagesize = 14;
	if (player.ship.hudHidden === true || this.$isBigGuiActive() === true) pagesize = 20;

	var spc = String.fromCharCode(31) + String.fromCharCode(31) + String.fromCharCode(31);
	var def = &quot;99_EXIT&quot;;
	var col1 = 15;
	var col2 = 4;

	//text += &quot;Equipment available at this station:\n&quot;;
	text += this.$padTextRight(&quot;&quot;, col1 + col2) + this.$padTextLeft(&quot;Equip&quot;, col2) + this.$padTextLeft(&quot;Cargo&quot;, col2) + &quot;\n&quot;;
	text += this.$padTextRight(&quot;Equipment item&quot;, col1) +
		this.$padTextLeft(&quot;TL&quot;, col2) +
		this.$padTextLeft(&quot;space&quot;, col2) +
		this.$padTextLeft(&quot;space&quot;, col2) +
		this.$padTextLeft(&quot;Weight&quot;, col2) + &quot;\n\n&quot;;

	var eqlist = EquipmentInfo.allEquipment;
	for (var i = 0; i &lt; eqlist.length; i++) {
		var eq = eqlist[i];
		//if (eq.name === &quot;GalCop Scanner&quot;) log(this.name, &quot;eq &quot; + eq.equipmentKey);
		// skip any &quot;repair&quot; or &quot;removal&quot; equipment items
		if ((eq.equipmentKey.indexOf(&quot;REPAIR&quot;) &gt;= 0 &amp;&amp; eq.equipmentKey != &quot;EQ_REPAIRBOTS_MINE&quot; &amp;&amp; eq.equipmentKey != &quot;EQ_REPAIRBOTS_CONTROLLER&quot; &amp;&amp; eq.equipmentKey != &quot;EQ_REPAIRBOTS_RECHARGE&quot;) ||
			eq.equipmentKey.indexOf(&quot;REMOVE&quot;) &gt;= 0 || eq.equipmentKey.indexOf(&quot;REMOVAL&quot;) &gt;= 0 || eq.equipmentKey.indexOf(&quot;REFUND&quot;) &gt;= 0 || eq.equipmentKey.indexOf(&quot;_SALVAGED&quot;) &gt;= 0 ||
			eq.name.indexOf(&quot;(RRS discount)&quot;) &gt;= 0 || eq.equipmentKey === &quot;EQ_MILITARY_JAMMER&quot; || eq.equipmentKey === &quot;EQ_MILITARY_SCANNER_FILTER&quot; ||
			eq.equipmentKey.indexOf(&quot;EQ_CRIPPLED&quot;) &gt;= 0) continue;

		// system.info.techlevel &gt;= eq.techLevel &amp;&amp; 
		if (this._ignoreEquip.indexOf(eq.equipmentKey) === -1 &amp;&amp; eq.isVisible === true &amp;&amp; eq.techLevel &lt;= 16 &amp;&amp; eq.isAvailableToPlayer) {
			// is this item already in the list?
			var found = false;
			for (var j = 0; j &lt; list.length; j++) {
				if (list[j].name === eq.name) found = true;
			}
			if (found === true) continue;

			var space = 0;
			var weight = 0;
			var cargo = 0;
			var lookup = this._equipmentMatrix[eq.equipmentKey];
			if (lookup) {
				space = lookup[0];
				weight = lookup[1];
				cargo = eq.requiredCargoSpace;
			} else {
				if (this._debug) log(this.name, &quot;!!NOTE: Equipment item not found &quot; + eq.equipmentKey);
				if (eq.requiredCargoSpace === 0) {
					space = 1;
					weight = 1;
					cargo = 0;
				} else {
					space = 0;
					cargo = eq.requiredCargoSpace;
					weight = eq.requiredCargoSpace;
				}
			}
			if (space &gt; 0 || weight &gt; 0) {
				list.push({
					name: eq.name,
					tl: (parseInt(eq.techLevel) + 1).toString(),
					space: space,
					weight: weight,
					cargo: cargo
				});
			}
		}
	}
	list.sort(compare);

	var maxpage = Math.ceil(list.length / (pagesize));
	var end = ((this._page * (pagesize)) + (pagesize));
	if (end &gt; list.length) end = list.length;
	for (var i = (this._page * (pagesize)); i &lt; end; i++) {
		text += this.$padTextRight(list[i].name, col1) +
			this.$padTextLeft(list[i].tl, col2) +
			this.$padTextLeft(list[i].space.toFixed(1) + spc + &quot;t&quot;, col2) +
			this.$padTextLeft(list[i].cargo.toFixed(1) + spc + &quot;t&quot;, col2) +
			this.$padTextLeft(list[i].weight.toFixed(1) + spc + &quot;t&quot;, col2) + &quot;\n&quot;;
	}

	if (maxpage &gt; 1 &amp;&amp; this._page &lt; (maxpage - 1)) {
		curChoices[&quot;95_NEXT&quot;] = {
			text: &quot;[sc-nextpage]&quot;,
			color: this._itemColor
		};
	} else {
		curChoices[&quot;95_NEXT&quot;] = {
			text: &quot;[sc-nextpage]&quot;,
			color: this._disabledColor,
			unselectable: true
		};
	}
	if (this._page &gt; 0) {
		curChoices[&quot;96_PREV&quot;] = {
			text: &quot;[sc-prevpage]&quot;,
			color: this._itemColor
		};
	} else {
		curChoices[&quot;96_PREV&quot;] = {
			text: &quot;[sc-prevpage]&quot;,
			color: this._disabledColor,
			unselectable: true
		};
	}

	curChoices[&quot;99_EXIT&quot;] = {
		text: &quot;[sc-return]&quot;,
		color: this._itemColor
	};

	if (this._lastChoice[24] != &quot;&quot;) def = this._lastChoice[24];

	var opts = {
		screenID: &quot;oolite-shipconfig-equipmentlist-map&quot;,
		title: &quot;Equipment Specifications - Page &quot; + (parseInt(this._page) + 1) + &quot; of &quot; + maxpage,
		overlay: {
			name: &quot;shipconfig_rocket.png&quot;,
			height: 546
		},
		allowInterrupt: true,
		exitScreen: &quot;GUI_SCREEN_INTERFACES&quot;,
		choices: curChoices,
		initialChoicesKey: def,
		message: text
	};

	mission.runScreen(opts, this.$equipmentListScreenHandler, this);
}

//-------------------------------------------------------------------------------------------------------------
this.$equipmentListScreenHandler = function $equipmentListScreenHandler(choice) {

	if (!choice) return;

	if (choice === &quot;95_NEXT&quot;) this._page += 1;
	if (choice === &quot;96_PREV&quot;) this._page -= 1;
	this._lastChoice[24] = choice;

	if (choice != &quot;99_EXIT&quot;) {
		this.$equipmentListing();
	}
}

//-------------------------------------------------------------------------------------------------------------
this.$shipConfig = function $shipConfig() {
	function compare(a, b) {
		if (a.space != b.space) {
			return b.space - a.space;
		} else if (a.cargo != b.cargo) {
			return b.cargo - a.cargo;
		} else if (a.weight != b.weight) {
			return b.weight - a.weight;
		} else {
			return a.name &gt; b.name;
		}
	}

	var p = player.ship;
	var stn = p.dockedStation;
	var used = this.$calcEquipmentSpace(p);
	var maxSpace = Math.ceil(this.$equipmentSpaceTotal(p) + this.$cargoSpaceAvailable(p));
	var spc = String.fromCharCode(31) + String.fromCharCode(31) + String.fromCharCode(31);
	var curr = this._currEquip;

	var priceFactor = this.$equipmentPriceFactor(p.shipClassName, this.$getShipMass(p));

	var col1 = 19;
	var col2 = 3.5;
	var col3 = 6;

	var interrupt = true;
	var text = &quot;&quot;;
	var curChoices = {};
	var itemcount = 0;

	var pagesize = 22;
	if (this.$isBigGuiActive() === false) p.hudHidden = true;
	this._configScreen = true;

	var def = &quot;99_EXIT&quot;;
	text += this.$pageHeader(&quot;config&quot;);

	// display the list of options
	if (used &gt; maxSpace) {
		// make sure we don&#39;t lock the player in during flight
		if (p.alertCondition === 0) {
			interrupt = false; // set to false to force the player to sell equipment before continuing
		}
	} else {
		this._initialSetup = false;
	}

	if (this._display === 0) {
		text += this.$padTextRight(expandDescription(&quot;[sc-mainmenu]&quot;), col1) + this.$padTextLeft(&quot;Equip&quot;, col2) + &quot;\n&quot;;
		text += this.$padTextRight(expandDescription(&quot;[sc-menudescription]&quot;), col1) +
			this.$padTextLeft(&quot;space&quot;, col2) +
			this.$padTextLeft(&quot;Weight&quot;, col2);

		var itemcolor = this._menuColor;
		if (p.equipmentStatus(this.$equipmentItemInUse(&quot;engines&quot;, p)) === &quot;EQUIPMENT_DAMAGED&quot;) itemcolor = this._damagedColor;
		curChoices[&quot;01_ENGINES&quot;] = {
			text: this.$padTextRight(&quot;Engines (Class &quot; + this.$equipmentItemInUse(&quot;engines&quot;, p).replace(&quot;EQ_ENGINE_TYPE&quot;, &quot;&quot;) + &quot;)&quot;, col1) + this.$padTextLeft(this.$equipmentSpaceInUse(&quot;engines&quot;, p).toFixed(1) + spc + &quot;t&quot;, col2) + this.$padTextLeft(this.$equipmentWeightInUse(&quot;engines&quot;, p).toFixed(1) + spc + &quot;t&quot;, col2),
			alignment: &quot;LEFT&quot;,
			color: itemcolor
		};
		if (this.$shipHasHyperspaceMotor(p.dataKey) === true &amp;&amp; this._OXPHyperdrives === false) {
			itemcolor = this._menuColor;
			if (p.equipmentStatus(this.$equipmentItemInUse(&quot;hyperdrive&quot;, p)) === &quot;EQUIPMENT_DAMAGED&quot;) itemcolor = this._damagedColor;
			curChoices[&quot;02_HYPERDRIVE&quot;] = {
				text: this.$padTextRight(&quot;Hyperdrive (Class &quot; + this.$equipmentItemInUse(&quot;hyperdrive&quot;, p).replace(&quot;EQ_HYPERDRIVE_TYPE&quot;, &quot;&quot;) + &quot;)&quot;, col1) + this.$padTextLeft(this.$equipmentSpaceInUse(&quot;hyperdrive&quot;, p).toFixed(1) + spc + &quot;t&quot;, col2) + this.$padTextLeft(this.$equipmentWeightInUse(&quot;hyperdrive&quot;, p).toFixed(1) + spc + &quot;t&quot;, col2),
				alignment: &quot;LEFT&quot;,
				color: itemcolor
			};
		}
		var itemcolor = this._menuColor;
		if (p.equipmentStatus(this.$equipmentItemInUse(&quot;thrusters&quot;, p)) === &quot;EQUIPMENT_DAMAGED&quot;) itemcolor = this._damagedColor;
		curChoices[&quot;03_THRUSTERS&quot;] = {
			text: this.$padTextRight(&quot;Manoeuvring Thrusters (Class &quot; + this.$equipmentItemInUse(&quot;thrusters&quot;, p).replace(&quot;EQ_THRUSTERS_TYPE&quot;, &quot;&quot;) + &quot;)&quot;, col1) + this.$padTextLeft(this.$equipmentSpaceInUse(&quot;thrusters&quot;, p).toFixed(1) + spc + &quot;t&quot;, col2) + this.$padTextLeft(this.$equipmentWeightInUse(&quot;thrusters&quot;, p).toFixed(1) + spc + &quot;t&quot;, col2),
			alignment: &quot;LEFT&quot;,
			color: itemcolor
		};

		if (this._heatControl === true) {
			var itemcolor = this._menuColor;
			var bs = this.$equipmentItemInUse(&quot;boosters&quot;, p);
			if (bs != &quot;&quot;) {
				if (p.equipmentStatus(bs) === &quot;EQUIPMENT_DAMAGED&quot;) itemcolor = this._damagedColor;
				curChoices[&quot;03A_BOOSTERS&quot;] = {
					text: this.$padTextRight(&quot;Boosters (Class &quot; + this.$equipmentItemInUse(&quot;boosters&quot;, p).replace(&quot;EQ_BOOSTERS_TYPE&quot;, &quot;&quot;) + &quot;)&quot;, col1) + this.$padTextLeft(this.$equipmentSpaceInUse(&quot;boosters&quot;, p).toFixed(1) + spc + &quot;t&quot;, col2) + this.$padTextLeft(this.$equipmentWeightInUse(&quot;boosters&quot;, p).toFixed(1) + spc + &quot;t&quot;, col2),
					alignment: &quot;LEFT&quot;,
					color: itemcolor
				};
			} else {
				curChoices[&quot;03A_BOOSTERS&quot;] = {
					text: this.$padTextRight(&quot;Boosters (None)&quot;, col1) + this.$padTextLeft(&quot;0.0&quot; + spc + &quot;t&quot;, col2) + this.$padTextLeft(&quot;0.0&quot; + spc + &quot;t&quot;, col2),
					alignment: &quot;LEFT&quot;,
					color: itemcolor
				};
			}
		}

		var itemcolor = this._menuColor;
		if (p.equipmentStatus(this.$equipmentItemInUse(&quot;energy&quot;, p)) === &quot;EQUIPMENT_DAMAGED&quot;) itemcolor = this._damagedColor;
		curChoices[&quot;04_ENERGY&quot;] = {
			text: this.$padTextRight(&quot;Energy Banks (Class &quot; + this.$equipmentItemInUse(&quot;energy&quot;, p).replace(&quot;EQ_ENERGYBANK_TYPE&quot;, &quot;&quot;) + &quot;)&quot;, col1) + this.$padTextLeft(this.$equipmentSpaceInUse(&quot;energy&quot;, p).toFixed(1) + spc + &quot;t&quot;, col2) + this.$padTextLeft(this.$equipmentWeightInUse(&quot;energy&quot;, p).toFixed(1) + spc + &quot;t&quot;, col2),
			alignment: &quot;LEFT&quot;,
			color: itemcolor
		};
		var itemcolor = this._menuColor;
		var fs = this.$equipmentItemInUse(&quot;frontshields&quot;, p);
		if (fs === &quot;EQ_NO_FORWARD_SHIELD&quot;) {
			curChoices[&quot;05_FRONTSHIELDS&quot;] = {
				text: this.$padTextRight(&quot;Forward Shields (None)&quot;, col1) + this.$padTextLeft(this.$equipmentSpaceInUse(&quot;frontshields&quot;, p).toFixed(1) + spc + &quot;t&quot;, col2) + this.$padTextLeft(this.$equipmentWeightInUse(&quot;frontshields&quot;, p).toFixed(1) + spc + &quot;t&quot;, col2),
				alignment: &quot;LEFT&quot;,
				color: itemcolor
			};
		} else {
			if (p.equipmentStatus(this.$equipmentItemInUse(&quot;frontshields&quot;, p)) === &quot;EQUIPMENT_DAMAGED&quot;) itemcolor = this._damagedColor;
			curChoices[&quot;05_FRONTSHIELDS&quot;] = {
				text: this.$padTextRight(&quot;Forward Shields (Class &quot; + this.$equipmentItemInUse(&quot;frontshields&quot;, p).replace(&quot;EQ_FORWARD_SHIELD_TYPE&quot;, &quot;&quot;) + &quot;)&quot;, col1) + this.$padTextLeft(this.$equipmentSpaceInUse(&quot;frontshields&quot;, p).toFixed(1) + spc + &quot;t&quot;, col2) + this.$padTextLeft(this.$equipmentWeightInUse(&quot;frontshields&quot;, p).toFixed(1) + spc + &quot;t&quot;, col2),
				alignment: &quot;LEFT&quot;,
				color: itemcolor
			};
		}
		var itemcolor = this._menuColor;
		var as = this.$equipmentItemInUse(&quot;aftshields&quot;, p);
		if (as === &quot;EQ_NO_AFT_SHIELD&quot;) {
			curChoices[&quot;06_AFTSHIELDS&quot;] = {
				text: this.$padTextRight(&quot;Aft Shields (None)&quot;, col1) + this.$padTextLeft(this.$equipmentSpaceInUse(&quot;aftshields&quot;, p).toFixed(1) + spc + &quot;t&quot;, col2) + this.$padTextLeft(this.$equipmentWeightInUse(&quot;aftshields&quot;, p).toFixed(1) + spc + &quot;t&quot;, col2),
				alignment: &quot;LEFT&quot;,
				color: itemcolor
			};
		} else {
			if (p.equipmentStatus(this.$equipmentItemInUse(&quot;aftshields&quot;, p)) === &quot;EQUIPMENT_DAMAGED&quot;) itemcolor = this._damagedColor;
			curChoices[&quot;06_AFTSHIELDS&quot;] = {
				text: this.$padTextRight(&quot;Aft Shields (Class &quot; + this.$equipmentItemInUse(&quot;aftshields&quot;, p).replace(&quot;EQ_AFT_SHIELD_TYPE&quot;, &quot;&quot;) + &quot;)&quot;, col1) + this.$padTextLeft(this.$equipmentSpaceInUse(&quot;aftshields&quot;, p).toFixed(1) + spc + &quot;t&quot;, col2) + this.$padTextLeft(this.$equipmentWeightInUse(&quot;aftshields&quot;, p).toFixed(1) + spc + &quot;t&quot;, col2),
				alignment: &quot;LEFT&quot;,
				color: itemcolor
			};
		}
		var itemcolor = this._menuColor;
		var fi = this.$equipmentItemInUse(&quot;fuelinjectors&quot;, p);
		if (fi != &quot;&quot;) {
			if (p.equipmentStatus(fi) === &quot;EQUIPMENT_DAMAGED&quot;) itemcolor = this._damagedColor;
			curChoices[&quot;07_FUELINJECTORS&quot;] = {
				text: this.$padTextRight(&quot;Fuel Injectors (Class &quot; + this.$equipmentItemInUse(&quot;fuelinjectors&quot;, p).replace(&quot;EQ_FUEL_INJECTION_TYPE&quot;, &quot;&quot;) + &quot;)&quot;, col1) + this.$padTextLeft(this.$equipmentSpaceInUse(&quot;fuelinjectors&quot;, p).toFixed(1) + spc + &quot;t&quot;, col2) + this.$padTextLeft(this.$equipmentWeightInUse(&quot;fuelinjectors&quot;, p).toFixed(1) + spc + &quot;t&quot;, col2),
				alignment: &quot;LEFT&quot;,
				color: itemcolor
			};
		} else {
			curChoices[&quot;07_FUELINJECTORS&quot;] = {
				text: this.$padTextRight(&quot;Fuel Injectors (None)&quot;, col1) + this.$padTextLeft(&quot;0.0&quot; + spc + &quot;t&quot;, col2) + this.$padTextLeft(&quot;0.0&quot; + spc + &quot;t&quot;, col2),
				alignment: &quot;LEFT&quot;,
				color: itemcolor
			};
		}
		var itemcolor = this._menuColor;
		var sc = this.$equipmentItemInUse(&quot;fuelscoops&quot;, p);
		if (sc != &quot;&quot;) {
			if (p.equipmentStatus(sc) === &quot;EQUIPMENT_DAMAGED&quot;) itemcolor = this._damagedColor;
			curChoices[&quot;08_FUELSCOOPS&quot;] = {
				text: this.$padTextRight(&quot;Fuel Scoops (Class &quot; + this.$equipmentItemInUse(&quot;fuelscoops&quot;, p).replace(&quot;EQ_FUEL_SCOOPS_TYPE&quot;, &quot;&quot;) + &quot;)&quot;, col1) + this.$padTextLeft(this.$equipmentSpaceInUse(&quot;fuelscoops&quot;, p).toFixed(1) + spc + &quot;t&quot;, col2) + this.$padTextLeft(this.$equipmentWeightInUse(&quot;fuelscoops&quot;, p).toFixed(1) + spc + &quot;t&quot;, col2),
				alignment: &quot;LEFT&quot;,
				color: itemcolor
			};
		} else {
			curChoices[&quot;08_FUELSCOOPS&quot;] = {
				text: this.$padTextRight(&quot;Fuel Scoops (None)&quot;, col1) + this.$padTextLeft(&quot;0.0&quot; + spc + &quot;t&quot;, col2) + this.$padTextLeft(&quot;0.0&quot; + spc + &quot;t&quot;, col2),
				alignment: &quot;LEFT&quot;,
				color: itemcolor
			};
		}
		var itemcolor = this._menuColor;
		var hs = this.$equipmentItemInUse(&quot;heatshields&quot;, p);
		if (hs != &quot;&quot;) {
			if (p.equipmentStatus(hs) === &quot;EQUIPMENT_DAMAGED&quot;) itemcolor = this._damagedColor;
			curChoices[&quot;09_HEATSHIELDS&quot;] = {
				text: this.$padTextRight(&quot;Heat Shields (Class &quot; + hs.replace(&quot;EQ_HEAT_SHIELD_TYPE&quot;, &quot;&quot;) + &quot;)&quot;, col1) + this.$padTextLeft(this.$equipmentSpaceInUse(&quot;heatshields&quot;, p).toFixed(1) + spc + &quot;t&quot;, col2) + this.$padTextLeft(this.$equipmentWeightInUse(&quot;heatshields&quot;, p).toFixed(1) + spc + &quot;t&quot;, col2),
				alignment: &quot;LEFT&quot;,
				color: itemcolor
			};
		} else {
			curChoices[&quot;09_HEATSHIELDS&quot;] = {
				text: this.$padTextRight(&quot;Heat Shields (None)&quot;, col1) + this.$padTextLeft(&quot;0.0&quot; + spc + &quot;t&quot;, col2) + this.$padTextLeft(&quot;0.0&quot; + spc + &quot;t&quot;, col2),
				alignment: &quot;LEFT&quot;,
				color: itemcolor
			};
		}
		var itemcolor = this._menuColor;
		// if player has alternative armour installed, don&#39;t show this item at all
		if (this.$playerHasOtherArmour() === false) {
			var arf = this.$equipmentItemInUse(&quot;frontarmour&quot;, p);
			if (arf != &quot;&quot;) {
				if (p.script._armourFront &lt; 100) itemcolor = this._damagedColor;
				curChoices[&quot;10_ARMOUR_0FRONT&quot;] = {
					text: this.$padTextRight(&quot;Forward Armour Plating (Class &quot; + arf.replace(&quot;EQ_ARMOUR_FORWARD_TYPE&quot;, &quot;&quot;) + &quot;)&quot;, col1) + this.$padTextLeft(&quot;0.0&quot; + spc + &quot;t&quot;, col2) + this.$padTextLeft(this.$equipmentWeightInUse(&quot;frontarmour&quot;, p).toFixed(1) + spc + &quot;t&quot;, col2),
					alignment: &quot;LEFT&quot;,
					color: itemcolor
				};
			} else {
				curChoices[&quot;10_ARMOUR_0FRONT&quot;] = {
					text: this.$padTextRight(&quot;Forward Armour Plating (None)&quot;, col1) + this.$padTextLeft(&quot;0.0&quot; + spc + &quot;t&quot;, col2) + this.$padTextLeft(&quot;0.0&quot; + spc + &quot;t&quot;, col2),
					alignment: &quot;LEFT&quot;,
					color: itemcolor
				};
			}
			var ara = this.$equipmentItemInUse(&quot;aftarmour&quot;, p);
			if (ara != &quot;&quot;) {
				if (p.script._armourAft &lt; 100) itemcolor = this._damagedColor;
				curChoices[&quot;10_ARMOUR_1AFT&quot;] = {
					text: this.$padTextRight(&quot;Aft Armour Plating (Class &quot; + ara.replace(&quot;EQ_ARMOUR_AFT_TYPE&quot;, &quot;&quot;) + &quot;)&quot;, col1) + this.$padTextLeft(&quot;0.0&quot; + spc + &quot;t&quot;, col2) + this.$padTextLeft(this.$equipmentWeightInUse(&quot;aftarmour&quot;, p).toFixed(1) + spc + &quot;t&quot;, col2),
					alignment: &quot;LEFT&quot;,
					color: itemcolor
				};
			} else {
				curChoices[&quot;10_ARMOUR_1AFT&quot;] = {
					text: this.$padTextRight(&quot;Aft Armour Plating (None)&quot;, col1) + this.$padTextLeft(&quot;0.0&quot; + spc + &quot;t&quot;, col2) + this.$padTextLeft(&quot;0.0&quot; + spc + &quot;t&quot;, col2),
					alignment: &quot;LEFT&quot;,
					color: itemcolor
				};
			}
		} else {
			for (var i = 0; i &lt; this._altArmour.length; i++) {
				if (p.equipmentStatus(this._altArmour[i]) === &quot;EQUIPMENT_OK&quot; || p.equipmentStatus(this._altArmour[i]) === &quot;EQUIPMENT_DAMAGED&quot;) {
					var info = EquipmentInfo.infoForKey(this._altArmour[i]);
					var wt = 0;
					if (this._equipmentMatrix[this._altArmour[i]]) wt = this._equipmentMatrix[this._altArmour[i]][1];
					curChoices[&quot;10_ARMOUR&quot;] = {
						text: this.$padTextRight(&quot;Armour (&quot; + info.name + &quot;)&quot;, col1) + this.$padTextLeft(&quot;0.0&quot; + spc + &quot;t&quot;, col2) + this.$padTextLeft(wt.toFixed(1) + spc + &quot;t&quot;, col2),
						alignment: &quot;LEFT&quot;,
						color: this._disabledColor,
						unselectable: true
					};
					break;
				}
			}
		}
		curChoices[&quot;11_ELECTRICAL&quot;] = {
			text: this.$padTextRight(&quot;Electrical Bus/Power Couplings&quot;, col1) + this.$padTextLeft(this.$equipmentSpaceInUse(&quot;electrical&quot;, p).toFixed(1) + spc + &quot;t&quot;, col2) + this.$padTextLeft(this.$equipmentWeightInUse(&quot;electrical&quot;, p).toFixed(1) + spc + &quot;t&quot;, col2),
			alignment: &quot;LEFT&quot;,
			color: this._menuColor
		};

		for (var i = 0; i &lt; (pagesize - (20 - (this.$shipHasHyperspaceMotor(p.dataKey) === true &amp;&amp; this._OXPHyperdrives === false ? 0 : 1))); i++) {
			curChoices[&quot;90_SPACER_&quot; + i] = &quot;&quot;;
		}

		curChoices[&quot;96_VIEWEQUIP&quot;] = {
			text: &quot;[sc-viewinstalled]&quot;,
			color: this._itemColor
		};
		if (worldScripts.EquipmentStorage.$stationHasStorageFacilities(stn) === true) {
			curChoices[&quot;97A_STORAGE&quot;] = {
				text: &quot;[storage-store-equipment]&quot;,
				color: this._itemColor
			};
		} else {
			curChoices[&quot;97A_STORAGE&quot;] = {
				text: &quot;[storage-store-equipment]&quot;,
				color: this._disabledColor,
				unselectable: true
			};
		}
		curChoices[&quot;97_SELL&quot;] = {
			text: &quot;[sc-sellequip]&quot;,
			color: this._itemColor
		};

		// display the list of options
		if (used &gt; maxSpace) {
			curChoices[&quot;99_EXIT&quot;] = {
				text: &quot;[sc-return]&quot;,
				color: this._disabledColor,
				unselectable: true
			};
		} else {
			curChoices[&quot;99_EXIT&quot;] = {
				text: &quot;[sc-return]&quot;,
				color: this._itemColor
			};
		}

		if (this._lastChoice[this._display] != &quot;&quot;) def = this._lastChoice[this._display];

		var opts = {
			screenID: &quot;oolite-shipconfig-main-map&quot;,
			title: &quot;Ship Configuration&quot;,
			allowInterrupt: interrupt,
			exitScreen: &quot;GUI_SCREEN_EQUIP_SHIP&quot;,
			choices: curChoices,
			initialChoicesKey: def,
			message: text
		};
	}

	var list = [];
	var dam = 1;
	var coupling = 0;
	var bus = this.$equipmentCouplingLevelInUse(&quot;electricalbus&quot;, p);
	var section = &quot;&quot;;

	if (this._display === 1) { // engines
		section = &quot;[sc-section-engines]&quot;;
		coupling = this.$equipmentCouplingLevelInUse(&quot;engines&quot;, p);
		for (var i = 0; i &lt; this._engines.length; i++) {
			var eq = this._engines[i];
			var info = EquipmentInfo.infoForKey(eq);
			var idx = curr.indexOf(eq);

			var check = p.equipmentStatus(eq);
			if ((check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) || (stn.equivalentTechLevel &gt;= info.techLevel &amp;&amp; (used + this._equipmentMatrix[eq][0] - this.$equipmentSpaceInUse(&quot;engines&quot;, p)) &lt;= maxSpace)) {
				if (check === &quot;EQUIPMENT_UNAVAILABLE&quot; &amp;&amp; (coupling + 1) &lt; this.$equipmentCouplingRequired(&quot;engines&quot;, eq, p)) check = &quot;UNAVAILABLE&quot;;
				if (check === &quot;EQUIPMENT_UNAVAILABLE&quot; &amp;&amp; (coupling + 1) === this.$equipmentCouplingRequired(&quot;engines&quot;, eq, p)) check = &quot;RISK&quot;;
				dam = 1;
				if (check === &quot;EQUIPMENT_DAMAGED&quot;) dam = 0.5;
				list.push({
					name: info.scriptInfo.short_title,
					extra: info.scriptInfo.description,
					key: eq,
					space: this._equipmentMatrix[eq][0],
					weight: this._equipmentMatrix[eq][1],
					cost: (info.price * dam) * (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot; ? (idx &gt;= 0 ? this._refundPct : 1) * -1 : 1) * (stn.equivalentTechLevel &gt;= info.techLevel ? stn.equipmentPriceFactor : 1) * priceFactor,
					flag: check
				});
			}
		}
	}
	if (this._display === 2) { // hyperdrive
		section = &quot;[sc-section-hyperdrive]&quot;;
		coupling = this.$equipmentCouplingLevelInUse(&quot;hyperdrive&quot;, p);
		for (var i = 0; i &lt; this._hyperdrive.length; i++) {
			var eq = this._hyperdrive[i];
			var info = EquipmentInfo.infoForKey(eq);
			var idx = curr.indexOf(eq);

			var check = p.equipmentStatus(eq);
			if ((check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) || (stn.equivalentTechLevel &gt;= info.techLevel &amp;&amp; (used + this._equipmentMatrix[eq][0] - this.$equipmentSpaceInUse(&quot;hyperdrive&quot;, p)) &lt;= maxSpace)) {
				if (check === &quot;EQUIPMENT_UNAVAILABLE&quot; &amp;&amp; (coupling + 1) &lt; this.$equipmentCouplingRequired(&quot;hyperdrive&quot;, eq, p)) check = &quot;UNAVAILABLE&quot;;
				if (check === &quot;EQUIPMENT_UNAVAILABLE&quot; &amp;&amp; (coupling + 1) === this.$equipmentCouplingRequired(&quot;hyperdrive&quot;, eq, p)) check = &quot;RISK&quot;;
				dam = 1;
				if (check === &quot;EQUIPMENT_DAMAGED&quot;) dam = 0.5;
				list.push({
					name: info.scriptInfo.short_title,
					extra: info.scriptInfo.description,
					key: eq,
					space: this._equipmentMatrix[eq][0],
					weight: this._equipmentMatrix[eq][1],
					cost: (info.price * dam) * (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot; ? (idx &gt;= 0 ? this._refundPct : 1) * -1 : 1) * (stn.equivalentTechLevel &gt;= info.techLevel ? stn.equipmentPriceFactor : 1) * priceFactor,
					flag: check
				});
			}
		}
	}
	if (this._display === 3) { // thrusters
		section = &quot;[sc-section-thrusters]&quot;;
		coupling = this.$equipmentCouplingLevelInUse(&quot;thrusters&quot;, p);
		for (var i = 0; i &lt; this._thrusters.length; i++) {
			var eq = this._thrusters[i];
			var info = EquipmentInfo.infoForKey(eq);
			var idx = curr.indexOf(eq);

			var check = p.equipmentStatus(eq);
			if ((check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) || (stn.equivalentTechLevel &gt;= info.techLevel &amp;&amp; (used + this._equipmentMatrix[eq][0] - this.$equipmentSpaceInUse(&quot;thrusters&quot;, p)) &lt;= maxSpace)) {
				if (check === &quot;EQUIPMENT_UNAVAILABLE&quot; &amp;&amp; (coupling + 1) &lt; this.$equipmentCouplingRequired(&quot;thrusters&quot;, eq, p)) check = &quot;UNAVAILABLE&quot;;
				if (check === &quot;EQUIPMENT_UNAVAILABLE&quot; &amp;&amp; (coupling + 1) === this.$equipmentCouplingRequired(&quot;thrusters&quot;, eq, p)) check = &quot;RISK&quot;;
				dam = 1;
				if (check === &quot;EQUIPMENT_DAMAGED&quot;) dam = 0.5;
				list.push({
					name: info.scriptInfo.short_title,
					extra: info.scriptInfo.description,
					key: eq,
					space: this._equipmentMatrix[eq][0],
					weight: this._equipmentMatrix[eq][1],
					cost: (info.price * dam) * (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot; ? (idx &gt;= 0 ? this._refundPct : 1) * -1 : 1) * (stn.equivalentTechLevel &gt;= info.techLevel ? stn.equipmentPriceFactor : 1) * priceFactor,
					flag: check
				});
			}
		}
	}
	if (this._display === 18) { // boosters
		section = &quot;[sc-section-boosters]&quot;;
		coupling = this.$equipmentCouplingLevelInUse(&quot;boosters&quot;, p);
		var found = false;
		var key = &quot;&quot;;
		for (var i = 0; i &lt; this._boosters.length; i++) {
			if (p.equipmentStatus(this._boosters[i]) === &quot;EQUIPMENT_OK&quot; || p.equipmentStatus(this._boosters[i]) === &quot;EQUIPMENT_DAMAGED&quot;) {
				key = this._boosters[i];
				found = true;
			}
		}
		if (found === true &amp;&amp; EquipmentInfo.infoForKey(key).effectiveTechLevel &lt;= stn.equivalentTechLevel) {
			list.push({
				name: expandDescription(&quot;[sc-remove-boosters]&quot;),
				extra: &quot;&quot;,
				key: &quot;EQ_BOOSTERS_REMOVE&quot;,
				space: 0,
				weight: 0,
				cost: 0,
				flag: &quot;&quot;
			});
		}
		for (var i = 0; i &lt; this._boosters.length; i++) {
			var eq = this._boosters[i];
			var info = EquipmentInfo.infoForKey(eq);
			var idx = curr.indexOf(eq);

			var check = p.equipmentStatus(eq);
			if ((check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) || (stn.equivalentTechLevel &gt;= info.techLevel &amp;&amp; (used + this._equipmentMatrix[eq][0] - this.$equipmentSpaceInUse(&quot;boosters&quot;, p)) &lt;= maxSpace)) {
				if (check === &quot;EQUIPMENT_UNAVAILABLE&quot; &amp;&amp; (coupling + 1) &lt; this.$equipmentCouplingRequired(&quot;boosters&quot;, eq, p)) check = &quot;UNAVAILABLE&quot;;
				if (check === &quot;EQUIPMENT_UNAVAILABLE&quot; &amp;&amp; (coupling + 1) === this.$equipmentCouplingRequired(&quot;boosters&quot;, eq, p)) check = &quot;RISK&quot;;
				dam = 1;
				if (check === &quot;EQUIPMENT_DAMAGED&quot;) dam = 0.5;
				list.push({
					name: info.scriptInfo.short_title,
					extra: info.scriptInfo.description,
					key: eq,
					space: this._equipmentMatrix[eq][0],
					weight: this._equipmentMatrix[eq][1],
					cost: (info.price * dam) * (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot; ? (idx &gt;= 0 ? this._refundPct : 1) * -1 : 1) * (stn.equivalentTechLevel &gt;= info.techLevel ? stn.equipmentPriceFactor : 1) * priceFactor,
					flag: check
				});
			}
		}
	}
	if (this._display === 4) { // energy
		section = &quot;[sc-section-energy]&quot;;
		coupling = this.$equipmentCouplingLevelInUse(&quot;energy&quot;, p);
		for (var i = 0; i &lt; this._energy.length; i++) {
			var eq = this._energy[i];
			var info = EquipmentInfo.infoForKey(eq);
			var idx = curr.indexOf(eq);

			var check = p.equipmentStatus(eq);
			if ((check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) || (stn.equivalentTechLevel &gt;= info.techLevel &amp;&amp; (used + this._equipmentMatrix[eq][0] - this.$equipmentSpaceInUse(&quot;energy&quot;, p)) &lt;= maxSpace)) {
				if (check === &quot;EQUIPMENT_UNAVAILABLE&quot; &amp;&amp; (coupling + 1) &lt; this.$equipmentCouplingRequired(&quot;energy&quot;, eq, p)) check = &quot;UNAVAILABLE&quot;;
				if (check === &quot;EQUIPMENT_UNAVAILABLE&quot; &amp;&amp; (coupling + 1) === this.$equipmentCouplingRequired(&quot;energy&quot;, eq, p)) check = &quot;RISK&quot;;
				dam = 1;
				if (check === &quot;EQUIPMENT_DAMAGED&quot;) dam = 0.5;
				list.push({
					name: info.scriptInfo.short_title,
					extra: info.scriptInfo.description,
					key: eq,
					space: this._equipmentMatrix[eq][0],
					weight: this._equipmentMatrix[eq][1],
					cost: (info.price * dam) * (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot; ? (idx &gt;= 0 ? this._refundPct : 1) * -1 : 1) * (stn.equivalentTechLevel &gt;= info.techLevel ? stn.equipmentPriceFactor : 1) * priceFactor,
					flag: check
				});
			}
		}
	}
	if (this._display === 5) { // front shields
		var startpoint = 0;
		section = &quot;[sc-section-frontshields]&quot;;
		coupling = this.$equipmentCouplingLevelInUse(&quot;frontshields&quot;, p);
		// if any shield boosters are in place, we can&#39;t remove shields
		if (p.equipmentStatus(&quot;EQ_SHIELD_BOOSTER&quot;) === &quot;EQUIPMENT_OK&quot; || p.equipmentStatus(&quot;EQ_NAVAL_SHIELD_BOOSTER&quot;) === &quot;EQUIPMENT_OK&quot;) startpoint = 1;
		for (var i = startpoint; i &lt; this._frontshields.length; i++) {
			var eq = this._frontshields[i];
			var info = EquipmentInfo.infoForKey(eq);
			var idx = curr.indexOf(eq);

			var check = p.equipmentStatus(eq);
			if ((check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) || (stn.equivalentTechLevel &gt;= info.techLevel &amp;&amp; (used + this._equipmentMatrix[eq][0] - this.$equipmentSpaceInUse(&quot;frontshields&quot;, p)) &lt;= maxSpace)) {
				if (check === &quot;EQUIPMENT_UNAVAILABLE&quot; &amp;&amp; (coupling + 1) &lt; this.$equipmentCouplingRequired(&quot;frontshields&quot;, eq, p)) check = &quot;UNAVAILABLE&quot;;
				if (check === &quot;EQUIPMENT_UNAVAILABLE&quot; &amp;&amp; (coupling + 1) === this.$equipmentCouplingRequired(&quot;frontshields&quot;, eq, p)) check = &quot;RISK&quot;;
				dam = 1;
				if (check === &quot;EQUIPMENT_DAMAGED&quot;) dam = 0.5;
				list.push({
					name: info.scriptInfo.short_title,
					extra: info.scriptInfo.description,
					key: eq,
					space: this._equipmentMatrix[eq][0],
					weight: this._equipmentMatrix[eq][1],
					cost: (info.price * dam) * (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot; ? (idx &gt;= 0 ? this._refundPct : 1) * -1 : 1) * (stn.equivalentTechLevel &gt;= info.techLevel ? stn.equipmentPriceFactor : 1) * priceFactor,
					flag: check
				});
			}
		}
	}
	if (this._display === 6) { // aft shields
		var startpoint = 0;
		section = &quot;[sc-section-aftshields]&quot;;
		coupling = this.$equipmentCouplingLevelInUse(&quot;aftshields&quot;, p);
		// if any shield boosters are in place, we can&#39;t remove shields
		if (p.equipmentStatus(&quot;EQ_SHIELD_BOOSTER&quot;) === &quot;EQUIPMENT_OK&quot; || p.equipmentStatus(&quot;EQ_NAVAL_SHIELD_BOOSTER&quot;) === &quot;EQUIPMENT_OK&quot;) startpoint = 1;
		for (var i = startpoint; i &lt; this._aftshields.length; i++) {
			var eq = this._aftshields[i];
			var info = EquipmentInfo.infoForKey(eq);
			var idx = curr.indexOf(eq);

			var check = p.equipmentStatus(eq);
			if ((check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) || (stn.equivalentTechLevel &gt;= info.techLevel &amp;&amp; (used + this._equipmentMatrix[eq][0] - this.$equipmentSpaceInUse(&quot;aftshields&quot;, p)) &lt;= maxSpace)) {
				if (check === &quot;EQUIPMENT_UNAVAILABLE&quot; &amp;&amp; (coupling + 1) &lt; this.$equipmentCouplingRequired(&quot;aftshields&quot;, eq, p)) check = &quot;UNAVAILABLE&quot;;
				if (check === &quot;EQUIPMENT_UNAVAILABLE&quot; &amp;&amp; (coupling + 1) === this.$equipmentCouplingRequired(&quot;aftshields&quot;, eq, p)) check = &quot;RISK&quot;;
				dam = 1;
				if (check === &quot;EQUIPMENT_DAMAGED&quot;) dam = 0.5;
				list.push({
					name: info.scriptInfo.short_title,
					extra: info.scriptInfo.description,
					key: eq,
					space: this._equipmentMatrix[eq][0],
					weight: this._equipmentMatrix[eq][1],
					cost: (info.price * dam) * (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot; ? (idx &gt;= 0 ? this._refundPct : 1) * -1 : 1) * (stn.equivalentTechLevel &gt;= info.techLevel ? stn.equipmentPriceFactor : 1) * priceFactor,
					flag: check
				});
			}
		}
	}
	if (this._display === 7) { // fuel injectors
		// inject a &quot;remove&quot; item into the list
		// do we have any injectors?
		section = &quot;[sc-section-fuelinjectors]&quot;;
		coupling = this.$equipmentCouplingLevelInUse(&quot;engines&quot;, p);
		var found = false;
		var key = &quot;&quot;;
		for (var i = 0; i &lt; this._fuelinjectors.length; i++) {
			if (p.equipmentStatus(this._fuelinjectors[i]) === &quot;EQUIPMENT_OK&quot; || p.equipmentStatus(this._fuelinjectors[i]) === &quot;EQUIPMENT_DAMAGED&quot;) {
				found = true;
				key = this._fuelinjectors[i];
			}
		}
		if (found === true &amp;&amp; EquipmentInfo.infoForKey(key).effectiveTechLevel &lt;= stn.equivalentTechLevel) {
			list.push({
				name: expandDescription(&quot;[sc-remove-fuelinjectors]&quot;),
				extra: &quot;&quot;,
				key: &quot;EQ_FUEL_INJECTION_REMOVE&quot;,
				space: 0,
				weight: 0,
				cost: 0,
				flag: &quot;&quot;
			});
		}
		for (var i = 0; i &lt; this._fuelinjectors.length; i++) {
			var eq = this._fuelinjectors[i];
			var info = EquipmentInfo.infoForKey(eq);
			var idx = curr.indexOf(eq);

			var check = p.equipmentStatus(eq);
			if ((check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) || (stn.equivalentTechLevel &gt;= info.techLevel &amp;&amp; (used + this._equipmentMatrix[eq][0] - this.$equipmentSpaceInUse(&quot;fuelinjectors&quot;, p)) &lt;= maxSpace)) {
				if (check === &quot;EQUIPMENT_UNAVAILABLE&quot; &amp;&amp; (coupling + 1) &lt; this.$equipmentCouplingRequired(&quot;engines&quot;, eq, p)) check = &quot;UNAVAILABLE&quot;;
				if (check === &quot;EQUIPMENT_UNAVAILABLE&quot; &amp;&amp; (coupling + 1) === this.$equipmentCouplingRequired(&quot;engines&quot;, eq, p)) check = &quot;RISK&quot;;
				dam = 1;
				if (check === &quot;EQUIPMENT_DAMAGED&quot;) dam = 0.5;
				list.push({
					name: info.scriptInfo.short_title,
					extra: info.scriptInfo.description,
					key: eq,
					space: this._equipmentMatrix[eq][0],
					weight: this._equipmentMatrix[eq][1],
					cost: (info.price * dam) * (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot; ? (idx &gt;= 0 ? this._refundPct : 1) * -1 : 1) * stn.equipmentPriceFactor,
					flag: check
				});
			}
		}
	}
	if (this._display === 20) { // fuel scoops
		// inject a &quot;remove&quot; item into the list
		// do we have any scoops?
		section = &quot;[sc-section-fuelscoops]&quot;;
		var found = false;
		var key = &quot;&quot;;
		for (var i = 0; i &lt; this._fuelscoops.length; i++) {
			if (p.equipmentStatus(this._fuelscoops[i]) === &quot;EQUIPMENT_OK&quot; || p.equipmentStatus(this._fuelscoops[i]) === &quot;EQUIPMENT_DAMAGED&quot;) {
				found = true;
				key = this._fuelscoops[i];;
			}
		}
		if (found === true &amp;&amp; EquipmentInfo.infoForKey(key).effectiveTechLevel &lt;= stn.equivalentTechLevel) {
			list.push({
				name: expandDescription(&quot;[sc-remove-fuelscoops]&quot;),
				extra: &quot;&quot;,
				key: &quot;EQ_FUEL_SCOOPS_REMOVE&quot;,
				space: 0,
				weight: 0,
				cost: 0,
				flag: &quot;&quot;
			});
		}
		for (var i = 0; i &lt; this._fuelscoops.length; i++) {
			var eq = this._fuelscoops[i];
			var info = EquipmentInfo.infoForKey(eq);
			var idx = curr.indexOf(eq);

			var check = p.equipmentStatus(eq);
			if ((check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) || stn.equivalentTechLevel &gt;= info.techLevel) {
				dam = 1;
				if (check === &quot;EQUIPMENT_DAMAGED&quot;) dam = 0.5;
				list.push({
					name: info.scriptInfo.short_title,
					extra: info.scriptInfo.description,
					key: eq,
					space: this._equipmentMatrix[eq][0],
					weight: this._equipmentMatrix[eq][1],
					cost: (info.price * dam) * (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot; ? (idx &gt;= 0 ? this._refundPct : 1) * -1 : 1) * stn.equipmentPriceFactor,
					flag: check
				});
			}
		}
	}
	if (this._display === 8) { // heat shields
		// inject a &quot;remove&quot; item into the list
		// do we have any heat shielding?
		section = &quot;[sc-section-heatshields]&quot;;
		var found = false;
		var key = &quot;&quot;;
		for (var i = 0; i &lt; this._heatshields.length; i++) {
			if (p.equipmentStatus(this._heatshields[i]) === &quot;EQUIPMENT_OK&quot; || p.equipmentStatus(this._heatshields[i]) === &quot;EQUIPMENT_DAMAGED&quot;) {
				found = true;
				key = this._heatshields[i];
			}
		}
		if (found === true &amp;&amp; EquipmentInfo.infoForKey(key).effectiveTechLevel &lt;= stn.equivalentTechLevel) {
			list.push({
				name: expandDescription(&quot;[sc-remove-heatshields]&quot;),
				extra: &quot;&quot;,
				key: &quot;EQ_HEAT_SHIELD_REMOVE&quot;,
				space: 0,
				weight: 0,
				cost: 0,
				flag: &quot;&quot;
			});
		}
		for (var i = 0; i &lt; this._heatshields.length; i++) {
			var eq = this._heatshields[i];
			var info = EquipmentInfo.infoForKey(eq);
			var idx = curr.indexOf(eq);

			var check = p.equipmentStatus(eq);
			if ((check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) || stn.equivalentTechLevel &gt;= info.techLevel) {
				dam = 1;
				if (check === &quot;EQUIPMENT_DAMAGED&quot;) dam = 0.5;
				list.push({
					name: info.scriptInfo.short_title,
					extra: info.scriptInfo.description,
					key: eq,
					space: this._equipmentMatrix[eq][0],
					weight: this._equipmentMatrix[eq][1],
					cost: (info.price * dam) * (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot; ? (idx &gt;= 0 ? this._refundPct : 1) * -1 : 1) * stn.equipmentPriceFactor,
					flag: check
				});
			}
		}
	}
	if (this._display === 9) { // front armour
		// inject a &quot;remove&quot; item into the list
		// do we have any armour?
		section = &quot;[sc-section-forward-armour]&quot;;
		var found = false;
		var key = &quot;&quot;;
		for (var i = 0; i &lt; this._frontarmour.length; i++) {
			if (p.equipmentStatus(this._frontarmour[i]) === &quot;EQUIPMENT_OK&quot; || p.equipmentStatus(this._frontarmour[i]) === &quot;EQUIPMENT_DAMAGED&quot;) {
				found = true;
				key = this._frontarmour[i];
			}
		}
		if (found === true &amp;&amp; EquipmentInfo.infoForKey(key).effectiveTechLevel &lt;= stn.equivalentTechLevel) {
			list.push({
				name: expandDescription(&quot;[sc-remove-front-armour]&quot;),
				extra: &quot;&quot;,
				key: &quot;EQ_ARMOUR_FORWARD_REMOVE&quot;,
				space: 0,
				weight: 0,
				cost: 0,
				flag: &quot;&quot;
			});
		}
		for (var i = 0; i &lt; this._frontarmour.length; i++) {
			var eq = this._frontarmour[i];
			var info = EquipmentInfo.infoForKey(eq);
			var idx = curr.indexOf(eq);

			var check = p.equipmentStatus(eq);

			if (check === &quot;EQUIPMENT_OK&quot; &amp;&amp; p.script._armourFront &lt; 100) check = &quot;EQUIPMENT_DAMAGED&quot;;

			if ((check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) || stn.equivalentTechLevel &gt;= info.techLevel) {
				dam = 1;
				if (check === &quot;EQUIPMENT_DAMAGED&quot;) dam = 0.5;
				list.push({
					name: info.scriptInfo.short_title,
					extra: info.scriptInfo.description,
					key: eq,
					space: this._equipmentMatrix[eq][0],
					weight: this._equipmentMatrix[eq][1],
					cost: (info.price * dam) * (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot; ? (idx &gt;= 0 ? this._refundPct : 1) * -1 : 1) * (stn.equivalentTechLevel &gt;= info.techLevel ? stn.equipmentPriceFactor : 1) * priceFactor,
					flag: check
				});
			}
		}
	}
	if (this._display === 21) { // aft armour
		// inject a &quot;remove&quot; item into the list
		// do we have any armour?
		section = &quot;[sc-section-aft-armour]&quot;;
		var found = false;
		var key = &quot;&quot;;
		for (var i = 0; i &lt; this._aftarmour.length; i++) {
			if (p.equipmentStatus(this._aftarmour[i]) === &quot;EQUIPMENT_OK&quot; || p.equipmentStatus(this._aftarmour[i]) === &quot;EQUIPMENT_DAMAGED&quot;) {
				found = true;
				key = this._aftarmour[i];
			}
		}
		if (found === true &amp;&amp; EquipmentInfo.infoForKey(key).effectiveTechLevel &lt;= stn.equivalentTechLevel) {
			list.push({
				name: expandDescription(&quot;[sc-remove-aft-armour]&quot;),
				extra: &quot;&quot;,
				key: &quot;EQ_ARMOUR_AFT_REMOVE&quot;,
				space: 0,
				weight: 0,
				cost: 0,
				flag: &quot;&quot;
			});
		}
		for (var i = 0; i &lt; this._aftarmour.length; i++) {
			var eq = this._aftarmour[i];
			var info = EquipmentInfo.infoForKey(eq);
			var idx = curr.indexOf(eq);

			var check = p.equipmentStatus(eq);

			if (check === &quot;EQUIPMENT_OK&quot; &amp;&amp; p.script._armourAft &lt; 100) check = &quot;EQUIPMENT_DAMAGED&quot;;

			if ((check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) || stn.equivalentTechLevel &gt;= info.techLevel) {
				dam = 1;
				if (check === &quot;EQUIPMENT_DAMAGED&quot;) dam = 0.5;
				list.push({
					name: info.scriptInfo.short_title,
					extra: info.scriptInfo.description,
					key: eq,
					space: this._equipmentMatrix[eq][0],
					weight: this._equipmentMatrix[eq][1],
					cost: (info.price * dam) * (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot; ? (idx &gt;= 0 ? this._refundPct : 1) * -1 : 1) * (stn.equivalentTechLevel &gt;= info.techLevel ? stn.equipmentPriceFactor : 1) * priceFactor,
					flag: check
				});
			}
		}
	}

	if (this._display === 11) { // elec bus
		section = &quot;[sc-section-electricalbus]&quot;;
		for (var i = 0; i &lt; this._electricalbus.length; i++) {
			var eq = this._electricalbus[i];
			var info = EquipmentInfo.infoForKey(eq);
			var idx = curr.indexOf(eq);

			var check = p.equipmentStatus(eq);
			if ((check === &quot;EQUIPMENT_OK&quot;) || (stn.equivalentTechLevel &gt;= info.techLevel &amp;&amp; (used + this._equipmentMatrix[eq][0] - this.$equipmentSpaceInUse(&quot;electricalbus&quot;, p)) &lt;= maxSpace)) {
				// check for downgrade case where its not available if a +1 coupling is attached
				if (check === &quot;EQUIPMENT_UNAVAILABLE&quot; &amp;&amp; (i + 1) &lt; bus &amp;&amp; (i + 1) &lt;= (this.$maxEquipmentCouplingInUse(p) - 1)) check = &quot;UNAVAILABLE&quot;;
				list.push({
					name: info.scriptInfo.short_title,
					extra: info.scriptInfo.description,
					key: eq,
					space: this._equipmentMatrix[eq][0],
					weight: this._equipmentMatrix[eq][1],
					cost: info.price * (check === &quot;EQUIPMENT_OK&quot; ? (idx &gt;= 0 ? this._refundPct : 1) * -1 : 1) * (stn.equivalentTechLevel &gt;= info.techLevel ? stn.equipmentPriceFactor : 1) * priceFactor,
					flag: check
				});
			}
		}
	}
	if (this._display === 12) { // engine coupling
		section = &quot;[sc-section-enginecoupling]&quot;;
		for (var i = 0; i &lt; this._enCoupling.length; i++) {
			var eq = this._enCoupling[i];
			var info = EquipmentInfo.infoForKey(eq);
			var idx = curr.indexOf(eq);

			var check = p.equipmentStatus(eq);
			if ((check === &quot;EQUIPMENT_OK&quot;) || (stn.equivalentTechLevel &gt;= info.techLevel &amp;&amp; (used + this._equipmentMatrix[eq][0] - this.$equipmentSpaceInUse(&quot;enginecoupling&quot;, p)) &lt;= maxSpace)) {
				if (check != &quot;EQUIPMENT_OK&quot; &amp;&amp; (bus + 1) &lt; this.$equipmentCouplingRequired(&quot;all&quot;, eq, p)) check = &quot;UNAVAILABLE&quot;;
				if (check != &quot;EQUIPMENT_OK&quot; &amp;&amp; (bus + 1) === this.$equipmentCouplingRequired(&quot;all&quot;, eq, p)) check = &quot;RISK&quot;;
				if (check === &quot;EQUIPMENT_UNAVAILABLE&quot; &amp;&amp; (i + 1) &lt; (this.$equipmentLevelInUse(&quot;engines&quot;, p) - 1)) check = &quot;UNAVAILABLE&quot;;
				list.push({
					name: info.scriptInfo.short_title,
					extra: info.scriptInfo.description,
					key: eq,
					space: this._equipmentMatrix[eq][0],
					weight: this._equipmentMatrix[eq][1],
					cost: info.price * (check === &quot;EQUIPMENT_OK&quot; ? (idx &gt;= 0 ? this._refundPct : 1) * -1 : 1) * (stn.equivalentTechLevel &gt;= info.techLevel ? stn.equipmentPriceFactor : 1) * priceFactor,
					flag: check
				});
			}
		}
	}
	if (this.$shipHasHyperspaceMotor(p.dataKey) === true &amp;&amp; this._OXPHyperdrives === false) { // hyperdrive
		if (this._display === 13) {
			section = &quot;[sc-section-hyperdrivecoupling]&quot;;
			for (var i = 0; i &lt; this._hdCoupling.length; i++) {
				var eq = this._hdCoupling[i];
				var info = EquipmentInfo.infoForKey(eq);
				var idx = curr.indexOf(eq);

				var check = p.equipmentStatus(eq);
				if ((check === &quot;EQUIPMENT_OK&quot;) || (stn.equivalentTechLevel &gt;= info.techLevel &amp;&amp; (used + this._equipmentMatrix[eq][0] - this.$equipmentSpaceInUse(&quot;hyperdrivecoupling&quot;, p)) &lt;= maxSpace)) {
					if (check != &quot;EQUIPMENT_OK&quot; &amp;&amp; (bus + 1) &lt; this.$equipmentCouplingRequired(&quot;all&quot;, eq, p)) check = &quot;UNAVAILABLE&quot;;
					if (check != &quot;EQUIPMENT_OK&quot; &amp;&amp; (bus + 1) === this.$equipmentCouplingRequired(&quot;all&quot;, eq, p)) check = &quot;RISK&quot;;
					if (check === &quot;EQUIPMENT_UNAVAILABLE&quot; &amp;&amp; (i + 1) &lt; (this.$equipmentLevelInUse(&quot;hyperdrive&quot;, p) - 1)) check = &quot;UNAVAILABLE&quot;;
					list.push({
						name: info.scriptInfo.short_title,
						extra: info.scriptInfo.description,
						key: eq,
						space: this._equipmentMatrix[eq][0],
						weight: this._equipmentMatrix[eq][1],
						cost: info.price * (check === &quot;EQUIPMENT_OK&quot; ? (idx &gt;= 0 ? this._refundPct : 1) * -1 : 1) * (stn.equivalentTechLevel &gt;= info.techLevel ? stn.equipmentPriceFactor : 1) * priceFactor,
						flag: check
					});
				}
			}
		}
	}
	if (this._display === 14) { // thrusters coupling
		section = &quot;[sc-section-thrusterscoupling]&quot;;
		for (var i = 0; i &lt; this._thCoupling.length; i++) {
			var eq = this._thCoupling[i];
			var info = EquipmentInfo.infoForKey(eq);
			var idx = curr.indexOf(eq);

			var check = p.equipmentStatus(eq);
			if ((check === &quot;EQUIPMENT_OK&quot;) || (stn.equivalentTechLevel &gt;= info.techLevel &amp;&amp; (used + this._equipmentMatrix[eq][0] - this.$equipmentSpaceInUse(&quot;thrusterscoupling&quot;, p)) &lt;= maxSpace)) {
				if (check != &quot;EQUIPMENT_OK&quot; &amp;&amp; (bus + 1) &lt; this.$equipmentCouplingRequired(&quot;all&quot;, eq, p)) check = &quot;UNAVAILABLE&quot;;
				if (check != &quot;EQUIPMENT_OK&quot; &amp;&amp; (bus + 1) === this.$equipmentCouplingRequired(&quot;all&quot;, eq, p)) check = &quot;RISK&quot;;
				if (check === &quot;EQUIPMENT_UNAVAILABLE&quot; &amp;&amp; (i + 1) &lt; (this.$equipmentLevelInUse(&quot;thrusters&quot;, p) - 1)) check = &quot;UNAVAILABLE&quot;;
				list.push({
					name: info.scriptInfo.short_title,
					extra: info.scriptInfo.description,
					key: eq,
					space: this._equipmentMatrix[eq][0],
					weight: this._equipmentMatrix[eq][1],
					cost: info.price * (check === &quot;EQUIPMENT_OK&quot; ? (idx &gt;= 0 ? this._refundPct : 1) * -1 : 1) * (stn.equivalentTechLevel &gt;= info.techLevel ? stn.equipmentPriceFactor : 1) * priceFactor,
					flag: check
				});
			}
		}
	}
	if (this._display === 19 &amp;&amp; this._heatControl === true) { // boosters
		section = &quot;[sc-section-boosterscoupling]&quot;;
		for (var i = 0; i &lt; this._bsCoupling.length; i++) {
			var eq = this._bsCoupling[i];
			var info = EquipmentInfo.infoForKey(eq);
			var idx = curr.indexOf(eq);

			var check = p.equipmentStatus(eq);
			if ((check === &quot;EQUIPMENT_OK&quot;) || (stn.equivalentTechLevel &gt;= info.techLevel &amp;&amp; (used + this._equipmentMatrix[eq][0] - this.$equipmentSpaceInUse(&quot;boosterscoupling&quot;, p)) &lt;= maxSpace)) {
				if (check != &quot;EQUIPMENT_OK&quot; &amp;&amp; (bus + 1) &lt; this.$equipmentCouplingRequired(&quot;all&quot;, eq, p)) check = &quot;UNAVAILABLE&quot;;
				if (check != &quot;EQUIPMENT_OK&quot; &amp;&amp; (bus + 1) === this.$equipmentCouplingRequired(&quot;all&quot;, eq, p)) check = &quot;RISK&quot;;
				if (check === &quot;EQUIPMENT_UNAVAILABLE&quot; &amp;&amp; (i + 1) &lt; (this.$equipmentLevelInUse(&quot;boosters&quot;, p) - 1)) check = &quot;UNAVAILABLE&quot;;
				list.push({
					name: info.scriptInfo.short_title,
					extra: info.scriptInfo.description,
					key: eq,
					space: this._equipmentMatrix[eq][0],
					weight: this._equipmentMatrix[eq][1],
					cost: info.price * (check === &quot;EQUIPMENT_OK&quot; ? (idx &gt;= 0 ? this._refundPct : 1) * -1 : 1) * (stn.equivalentTechLevel &gt;= info.techLevel ? stn.equipmentPriceFactor : 1) * priceFactor,
					flag: check
				});
			}
		}
	}
	if (this._display === 15) { // energy coupling
		section = &quot;[sc-section-energycoupling]&quot;;
		for (var i = 0; i &lt; this._ebCoupling.length; i++) {
			var eq = this._ebCoupling[i];
			var info = EquipmentInfo.infoForKey(eq);
			var idx = curr.indexOf(eq);

			var check = p.equipmentStatus(eq);
			if ((check === &quot;EQUIPMENT_OK&quot;) || (stn.equivalentTechLevel &gt;= info.techLevel &amp;&amp; (used + this._equipmentMatrix[eq][0] - this.$equipmentSpaceInUse(&quot;energycoupling&quot;, p)) &lt;= maxSpace)) {
				if (check != &quot;EQUIPMENT_OK&quot; &amp;&amp; (bus + 1) &lt; this.$equipmentCouplingRequired(&quot;all&quot;, eq, p)) check = &quot;UNAVAILABLE&quot;;
				if (check != &quot;EQUIPMENT_OK&quot; &amp;&amp; (bus + 1) === this.$equipmentCouplingRequired(&quot;all&quot;, eq, p)) check = &quot;RISK&quot;;
				if (check === &quot;EQUIPMENT_UNAVAILABLE&quot; &amp;&amp; (i + 1) &lt; (this.$equipmentLevelInUse(&quot;energy&quot;, p) - 1)) check = &quot;UNAVAILABLE&quot;;
				list.push({
					name: info.scriptInfo.short_title,
					extra: info.scriptInfo.description,
					key: eq,
					space: this._equipmentMatrix[eq][0],
					weight: this._equipmentMatrix[eq][1],
					cost: info.price * (check === &quot;EQUIPMENT_OK&quot; ? (idx &gt;= 0 ? this._refundPct : 1) * -1 : 1) * (stn.equivalentTechLevel &gt;= info.techLevel ? stn.equipmentPriceFactor : 1) * priceFactor,
					flag: check
				});
			}
		}
	}
	if (this._display === 16) { // front shield coupling
		section = &quot;[sc-section-frontshieldscoupling]&quot;;
		for (var i = 0; i &lt; this._fsCoupling.length; i++) {
			var eq = this._fsCoupling[i];
			var info = EquipmentInfo.infoForKey(eq);
			var idx = curr.indexOf(eq);

			var check = p.equipmentStatus(eq);
			if ((check === &quot;EQUIPMENT_OK&quot;) || (stn.equivalentTechLevel &gt;= info.techLevel &amp;&amp; (used + this._equipmentMatrix[eq][0] - this.$equipmentSpaceInUse(&quot;frontshieldscoupling&quot;, p)) &lt;= maxSpace)) {
				if (check != &quot;EQUIPMENT_OK&quot; &amp;&amp; (bus + 1) &lt; this.$equipmentCouplingRequired(&quot;all&quot;, eq, p)) check = &quot;UNAVAILABLE&quot;;
				if (check != &quot;EQUIPMENT_OK&quot; &amp;&amp; (bus + 1) === this.$equipmentCouplingRequired(&quot;all&quot;, eq, p)) check = &quot;RISK&quot;;
				if (check === &quot;EQUIPMENT_UNAVAILABLE&quot; &amp;&amp; (i + 1) &lt; (this.$equipmentLevelInUse(&quot;frontshields&quot;, p) - 1)) check = &quot;UNAVAILABLE&quot;;
				list.push({
					name: info.scriptInfo.short_title,
					extra: info.scriptInfo.description,
					key: eq,
					space: this._equipmentMatrix[eq][0],
					weight: this._equipmentMatrix[eq][1],
					cost: info.price * (check === &quot;EQUIPMENT_OK&quot; ? (idx &gt;= 0 ? this._refundPct : 1) * -1 : 1) * (stn.equivalentTechLevel &gt;= info.techLevel ? stn.equipmentPriceFactor : 1) * priceFactor,
					flag: check
				});
			}
		}
	}
	if (this._display === 17) { // aft shield coupling
		section = &quot;[sc-section-aftshieldscoupling]&quot;;
		for (var i = 0; i &lt; this._asCoupling.length; i++) {
			var eq = this._asCoupling[i];
			var info = EquipmentInfo.infoForKey(eq);
			var idx = curr.indexOf(eq);

			var check = p.equipmentStatus(eq);
			if ((check === &quot;EQUIPMENT_OK&quot;) || (stn.equivalentTechLevel &gt;= info.techLevel &amp;&amp; (used + this._equipmentMatrix[eq][0] - this.$equipmentSpaceInUse(&quot;aftshieldscoupling&quot;, p)) &lt;= maxSpace)) {
				if (check != &quot;EQUIPMENT_OK&quot; &amp;&amp; (bus + 1) &lt; this.$equipmentCouplingRequired(&quot;all&quot;, eq, p)) check = &quot;UNAVAILABLE&quot;;
				if (check != &quot;EQUIPMENT_OK&quot; &amp;&amp; (bus + 1) === this.$equipmentCouplingRequired(&quot;all&quot;, eq, p)) check = &quot;RISK&quot;;
				if (check === &quot;EQUIPMENT_UNAVAILABLE&quot; &amp;&amp; (i + 1) &lt; (this.$equipmentLevelInUse(&quot;aftshields&quot;, p) - 1)) check = &quot;UNAVAILABLE&quot;;
				list.push({
					name: info.scriptInfo.short_title,
					extra: info.scriptInfo.description,
					key: eq,
					space: this._equipmentMatrix[eq][0],
					weight: this._equipmentMatrix[eq][1],
					cost: info.price * (check === &quot;EQUIPMENT_OK&quot; ? (idx &gt;= 0 ? this._refundPct : 1) * -1 : 1) * (stn.equivalentTechLevel &gt;= info.techLevel ? stn.equipmentPriceFactor : 1) * priceFactor,
					flag: check
				});
			}
		}
	}

	if ((this._display &gt;= 1 &amp;&amp; this._display &lt;= 9) || (this._display &gt;= 11 &amp;&amp; this._display &lt;= 21)) {
		def = &quot;98_EXIT&quot;;

		itemcount -= 2;

		text += this.$padTextRight(expandDescription(section), col1) + this.$padTextLeft(&quot;Equip&quot;, col2) + &quot;\n&quot;;
		text += this.$padTextRight(&quot;Equipment item&quot;, col1) +
			this.$padTextLeft(&quot;space&quot;, col2) +
			this.$padTextLeft(&quot;Weight&quot;, col2) +
			this.$padTextLeft(&quot;Cost&quot;, col3);

		if (list.length === 0) {
			text += expandDescription(&quot;[sc-no-items-available]&quot;);
			itemcount += 2;
		} else {
			var maxpage = Math.ceil(list.length / (pagesize - 7));
			var end = ((this._page * (pagesize - 7)) + (pagesize - 7));
			if (end &gt; list.length) end = list.length;
			for (var i = (this._page * (pagesize - 7)); i &lt; end; i++) {
				var c = this._menuColor;
				switch (list[i].flag) {
					case &quot;EQUIPMENT_OK&quot;:
						c = this._installedColor;
						break;
					case &quot;EQUIPMENT_DAMAGED&quot;:
						c = this._damagedColor;
						break;
					case &quot;UNAVAILABLE&quot;:
						c = this._disabledColor;
						break;
					case &quot;RISK&quot;:
						c = this._riskColor;
						break;
				}
				curChoices[&quot;01_EQUIP-&quot; + (i &lt; 10 ? &quot;0&quot; : &quot;&quot;) + i + &quot;~&quot; + list[i].key] = {
					text: this.$padTextRight(list[i].name + (list[i].extra != &quot;&quot; ? &quot; (&quot; + list[i].extra + &quot;)&quot; : &quot;&quot;), col1) +
						this.$padTextLeft(list[i].space.toFixed(1) + spc + &quot;t&quot;, col2) +
						this.$padTextLeft(list[i].weight.toFixed(1) + spc + &quot;t&quot;, col2) +
						this.$padTextLeft(formatCredits((list[i].cost / 10), true, true), col3),
					alignment: &quot;LEFT&quot;,
					color: c,
					unselectable: (list[i].flag === &quot;EQUIPMENT_OK&quot; || list[i].flag === &quot;EQUIPMENT_DAMAGED&quot; || list[i].flag === &quot;UNAVAILABLE&quot; ? true : false)
				};
				itemcount += 1;
			}
		}

		for (var i = 0; i &lt; ((pagesize - 8) - itemcount); i++) {
			curChoices[&quot;90_SPACER_&quot; + i] = &quot;&quot;;
		}

		if (maxpage &gt; 1 &amp;&amp; this._page &lt; (maxpage - 1)) {
			curChoices[&quot;95_NEXT&quot;] = {
				text: &quot;[sc-nextpage]&quot;,
				color: this._itemColor
			};
		} else {
			curChoices[&quot;95_NEXT&quot;] = {
				text: &quot;[sc-nextpage]&quot;,
				color: this._disabledColor,
				unselectable: true
			};
		}
		if (this._page &gt; 0) {
			curChoices[&quot;96_PREV&quot;] = {
				text: &quot;[sc-prevpage]&quot;,
				color: this._itemColor
			};
		} else {
			curChoices[&quot;96_PREV&quot;] = {
				text: &quot;[sc-prevpage]&quot;,
				color: this._disabledColor,
				unselectable: true
			};
		}

		if (this._display &lt;= 9 || this._display === 18 || this._display &gt;= 20) {
			curChoices[&quot;98_EXIT&quot;] = {
				text: &quot;[sc-return]&quot;,
				color: this._itemColor
			};
		} else {
			def = &quot;97_EXIT&quot;;
			curChoices[&quot;97_EXIT&quot;] = {
				text: &quot;[sc-return]&quot;,
				color: this._itemColor
			};
		}

		if (this._lastChoice[this._display] != &quot;&quot;) def = this._lastChoice[this._display];

		var opts = {
			screenID: &quot;oolite-shipconfig-section-map&quot;,
			title: &quot;Ship Configuration&quot;,
			allowInterrupt: interrupt,
			exitScreen: &quot;GUI_SCREEN_EQUIP_SHIP&quot;,
			choices: curChoices,
			initialChoicesKey: def,
			message: text
		};
	}

	// electrical sub menu
	if (this._display === 10) {
		text += this.$padTextRight(expandDescription(&quot;[sc-section-elecbuscouplings]&quot;), col1) + this.$padTextLeft(&quot;Equip&quot;, col2) + &quot;\n&quot;;
		text += this.$padTextRight(expandDescription(&quot;[sc-menudescription]&quot;), col1) +
			this.$padTextLeft(&quot;space&quot;, col2) +
			this.$padTextLeft(&quot;Weight&quot;, col2);

		curChoices[&quot;11_BUS&quot;] = {
			text: this.$padTextRight(&quot;Electrical Bus (Class &quot; + this.$equipmentItemInUse(&quot;electricalbus&quot;, p).replace(&quot;EQ_ELEC_BUS_TYPE&quot;, &quot;&quot;) + &quot;)&quot;, col1) + this.$padTextLeft(this.$equipmentSpaceInUse(&quot;electricalbus&quot;, p).toFixed(1) + spc + &quot;t&quot;, col2) + this.$padTextLeft(this.$equipmentWeightInUse(&quot;electricalbus&quot;, p).toFixed(1) + spc + &quot;t&quot;, col2),
			alignment: &quot;LEFT&quot;,
			color: this._menuColor
		};
		curChoices[&quot;12_ENGINES&quot;] = {
			text: this.$padTextRight(&quot;Engine Power Coupling (Class &quot; + this.$equipmentItemInUse(&quot;enginecoupling&quot;, p).replace(&quot;EQ_ENGINE_COUPLING_TYPE&quot;, &quot;&quot;) + &quot;)&quot;, col1) + this.$padTextLeft(this.$equipmentSpaceInUse(&quot;enginecoupling&quot;, p).toFixed(1) + spc + &quot;t&quot;, col2) + this.$padTextLeft(this.$equipmentWeightInUse(&quot;enginecoupling&quot;, p).toFixed(1) + spc + &quot;t&quot;, col2),
			alignment: &quot;LEFT&quot;,
			color: this._menuColor
		};
		if (this.$shipHasHyperspaceMotor(p.dataKey) === true &amp;&amp; this._OXPHyperdrives === false) {
			curChoices[&quot;13_HYPERDRIVE&quot;] = {
				text: this.$padTextRight(&quot;Hyperdrive Power Coupling (Class &quot; + this.$equipmentItemInUse(&quot;hyperdrivecoupling&quot;, p).replace(&quot;EQ_HYPERDRIVE_COUPLING_TYPE&quot;, &quot;&quot;) + &quot;)&quot;, col1) + this.$padTextLeft(this.$equipmentSpaceInUse(&quot;hyperdrivecoupling&quot;, p).toFixed(1) + spc + &quot;t&quot;, col2) + this.$padTextLeft(this.$equipmentWeightInUse(&quot;hyperdrivecoupling&quot;, p).toFixed(1) + spc + &quot;t&quot;, col2),
				alignment: &quot;LEFT&quot;,
				color: this._menuColor
			};
		}
		// do we have a wide font?
		var thrText = &quot;Manoeuvring Thrusters&quot;;
		if (defaultFont.measureString(&quot;W&quot;) &gt; 0.8) thrText = &quot;Thrusters&quot;;
		curChoices[&quot;14_THRUSTERS&quot;] = {
			text: this.$padTextRight(thrText + &quot; Power Coupling (Class &quot; + this.$equipmentItemInUse(&quot;thrusterscoupling&quot;, p).replace(&quot;EQ_THRUSTERS_COUPLING_TYPE&quot;, &quot;&quot;) + &quot;)&quot;, col1) + this.$padTextLeft(this.$equipmentSpaceInUse(&quot;thrusterscoupling&quot;, p).toFixed(1) + spc + &quot;t&quot;, col2) + this.$padTextLeft(this.$equipmentWeightInUse(&quot;thrusterscoupling&quot;, p).toFixed(1) + spc + &quot;t&quot;, col2),
			alignment: &quot;LEFT&quot;,
			color: this._menuColor
		};
		curChoices[&quot;14A_BOOSTERS&quot;] = {
			text: this.$padTextRight(&quot;Boosters Power Coupling (Class &quot; + this.$equipmentItemInUse(&quot;boosterscoupling&quot;, p).replace(&quot;EQ_BOOSTERS_COUPLING_TYPE&quot;, &quot;&quot;) + &quot;)&quot;, col1) + this.$padTextLeft(this.$equipmentSpaceInUse(&quot;boosterscoupling&quot;, p).toFixed(1) + spc + &quot;t&quot;, col2) + this.$padTextLeft(this.$equipmentWeightInUse(&quot;boosterscoupling&quot;, p).toFixed(1) + spc + &quot;t&quot;, col2),
			alignment: &quot;LEFT&quot;,
			color: this._menuColor
		};
		curChoices[&quot;15_ENERGY&quot;] = {
			text: this.$padTextRight(&quot;Energy Banks Power Coupling (Class &quot; + this.$equipmentItemInUse(&quot;energycoupling&quot;, p).replace(&quot;EQ_ENERGYBANK_COUPLING_TYPE&quot;, &quot;&quot;) + &quot;)&quot;, col1) + this.$padTextLeft(this.$equipmentSpaceInUse(&quot;energycoupling&quot;, p).toFixed(1) + spc + &quot;t&quot;, col2) + this.$padTextLeft(this.$equipmentWeightInUse(&quot;energycoupling&quot;, p).toFixed(1) + spc + &quot;t&quot;, col2),
			alignment: &quot;LEFT&quot;,
			color: this._menuColor
		};
		curChoices[&quot;16_FRONTSHIELDS&quot;] = {
			text: this.$padTextRight(&quot;Forward Shields Power Coupling (Class &quot; + this.$equipmentItemInUse(&quot;frontshieldscoupling&quot;, p).replace(&quot;EQ_FORWARD_SHIELD_COUPLING_TYPE&quot;, &quot;&quot;) + &quot;)&quot;, col1) + this.$padTextLeft(this.$equipmentSpaceInUse(&quot;frontshieldscoupling&quot;, p).toFixed(1) + spc + &quot;t&quot;, col2) + this.$padTextLeft(this.$equipmentWeightInUse(&quot;frontshieldscoupling&quot;, p).toFixed(1) + spc + &quot;t&quot;, col2),
			alignment: &quot;LEFT&quot;,
			color: this._menuColor
		};
		curChoices[&quot;17_AFTSHIELDS&quot;] = {
			text: this.$padTextRight(&quot;Aft Shields Power Coupling (Class &quot; + this.$equipmentItemInUse(&quot;aftshieldscoupling&quot;, p).replace(&quot;EQ_AFT_SHIELD_COUPLING_TYPE&quot;, &quot;&quot;) + &quot;)&quot;, col1) + this.$padTextLeft(this.$equipmentSpaceInUse(&quot;aftshieldscoupling&quot;, p).toFixed(1) + spc + &quot;t&quot;, col2) + this.$padTextLeft(this.$equipmentWeightInUse(&quot;aftshieldscoupling&quot;, p).toFixed(1) + spc + &quot;t&quot;, col2),
			alignment: &quot;LEFT&quot;,
			color: this._menuColor
		};

		for (var i = 0; i &lt; (pagesize - (12 - (this.$shipHasHyperspaceMotor(p.dataKey) === true &amp;&amp; this._OXPHyperdrives === false ? 0 : 1))); i++) {
			curChoices[&quot;90_SPACER_&quot; + i] = &quot;&quot;;
		}

		curChoices[&quot;98_EXIT&quot;] = {
			text: &quot;[sc-return]&quot;,
			color: this._itemColor
		};

		if (this._lastChoice[this._display] != &quot;&quot;) def = this._lastChoice[this._display];

		var opts = {
			screenID: &quot;oolite-shipconfig-electrical-map&quot;,
			title: &quot;Ship Configuration&quot;,
			allowInterrupt: interrupt,
			exitScreen: &quot;GUI_SCREEN_EQUIP_SHIP&quot;,
			choices: curChoices,
			initialChoicesKey: def,
			message: text
		};

	}

	// view installed equipment
	if (this._display === 30) {
		text = expandDescription(&quot;[sc-spaceweight-profile]&quot;);
		text += this.$padTextRight(&quot;&quot;, col1) + this.$padTextLeft(&quot;Equip&quot;, col2) + this.$padTextLeft(&quot;Cargo&quot;, col2) + &quot;\n&quot;;
		text += this.$padTextRight(&quot;Item&quot;, col1) +
			this.$padTextLeft(&quot;space&quot;, col2) +
			this.$padTextLeft(&quot;space&quot;, col2) +
			this.$padTextLeft(&quot;Weight&quot;, col2) + &quot;\n\n&quot;;

		var eq = p.equipment;
		for (var i = 0; i &lt; eq.length; i++) {
			var item = eq[i];
			if (this._ignoreEquip.indexOf(item.equipmentKey) &gt;= 0) continue;
			var space = 0;
			var weight = 0;
			var cargos = 0;
			var lookup = this._equipmentMatrix[item.equipmentKey];

			if (lookup) {
				space = lookup[0];
				weight = lookup[1];
				cargos = item.requiredCargoSpace;
			} else {
				if (item.requiredCargoSpace === 0) {
					space = 1;
					weight = 1;
					cargos = 0;
				} else {
					space = 0;
					cargos = item.requiredCargoSpace;
					weight = item.requiredCargoSpace;
				}
			}
			if (item.isVisible &amp;&amp; item.requiresEmptyPylon === false &amp;&amp; (space &gt; 0 || weight &gt; 0)) {
				var dispname = item.name;
				if (item.equipmentKey === &quot;EQ_PASSENGER_BERTH&quot;) {
					cargos *= p.passengerCapacity;
					weight *= p.passengerCapacity;
					dispname = &quot;Passenger Berth&quot;;
					if (p.passengerCapacity &gt; 1) dispname = p.passengerCapacity + &quot; Passenger Berths&quot;;
				}
				list.push({
					eq: item.equipmentKey,
					space: space,
					weight: weight,
					cargo: cargos,
					name: dispname
				});
			}
		}
		// now add items not in the equipment list:
		if (p.forwardWeapon &amp;&amp; p.forwardWeapon.equipmentKey != &quot;EQ_WEAPON_NONE&quot;) {
			list.push({
				eq: p.forwardWeapon.equipmentKey,
				space: 0,
				weight: this.$weaponWeight(p.forwardWeapon.equipmentKey),
				cargo: 0,
				name: &quot;Forward weapon: &quot; + p.forwardWeapon.name
			});
		}
		if (p.aftWeapon &amp;&amp; p.aftWeapon.equipmentKey != &quot;EQ_WEAPON_NONE&quot;) {
			list.push({
				eq: p.aftWeapon.equipmentKey,
				space: 0,
				weight: this.$weaponWeight(p.aftWeapon.equipmentKey),
				cargo: 0,
				name: &quot;Aft weapon: &quot; + p.aftWeapon.name
			});
		}
		if (p.portWeapon &amp;&amp; p.portWeapon.equipmentKey != &quot;EQ_WEAPON_NONE&quot;) {
			list.push({
				eq: p.portWeapon.equipmentKey,
				space: 0,
				weight: this.$weaponWeight(p.portWeapon.equipmentKey),
				cargo: 0,
				name: &quot;Port weapon: &quot; + p.portWeapon.name
			});
		}
		if (p.starboardWeapon &amp;&amp; p.starboardWeapon.equipmentKey != &quot;EQ_WEAPON_NONE&quot;) {
			list.push({
				eq: p.starboardWeapon.equipmentKey,
				space: 0,
				weight: this.$weaponWeight(p.starboardWeapon.equipmentKey),
				cargo: 0,
				name: &quot;Starboard weapon: &quot; + p.starboardWeapon.name
			});
		}
		// any missiles?
		if (p.missileCapacity &gt; 0) {
			var flag = false;
			try {
				var miss = p.missiles;
				flag = true;
			} catch (err) {
				if (this._debug) log(this.name, &quot;!!ERROR: &quot; + err);
			}
			if (flag === true) {
				for (var i = 0; i &lt; miss.length; i++) {
					//if (this._debug) log(this.name, p.missileCapacity + &quot; - &quot; + i + &quot;: &quot; + miss[i].equipmentKey);
					if (this._ignoreEquip.indexOf(miss[i].equipmentKey) &gt;= 0) continue;
					if (!this._equipmentMatrix[miss[i].equipmentKey]) {
						list.push({
							eq: miss[i].equipmentKey,
							space: 0,
							weight: 1,
							cargo: 0,
							name: (miss[i].name === &quot;Missile&quot; ? &quot;Standard Missile&quot; : miss[i].name)
						});
					} else {
						list.push({
							eq: miss[i].equipmentKey,
							space: 0,
							weight: this._equipmentMatrix[miss[i].equipmentKey][1],
							cargo: 0,
							name: miss[i].name
						});
					}
				}
			}
		}

		// special items
		// LMSS weapons
		var lmss = worldScripts.LMSS_Core;
		if (lmss) {
			if (lmss._forwardAltKey != &quot;EQ_WEAPON_NONE&quot; &amp;&amp; lmss._forwardAltKey != &quot;&quot;) {
				list.push({
					eq: lmss._forwardAltKey,
					space: 0,
					weight: this.$weaponWeight(lmss._forwardAltKey),
					cargo: 0,
					name: &quot;LMSS Secondary weapon: &quot; + EquipmentInfo.infoForKey(lmss._forwardAltKey).name
				});
			}
			if (lmss._aftAltKey != &quot;EQ_WEAPON_NONE&quot; &amp;&amp; lmss._aftAltKey != &quot;&quot;) {
				list.push({
					eq: lmss._aftAltKey,
					space: 0,
					weight: this.$weaponWeight(lmss._aftAltKey),
					cargo: 0,
					name: &quot;LMSS Secondary weapon: &quot; + EquipmentInfo.infoForKey(lmss._aftAltKey).name
				});
			}
			if (lmss._portAltKey != &quot;EQ_WEAPON_NONE&quot; &amp;&amp; lmss._portAltKey != &quot;&quot;) {
				list.push({
					eq: lmss._portAltKey,
					space: 0,
					weight: this.$weaponWeight(lmss._portAltKey),
					cargo: 0,
					name: &quot;LMSS Secondary weapon: &quot; + EquipmentInfo.infoForKey(lmss._portAltKey).name
				});
			}
			if (lmss._starboardAltKey != &quot;EQ_WEAPON_NONE&quot; &amp;&amp; lmss._starboardAltKey != &quot;&quot;) {
				list.push({
					eq: lmss._starboardAltKey,
					space: 0,
					weight: this.$weaponWeight(lmss._starboardAltKey),
					cargo: 0,
					name: &quot;LMSS Secondary weapon: &quot; + EquipmentInfo.infoForKey(lmss._starboardAltKey).name
				});
			}
		}

		var cargo = 0;
		// add cargo weight
		if (this.$getCargoCapacity(p) &gt; 0 &amp;&amp; p.cargoList.length &gt; 0) {
			for (var i = 0; i &lt; p.cargoList.length; i++) {
				var itm = p.cargoList[i];
				switch (itm.unit) {
					case &quot;t&quot;:
						cargo += itm.quantity;
						break;
					case &quot;kg&quot;:
						cargo += (itm.quantity / 500);
						break;
					case &quot;g&quot;:
						cargo += (itm.quantity / 500000);
						break;
				}
			}
		}

		var smuggling = worldScripts.Smugglers_Equipment;
		if (smuggling) {
			// add the weight of any cargo in the smuggling compartment
			var s_cargo = smuggling.$getSmugglingCargo();
			for (var i = 0; i &lt; s_cargo.length; i++) {
				switch (s_cargo[i].unit) {
					case &quot;t&quot;:
						cargo += s_cargo[i].quantity;
						break;
					case &quot;kg&quot;:
						cargo += (s_cargo[i].quantity / 1000);
						break;
					case &quot;g&quot;:
						cargo += (s_cargo[i].quantity / 1000000);
						break;
				}
			}
		}

		if (cargo &gt; 0) {
			list.push({
				eq: &quot;cargo&quot;,
				space: 0,
				weight: parseInt(cargo),
				cargo: cargo,
				name: &quot;Cargo&quot;
			});
		}

		list.sort(compare);

		var maxpage = Math.ceil(list.length / (pagesize - 2));
		var end = ((this._page * (pagesize - 2)) + (pagesize - 2));
		if (end &gt; list.length) end = list.length;
		for (var i = (this._page * (pagesize - 2)); i &lt; end; i++) {
			text += this.$padTextRight(list[i].name, col1) +
				this.$padTextLeft(list[i].space.toFixed(1) + spc + &quot;t&quot;, col2) +
				this.$padTextLeft(list[i].cargo.toFixed(1) + spc + &quot;t&quot;, col2) +
				this.$padTextLeft(list[i].weight.toFixed(1) + spc + &quot;t&quot;, col2) + &quot;\n&quot;;
			//itemcount += 1;
		}

		if (maxpage &gt; 1 &amp;&amp; this._page &lt; (maxpage - 1)) {
			curChoices[&quot;95_NEXT&quot;] = {
				text: &quot;[sc-nextpage]&quot;,
				color: this._itemColor
			};
		} else {
			curChoices[&quot;95_NEXT&quot;] = {
				text: &quot;[sc-nextpage]&quot;,
				color: this._disabledColor,
				unselectable: true
			};
		}
		if (this._page &gt; 0) {
			curChoices[&quot;96_PREV&quot;] = {
				text: &quot;[sc-prevpage]&quot;,
				color: this._itemColor
			};
		} else {
			curChoices[&quot;96_PREV&quot;] = {
				text: &quot;[sc-prevpage]&quot;,
				color: this._disabledColor,
				unselectable: true
			};
		}

		def = &quot;98_EXIT&quot;;
		if (this._lastChoice[this._display] != &quot;&quot;) def = this._lastChoice[this._display];


		curChoices[&quot;98_EXIT&quot;] = {
			text: &quot;[sc-return]&quot;,
			color: this._itemColor
		};

		var opts = {
			screenID: &quot;oolite-shipconfig-installed-map&quot;,
			title: &quot;Ship Configuration&quot;,
			allowInterrupt: interrupt,
			exitScreen: &quot;GUI_SCREEN_EQUIP_SHIP&quot;,
			choices: curChoices,
			initialChoicesKey: def,
			message: text
		};

	}

	this.$addShipModelToScreen(opts);
	mission.runScreen(opts, this.$shipConfigScreenHandler, this);
	this.$finaliseShipModel();
}

//-------------------------------------------------------------------------------------------------------------
// returns the ship config page header
this.$pageHeader = function $pageHeader(pageType) {

	var p = player.ship;
	var shipspec = Ship.shipDataForKey(p.dataKey);
	var used = this.$calcEquipmentSpace(p);
	var cargoUsed = this.$cargoEquipmentSpaceAmount(p);
	var maxCargo = this.$cargoSpaceAvailable(p);
	var maxSpace = Math.ceil(this.$equipmentSpaceTotal(p) + maxCargo);
	var spc = String.fromCharCode(31) + String.fromCharCode(31) + String.fromCharCode(31);

	var text = &quot;&quot;;

	var addtext = &quot;&quot;;
	switch (pageType) {
		case &quot;sell&quot;:
			if (used &gt; maxSpace) {
				addtext = expandDescription(&quot;[sc-overload-sell]&quot;);
				cargoUsed = maxCargo;
			}
			break;
		case &quot;store&quot;:
			if (used &gt; maxSpace) {
				addtext = expandDescription(&quot;[sc-overload-store]&quot;);
				cargoUsed = maxCargo;
			}
			if (player.ship.dockedStation.isMainStation === true &amp;&amp; worldScripts.EquipmentStorage.$storageSystemCount(galaxyNumber, system.ID) === 0) {
				addtext += expandDescription(&quot;[storage-deposit-required]&quot;, {
					fee: formatCredits(worldScripts.EquipmentStorage._establishmentFee, false, true)
				});
			}
			break;
		case &quot;config&quot;:
			if (used &gt; maxSpace) {
				addtext = expandDescription(&quot;[sc-overload-config]&quot;);
				cargoUsed = maxCargo;
			}
			if (this._freeUpgrades === true) addtext += expandDescription(&quot;[sc-free-upgrades]&quot;);
			break;
	}

	text += this.$padTextRight(expandDescription(&quot;[sc-header-cash]&quot;, {
		cash: formatCredits(player.credits, true, true)
	}), 18) + p.shipClassName + expandDescription(&quot;[sc-header-statistics]&quot;) + &quot;\n&quot;;
	text += this.$padTextRight(expandDescription(&quot;[sc-header-equipspace]&quot;), 11) + this.$padTextRight(used.toFixed(1) + spc + &quot;t (&quot; + maxSpace.toFixed(0) + spc + &quot;t)&quot;, 7) +
		this.$padTextRight(expandDescription(&quot;[sc-header-thrust]&quot;), 4) + this.$padTextRight(this.$calculatedValue(&quot;thrust&quot;, p).toFixed(1) + spc + &quot;m/s&quot;, 5) +
		&quot;(&quot; + parseInt(shipspec[&quot;thrust&quot;]) + spc + &quot;m/s)\n&quot;;
	text += this.$padTextRight(expandDescription(&quot;[sc-header-cargo]&quot;), 11) + this.$padTextRight(cargoUsed.toFixed(1) + spc + &quot;t (&quot; + maxCargo + spc + &quot;t)&quot;, 7) +
		this.$padTextRight(expandDescription(&quot;[sc-header-speed]&quot;), 4) + this.$padTextRight((this.$calculatedValue(&quot;speed&quot;, p) / 1000).toFixed(3) + spc + &quot;LS&quot;, 5) +
		&quot;(&quot; + (parseInt(shipspec[&quot;max_flight_speed&quot;]) / 1000).toFixed(3) + spc + &quot;LS)\n&quot;;
	text += this.$padTextRight(expandDescription(&quot;[sc-header-weight]&quot;), 11) + this.$padTextRight(this.$calcEquipmentWeight(p).toFixed(1) + spc + &quot;t&quot;, 7) +
		this.$padTextRight(expandDescription(&quot;[sc-header-pitch]&quot;), 4) + this.$padTextRight(this.$calculatedValue(&quot;pitch&quot;, p).toFixed(2), 5) +
		&quot;(&quot; + parseFloat(shipspec[&quot;max_flight_pitch&quot;]).toFixed(2) + &quot;)\n&quot;;
	text += this.$padTextRight(expandDescription(&quot;[sc-header-busovl]&quot;), 11) + this.$padTextRight(this.$busOverloadChance(p).toFixed(0) + spc + &quot;%&quot;, 7) +
		this.$padTextRight(expandDescription(&quot;[sc-header-roll]&quot;), 4) + this.$padTextRight(this.$calculatedValue(&quot;roll&quot;, p).toFixed(2), 5) +
		&quot;(&quot; + parseFloat(shipspec[&quot;max_flight_roll&quot;]).toFixed(2) + &quot;)\n&quot;;
	text += addtext + &quot;\n&quot;;

	return text;
}

//-------------------------------------------------------------------------------------------------------------
this.$shipConfigScreenHandler = function $shipConfigScreenHandler(choice) {

	if (!choice) return;

	var p = player.ship;
	var stn = p.dockedStation;

	this._lastChoice[this._display] = choice;

	if (choice.indexOf(&quot;01_EQUIP&quot;) &gt;= 0) {
		var item = choice.substring(choice.indexOf(&quot;~&quot;) + 1);
		switch (item) {
			case &quot;EQ_FUEL_INJECTION_REMOVE&quot;:
				for (var i = 0; i &lt; this._fuelinjectors.length; i++) {
					if (p.equipmentStatus(this._fuelinjectors[i]) === &quot;EQUIPMENT_OK&quot; || p.equipmentStatus(this._fuelinjectors[i]) === &quot;EQUIPMENT_DAMAGED&quot;) {
						this._source = &quot;REMOVEITEM&quot;;
						this.$sellEquipmentScreenHandler(&quot;01_EQUIP~&quot; + this._fuelinjectors[i]);
						break;
					}
				}
				break;
			case &quot;EQ_FUEL_SCOOPS_REMOVE&quot;:
				for (var i = 0; i &lt; this._fuelscoops.length; i++) {
					if (p.equipmentStatus(this._fuelscoops[i]) === &quot;EQUIPMENT_OK&quot; || p.equipmentStatus(this._fuelscoops[i]) === &quot;EQUIPMENT_DAMAGED&quot;) {
						this._source = &quot;REMOVEITEM&quot;;
						this.$sellEquipmentScreenHandler(&quot;01_EQUIP~&quot; + this._fuelscoops[i]);
						break;
					}
				}
				break;
			case &quot;EQ_HEAT_SHIELD_REMOVE&quot;:
				for (var i = 0; i &lt; this._heatshields.length; i++) {
					if (p.equipmentStatus(this._heatshields[i]) === &quot;EQUIPMENT_OK&quot; || p.equipmentStatus(this._heatshields[i]) === &quot;EQUIPMENT_DAMAGED&quot;) {
						this._source = &quot;REMOVEITEM&quot;;
						this.$sellEquipmentScreenHandler(&quot;01_EQUIP~&quot; + this._heatshields[i]);
						break;
					}
				}
				break;
			case &quot;EQ_ARMOUR_FORWARD_REMOVE&quot;:
				for (var i = 0; i &lt; this._frontarmour.length; i++) {
					if (p.equipmentStatus(this._frontarmour[i]) === &quot;EQUIPMENT_OK&quot; || p.equipmentStatus(this._frontarmour[i]) === &quot;EQUIPMENT_DAMAGED&quot;) {
						this._source = &quot;REMOVEITEM&quot;;
						this.$sellEquipmentScreenHandler(&quot;01_EQUIP~&quot; + this._frontarmour[i]);
						break;
					}
				}
				break;
			case &quot;EQ_ARMOUR_AFT_REMOVE&quot;:
				for (var i = 0; i &lt; this._aftarmour.length; i++) {
					if (p.equipmentStatus(this._aftarmour[i]) === &quot;EQUIPMENT_OK&quot; || p.equipmentStatus(this._aftarmour[i]) === &quot;EQUIPMENT_DAMAGED&quot;) {
						this._source = &quot;REMOVEITEM&quot;;
						this.$sellEquipmentScreenHandler(&quot;01_EQUIP~&quot; + this._aftarmour[i]);
						break;
					}
				}
				break;
			case &quot;EQ_BOOSTERS_REMOVE&quot;:
				for (var i = 0; i &lt; this._boosters.length; i++) {
					if (p.equipmentStatus(this._boosters[i]) === &quot;EQUIPMENT_OK&quot; || p.equipmentStatus(this._boosters[i]) === &quot;EQUIPMENT_DAMAGED&quot;) {
						this._source = &quot;REMOVEITEM&quot;;
						this.$sellEquipmentScreenHandler(&quot;01_EQUIP~&quot; + this._boosters[i]);
						break;
					}
				}
				break;
			default:
				var info = EquipmentInfo.infoForKey(item);
				var priceFactor = this.$equipmentPriceFactor(p.shipClassName, this.$getShipMass(p)) * (stn.equivalentTechLevel &gt;= info.techLevel ? stn.equipmentPriceFactor : 1);

				// scoops, injectors and heatshields don&#39;t have a price factor
				if (this._fuelscoops.indexOf(item) &gt;= 0 || this._fuelinjectors.indexOf(item) &gt;= 0 || this._heatshields.indexOf(item) &gt;= 0) priceFactor = 1;

				if (this._freeUpgrades === true || (player.credits &gt;= (info.price / 10) * priceFactor)) {
					this.$playSound(&quot;buy&quot;);
					// reset the holding dict
					this._current = {};
					p.awardEquipment(item);
					if (this._freeUpgrades === false) {
						player.credits -= (info.price / 10) * priceFactor;
						// give the player an email, if installed
						var ga = worldScripts.GalCopAdminServices;
						if (ga) {
							ga.playerBoughtEquipment(item);
						}
					}
					if (this._installationTime === true) {
						clock.addSeconds(600 + (info.price * priceFactor));
						// perform any callbacks that have been registered
						if (this._callbacks.length &gt; 0) {
							for (var cb = 0; cb &lt; this._callbacks.length; cb++) {
								this._callbacks[cb]();
							}
						}
					}
				} else {
					player.consoleMessage(&quot;Insufficient credit to purchase item.&quot;);
				}
		}
	}

	if (choice === &quot;01_ENGINES&quot;) {
		this._display = 1;
		this._page = 0;
	}
	if (choice === &quot;02_HYPERDRIVE&quot;) {
		this._display = 2;
		this._page = 0;
	}
	if (choice === &quot;03_THRUSTERS&quot;) {
		this._display = 3;
		this._page = 0;
	}
	if (choice === &quot;03A_BOOSTERS&quot;) {
		this._display = 18;
		this._page = 0;
	}
	if (choice === &quot;04_ENERGY&quot;) {
		this._display = 4;
		this._page = 0;
	}
	if (choice === &quot;05_FRONTSHIELDS&quot;) {
		this._display = 5;
		this._page = 0;
	}
	if (choice === &quot;06_AFTSHIELDS&quot;) {
		this._display = 6;
		this._page = 0;
	}
	if (choice === &quot;07_FUELINJECTORS&quot;) {
		this._display = 7;
		this._page = 0;
	}
	if (choice === &quot;08_FUELSCOOPS&quot;) {
		this._display = 20;
		this._page = 0;
	}
	if (choice === &quot;09_HEATSHIELDS&quot;) {
		this._display = 8;
		this._page = 0;
	}
	if (choice === &quot;10_ARMOUR_0FRONT&quot;) {
		this._display = 9;
		this._page = 0;
	}
	if (choice === &quot;10_ARMOUR_1AFT&quot;) {
		this._display = 21;
		this._page = 0;
	}
	if (choice === &quot;11_ELECTRICAL&quot;) {
		this._display = 10;
		this._page = 0;
	}

	if (choice === &quot;11_BUS&quot;) {
		this._display = 11;
		this._page = 0;
	}
	if (choice === &quot;12_ENGINES&quot;) {
		this._display = 12;
		this._page = 0;
	}
	if (choice === &quot;13_HYPERDRIVE&quot;) {
		this._display = 13;
		this._page = 0;
	}
	if (choice === &quot;14_THRUSTERS&quot;) {
		this._display = 14;
		this._page = 0;
	}
	if (choice === &quot;14A_BOOSTERS&quot;) {
		this._display = 19;
		this._page = 0;
	}
	if (choice === &quot;15_ENERGY&quot;) {
		this._display = 15;
		this._page = 0;
	}
	if (choice === &quot;16_FRONTSHIELDS&quot;) {
		this._display = 16;
		this._page = 0;
	}
	if (choice === &quot;17_AFTSHIELDS&quot;) {
		this._display = 17;
		this._page = 0;
	}

	if (choice === &quot;97_EXIT&quot;) {
		this._display = 10;
		this._page = 0;
	}
	if (choice === &quot;98_EXIT&quot;) {
		this._display = 0;
		this._page = 0;
	}

	if (choice === &quot;95_NEXT&quot;) this._page += 1;
	if (choice === &quot;96_PREV&quot;) this._page -= 1;

	if (choice === &quot;96_VIEWEQUIP&quot;) {
		this._display = 30;
		this._page = 0;
	}

	if (choice === &quot;97_SELL&quot;) {
		this._source = &quot;CONFIGSCREEN&quot;;
		this.$sellEquipment();
		return;
	}
	if (choice === &quot;97A_STORAGE&quot;) {
		this._source = &quot;CONFIGSCREEN&quot;;
		worldScripts.EquipmentStorage.$storeEquipment();
		return;
	}
	if (choice != &quot;99_EXIT&quot;) {
		this.$shipConfig();
	}
	//worldScripts.ShipConfiguration_F3HUDControl.guiScreenChanged();
}

//-------------------------------------------------------------------------------------------------------------
this.$sellEquipment = function $sellEquipment() {
	function compare(a, b) {
		return b.space - a.space;
	}

	var p = player.ship;
	var stn = p.dockedStation;
	var used = this.$calcEquipmentSpace(p);
	var maxSpace = Math.ceil(this.$equipmentSpaceTotal(p) + this.$cargoSpaceAvailable(p));
	var interrupt = true;
	var spc = String.fromCharCode(31) + String.fromCharCode(31) + String.fromCharCode(31);

	var text = &quot;&quot;;
	var curChoices = {};
	var itemcount = 0;

	var pagesize = 15;
	if (this.$isBigGuiActive() === false) p.hudHidden = true;
	this._configScreen = true;

	// display the list of options
	if (used &gt; maxSpace) {
		// make sure we don&#39;t lock the player in during flight
		if (p.alertCondition === 0) {
			interrupt = false; // set to false to force the player to sell equipment before continuing
		}
		curChoices[&quot;98_SWITCH&quot;] = {
			text: &quot;[sc-change-config]&quot;,
			color: this._itemColor
		};
		curChoices[&quot;99_EXIT&quot;] = {
			text: &quot;[sc-return]&quot;,
			color: this._disabledColor,
			unselectable: true
		};
		pagesize -= 1;
	} else {
		curChoices[&quot;99_EXIT&quot;] = {
			text: &quot;[sc-return]&quot;,
			color: this._itemColor
		};
		this._initialSetup = false;
	}

	text += this.$pageHeader(&quot;sell&quot;);

	text += this.$padTextRight(expandDescription(&quot;[sc-selling-equipment]&quot;), 16) + this.$padTextLeft(&quot;Equip&quot;, 4) + &quot;\n&quot;;
	text += this.$padTextRight(&quot;Equipment Item&quot;, 16) +
		this.$padTextLeft(&quot;space&quot;, 4) +
		this.$padTextLeft(&quot;Weight&quot;, 4) +
		this.$padTextLeft(&quot;Refund&quot;, 8) + &quot;\n\n&quot;;

	var eq = p.equipment;
	var list = [];
	var priceFactor = this.$equipmentPriceFactor(p.shipClassName, this.$getShipMass(p));
	var curr = this._currEquip;

	for (var i = 0; i &lt; eq.length; i++) {
		var item = eq[i];
		// don&#39;t include &quot;no sell&quot; items
		if (this._noSell.indexOf(item.equipmentKey) &gt;= 0) continue;
		// don&#39;t include any items in the ignore equipment list
		if (this._ignoreEquip.indexOf(item.equipmentKey) &gt;= 0) continue;
		// don&#39;t include any items that have a zero cost
		if (item.cost === 0) continue;
		var space = 0;
		var weight = 0;
		var lookup = this._equipmentMatrix[item.equipmentKey];
		if (lookup) {
			space = lookup[0];
			weight = lookup[1];
		} else {
			if (item.requiredCargoSpace === 0) {
				space = 1;
				weight = 1;
			} else {
				space = 0;
				weight = item.requiredCargoSpace;
			}
		}
		var colr = this._menuColor;
		var dam = 1;
		if (p.equipmentStatus(item.equipmentKey) === &quot;EQUIPMENT_DAMAGED&quot;) {
			colr = this._damagedColor;
			dam = 0.5;
		}
		// special case for armour
		if (this._frontarmour.indexOf(item.equipmentKey) &gt;= 0 &amp;&amp; p.script._armourFront &lt; 100) {
			colr = this._damagedColor;
			dam = 0.5;
		}
		if (this._aftarmour.indexOf(item.equipmentKey) &gt;= 0 &amp;&amp; p.script._armourAft &lt; 100) {
			colr = this._damagedColor;
			dam = 0.5;
		}

		if (item.isVisible &amp;&amp; item.requiresEmptyPylon === false &amp;&amp; (space &gt; 0 || weight &gt; 0)) {
			// any items in the negotiate list will show as &quot;???&quot; in the cost column
			// if the player chooses to sell this item he will have to negotiate a price
			var loop = 1;
			// special case for passenger berths - only 1 item is in the equipment list, but you could have multiple installed
			if (item.equipmentKey === &quot;EQ_PASSENGER_BERTH&quot;) loop = p.passengerCapacity;

			var pf = stn.equipmentPriceFactor;
			// these items don&#39;t use the price factoring
			if (this._priceFactor.indexOf(item.equipmentKey) &gt;= 0) {
				pf = priceFactor;
			}
			var idx = curr.indexOf(item.equipmentKey);
			var disabled = &quot;&quot;;
			if (item.effectiveTechLevel &gt; stn.equivalentTechLevel) {disabled = &quot;Low TL&quot;; colr = this._disabledColor;}
			if (this.$equipmentIsRequired(item.equipmentKey) === true) {disabled = &quot;Required&quot;; colr = this._disabledColor;}

			for (var j = 1; j &lt;= loop; j++) {
				list.push({
					eq: item.equipmentKey,
					space: space,
					weight: weight,
					cost: (this._sellNegotiate.indexOf(item.equipmentKey) &gt;= 0 ? &quot;???&quot; : (item.price / 10) * dam * (idx &gt;= 0 ? this._refundPct : 1) * pf),
					color: colr,
					name: (item.equipmentKey === &quot;EQ_PASSENGER_BERTH&quot; ? &quot;Passenger Berth&quot; : item.name),
					section: &quot;&quot;,
					disabled: disabled
				});
			}
		}
	}
	// laser weapons
	colr = this._menuColor;
	var lmss = worldScripts.LMSS_Core;
	var section = [&quot;Forward&quot;, &quot;Aft&quot;, &quot;Port&quot;, &quot;Starboard&quot;, &quot;Forward (Secondary)&quot;, &quot;Aft (Secondary)&quot;, &quot;Port (Secondary)&quot;, &quot;Starboard (Secondary)&quot;];
	for (var i = 0; i &lt; 7; i++) {
		var key = &quot;&quot;;
		switch (i) {
			case 0:
				key = p.forwardWeapon.equipmentKey;
				break;
			case 1:
				key = p.aftWeapon.equipmentKey;
				break;
			case 2:
				key = p.portWeapon.equipmentKey;
				break;
			case 3:
				key = p.starboardWeapon.equipmentKey;
				break;
			case 4:
				if (lmss) key = lmss._forwardAltKey;
				break;
			case 5:
				if (lmss) key = lmss._aftAltKey;
				break;
			case 6:
				if (lmss) key = lmss._portAltKey;
				break;
			case 7:
				if (lmss) key = lmss._starboardAltKey;
				break;
		}
		if (key !== &quot;&quot; &amp;&amp; key !== &quot;EQ_WEAPON_NONE&quot;) {
			var item = EquipmentInfo.infoForKey(key);
			var space = 0;
			var weight = 0;
			var zeroSpace = 0;

			var lookup = this._equipmentMatrix[item.equipmentKey];
			if (lookup) {
				space = parseFloat(lookup[0]);
				weight = parseFloat(lookup[1]);
			} else {
				space = 0;
				weight = 1;
			}

			if (item.effectiveTechLevel &lt;= stn.equivalentTechLevel) {
				list.push({
					eq: item.equipmentKey,
					space: space,
					weight: weight,
					cost: (item.price / 10),
					color: colr,
					name: item.name + &quot; (&quot; + section[i] + &quot;)&quot;,
					section: i,
					disabled: &quot;&quot;
				});
			}
		}
	}

	if (list.length &gt; 0) {
		list.sort(compare);

		var maxpage = Math.ceil(list.length / pagesize);
		if (maxpage &lt; (this._page + 1)) this._page -= 1;
		var end = ((this._page * pagesize) + pagesize);
		if (end &gt; list.length) end = list.length;
		// note: then station equipmentPriceFactor has been removed to prevent exploitation of equipment sales at different stations (galcop =&gt; rock hermit)
		for (var i = (this._page * pagesize); i &lt; end; i++) {
			curChoices[&quot;01_EQUIP-&quot; + (i &lt; 10 ? &quot;0&quot; : &quot;&quot;) + i + &quot;~&quot; + list[i].eq + (list[i].section !== &quot;&quot; ? &quot;|&quot; + list[i].section : &quot;&quot;)] = {
				text: this.$padTextRight(list[i].name, 16) +
					this.$padTextLeft(list[i].space.toFixed(1) + spc + &quot;t&quot;, 4) +
					this.$padTextLeft(list[i].weight.toFixed(1) + spc + &quot;t&quot;, 4) +
					(list[i].disabled === &quot;&quot; ? (list[i].cost === &quot;???&quot; ? this.$padTextLeft(&quot;???&quot;, 8) :
						this.$padTextLeft(formatCredits((list[i].cost), true, true), 8)) : this.$padTextLeft(list[i].disabled, 8)), //* stn.equipmentPriceFactor
				alignment: &quot;LEFT&quot;,
				color: list[i].color,
				unselectable: (list[i].disabled != &quot;&quot; ? true : false)
			};
			itemcount += 1;
		}
		for (var i = 0; i &lt; ((pagesize + 1) - itemcount); i++) {
			curChoices[&quot;90_SPACER_&quot; + i] = &quot;&quot;;
		}
	} else {
		text += expandDescription(&quot;[sc-equipment-none-to-sell]&quot;);
	}

	if (maxpage &gt; 1 &amp;&amp; this._page &lt; (maxpage - 1)) {
		curChoices[&quot;95_NEXT&quot;] = {
			text: &quot;[sc-nextpage]&quot;,
			color: this._itemColor
		};
	} else {
		curChoices[&quot;95_NEXT&quot;] = {
			text: &quot;[sc-nextpage]&quot;,
			color: this._disabledColor,
			unselectable: true
		};
	}
	if (this._page &gt; 0) {
		curChoices[&quot;96_PREV&quot;] = {
			text: &quot;[sc-prevpage]&quot;,
			color: this._itemColor
		};
	} else {
		curChoices[&quot;96_PREV&quot;] = {
			text: &quot;[sc-prevpage]&quot;,
			color: this._disabledColor,
			unselectable: true
		};
	}

	var def = &quot;99_EXIT&quot;;
	if (this._lastChoice[20] != &quot;&quot;) def = this._lastChoice[20];

	var opts = {
		screenID: &quot;oolite-shipconfig-sell-map&quot;,
		title: &quot;Sell Equipment&quot;,
		allowInterrupt: interrupt,
		exitScreen: this._sellEquipExitScreen,
		choices: curChoices,
		initialChoicesKey: def,
		message: text
	};

	this.$addShipModelToScreen(opts);
	mission.runScreen(opts, this.$sellEquipmentScreenHandler, this);
	this.$finaliseShipModel();
}

//-------------------------------------------------------------------------------------------------------------
this.$sellEquipmentScreenHandler = function $sellEquipmentScreenHandler(choice) {
	if (!choice) return;

	var p = player.ship;
	var stn = p.dockedStation;

	if (this._source != &quot;REMOVEITEM&quot;) this._lastChoice[20] = choice;

	if (choice.indexOf(&quot;01_EQUIP&quot;) &gt;= 0) {
		var item = choice.substring(choice.indexOf(&quot;~&quot;) + 1);
		var section = &quot;&quot;;
		// check for a laser position
		if (item.indexOf(&quot;|&quot;) &gt;= 0) {
			section = item.split(&quot;|&quot;)[1];
			item = item.split(&quot;|&quot;)[0];
		}

		var info = EquipmentInfo.infoForKey(item);
		if (section === &quot;&quot;) {
			if (this._sellNegotiate.indexOf(item) &gt;= 0) {
				var cost = (info.price / 10) * this._refundPct;
				if (p.equipmentStatus(item) === &quot;EQUIPMENT_DAMAGED&quot;) cost *= 0.5;
				worldScripts.ShipConfiguration_SellNegotiate.$displayInitialScreen(item, cost);
				return;
			}
			var dam = p.equipmentStatus(item);

			// special case for passenger berths
			if (item === &quot;EQ_PASSENGER_BERTH&quot;) {
				var creds = player.credits;
				p.awardEquipment(&quot;EQ_PASSENGER_BERTH_REMOVAL&quot;);
				p.credits = creds;
			} else {
				p.removeEquipment(item);
			}
		} else {
			var lmss = worldScripts.LMSS_Core;
			switch (section) {
				case &quot;0&quot;:
					p.forwardWeapon = &quot;EQ_WEAPON_NONE&quot;;
					break;
				case &quot;1&quot;:
					p.aftWeapon = &quot;EQ_WEAPON_NONE&quot;;
					break;
				case &quot;2&quot;:
					p.portWeapon = &quot;EQ_WEAPON_NONE&quot;;
					break;
				case &quot;3&quot;:
					p.starboardWeapon = &quot;EQ_WEAPON_NONE&quot;
					break;
				case &quot;4&quot;:
					lmss._forwardAltKey = &quot;EQ_WEAPON_NONE&quot;;
					p.removeEquipment(&quot;EQ_LMSS_FRONT_WEAPON&quot;);
					break;
				case &quot;5&quot;:
					lmss._aftAltKey = &quot;EQ_WEAPON_NONE&quot;;
					p.removeEquipment(&quot;EQ_LMSS_AFT_WEAPON&quot;);
					break;
				case &quot;6&quot;:
					lmss._portAltKey = &quot;EQ_WEAPON_NONE&quot;;
					p.removeEquipment(&quot;EQ_LMSS_PORT_WEAPON&quot;);
					break;
				case &quot;7&quot;:
					lmss._starboardAltKey = &quot;EQ_WEAPON_NONE&quot;;
					p.removeEquipment(&quot;EQ_LMSS_STARBOARD_WEAPON&quot;);
					break;
			}
			if (lmss) lmss.$updateManifest();
			var dam = &quot;EQUIPMENT_OK&quot;; // lasers can&#39;t be damaged
		}
		// is this new or used? idx === -1 means new, otherwise any number &gt;= 0 means used
		var idx = this._currEquip.indexOf(item);
		if (idx &gt;= 0) this._currEquip.splice(idx, 1);

		var doRefund = true;
		// reset the holding dict
		this._current = {};
		if (this._freeUpgrades === true) {
			// don&#39;t give the player a refund for these, otherwise they can make money by buying and selling the same thing
			if (this._fuelinjectors.indexOf(item) &gt;= 0 ||
				this._fuelscoops.indexOf(item) &gt;= 0 ||
				this._heatshields.indexOf(item) &gt;= 0 ||
				this._armour.indexOf(item) &gt;= 0 ||
				this._boosters.indexOf(item) &gt;= 0)
				doRefund = false;
		}
		var priceFactor = stn.equipmentPriceFactor;
		if (this._priceFactor.indexOf(item) &gt;= 0) {
			priceFactor = this.$equipmentPriceFactor(p.shipClassName, this.$getShipMass(p));
		}
		// lasers get a full refund, to match what happens when you do a buy/replace
		var refund = (info.price / 10) * (info.equipmentKey.indexOf(&quot;EQ_WEAPON&quot;) &gt;= 0 || (idx === -1 ? 1 : this._refundPct)) * priceFactor;
		if (dam === &quot;EQUIPMENT_DAMAGED&quot;) refund *= 0.5;
		if (doRefund === true) player.credits += refund;

		// give the player an email, if installed
		var ga = worldScripts.GalCopAdminServices;
		if (ga &amp;&amp; doRefund === true) {
			ga._oldCredits = player.credits - (doRefund === true ? refund : 0);
			ga.playerBoughtEquipment(item);
		}
		this.$addEquipmentSpaceItem(p);
		this.$playSound(&quot;sell&quot;);
	}

	if (choice === &quot;95_NEXT&quot;) this._page += 1;
	if (choice === &quot;96_PREV&quot;) this._page -= 1;
	if (choice === &quot;98_SWITCH&quot;) {
		this._source = &quot;&quot;;
		this.$shipConfig();
		return;
	}

	if (this._source === &quot;REMOVEITEM&quot;) return;

	if (choice != &quot;99_EXIT&quot;) {
		this.$sellEquipment();
		return;
	}

	if (choice === &quot;99_EXIT&quot; &amp;&amp; this._source === &quot;CONFIGSCREEN&quot;) {
		this._source = &quot;&quot;;
		this.$shipConfig();
	}
	worldScripts.ShipConfiguration_F3HUDControl.guiScreenChanged();
}

//-------------------------------------------------------------------------------------------------------------
// add the ship model, or an overlay, to the options for a mission screen
this.$addShipModelToScreen = function $addShipModelToScreen(opts) {
	var p = player.ship;
	if (this._shipModel === true) {
		opts[&quot;model&quot;] = &quot;[&quot; + p.dataKey + &quot;]&quot;;
		opts[&quot;modelPersonality&quot;] = p.entityPersonality;
		opts[&quot;spinModel&quot;] = false;
		if (p.hudHidden === true || this.$isBigGuiActive() === true) {
			opts[&quot;overlay&quot;] = {
				name: &quot;shipconfig_mask.png&quot;,
				height: 546
			};
		} else {
			opts[&quot;overlay&quot;] = {
				name: &quot;shipconfig_mask_sml.png&quot;,
				height: 546
			};
		}
	} else {
		opts[&quot;overlay&quot;] = {
			name: &quot;shipconfig_rocket.png&quot;,
			height: 546
		};
	}
}

//-------------------------------------------------------------------------------------------------------------
this.$finaliseShipModel = function $finaliseShipModel() {

	if (this._shipModel === false) return;

	var m = mission.displayModel;
	// rotate model for a better view
	if (m) {
		// if gallery has been loaded and used, remove the frame callback
		var w = worldScripts.gallery;
		if (w &amp;&amp; isValidFrameCallback(w.$GalleryFCB)) removeFrameCallback(w.$GalleryFCB);

		var zoom_factor = 3.6;
		if (this._shipModel) {
			if (this._zoomOverride[player.ship.shipClassName]) zoom_factor = this._zoomOverride[player.ship.shipClassName];
		}
		// zoom and rotate the image
		m.position = Vector3D(0, 0, m.collisionRadius * zoom_factor);
		m.orientation = m.orientation.rotate([0, 0, 0]);
		m.orientation = m.orientation.rotateZ(Math.PI * 1.2);
		m.orientation = m.orientation.rotateX(-1.1);
	}
}

//=============================================================================================================
// calculation/general functions

//-------------------------------------------------------------------------------------------------------------
// attach our equipment processing scripts to the player ship script object
this.$setUpScriptConfig = function $setUpScriptConfig() {
	var p = player.ship;
	if (!p.script.$equipmentDamaged_Event) p.script.$equipmentDamaged_Event = this.$equipmentDamaged_Event;
	if (!p.script.$awaitEquipmentDamaged) p.script.$awaitEquipmentDamaged = this.$awaitEquipmentDamaged;
	if (!p.script.$checkRemainingEnergy) p.script.$checkRemainingEnergy = this.$checkRemainingEnergy;
	if (p.script.hasOwnProperty(&quot;_damagedItems&quot;) === false) p.script._damagedItems = []; // list of damaged items that required config adjustment
	if (p.script.hasOwnProperty(&quot;_checkForDamage&quot;) === false) p.script._checkForDamage = null; // timer used to call &quot;$awaitEquipmentDamaged&quot; to check the &quot;damagedItems&quot; array
}

//-------------------------------------------------------------------------------------------------------------
// this script should be attached to a ship.script object, including the player ship, for use inside the ship in question
this.$equipmentDamaged_Event = function $equipmentDamaged_Event(equipmentKey) {

	var isPlayer = this.ship.isPlayer;
	var sc = worldScripts.ShipConfiguration_Core;

	if (isPlayer &amp;&amp; sc._damaging === true) return;

	// armour handled in it&#39;s own script
	if (sc._armour.indexOf(equipmentKey) &gt;= 0) return;

	if (isPlayer) sc._damaging = true;

	if (equipmentKey === &quot;EQ_HEAT_SINK&quot;) {
		// do we have any working heat sinks?
		if (this.ship.equipmentStatus(&quot;EQ_HEAT_SINK&quot;, true)[&quot;EQUIPMENT_OK&quot;] == 0) {
			this.ship.removeEquipment(&quot;EQ_HEAT_SINK_CONTROL&quot;);
			this.ship.removeEquipment(&quot;EQ_HEAT_SINK_CONTROL_PASSIVE&quot;);
		}
	}

	if (!this.ship.script._damagedItems) this.ship.script._damagedItems = [];

	// when engines are damaged, reduce maxThrust/maxSpeed
	// when thrusters are damaged, reduce maxPitch and maxRoll
	// when hyperdrive is damaged, disable hyperjumps
	// when energy banks are disabled, stop recharging, start a slow energy leak
	// when shields are damaged, reduce to 0
	// when heat shield is damaged, reduce heat shielding on ship

	if (sc._engines.indexOf(equipmentKey) &gt;= 0) {
		// damage the injectors before the engine
		if (this.ship.equipmentStatus(sc.$equipmentItemInUse(&quot;fuelinjectors&quot;, this.ship)) === &quot;EQUIPMENT_OK&quot;) {
			this.ship.setEquipmentStatus(equipmentKey, &quot;EQUIPMENT_OK&quot;);
			if (isPlayer) sc._damaging = false;
			this.ship.setEquipmentStatus(sc.$equipmentItemInUse(&quot;fuelinjectors&quot;, this.ship), &quot;EQUIPMENT_DAMAGED&quot;);
			return;
		}
		this.ship.script._damagedItems.push(equipmentKey);
		if (!this.ship.script._checkForDamage || !this.ship.script._checkForDamage.isRunning) {
			this.ship.script._checkForDamage = new Timer(this, this.ship.script.$awaitEquipmentDamaged, 0.25, 0);
		}
	}
	if (sc._thrusters.indexOf(equipmentKey) &gt;= 0) {
		this.ship.script._damagedItems.push(equipmentKey);
		if (!this.ship.script._checkForDamage || !this.ship.script._checkForDamage.isRunning) {
			this.ship.script._checkForDamage = new Timer(this, this.ship.script.$awaitEquipmentDamaged, 0.25, 0);
		}
	}
	if (sc._energy.indexOf(equipmentKey) &gt;= 0) {
		// damage extra energy units before base energy units
		if (this.ship.equipmentStatus(&quot;EQ_ENERGY_GRID&quot;) === &quot;EQUIPMENT_OK&quot;) {
			this.ship.setEquipmentStatus(equipmentKey, &quot;EQUIPMENT_OK&quot;);
			this.ship.setEquipmentStatus(&quot;EQ_ENERGY_GRID&quot;, &quot;EQUIPMENT_DAMAGED&quot;);
			if (isPlayer) {
				sc.$playSound(&quot;explosion&quot;);
				sc._damaging = false;
			}
			return;
		}
		if (this.ship.equipmentStatus(&quot;EQ_NAVAL_GRID&quot;) === &quot;EQUIPMENT_OK&quot;) {
			this.ship.setEquipmentStatus(equipmentKey, &quot;EQUIPMENT_OK&quot;);
			this.ship.setEquipmentStatus(&quot;EQ_NAVAL_GRID&quot;, &quot;EQUIPMENT_DAMAGED&quot;);
			if (isPlayer) {
				sc.$playSound(&quot;explosion&quot;);
				sc._damaging = false;
			}
			return;
		}
		if (this.ship.equipmentStatus(&quot;EQ_NAVAL_ENERGY_UNIT&quot;) === &quot;EQUIPMENT_OK&quot;) {
			this.ship.setEquipmentStatus(equipmentKey, &quot;EQUIPMENT_OK&quot;);
			this.ship.setEquipmentStatus(&quot;EQ_NAVAL_ENERGY_UNIT&quot;, &quot;EQUIPMENT_DAMAGED&quot;);
			if (isPlayer) {
				sc.$playSound(&quot;explosion&quot;);
				sc._damaging = false;
			}
			return;
		}
		if (this.ship.equipmentStatus(&quot;EQ_ENERGY_UNIT&quot;) === &quot;EQUIPMENT_OK&quot;) {
			this.ship.setEquipmentStatus(equipmentKey, &quot;EQUIPMENT_OK&quot;);
			this.ship.setEquipmentStatus(&quot;EQ_ENERGY_UNIT&quot;, &quot;EQUIPMENT_DAMAGED&quot;);
			if (isPlayer) {
				sc.$playSound(&quot;explosion&quot;);
				sc._damaging = false;
			}
			return;
		}
		this.ship.script._damagedItems.push(equipmentKey);
		if (!this.ship.script._checkForDamage || !this.ship.script._checkForDamage.isRunning) {
			this.ship.script._checkForDamage = new Timer(this, this.ship.script.$awaitEquipmentDamaged, 0.25, 0);
		}
	}

	if (sc._frontshields.indexOf(equipmentKey) &gt;= 0 || sc._aftshields.indexOf(equipmentKey) &gt;= 0 || sc._shieldEquipment.indexOf(equipmentKey) &gt;= 0) {
		// damage the naval grid, shield booster and mil shield enhancements first
		/* if (this.ship.equipmentStatus(&quot;EQ_ENERGY_GRID&quot;) === &quot;EQUIPMENT_OK&quot;) {
			this.ship.setEquipmentStatus(equipmentKey, &quot;EQUIPMENT_OK&quot;);
			this.ship.setEquipmentStatus(&quot;EQ_ENERGY_GRID&quot;, &quot;EQUIPMENT_DAMAGED&quot;);
			if (isPlayer) {
				sc.$playSound(&quot;explosion&quot;);
				sc._damaging = false;
			}
			return;
		}
		if (this.ship.equipmentStatus(&quot;EQ_NAVAL_GRID&quot;) === &quot;EQUIPMENT_OK&quot;) {
			this.ship.setEquipmentStatus(equipmentKey, &quot;EQUIPMENT_OK&quot;);
			this.ship.setEquipmentStatus(&quot;EQ_NAVAL_GRID&quot;, &quot;EQUIPMENT_DAMAGED&quot;);
			if (isPlayer) {
				sc.$playSound(&quot;explosion&quot;);
				sc._damaging = false;
			}
			return;
		}
		if (this.ship.equipmentStatus(&quot;EQ_NAVAL_SHIELD_BOOSTER&quot;) === &quot;EQUIPMENT_OK&quot;) {
			this.ship.setEquipmentStatus(equipmentKey, &quot;EQUIPMENT_OK&quot;);
			this.ship.setEquipmentStatus(&quot;EQ_NAVAL_SHIELD_BOOSTER&quot;, &quot;EQUIPMENT_DAMAGED&quot;);
			if (isPlayer) {
				sc.$playSound(&quot;explosion&quot;);
				sc._damaging = false;
			}
			return;
		}
		if (this.ship.equipmentStatus(&quot;EQ_SHIELD_BOOSTER&quot;) === &quot;EQUIPMENT_OK&quot;) {
			this.ship.setEquipmentStatus(equipmentKey, &quot;EQUIPMENT_OK&quot;);
			this.ship.setEquipmentStatus(&quot;EQ_SHIELD_BOOSTER&quot;, &quot;EQUIPMENT_DAMAGED&quot;);
			if (isPlayer) {
				sc.$playSound(&quot;explosion&quot;);
				sc._damaging = false;
			}
			return;
		} */
		this.ship.script._damagedItems.push(equipmentKey);
		if (!this.ship.script._checkForDamage || !this.ship.script._checkForDamage.isRunning) {
			this.ship.script._checkForDamage = new Timer(this, this.ship.script.$awaitEquipmentDamaged, 0.25, 0);
		}
	}
	if (sc._heatshields.indexOf(equipmentKey) &gt;= 0) {
		this.ship.script._damagedItems.push(equipmentKey);
		if (!this.ship.script._checkForDamage || !this.ship.script._checkForDamage.isRunning) {
			this.ship.script._checkForDamage = new Timer(this, this.ship.script.$awaitEquipmentDamaged, 0.25, 0);
		}
	}
	// special case for when another OXP causes damage to heat shield
	if (equipmentKey === &quot;EQ_HEAT_SHIELD&quot;) {
		if (isPlayer) sc._damaging = false;
		this.ship.setEquipmentStatus(sc.$equipmentItemInUse(&quot;heatshields&quot;, this.ship), &quot;EQUIPMENT_DAMAGED&quot;);
		return;
	}
	if (sc._fuelinjectors.indexOf(equipmentKey) &gt;= 0) {
		this.ship.script._damagedItems.push(equipmentKey);
		if (!this.ship.script._checkForDamage || !this.ship.script._checkForDamage.isRunning) {
			this.ship.script._checkForDamage = new Timer(this, this.ship.script.$awaitEquipmentDamaged, 0.25, 0);
		}
	}
	// special case for when another OXP causes damage to fuel injectors
	if (equipmentKey === &quot;EQ_FUEL_INJECTION&quot;) {
		if (isPlayer) sc._damaging = false;
		this.ship.setEquipmentStatus(sc.$equipmentItemInUse(&quot;fuelinjectors&quot;, this.ship), &quot;EQUIPMENT_DAMAGED&quot;);
		return;
	}
	if (sc._fuelscoops.indexOf(equipmentKey) &gt;= 0) {
		this.ship.script._damagedItems.push(equipmentKey);
		if (!this.ship.script._checkForDamage || !this.ship.script._checkForDamage.isRunning) {
			this.ship.script._checkForDamage = new Timer(this, this.ship.script.$awaitEquipmentDamaged, 0.25, 0);
		}
	}
	// special case for when another OXP causes damage to fuel scoops
	if (equipmentKey === &quot;EQ_FUEL_SCOOPS&quot;) {
		if (isPlayer) sc._damaging = false;
		this.ship.setEquipmentStatus(sc.$equipmentItemInUse(&quot;fuelscoops&quot;, this.ship), &quot;EQUIPMENT_DAMAGED&quot;);
		return;
	}
	if (sc._hyperdrive.indexOf(equipmentKey) &gt;= 0) {
		this.ship.script._damagedItems.push(equipmentKey);
		if (!this.ship.script._checkForDamage || !this.ship.script._checkForDamage.isRunning) {
			this.ship.script._checkForDamage = new Timer(this, this.ship.script.$awaitEquipmentDamaged, 0.25, 0);
		}
	}

	if (isPlayer) sc._damaging = false;
}

//-------------------------------------------------------------------------------------------------------------
// this script should be attached to a ship.script object, for use inside the ship in question
this.$awaitEquipmentDamaged = function $awaitEquipmentDamaged() {

	if (this.ship == null) return;
	if (!this.ship.script) return;
	
	//var p = player.ship;
	var sc = worldScripts.ShipConfiguration_Core;
	var isPlayer = this.ship.isPlayer;

	delete this.ship.script._checkForDamage;
	for (var i = this.ship.script._damagedItems.length - 1; i &gt;= 0; i--) {
		// make sure the equipment didn&#39;t get repaired by the armour script
		if (this.ship.equipmentStatus(this.ship.script._damagedItems[i]) === &quot;EQUIPMENT_DAMAGED&quot;) {
			if (isPlayer) sc.$playSound(&quot;explosion&quot;);
			if (sc._engines.indexOf(this.ship.script._damagedItems[i]) &gt;= 0) {
				this.ship.maxSpeed = this.ship.maxSpeed * 0.67;
				this.ship.maxThrust = this.ship.maxThrust * 0.67;
				this.ship.thrust = this.ship.maxThrust;
				if (isPlayer) player.consoleMessage(&quot;Warning! Engines damaged!&quot;, 4);
			}
			if (sc._thrusters.indexOf(this.ship.script._damagedItems[i]) &gt;= 0) {
				this.ship.maxPitch = this.ship.maxPitch * 0.75;
				this.ship.maxRoll = this.ship.maxRoll * 0.75;
				if (isPlayer) player.consoleMessage(&quot;Warning! Thrusters damaged!&quot;, 4);
			}
			if (sc._boosters.indexOf(this.ship.script._damagedItems[i]) &gt;= 0) {
				this.ship.script._boosterHeatPoint = 0;
				this.ship.maxSpeed = sc.$calculatedValue(&quot;speed&quot;, this.ship);
				this.ship.maxThrust = sc.$calculatedValue(&quot;thrust&quot;, this.ship);
				this.ship.thrust = this.ship.maxThrust;
				this.ship.maxPitch = sc.$calculatedValue(&quot;pitch&quot;, this.ship);
				this.ship.maxRoll = sc.$calculatedValue(&quot;roll&quot;, this.ship);
				this.ship.maxYaw = sc.$calculatedValue(&quot;yaw&quot;, this.ship);
				if (isPlayer) player.consoleMessage(&quot;Warning! Boosters damaged!&quot;, 4);
			}
			if (sc._energy.indexOf(this.ship.script._damagedItems[i]) &gt;= 0) {
				this.ship.script._energyRechargeRate_Stored = this.ship.energyRechargeRate;
				this.ship.energyRechargeRate = 0;
				if (isPlayer) player.consoleMessage(&quot;Warning! Energy banks damaged!&quot;, 4);
				if (this.ship.alertCondition != 0) {
					if (!this.ship.script._energyTimer || !this.ship.script._energyTimer.isRunning) {
						this.ship.script._energyTimer = new Timer(this, this.ship.script.$checkRemainingEnergy, 1, 1);
					}
				}
			}
			if (sc._frontshields.indexOf(this.ship.script._damagedItems[i]) &gt;= 0) {
				// should be compatible with naval grid - we are damaging those items before allowing damage to shields
				// so NG should have reset the recharge rate by this point
				//this.ship.script._forwardShieldRechargeRate_Stored = this.ship.forwardShieldRechargeRate;
				//this.ship.forwardShieldRechargeRate = -0.5;
				sc.$updateShieldValues(this.ship);
				if (isPlayer) {
					player.consoleMessage(&quot;Warning! Front shield generator damaged!&quot;, 4);
					sc.$disableShieldOXPs();
				}
			}
			if (sc._aftshields.indexOf(this.ship.script._damagedItems[i]) &gt;= 0) {
				//this.ship.script._aftshieldsRechargeRate_Stored = this.ship.aftShieldRechargeRate;
				//this.ship.aftShieldRechargeRate = -0.5;
				sc.$updateShieldValues(this.ship);
				if (isPlayer) {
					player.consoleMessage(&quot;Warning! Aft shield generator damaged!&quot;, 4);
					sc.$disableShieldOXPs();
				}
			}
			if (sc._shieldEquipment.indexOf(this.ship.script._damagedItems[i]) &gt;= 0) {
				sc.$updateShieldValues(this.ship);
			}
			if (sc._fuelinjectors.indexOf(this.ship.script._damagedItems[i]) &gt;= 0) {
				if (isPlayer) player.consoleMessage(&quot;Warning! Fuel injectors damaged!&quot;, 4);
				if (isPlayer) sc._damaging = true;
				this.ship.setEquipmentStatus(&quot;EQ_FUEL_INJECTION&quot;, &quot;EQUIPMENT_DAMAGED&quot;);
				if (isPlayer) sc._damaging = false;
			}
			if (sc._fuelscoops.indexOf(this.ship.script._damagedItems[i]) &gt;= 0) {
				if (isPlayer) player.consoleMessage(&quot;Warning! Fuel scoops damaged!&quot;, 4);
				if (isPlayer) sc._damaging = true;
				this.ship.setEquipmentStatus(&quot;EQ_FUEL_SCOOPS&quot;, &quot;EQUIPMENT_DAMAGED&quot;);
				if (isPlayer) sc._damaging = false;
			}
			if (sc._heatshields.indexOf(this.ship.script._damagedItems[i]) &gt;= 0) {
				// reset heat shield strength back to the baseline for the ship
				var shipspec = Ship.shipDataForKey(this.ship.dataKey);
				this.ship.heatInsulation = parseFloat((shipspec[&quot;heat_insulation&quot;] ? shipspec[&quot;heat_insulation&quot;] : 1.0));
				this.ship.script._heat_sink_factor = parseFloat(this._defaultHeatShieldHSFactor);
				if (isPlayer) player.consoleMessage(&quot;Warning! Heat shield damaged!&quot;, 4);
				if (isPlayer) sc._damaging = true;
				this.ship.setEquipmentStatus(&quot;EQ_HEAT_SHIELD&quot;, &quot;EQUIPMENT_DAMAGED&quot;);
				if (isPlayer) sc._damaging = false;
			}
			if (sc._hyperdrive.indexOf(this.ship.script._damagedItems[i]) &gt;= 0) {
				this.ship.hyperdriveSpinTime = 50;
				if (isPlayer) player.consoleMessage(&quot;Warning! Hyperdrive damaged!&quot;, 4);
				if (Math.random() &lt; 0.34) {
					this.ship.fuelLeakRate = 0.25;
					if (isPlayer) player.consoleMessage(&quot;ALERT! Quirium fuel leakage detected!&quot;, 3);
				}
			}
		}
		this.ship.script._damagedItems.splice(i, 1);
	}

	// if something got damaged while we were processing, set the timer up again
	if (this.ship.script._damagedItems.length &gt; 0) {
		this.ship.script._checkForDamage = new Timer(this, this.ship.script.$awaitEquipmentDamaged, 0.25, 0);
	}
}

//-------------------------------------------------------------------------------------------------------------
// this script should be attached to a ship.script object, for use inside the ship in question
this.$checkRemainingEnergy = function $checkRemainingEnergy() {
	// make sure we&#39;re still attached to a valid entity
	if (this.ship.isValid === false || this.ship.isInSpace === false) {
		if (this.ship.script) {
			this.ship.script._energyTimer.stop();
			delete this.ship.script._energyTimer;
		}
		return;
	}
	this.ship.energy -= 1;
	this.ship.script._counter += 1;
	if (this.ship.script._counter === 30) {
		if (this.ship.isPlayer) player.consoleMessage(&quot;Warning! Energy levels depleting!&quot;, 4);
		this.ship.script._counter = 0;
	}
	if (this.ship.energy &lt; 30) {
		this.ship.script._energyTimer.stop();
		delete this.ship.script._energyTimer;
		this.ship.energyRechargeRate = 0;
		if (this.ship.isPlayer) player.consoleMessage(&quot;Warning! Energy levels critical!&quot;, 4);
	}
}

//-------------------------------------------------------------------------------------------------------------
// turn off shield cycler and shield equaliser, if installed
this.$disableShieldOXPs = function $disableShieldOXPs() {
	var p = player.ship;
	// disables Shield Cycler if fitted and active to prevent catastrophic shield/energy loss.
	if (p.equipmentStatus(&quot;EQ_SC_SHIELD_CYCLER_INTERNAL&quot;) === &quot;EQUIPMENT_OK&quot; &amp;&amp; !worldScripts[&quot;Shield Cycler&quot;].deactivated) {
		if (worldScripts[&quot;Shield Cycler&quot;]._sc_stop()) {
			this._stoppedSC = true;
			player.consoleMessage(&quot;All Shield Cycler functionality disabled pending Primary Shield Generator repair.&quot;, 4);
		}
	}
	// disables Shield Equaliser (and Capacitors) if fitted to prevent catastrophic Shield Loss.
	if (p.equipmentStatus(&quot;EQ_SHIELD_EQUALIZER&quot;) === &quot;EQUIPMENT_OK&quot; &amp;&amp; worldScripts[&quot;shieldequalizercapacitors&quot;].shieldCheckTimer.isRunning) {
		worldScripts[&quot;shieldequalizercapacitors&quot;].shieldCheckTimer.stop();
		this._stoppedSEC = true;
		player.consoleMessage(&quot;All Shield Equalizer functionality disabled pending Primary Shield Generator repair.&quot;, 4);
	}
}

//-------------------------------------------------------------------------------------------------------------
// turn on shield cycler and shield equaliser, if installed
this.$enableShieldOXPs = function $enableShieldOXPs() {
	var p = player.ship;
	if (this._stoppedSC &amp;&amp; worldScripts[&quot;Shield Cycler&quot;].deactivated) {
		if (worldScripts[&quot;Shield Cycler&quot;]._sc_start()) {
			delete this._stoppedSC;
			if (p.equipmentStatus(&quot;EQ_SC_SHIELD_CYCLER_INTERNAL&quot;) === &quot;EQUIPMENT_OK&quot;) {
				player.consoleMessage(&quot;All Shield Cycler functionality re-enabled.&quot;, 4);
			}
		}
	}
	if (this._stoppedSEC &amp;&amp; worldScripts[&quot;shieldequalizercapacitors&quot;].shieldCheckTimer) {
		worldScripts[&quot;shieldequalizercapacitors&quot;].shieldCheckTimer.start();
		delete this._stoppedSEC;
		if (player.ship.equipmentStatus(&quot;EQ_SHIELD_EQUALIZER&quot;) === &quot;EQUIPMENT_OK&quot;) {
			player.consoleMessage(&quot;All Shield Equalizer functionality re-enabled.&quot;, 4);
		}
	}
}

//-------------------------------------------------------------------------------------------------------------
this.$stopTimers = function $stopTimers() {
	var p = player.ship;
	if (p &amp;&amp; p.script &amp;&amp; p.script._energyTimer &amp;&amp; p.script._energyTimer.isRunning) {
		p.script._energyTimer.stop();
		delete p.script._energyTimer;
	}
	if (this._busOverloadResetTimer &amp;&amp; this._busOverloadResetTimer.isRunning) {
		this._busOverloadResetTimer.stop();
	}
	delete this._busOverloadResetTimer;
}

//-------------------------------------------------------------------------------------------------------------
// checks for an overload state and then sets up the flags if overloaded
this.$checkForOverload = function $checkForOverload() {
	var p = player.ship;
	var equipSpace = this.$equipmentSpaceTotal(p);
	var cargoSpace = this.$cargoSpaceAvailable(p); // + this.$cargoEquipmentSpaceAmount(p));

	var used = this.$calcEquipmentSpace(p);
	if (used &gt; equipSpace) {
		// allocate cargo space to equipment space
		var diff = parseInt(used - equipSpace);
		if (diff &gt; cargoSpace) {
			// we don&#39;t have space for this
			// switch into &quot;overloaded&quot; mode so the player can choose what item to remove
			this._initialSetup = true;
			this._promptPlayer = true;
		}
	}
}

//-------------------------------------------------------------------------------------------------------------
// returns true if the player has an alternative armour installed, otherwise false
this.$playerHasOtherArmour = function $playerHasOtherArmour() {
	var p = player.ship;
	var result = false;
	for (var i = 0; i &lt; this._altArmour.length; i++) {
		var sts = p.equipmentStatus(this._altArmour[i]);
		if (sts === &quot;EQUIPMENT_OK&quot; || sts === &quot;EQUIPMENT_DAMAGED&quot;) result = true;
	}
	return result;
}

//-------------------------------------------------------------------------------------------------------------
// calculate how much bus overload exists on the ship
this.$busOverloadChance = function $busOverloadChance(ship) {

	if (!ship) return 0;

	// work out if anything is over the coupling/bus class
	var total = 0;
	var eq = 0;
	var check = 0;

	var bus = this.$equipmentCouplingLevelInUse(&quot;electricalbus&quot;, ship);

	eq = parseInt(this.$equipmentCouplingLevelInUse(&quot;engines&quot;, ship));
	check = parseInt(this.$equipmentCouplingRequired(&quot;engines&quot;, this.$equipmentItemInUse(&quot;engines&quot;, ship), ship));
	if ((check - eq) &gt; 0) total += ((check - eq) * 2);
	if ((eq - bus) &gt; 0) total += (eq - bus);

	// fi use the engines power coupling
	eq = parseInt(this.$equipmentCouplingLevelInUse(&quot;fuelinjectors&quot;, ship));
	check = parseInt(this.$equipmentCouplingRequired(&quot;fuelinjectors&quot;, this.$equipmentItemInUse(&quot;fuelinjectors&quot;, ship), ship));
	if ((check - eq) &gt; 0) total += ((check - eq) * 2);
	if ((eq - bus) &gt; 0) total += (eq - bus);

	if (this.$shipHasHyperspaceMotor(ship.dataKey) === true &amp;&amp; this._OXPHyperdrives === false) {
		eq = parseInt(this.$equipmentCouplingLevelInUse(&quot;hyperdrive&quot;, ship));
		check = parseInt(this.$equipmentCouplingRequired(&quot;hyperdrive&quot;, this.$equipmentItemInUse(&quot;hyperdrive&quot;, ship), ship));
		if ((check - eq) &gt; 0) total += ((check - eq) * 2);
		if ((eq - bus) &gt; 0) total += (eq - bus);
	}

	eq = parseInt(this.$equipmentCouplingLevelInUse(&quot;thrusters&quot;, ship));
	check = parseInt(this.$equipmentCouplingRequired(&quot;thrusters&quot;, this.$equipmentItemInUse(&quot;thrusters&quot;, ship), ship));
	if ((check - eq) &gt; 0) total += ((check - eq) * 2);
	if ((eq - bus) &gt; 0) total += (eq - bus);

	eq = parseInt(this.$equipmentCouplingLevelInUse(&quot;boosters&quot;, ship));
	check = parseInt(this.$equipmentCouplingRequired(&quot;boosters&quot;, this.$equipmentItemInUse(&quot;boosters&quot;, ship), ship));
	if ((check - eq) &gt; 0) total += ((check - eq) * 2);
	if ((eq - bus) &gt; 0) total += (eq - bus);

	eq = parseInt(this.$equipmentCouplingLevelInUse(&quot;energy&quot;, ship));
	check = parseInt(this.$equipmentCouplingRequired(&quot;energy&quot;, this.$equipmentItemInUse(&quot;energy&quot;, ship), ship));
	if ((check - eq) &gt; 0) total += ((check - eq) * 2);
	if (eq &gt; 7) eq = 7; // limit equipment coupling level to 7 - bus level 7 handles all energy couplings over 7
	if ((eq - bus) &gt; 0) total += (eq - bus);

	eq = parseInt(this.$equipmentCouplingLevelInUse(&quot;frontshields&quot;, ship));
	check = parseInt(this.$equipmentCouplingRequired(&quot;frontshields&quot;, this.$equipmentItemInUse(&quot;frontshields&quot;, ship), ship));
	if ((check - eq) &gt; 0) total += ((check - eq) * 2);
	if ((eq - bus) &gt; 0) total += (eq - bus);

	eq = parseInt(this.$equipmentCouplingLevelInUse(&quot;aftshields&quot;, ship));
	check = parseInt(this.$equipmentCouplingRequired(&quot;aftshields&quot;, this.$equipmentItemInUse(&quot;aftshields&quot;, ship), ship));
	if ((check - eq) &gt; 0) total += ((check - eq) * 2);
	if ((eq - bus) &gt; 0) total += (eq - bus);

	return total;
}

//-------------------------------------------------------------------------------------------------------------
// decrease the bus overload counter if we haven&#39;t been hit for 30 seconds
this.$decreaseBusOverload = function $decreaseBusOverload() {
	if (this._busOverloadCounter &gt; 0) {
		this._busOverloadCounter -= 1;
		if (this._busOverloadCounter &lt; 0) this._busOverloadCounter = 0;
	} else {
		if (this._busOverloadResetTimer &amp;&amp; this._busOverloadResetTimer.isRunning) this._busOverloadResetTimer.stop();
	}
}

//-------------------------------------------------------------------------------------------------------------
// returns true if the passed equipment key is required by another piece of installed equipment, otherwise false
this.$equipmentIsRequired = function $equipmentIsRequired(equipmentKey) {

	// todo: look at requiresAnyEquipment as well
	var p = player.ship;
	var eq = p.equipment;
	var result = false;

	// special case for passengers: make sure we always have enough berths for the number of passengers currently on board.
	if (equipmentKey === &quot;EQ_PASSENGER_BERTH&quot;) {
		if (p.passengerCount &gt; 0 &amp;&amp; p.passengerCapacity &lt;= p.passengerCount) {
			result = true;
		}
	} else {
		for (var i = 0; i &lt; eq.length; i++) {
			// special case that isn&#39;t listed in equipment config
			//if (equipmentKey === &quot;EQ_SHIELD_BOOSTER&quot; &amp;&amp; eq[i].equipmentKey === &quot;EQ_NAVAL_SHIELD_BOOSTER&quot;) {
			//	result = true;
			//	break;
			// }
			var info = EquipmentInfo.infoForKey(eq[i].equipmentKey);
			if (info.requiresEquipment) {
				if (info.requiresEquipment.indexOf(equipmentKey) &gt;= 0 || 
					// some special cases for ShipConfig items
					((equipmentKey.indexOf(&quot;EQ_FUEL_SCOOPS&quot;) &gt;= 0 &amp;&amp; info.requiresEquipment.indexOf(&quot;EQ_FUEL_SCOOPS&quot;) &gt;= 0) ||
					(equipmentKey.indexOf(&quot;EQ_FUEL_INJECTION&quot;) &gt;= 0 &amp;&amp; info.requiresEquipment.indexOf(&quot;EQ_FUEL_INJECTION&quot;) &gt;= 0) || 
					(equipmentKey.indexOf(&quot;EQ_HEAT_SHIELD&quot;) &gt;= 0 &amp;&amp; info.requiresEquipment.indexOf(&quot;EQ_HEAT_SHIELD&quot;) &gt;= 0))) {
					result = true;
					break;
				}
			}
		}
	}
	return result;
}

//-------------------------------------------------------------------------------------------------------------
// returns the equipment item of a particular section of the ship
this.$equipmentItemInUse = function $equipmentItemInUse(section, ship) {
	if (!ship) return &quot;&quot;;

	var item = &quot;&quot;;
	var check = &quot;&quot;;

	// check if we have a value stored in this._current. if so, we can pick it up from there
	// otherwise we&#39;ll scan through the various equipment item arrays
	if (ship.isPlayer === false || (!this._current[section] || this._current[section] === &quot;&quot;)) {
		switch (section) {
			case &quot;engines&quot;:
				for (var i = 0; i &lt; this._engines.length; i++) {
					check = ship.equipmentStatus(this._engines[i]);
					if (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
						item = this._engines[i];
						break;
					}
				}
				break;
			case &quot;hyperdrive&quot;:
				for (var i = 0; i &lt; this._hyperdrive.length; i++) {
					check = ship.equipmentStatus(this._hyperdrive[i]);
					if (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
						item = this._hyperdrive[i];
						break;
					}
				}
				break;
			case &quot;thrusters&quot;:
				for (var i = 0; i &lt; this._thrusters.length; i++) {
					check = ship.equipmentStatus(this._thrusters[i]);
					if (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
						item = this._thrusters[i];
						break;
					}
				}
				break;
			case &quot;boosters&quot;:
				for (var i = 0; i &lt; this._boosters.length; i++) {
					check = ship.equipmentStatus(this._boosters[i]);
					if (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
						item = this._boosters[i];
						break;
					}
				}
				break;
			case &quot;energy&quot;:
				for (var i = 0; i &lt; this._energy.length; i++) {
					check = ship.equipmentStatus(this._energy[i]);
					if (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
						item = this._energy[i];
						break;
					}
				}
				break;
			case &quot;frontshields&quot;:
				for (var i = 0; i &lt; this._frontshields.length; i++) {
					check = ship.equipmentStatus(this._frontshields[i]);
					if (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
						item = this._frontshields[i];
						break;
					}
				}
				break;
			case &quot;aftshields&quot;:
				for (var i = 0; i &lt; this._aftshields.length; i++) {
					check = ship.equipmentStatus(this._aftshields[i]);
					if (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
						item = this._aftshields[i];
						break;
					}
				}
				break;
			case &quot;heatshields&quot;:
				for (var i = 0; i &lt; this._heatshields.length; i++) {
					check = ship.equipmentStatus(this._heatshields[i]);
					if (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
						item = this._heatshields[i];
						break;
					}
				}
				break;
			case &quot;fuelinjectors&quot;:
				for (var i = 0; i &lt; this._fuelinjectors.length; i++) {
					check = ship.equipmentStatus(this._fuelinjectors[i]);
					if (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
						item = this._fuelinjectors[i];
						break;
					}
				}
				break;
			case &quot;fuelscoops&quot;:
				for (var i = 0; i &lt; this._fuelscoops.length; i++) {
					check = ship.equipmentStatus(this._fuelscoops[i]);
					if (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
						item = this._fuelscoops[i];
						break;
					}
				}
				break;
			case &quot;frontarmour&quot;:
				for (var i = 0; i &lt; this._frontarmour.length; i++) {
					check = ship.equipmentStatus(this._frontarmour[i]);
					if (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
						item = this._frontarmour[i];
						break;
					}
				}
				break;
			case &quot;aftarmour&quot;:
				for (var i = 0; i &lt; this._aftarmour.length; i++) {
					check = ship.equipmentStatus(this._aftarmour[i]);
					if (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
						item = this._aftarmour[i];
						break;
					}
				}
				break;
			case &quot;electricalbus&quot;:
				for (var i = 0; i &lt; this._electricalbus.length; i++) {
					check = ship.equipmentStatus(this._electricalbus[i]);
					if (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
						item = this._electricalbus[i];
						break;
					}
				}
				break;
			case &quot;hyperdrivecoupling&quot;:
				for (var i = 0; i &lt; this._hdCoupling.length; i++) {
					check = ship.equipmentStatus(this._hdCoupling[i]);
					if (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
						item = this._hdCoupling[i];
						break;
					}
				}
				break;
			case &quot;enginecoupling&quot;:
				for (var i = 0; i &lt; this._enCoupling.length; i++) {
					check = ship.equipmentStatus(this._enCoupling[i]);
					if (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
						item = this._enCoupling[i];
						break;
					}
				}
				break;
			case &quot;thrusterscoupling&quot;:
				for (var i = 0; i &lt; this._thCoupling.length; i++) {
					check = ship.equipmentStatus(this._thCoupling[i]);
					if (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
						item = this._thCoupling[i];
						break;
					}
				}
				break;
			case &quot;boosterscoupling&quot;:
				for (var i = 0; i &lt; this._bsCoupling.length; i++) {
					check = ship.equipmentStatus(this._bsCoupling[i]);
					if (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
						item = this._bsCoupling[i];
						break;
					}
				}
				break;
			case &quot;energycoupling&quot;:
				for (var i = 0; i &lt; this._ebCoupling.length; i++) {
					check = ship.equipmentStatus(this._ebCoupling[i]);
					if (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
						item = this._ebCoupling[i];
						break;
					}
				}
				break;
			case &quot;frontshieldscoupling&quot;:
				for (var i = 0; i &lt; this._fsCoupling.length; i++) {
					check = ship.equipmentStatus(this._fsCoupling[i]);
					if (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
						item = this._fsCoupling[i];
						break;
					}
				}
				break;
			case &quot;aftshieldscoupling&quot;:
				for (var i = 0; i &lt; this._asCoupling.length; i++) {
					check = ship.equipmentStatus(this._asCoupling[i]);
					if (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
						item = this._asCoupling[i];
						break;
					}
				}
				break;
		}
		if (ship.isPlayer) this._current[section] = item;
	} else {
		item = this._current[section];
	}

	return item;
}

//-------------------------------------------------------------------------------------------------------------
// returns the space element of a particular section of the ship
this.$equipmentSpaceInUse = function $equipmentSpaceInUse(section, ship) {
	if (!ship) return 0;
	if (section === &quot;electrical&quot;) {
		var total = 0;
		total += this._equipmentMatrix[this.$equipmentItemInUse(&quot;electricalbus&quot;, ship)][0];
		total += this._equipmentMatrix[this.$equipmentItemInUse(&quot;enginecoupling&quot;, ship)][0];
		total += this._equipmentMatrix[this.$equipmentItemInUse(&quot;energycoupling&quot;, ship)][0];
		total += this._equipmentMatrix[this.$equipmentItemInUse(&quot;thrusterscoupling&quot;, ship)][0];
		if (this.$equipmentItemInUse(&quot;boosterscoupling&quot;, ship))
			total += this._equipmentMatrix[this.$equipmentItemInUse(&quot;boosterscoupling&quot;, ship)][0];
		if (this.$shipHasHyperspaceMotor(ship.dataKey) === true &amp;&amp; this._OXPHyperdrives === false) {
			total += this._equipmentMatrix[this.$equipmentItemInUse(&quot;hyperdrivecoupling&quot;, ship)][0];
		}
		total += this._equipmentMatrix[this.$equipmentItemInUse(&quot;frontshieldscoupling&quot;, ship)][0];
		total += this._equipmentMatrix[this.$equipmentItemInUse(&quot;aftshieldscoupling&quot;, ship)][0];
		return total;
	} else {
		var item = this.$equipmentItemInUse(section, ship);
		if (item != &quot;&quot;) {
			return this._equipmentMatrix[item][0];
		} else {
			return 0;
		}
	}
}

//-------------------------------------------------------------------------------------------------------------
// returns the weight element of a particular section of the ship
this.$equipmentWeightInUse = function $equipmentWeightInUse(section, ship) {
	if (!ship) return 0;
	if (section === &quot;electrical&quot;) {
		var total = 0;
		total += this._equipmentMatrix[this.$equipmentItemInUse(&quot;electricalbus&quot;, ship)][1];
		total += this._equipmentMatrix[this.$equipmentItemInUse(&quot;enginecoupling&quot;, ship)][1];
		total += this._equipmentMatrix[this.$equipmentItemInUse(&quot;energycoupling&quot;, ship)][1];
		total += this._equipmentMatrix[this.$equipmentItemInUse(&quot;thrusterscoupling&quot;, ship)][1];
		if (this.$equipmentItemInUse(&quot;boosterscoupling&quot;, ship))
			total += this._equipmentMatrix[this.$equipmentItemInUse(&quot;boosterscoupling&quot;, ship)][1];
		if (this.$shipHasHyperspaceMotor(ship.dataKey) === true &amp;&amp; this._OXPHyperdrives === false) {
			total += this._equipmentMatrix[this.$equipmentItemInUse(&quot;hyperdrivecoupling&quot;, ship)][1];
		}
		total += this._equipmentMatrix[this.$equipmentItemInUse(&quot;frontshieldscoupling&quot;, ship)][1];
		total += this._equipmentMatrix[this.$equipmentItemInUse(&quot;aftshieldscoupling&quot;, ship)][1];
		return total;
	} else {
		var item = this.$equipmentItemInUse(section, ship);
		if (item != &quot;&quot;) {
			return this._equipmentMatrix[item][1];
		} else {
			return 0;
		}
	}
}

//-------------------------------------------------------------------------------------------------------------
this.$equipmentLevelInUse = function $equipmentLevelInUse(section, ship) {
	if (!ship) return 0;
	var item = this.$equipmentItemInUse(section, ship);
	return (this.$equipmentCouplingRequired(section, item, ship));
}

//-------------------------------------------------------------------------------------------------------------
// returns the coupling level for the equipment in use
this.$equipmentCouplingLevelInUse = function $equipmentCouplingLevelInUse(section, ship) {

	if (!ship) return 0;

	var level = 0;
	var coupling = &quot;&quot;;

	switch (section) {
		case &quot;electricalbus&quot;:
			coupling = this.$equipmentItemInUse(&quot;electricalbus&quot;, ship);
			level = this._electricalbus.indexOf(coupling);
			break;
		case &quot;engines&quot;:
		case &quot;fuelinjectors&quot;:
			coupling = this.$equipmentItemInUse(&quot;enginecoupling&quot;, ship);
			level = this._enCoupling.indexOf(coupling);
			break;
		case &quot;hyperdrive&quot;:
			coupling = this.$equipmentItemInUse(&quot;hyperdrivecoupling&quot;, ship);
			level = this._hdCoupling.indexOf(coupling);
			break;
		case &quot;thrusters&quot;:
			coupling = this.$equipmentItemInUse(&quot;thrusterscoupling&quot;, ship);
			level = this._thCoupling.indexOf(coupling);
			break;
		case &quot;boosters&quot;:
			coupling = this.$equipmentItemInUse(&quot;boosterscoupling&quot;, ship);
			level = this._bsCoupling.indexOf(coupling);
			break;
		case &quot;energy&quot;:
			coupling = this.$equipmentItemInUse(&quot;energycoupling&quot;, ship);
			level = this._ebCoupling.indexOf(coupling);
			break;
		case &quot;frontshields&quot;:
			coupling = this.$equipmentItemInUse(&quot;frontshieldscoupling&quot;, ship);
			level = this._fsCoupling.indexOf(coupling);
			break;
		case &quot;aftshields&quot;:
			coupling = this.$equipmentItemInUse(&quot;aftshieldscoupling&quot;, ship);
			level = this._asCoupling.indexOf(coupling);
			break;
	}

	return (level + 1);
}

//-------------------------------------------------------------------------------------------------------------
// return max coupling level in use
this.$maxEquipmentCouplingInUse = function $maxEquipmentCouplingInUse(ship) {

	if (!ship) return 0;

	var coupling = &quot;&quot;;
	var maxcoupling = 0;
	var level = 0;

	coupling = this.$equipmentItemInUse(&quot;enginecoupling&quot;, ship);
	level = this._enCoupling.indexOf(coupling);
	if (level &gt; maxcoupling) maxcoupling = level;

	if (this.$shipHasHyperspaceMotor(ship.dataKey) === true &amp;&amp; this._OXPHyperdrives === false) {
		coupling = this.$equipmentItemInUse(&quot;hyperdrivecoupling&quot;, ship);
		level = this._hdCoupling.indexOf(coupling);
		if (level &gt; maxcoupling) maxcoupling = level;
	}

	coupling = this.$equipmentItemInUse(&quot;thrusterscoupling&quot;, ship);
	level = this._thCoupling.indexOf(coupling);
	if (level &gt; maxcoupling) maxcoupling = level;

	coupling = this.$equipmentItemInUse(&quot;boosterscoupling&quot;, ship);
	if (coupling) {
		level = this._bsCoupling.indexOf(coupling);
		if (level &gt; maxcoupling) maxcoupling = level;
	}

	coupling = this.$equipmentItemInUse(&quot;energycoupling&quot;, ship);
	level = this._ebCoupling.indexOf(coupling);
	if (level &gt; maxcoupling) maxcoupling = level;

	if (this.$equipmentItemInUse(&quot;frontshields&quot;, ship) != &quot;EQ_NO_FORWARD_SHIELD&quot;) {
		coupling = this.$equipmentItemInUse(&quot;frontshieldscoupling&quot;, ship);
		level = this._fsCoupling.indexOf(coupling);
		if (level &gt; maxcoupling) maxcoupling = level;
	}

	if (this.$equipmentItemInUse(&quot;aftshields&quot;, ship) != &quot;EQ_NO_AFT_SHIELD&quot;) {
		coupling = this.$equipmentItemInUse(&quot;aftshieldscoupling&quot;, ship);
		level = this._asCoupling.indexOf(coupling);
		if (level &gt; maxcoupling) maxcoupling = level;
	}

	return maxcoupling;
}

//-------------------------------------------------------------------------------------------------------------
// returns the required level of coupling for a particular component
this.$equipmentCouplingRequired = function $equipmentCouplingRequired(section, equipmentKey, ship) {

	if (!ship) return 0;

	var level = 0;
	var coupling = &quot;&quot;;

	switch (section) {
		case &quot;all&quot;:
		case &quot;engines&quot;:
		case &quot;fuelinjectors&quot;:
		case &quot;hyperdrive&quot;:
		case &quot;thrusters&quot;:
		case &quot;boosters&quot;:
		case &quot;frontshields&quot;:
		case &quot;aftshields&quot;:
			if (equipmentKey.indexOf(&quot;_TYPE1&quot;) &gt;= 0) level = 1;
			if (equipmentKey.indexOf(&quot;_TYPE2&quot;) &gt;= 0) level = 2;
			if (equipmentKey.indexOf(&quot;_TYPE3&quot;) &gt;= 0) level = 3;
			if (equipmentKey.indexOf(&quot;_TYPE4&quot;) &gt;= 0) level = 4;
			if (equipmentKey.indexOf(&quot;_TYPE5&quot;) &gt;= 0) level = 5;
			if (equipmentKey.indexOf(&quot;_TYPE6&quot;) &gt;= 0) level = 6;
			if (equipmentKey.indexOf(&quot;_TYPE7&quot;) &gt;= 0) level = 7;
			if (equipmentKey.indexOf(&quot;_TYPE8&quot;) &gt;= 0) level = 7;
			break;
		case &quot;energy&quot;:
			var bustype = this._equipCouplingBus[equipmentKey];
			level = this._ebCoupling.indexOf(bustype) + 1;
			break;
	}

	return level;
}

//-------------------------------------------------------------------------------------------------------------
// puts all required equipment into the &quot;no sell&quot; array - this is only run once at startup
this.$populateNoSellList = function $populateNoSellList() {

	for (var i = 0; i &lt; this._electricalbus.length; i++) {
		if (this._noSell.indexOf(this._electricalbus[i]) === -1) this._noSell.push(this._electricalbus[i]);
	}
	for (var i = 0; i &lt; this._engines.length; i++) {
		if (this._noSell.indexOf(this._engines[i]) === -1) this._noSell.push(this._engines[i]);
	}
	for (var i = 0; i &lt; this._enCoupling.length; i++) {
		if (this._noSell.indexOf(this._enCoupling[i]) === -1) this._noSell.push(this._enCoupling[i]);
	}
	for (var i = 0; i &lt; this._hyperdrive.length; i++) {
		if (this._noSell.indexOf(this._hyperdrive[i]) === -1) this._noSell.push(this._hyperdrive[i]);
	}
	for (var i = 0; i &lt; this._hdCoupling.length; i++) {
		if (this._noSell.indexOf(this._hdCoupling[i]) === -1) this._noSell.push(this._hdCoupling[i]);
	}
	for (var i = 0; i &lt; this._thrusters.length; i++) {
		if (this._noSell.indexOf(this._thrusters[i]) === -1) this._noSell.push(this._thrusters[i]);
	}
	for (var i = 0; i &lt; this._thCoupling.length; i++) {
		if (this._noSell.indexOf(this._thCoupling[i]) === -1) this._noSell.push(this._thCoupling[i]);
	}
	for (var i = 0; i &lt; this._energy.length; i++) {
		if (this._noSell.indexOf(this._energy[i]) === -1) this._noSell.push(this._energy[i]);
	}
	for (var i = 0; i &lt; this._ebCoupling.length; i++) {
		if (this._noSell.indexOf(this._ebCoupling[i]) === -1) this._noSell.push(this._ebCoupling[i]);
	}
	for (var i = 0; i &lt; this._frontshields.length; i++) {
		if (this._noSell.indexOf(this._frontshields[i]) === -1) this._noSell.push(this._frontshields[i]);
	}
	for (var i = 0; i &lt; this._fsCoupling.length; i++) {
		if (this._noSell.indexOf(this._fsCoupling[i]) === -1) this._noSell.push(this._fsCoupling[i]);
	}
	for (var i = 0; i &lt; this._aftshields.length; i++) {
		if (this._noSell.indexOf(this._aftshields[i]) === -1) this._noSell.push(this._aftshields[i]);
	}
	for (var i = 0; i &lt; this._asCoupling.length; i++) {
		if (this._noSell.indexOf(this._asCoupling[i]) === -1) this._noSell.push(this._asCoupling[i]);
	}
	for (var i = 0; i &lt; this._bsCoupling.length; i++) {
		if (this._noSell.indexOf(this._bsCoupling[i]) === -1) this._noSell.push(this._bsCoupling[i]);
	}
}

//-------------------------------------------------------------------------------------------------------------
// installs the default factory equipment into a ship
this.$installBaseEquipment = function $installBaseEquipment(ship) {

	if (!ship) return;

	var changed = false;
	var equip = &quot;&quot;;
	var maxSpace = 0;
	var equipmentList = [];
	if (ship.isPlayer === false) {
		maxSpace = Math.ceil(this.$equipmentSpaceTotal(ship) + this.$cargoSpaceAvailable(ship));
		equipmentList = this.$getNPCEquipmentList(ship.primaryRole, ship.roles, maxSpace);
		if (!equipmentList || equipmentList.length === 0) {
			if (this._debug) log(this.name, &quot;!!NOTE: No match found for &quot; + ship.primaryRole + &quot;, ship type &quot; + ship.shipClassName + &quot;, space &quot; + maxSpace + &quot; - adding default equipment&quot;);
			equipmentList = [];
		} else {
			// based on accuracy (skill level) potentially remove some items from the list
			// the higher the accuracy, the fewer items will be removed
			// range is -5 to +10
			// below 0 = remove up to 3 items
			// 0 - 3 = remove up to 2 items
			// 3.1 - 6 = remove 1 item
			// above 6 no removal
			if (ship.isPolice === false) {
				var remove_count = 0;
				if (ship.accuracy &lt;= 0) remove_count = 3;
				if (ship.accuracy &gt; 0 &amp;&amp; ship.accuracy &lt;= 3) remove_count = 2;
				if (ship.accuracy &gt; 3 &amp;&amp; ship.accuracy &lt;= 6) remove_count = 1;
				if (remove_count &gt; 0) {
					for (var i = 1; i &lt;= remove_count; i++) {
						// lower accuracy means more chance of removal
						// blanking out the equipmentList item will mean default equipment only
						if (Math.random() &gt; ((ship.accuracy + 5) / 15)) {
							var idx = Math.floor(Math.random() * equipmentList.length);
							//if (this._debug &amp;&amp; equipmentList[idx] != &quot;&quot;) log(this.name, &quot;removing &quot; + equipmentList[idx] + &quot; from &quot; + ship);
							equipmentList[idx] = &quot;&quot;;
						}
					}
				}
			}
		}
	}

	// are any of the default items installed? If no, install them now.
	// main electrical bus
	var found = false;
	var bus = -1;
	for (var i = 0; i &lt; this._electricalbus.length; i++) {
		var check = ship.equipmentStatus(this._electricalbus[i]);
		if (check === &quot;EQUIPMENT_OK&quot;) {
			found = true;
			bus = (i + 1);
		}
	}
	if (found === false) {
		if (ship.isPlayer) {
			equip = &quot;EQ_ELEC_BUS_TYPE2&quot;;
			bus = 2;
		} else {
			equip = this.$selectNPCEquipment(&quot;electricalbus&quot;, equipmentList);
			bus = this._electricalbus.indexOf(equip) + 1;
		}
		ship.awardEquipment(equip);
		changed = true;
	}

	// engines
	found = false;
	var eng = -1;
	for (var i = 0; i &lt; this._engines.length; i++) {
		var check = ship.equipmentStatus(this._engines[i]);
		if (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
			found = true;
			eng = Math.floor(i / 6) + 1;
		}
	}
	if (found === false) {
		// for NPC ships, change the engine type based on primary role
		if (ship.isPlayer) {
			equip = &quot;EQ_ENGINE_TYPE2A&quot;;
			eng = 2;
		} else {
			equip = this.$selectNPCEquipment(&quot;engines&quot;, equipmentList);
			eng = Math.floor(this._engines.indexOf(equip) / 6) + 1;
		}
		ship.awardEquipment(equip);
		changed = true;
	}
	found = false;
	for (var i = 0; i &lt; this._enCoupling.length; i++) {
		var check = ship.equipmentStatus(this._enCoupling[i]);
		if (check === &quot;EQUIPMENT_OK&quot;) found = true;
	}
	if (found === false) {
		ship.awardEquipment(&quot;EQ_ENGINE_COUPLING_TYPE&quot; + eng);
		changed = true;
	}

	// hyperspace motor
	found = false;
	if (this.$shipHasHyperspaceMotor(ship.dataKey) === true &amp;&amp; this._OXPHyperdrives === false) {
		var hd = -1;
		for (var i = 0; i &lt; this._hyperdrive.length; i++) {
			var check = ship.equipmentStatus(this._hyperdrive[i]);
			if (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
				found = true;
				hd = i + 1;
			}
		}
		if (found === false) {
			if (ship.isPlayer) {
				equip = &quot;EQ_HYPERDRIVE_TYPE2&quot;;
				hd = 2;
			} else {
				equip = this.$selectNPCEquipment(&quot;hyperdrive&quot;, equipmentList);
				hd = this._hyperdrive.indexOf(equip) + 1;
			}
			ship.awardEquipment(equip);
			changed = true;
		}
		found = false;
		for (var i = 0; i &lt; this._hdCoupling.length; i++) {
			var check = ship.equipmentStatus(this._hdCoupling[i]);
			if (check === &quot;EQUIPMENT_OK&quot;) found = true;
		}
		if (found === false) {
			ship.awardEquipment(&quot;EQ_HYPERDRIVE_COUPLING_TYPE&quot; + hd);
			changed = true;
		}
	}

	// thrusters
	found = false;
	//var thr = -1;
	for (var i = 0; i &lt; this._thrusters.length; i++) {
		var check = ship.equipmentStatus(this._thrusters[i]);
		if (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
			equip = this._thrusters[i];
			found = true;
			break;
		}
	}
	if (found === false) {
		equip = &quot;EQ_THRUSTERS_TYPE2A&quot;;
		if (!ship.isPlayer) {
			equip = this.$selectNPCEquipment(&quot;thrusters&quot;, equipmentList);
		}
		ship.awardEquipment(equip);
		changed = true;
	}
	found = false;
	for (var i = 0; i &lt; this._thCoupling.length; i++) {
		var check = ship.equipmentStatus(this._thCoupling[i]);
		if (check === &quot;EQUIPMENT_OK&quot;) found = true;
	}
	if (found === false) {
		var thcp = this._equipCouplingBus[equip];
		ship.awardEquipment(thcp);
		changed = true;
	}

	// boosters - just install the minimum power coupling by default
	if (this._heatControl === true) {
		found = false;
		for (var i = 0; i &lt; this._bsCoupling.length; i++) {
			var check = ship.equipmentStatus(this._bsCoupling[i]);
			if (check === &quot;EQUIPMENT_OK&quot;) {
				found = true;
				break;
			}
		}
		if (found === false) {
			ship.awardEquipment(&quot;EQ_BOOSTERS_COUPLING_TYPE1&quot;);
			changed = true;
		}
	}

	// energy banks (standard class only, not class &quot;A&quot; types)
	found = false;
	var en = -1;
	for (var i = 0; i &lt; this._energy.length; i++) {
		var check = ship.equipmentStatus(this._energy[i]);
		if (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
			found = true;
			en = (i + 1);
		}
	}
	if (found === false) {
		var banks = Math.floor(ship.maxEnergy / 64);
		if (banks &lt;= 25) {
			if (banks === 0 &amp;&amp; ship.maxEnergy &gt; 0) banks = 1;
			// this should never happen, but just in case... default max energy should be 200, which is 3 banks
			if (ship.maxEnergy === 0) banks = 3;
			if (ship.isPlayer === false) {
				// check to see if this NPC configuration is overriding the number of banks
				equip = this.$selectNPCEquipment(&quot;energy&quot;, equipmentList, banks);
				if (equip != &quot;&quot;) banks = this._energy.indexOf(equip) + 1;
				//log(this.name, &quot;final equip = &quot; + equip);
			}
			ship.awardEquipment(&quot;EQ_ENERGYBANK_TYPE&quot; + banks);
			en = banks;
			changed = true;
		}
	}
	found = false;
	for (var i = 0; i &lt; this._ebCoupling.length; i++) {
		var check = ship.equipmentStatus(this._ebCoupling[i]);
		if (check === &quot;EQUIPMENT_OK&quot;) found = true;
	}
	// make sure the right electrical bus is fitted for the number of energy banks we have
	if (found === false) {
		switch (en) {
			case 1:
			case 2:
			case 3:
			case 4:
				ship.awardEquipment(&quot;EQ_ENERGYBANK_COUPLING_TYPE1&quot;);
				break;
			case 5:
			case 6:
			case 7:
				ship.awardEquipment(&quot;EQ_ENERGYBANK_COUPLING_TYPE2&quot;);
				break;
			case 8:
			case 9:
			case 10:
				ship.awardEquipment(&quot;EQ_ENERGYBANK_COUPLING_TYPE3&quot;);
				if (bus &lt; 3) {
					ship.removeEquipment(&quot;EQ_ELEC_BUS_TYPE&quot; + bus);
					ship.awardEquipment(&quot;EQ_ELEC_BUS_TYPE3&quot;);
				}
				break;
			case 11:
			case 12:
			case 13:
				ship.awardEquipment(&quot;EQ_ENERGYBANK_COUPLING_TYPE4&quot;);
				if (bus &lt; 4) {
					ship.removeEquipment(&quot;EQ_ELEC_BUS_TYPE&quot; + bus);
					ship.awardEquipment(&quot;EQ_ELEC_BUS_TYPE4&quot;);
				}
				break;
			case 14:
			case 15:
			case 16:
				ship.awardEquipment(&quot;EQ_ENERGYBANK_COUPLING_TYPE5&quot;);
				if (bus &lt; 5) {
					ship.removeEquipment(&quot;EQ_ELEC_BUS_TYPE&quot; + bus);
					ship.awardEquipment(&quot;EQ_ELEC_BUS_TYPE5&quot;);
				}
				break;
			case 17:
			case 18:
			case 19:
				ship.awardEquipment(&quot;EQ_ENERGYBANK_COUPLING_TYPE6&quot;);
				if (bus &lt; 6) {
					ship.removeEquipment(&quot;EQ_ELEC_BUS_TYPE&quot; + bus);
					ship.awardEquipment(&quot;EQ_ELEC_BUS_TYPE6&quot;);
				}
				break;
			case 20:
			case 21:
			case 22:
				ship.awardEquipment(&quot;EQ_ENERGYBANK_COUPLING_TYPE7&quot;);
				if (bus &lt; 7) {
					ship.removeEquipment(&quot;EQ_ELEC_BUS_TYPE&quot; + bus);
					ship.awardEquipment(&quot;EQ_ELEC_BUS_TYPE7&quot;);
				}
				break;
			case 23:
			case 24:
			case 25:
				ship.awardEquipment(&quot;EQ_ENERGYBANK_COUPLING_TYPE8&quot;);
				if (bus &lt; 7) {
					ship.removeEquipment(&quot;EQ_ELEC_BUS_TYPE&quot; + bus);
					ship.awardEquipment(&quot;EQ_ELEC_BUS_TYPE7&quot;);
				}
				break;
		}
		changed = true;
	}

	// note: we&#39;ll add the shield equipment to NPC&#39;s, even if they don&#39;t officially have shields - the game compensates for the lack of shields with addition energy
	// and we want the weight profile to be the same as for the player
	// front shields
	found = false;
	var fs = -1;
	for (var i = 0; i &lt; this._frontshields.length; i++) {
		var check = ship.equipmentStatus(this._frontshields[i]);
		if (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
			found = true;
			fs = i;
		}
	}
	if (found === false) {
		if (ship.isPlayer) {
			equip = &quot;EQ_FORWARD_SHIELD_TYPE2&quot;;
			fs = 2;
		} else {
			equip = this.$selectNPCEquipment(&quot;frontshields&quot;, equipmentList);
			fs = this._frontshields.indexOf(equip);
		}
		ship.awardEquipment(equip);
		changed = true;
	}
	found = false;
	if (fs === 0) fs = 1;
	for (var i = 0; i &lt; this._fsCoupling.length; i++) {
		var check = ship.equipmentStatus(this._fsCoupling[i]);
		if (check === &quot;EQUIPMENT_OK&quot;) found = true;
	}
	if (found === false) {
		ship.awardEquipment(&quot;EQ_FORWARD_SHIELD_COUPLING_TYPE&quot; + fs);
		changed = true;
	}

	// aft shields
	found = false;
	var as = -1;
	for (var i = 0; i &lt; this._aftshields.length; i++) {
		var check = ship.equipmentStatus(this._aftshields[i]);
		if (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
			found = true;
			as = i;
		}
	}
	if (found === false) {
		if (ship.isPlayer) {
			equip = &quot;EQ_AFT_SHIELD_TYPE2&quot;;
			as = 2;
		} else {
			equip = this.$selectNPCEquipment(&quot;aftshields&quot;, equipmentList);
			as = this._aftshields.indexOf(equip);
		}
		ship.awardEquipment(equip);
		changed = true;
	}
	found = false;
	if (as === 0) as = 1;
	for (var i = 0; i &lt; this._asCoupling.length; i++) {
		var check = ship.equipmentStatus(this._asCoupling[i]);
		if (check === &quot;EQUIPMENT_OK&quot;) found = true;
	}
	if (found === false) {
		ship.awardEquipment(&quot;EQ_AFT_SHIELD_COUPLING_TYPE&quot; + as);
		changed = true;
	}

	// fuel injectors
	var fi = ship.equipmentStatus(&quot;EQ_FUEL_INJECTION&quot;);
	equip = &quot;&quot;;
	if (fi === &quot;EQUIPMENT_OK&quot; || fi === &quot;EQUIPMENT_DAMAGED&quot;) {
		var fi_idx = -1;
		for (var i = 0; i &lt; this._fuelinjectors.length; i++) {
			var check = ship.equipmentStatus(this._fuelinjectors[i]);
			if (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
				equip = this._fuelinjectors[i];
				fi_idx = i;
			}
		}
		if (fi_idx === -1) {
			if (ship.isPlayer) {
				equip = &quot;EQ_FUEL_INJECTION_TYPE2&quot;;
			} else {
				equip = this.$selectNPCEquipment(&quot;fuelinjectors&quot;, equipmentList);
			}
		}
		if (equip != &quot;&quot;) {
			ship.awardEquipment(equip);
			changed = true;
		}
		if (fi === &quot;EQUIPMENT_DAMAGED&quot;) ship.setEquipmentStatus(equip, &quot;EQUIPMENT_DAMAGED&quot;);
	}
	// special case for NPCs with fuel injectors: don&#39;t install it if they don&#39;t already have it.
	/*if (!ship.isPlayer &amp;&amp; fi === &quot;EQUIPMENT_UNAVAILABLE&quot;) {
		equip = this.$selectNPCEquipment(&quot;fuelinjectors&quot;, equipmentList);
		if (equip != &quot;&quot;) {
			ship.awardEquipment(equip);
			changed = true;
		}
	} */
	// fuel scoops
	var sc = ship.equipmentStatus(&quot;EQ_FUEL_SCOOPS&quot;);
	equip = &quot;&quot;;
	if (sc === &quot;EQUIPMENT_OK&quot; || sc === &quot;EQUIPMENT_DAMAGED&quot;) {
		var sc_idx = -1;
		for (var i = 0; i &lt; this._fuelscoops.length; i++) {
			var check = ship.equipmentStatus(this._fuelscoops[i]);
			if (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
				equip = this._fuelscoops[i];
				sc_idx = i;
			}
		}
		if (sc_idx === -1) {
			if (ship.isPlayer) {
				equip = &quot;EQ_FUEL_SCOOPS_TYPE1&quot;;
			} else {
				equip = this.$selectNPCEquipment(&quot;fuelscoops&quot;, equipmentList);
			}
		}
		if (equip != &quot;&quot;) {
			ship.awardEquipment(equip);
			changed = true;
		}
		if (sc === &quot;EQUIPMENT_DAMAGED&quot;) ship.setEquipmentStatus(equip, &quot;EQUIPMENT_DAMAGED&quot;);
	}

	// heat shields
	var hs = ship.equipmentStatus(&quot;EQ_HEAT_SHIELD&quot;);
	equip = &quot;&quot;;
	// first check to see if we have a heat shield installed, but without the base Heat shield item (possibly it got lost)
	var equipHS = this.$equipmentItemInUse(&quot;heatshields&quot;, ship);
	var checkHS = ship.equipmentStatus(equipHS);
	if (checkHS === &quot;EQUIPMENT_OK&quot; || checkHS === &quot;EQUIPMENT_DAMAGED&quot;) {
		if (hs === &quot;EQUIPMENT_UNAVAILABLE&quot;) {
			ship.awardEquipment(&quot;EQ_HEAT_SHIELD&quot;);
			if (checkHS !== &quot;EQUIPMENT_OK&quot;) ship.setEquipmentStatus(&quot;EQ_HEAT_SHIELD&quot;, checkHS);
			hs = checkHS;
		}
	}
	if ((hs === &quot;EQUIPMENT_OK&quot; || hs === &quot;EQUIPMENT_DAMAGED&quot;) &amp;&amp; equipHS === &quot;&quot;) {
		if (ship.isPlayer) {
			equipHS = &quot;EQ_HEAT_SHIELD_TYPE2&quot;;
		} else {
			equipHS = this.$selectNPCEquipment(&quot;heatshields&quot;, equipmentList);
		}
		if (equipHS != &quot;&quot;) {
			ship.awardEquipment(equipHS);
			changed = true;
		}
		if (hs === &quot;EQUIPMENT_DAMAGED&quot;) ship.setEquipmentStatus(equipHS, &quot;EQUIPMENT_DAMAGED&quot;);
	}
	// only allocate NPC heat shields if they don&#39;t already have heat shields
	if (!ship.isPlayer &amp;&amp; hs === &quot;EQUIPMENT_UNAVAILABLE&quot;) {
		equip = this.$selectNPCEquipment(&quot;heatshields&quot;, equipmentList);
		if (equip != &quot;&quot;) {
			ship.awardEquipment(equip);
			changed = true;
		}
	}

	// armour
	if (ship.isPlayer === false) {
		equip = this.$selectNPCEquipment(&quot;frontarmour&quot;, equipmentList);
		if (equip != &quot;&quot;) {
			ship.awardEquipment(equip);
			changed = true;
		}
		equip = this.$selectNPCEquipment(&quot;aftarmour&quot;, equipmentList);
		if (equip != &quot;&quot;) {
			ship.awardEquipment(equip);
			changed = true;
		}
	}

	// heatsinks
	// just need to make sure ship have enough cargo space for them
	var equip = this.$selectNPCEquipment(&quot;heatsinks&quot;, equipmentList);
	if (equip != &quot;&quot;) {
		if (equip.indexOf(&quot;,&quot;) &gt;= 0) {
			var itms = equip.split(&quot;,&quot;);
			for (var i = 0; i &lt; itms.length; i++) {
				if (this.$cargoSpaceAvailable(ship) &gt; 0) ship.awardEquipment(itms[i]);
			}
		} else {
			if (this.$cargoSpaceAvailable(ship) &gt; 0) ship.awardEquipment(equip);
		}
	}

	return changed;
}

//-------------------------------------------------------------------------------------------------------------
// logic for NPC equipment choices
this.$selectNPCEquipment = function $selectNPCEquipment(section, equipmentList, defaultValue) {

	var result = &quot;&quot;;
	switch (section) {
		case &quot;engines&quot;:
			// logic hear to switch engines based on ship role and available space
			if (equipmentList) {
				for (var i = 0; i &lt; this._engines.length; i++) {
					if (equipmentList.indexOf(this._engines[i]) &gt;= 0) {
						result = this._engines[i];
						break;
					}
				}
				var change = 0;
				if (result === &quot;&quot;) {
					for (var i = 0; i &lt; equipmentList.length; i++) {
						if (equipmentList[i].indexOf(&quot;engines:&quot;) &gt;= 0) {
							change = parseInt(equipmentList[i].substring(equipmentList[i].indexOf(&quot;:&quot;) + 1));
							break;
						}
					}
				}
				if (change != 0) {
					var newidx = this._engines.indexOf(&quot;EQ_ENGINE_TYPE2A&quot;) + (change * 3);
					if (newidx &gt; this._engines.length - 1) newidx = this._engines.length - 1;
					if (newidx &lt; 0) newidx = 0;
					result = this._engines[newidx];
				}
			}
			if (result === &quot;&quot;) result = &quot;EQ_ENGINE_TYPE2A&quot;;
			break;
		case &quot;thrusters&quot;:
			if (equipmentList) {
				for (var i = 0; i &lt; this._thrusters.length; i++) {
					if (equipmentList.indexOf(this._thrusters[i]) &gt;= 0) {
						result = this._thrusters[i];
						break;
					}
				}
				var change = 0;
				if (result === &quot;&quot;) {
					for (var i = 0; i &lt; equipmentList.length; i++) {
						if (equipmentList[i].indexOf(&quot;thrusters:&quot;) &gt;= 0) {
							change = parseInt(equipmentList[i].substring(equipmentList[i].indexOf(&quot;:&quot;) + 1));
							break;
						}
					}
				}
				if (change != 0) {
					var newidx = this._thrusters.indexOf(&quot;EQ_THRUSTERS_TYPE2A&quot;) + change;
					if (newidx &gt; this._thrusters.length - 1) newidx = this._thrusters.length - 1;
					if (newidx &lt; 0) newidx = 0;
					result = this._thrusters[newidx];
				}
			}
			if (result === &quot;&quot;) result = &quot;EQ_THRUSTERS_TYPE2A&quot;;
			break;
		case &quot;boosters&quot;:
			if (equipmentList) {
				for (var i = 0; i &lt; this._boosters.length; i++) {
					if (equipmentList.indexOf(this._boosters[i]) &gt;= 0) {
						result = this._boosters[i];
						break;
					}
				}
				var change = 0;
				if (result === &quot;&quot;) {
					for (var i = 0; i &lt; equipmentList.length; i++) {
						if (equipmentList[i].indexOf(&quot;boosters:&quot;) &gt;= 0) {
							change = parseInt(equipmentList[i].substring(equipmentList[i].indexOf(&quot;:&quot;) + 1));
							break;
						}
					}
				}
				if (change != 0) {
					if (change &gt; this._boosters.length - 1) change = this._boosters.length - 1;
					if (change &gt;= 0) result = this._boosters[change];
				}
			}
			break;
		case &quot;hyperdrive&quot;:
			if (equipmentList) {
				for (var i = 0; i &lt; this._hyperdrive.length; i++) {
					if (equipmentList.indexOf(this._hyperdrive[i]) &gt;= 0) {
						result = this._hyperdrive[i];
						break;
					}
				}
				var change = 0;
				if (result === &quot;&quot;) {
					for (var i = 0; i &lt; equipmentList.length; i++) {
						if (equipmentList[i].indexOf(&quot;hyperdrive:&quot;) &gt;= 0) {
							change = parseInt(equipmentList[i].substring(equipmentList[i].indexOf(&quot;:&quot;) + 1));
							break;
						}
					}
				}
				if (change != 0) {
					var newidx = this._hyperdrive.indexOf(&quot;EQ_HYPERDRIVE_TYPE2&quot;) + change;
					if (newidx &gt; this._hyperdrive.length - 1) newidx = this._hyperdrive.length - 1;
					if (newidx &lt; 0) newidx = 0;
					result = this._hyperdrive[newidx];
				}
			}
			if (result === &quot;&quot;) result = &quot;EQ_HYPERDRIVE_TYPE2&quot;;
			break;
		case &quot;energy&quot;:
			// note: if NPC&#39;s need to get class &quot;A&quot; energy units installed, some changes to this routine will be required.
			// for the moment, though, I&#39;m assuming that only standard class units will be installed
			if (equipmentList) {
				for (var i = 0; i &lt; this._energy.length; i++) {
					if (equipmentList.indexOf(this._energy[i]) &gt;= 0) {
						result = this._energy[i];
						break;
					}
				}
				var change = 0;
				if (result === &quot;&quot;) {
					for (var i = 0; i &lt; equipmentList.length; i++) {
						if (equipmentList[i].indexOf(&quot;energy:&quot;) &gt;= 0) {
							change = parseInt(equipmentList[i].substring(equipmentList[i].indexOf(&quot;:&quot;) + 1));
							break;
						}
					}
				}
				if (change != 0) {
					var newidx = this._energy.indexOf(&quot;EQ_ENERGYBANK_TYPE&quot; + defaultValue) + change;
					if (newidx &gt; 24) newidx = 24;
					if (newidx &lt; 0) newidx = 0;
					result = this._energy[newidx];
				}
			}
			if (result === &quot;&quot; &amp;&amp; defaultValue) result = &quot;EQ_ENERGYBANK_TYPE&quot; + defaultValue;
			break;
		case &quot;frontshields&quot;:
			if (equipmentList) {
				for (var i = 0; i &lt; this._frontshields.length; i++) {
					if (equipmentList.indexOf(this._frontshields[i]) &gt;= 0) {
						result = this._frontshields[i];
						break;
					}
				}
				var change = 0;
				if (result === &quot;&quot;) {
					for (var i = 0; i &lt; equipmentList.length; i++) {
						if (equipmentList[i].indexOf(&quot;frontshields:&quot;) &gt;= 0) {
							change = parseInt(equipmentList[i].substring(equipmentList[i].indexOf(&quot;:&quot;) + 1));
							break;
						}
					}
				}
				if (change != 0) {
					var newidx = this._frontshields.indexOf(&quot;EQ_FORWARD_SHIELD_TYPE2&quot;) + change;
					if (newidx &gt; this._frontshields.length - 1) newidx = this._frontshields.length - 1;
					if (newidx &lt; 0) newidx = 0;
					result = this._frontshields[newidx];
				}
			}
			if (result === &quot;&quot;) result = &quot;EQ_FORWARD_SHIELD_TYPE2&quot;;
			break;
		case &quot;aftshields&quot;:
			if (equipmentList) {
				for (var i = 0; i &lt; this._aftshields.length; i++) {
					if (equipmentList.indexOf(this._aftshields[i]) &gt;= 0) {
						result = this._aftshields[i];
						break;
					}
				}
				var change = 0;
				if (result === &quot;&quot;) {
					for (var i = 0; i &lt; equipmentList.length; i++) {
						if (equipmentList[i].indexOf(&quot;aftshields:&quot;) &gt;= 0) {
							change = parseInt(equipmentList[i].substring(equipmentList[i].indexOf(&quot;:&quot;) + 1));
							break;
						}
					}
				}
				if (change != 0) {
					var newidx = this._aftshields.indexOf(&quot;EQ_AFT_SHIELD_TYPE2&quot;) + change;
					if (newidx &gt; this._aftshields.length - 1) newidx = this._aftshields.length - 1;
					if (newidx &lt; 0) newidx = 0;
					result = this._aftshields[newidx];
				}
			}
			if (result === &quot;&quot;) result = &quot;EQ_AFT_SHIELD_TYPE2&quot;;
			break;
		case &quot;electricalbus&quot;:
			result = &quot;EQ_ELEC_BUS_TYPE2&quot;;
			if (equipmentList) {
				for (var i = 0; i &lt; this._electricalbus.length; i++) {
					if (equipmentList.indexOf(this._electricalbus[i]) &gt;= 0) {
						result = this._electricalbus[i];
						break;
					}
				}
			}
			break;
		case &quot;fuelinjectors&quot;:
			if (equipmentList) {
				for (var i = 0; i &lt; this._fuelinjectors.length; i++) {
					if (equipmentList.indexOf(this._fuelinjectors[i]) &gt;= 0) {
						result = this._fuelinjectors[i];
						break;
					}
				}
				var change = 0;
				if (result === &quot;&quot;) {
					for (var i = 0; i &lt; equipmentList.length; i++) {
						if (equipmentList[i].indexOf(&quot;fuelinjectors:&quot;) &gt;= 0) {
							change = parseInt(equipmentList[i].substring(equipmentList[i].indexOf(&quot;:&quot;) + 1));
							break;
						}
					}
				}
				if (change != 0) {
					var newidx = this._fuelinjectors.indexOf(&quot;EQ_FUEL_INJECTION_TYPE2&quot;) + change;
					if (newidx &gt; this._fuelinjectors.length - 1) newidx = this._fuelinjectors.length - 1;
					if (newidx &lt; 0) newidx = 0;
					result = this._fuelinjectors[newidx];
				}
			}
			if (result === &quot;&quot;) result = &quot;EQ_FUEL_INJECTION_TYPE2&quot;;
			break;
		case &quot;fuelscoops&quot;:
			if (equipmentList) {
				for (var i = 0; i &lt; this._fuelscoops.length; i++) {
					if (equipmentList.indexOf(this._fuelscoops[i]) &gt;= 0) {
						result = this._fuelscoops[i];
						break;
					}
				}
				var change = 0;
				if (result === &quot;&quot;) {
					for (var i = 0; i &lt; equipmentList.length; i++) {
						if (equipmentList[i].indexOf(&quot;fuelscoops:&quot;) &gt;= 0) {
							change = parseInt(equipmentList[i].substring(equipmentList[i].indexOf(&quot;:&quot;) + 1));
							break;
						}
					}
				}
				if (change != 0) {
					var newidx = this._fuelscoops.indexOf(&quot;EQ_FUEL_SCOOPS_TYPE1&quot;) + change;
					if (newidx &gt; this._fuelscoops.length - 1) newidx = this._fuelscoops.length - 1;
					if (newidx &lt; 0) newidx = 0;
					result = this._fuelscoops[newidx];
				}
			}
			if (result === &quot;&quot;) result = &quot;EQ_FUEL_SCOOPS_TYPE1&quot;;
			break;
		case &quot;heatshields&quot;:
			if (equipmentList) {
				for (var i = 0; i &lt; this._heatshields.length; i++) {
					if (equipmentList.indexOf(this._heatshields[i]) &gt;= 0) {
						result = this._heatshields[i];
						break;
					}
				}
				var change = 0;
				if (result === &quot;&quot;) {
					for (var i = 0; i &lt; equipmentList.length; i++) {
						if (equipmentList[i].indexOf(&quot;heatshields:&quot;) &gt;= 0) {
							change = parseInt(equipmentList[i].substring(equipmentList[i].indexOf(&quot;:&quot;) + 1));
							break;
						}
					}
				}
				if (change != 0) {
					var newidx = this._heatshields.indexOf(&quot;EQ_HEAT_SHIELD_TYPE2&quot;) + change;
					if (newidx &gt; this._heatshields.length - 1) newidx = this._heatshields.length - 1;
					if (newidx &lt; 0) newidx = 0;
					result = this._heatshields[newidx];
				}
			}
			if (result === &quot;&quot;) result = &quot;EQ_HEAT_SHIELD_TYPE2&quot;;
			break;
		case &quot;frontarmour&quot;:
			if (equipmentList) {
				for (var i = 0; i &lt; this._frontarmour.length; i++) {
					if (equipmentList.indexOf(this._frontarmour[i]) &gt;= 0) {
						result = this._frontarmour[i];
						break;
					}
				}
				var change = 0;
				if (result === &quot;&quot;) {
					for (var i = 0; i &lt; equipmentList.length; i++) {
						if (equipmentList[i].indexOf(&quot;frontarmour:&quot;) &gt;= 0) {
							change = parseInt(equipmentList[i].substring(equipmentList[i].indexOf(&quot;:&quot;) + 1));
							break;
						}
					}
				}
				// the default is no armour, so if a change value is entered it has to be always positive
				if (change != 0) {
					if (change &gt; this._frontarmour.length - 1) change = this._frontarmour.length - 1;
					if (change &gt;= 0) result = this._frontarmour[change];
				}
			}
			break;
		case &quot;aftarmour&quot;:
			if (equipmentList) {
				for (var i = 0; i &lt; this._aftarmour.length; i++) {
					if (equipmentList.indexOf(this._aftarmour[i]) &gt;= 0) {
						result = this._aftarmour[i];
						break;
					}
				}
				var change = 0;
				if (result === &quot;&quot;) {
					for (var i = 0; i &lt; equipmentList.length; i++) {
						if (equipmentList[i].indexOf(&quot;aftarmour:&quot;) &gt;= 0) {
							change = parseInt(equipmentList[i].substring(equipmentList[i].indexOf(&quot;:&quot;) + 1));
							break;
						}
					}
				}
				// the default is no armour, so if a change value is entered it has to be always positive
				if (change != 0) {
					if (change &gt; this._aftarmour.length - 1) change = this._aftarmour.length - 1;
					if (change &gt;= 0) result = this._aftarmour[change];
				}
			}
			break;
		case &quot;heatsinks&quot;:
			if (equipmentList) {
				if (equipmentList.indexOf(&quot;EQ_HEAT_SINK&quot;) &gt;= 0) result = &quot;EQ_HEAT_SINK&quot;;
				var change = 0;
				if (result === &quot;&quot;) {
					for (var i = 0; i &lt; equipmentList.length; i++) {
						if (equipmentList[i].indexOf(&quot;heatsinks:&quot;) &gt;= 0) {
							change = parseInt(equipmentList[i].substring(equipmentList[i].indexOf(&quot;:&quot;) + 1));
							break;
						}
					}
				}
				// the default is no armour, so if a change value is entered it has to be always positive
				if (change != 0) {
					for (var i = 1; i &lt;= change; i++)
						result += (result === &quot;&quot; ? &quot;&quot; : &quot;,&quot;) + &quot;EQ_HEAT_SINK&quot;;
				}
			}
			break;
	}

	return result;
}

//-------------------------------------------------------------------------------------------------------------
// returns the NPC equipment array for a given role and space
this.$getNPCEquipmentList = function $getNPCEquipmentList(primRole, roleList, equipmentSpace) {
	var role = primRole;
	// check if there is a translation item for the primary role
	if (this._NPCEquivalents[primRole] != null) role = this._NPCEquivalents[primRole];
	// try with the primary role first
	for (var i = 0; i &lt; this._NPCConfig.length; i++) {
		if (this._NPCConfig[i].primaryRole == role &amp;&amp; equipmentSpace &gt;= this._NPCConfig[i].minSpace &amp;&amp; equipmentSpace &lt;= this._NPCConfig[i].maxSpace) {
			return this._NPCConfig[i].equipmentList;
		}
	}
	// if we get here there was no match for the primary role
	// now we&#39;ll check all the other roles
	for (var j = 0; j &lt; roleList.length; j++) {
		for (var i = 0; i &lt; this._NPCConfig.length; i++) {
			if (this._NPCConfig[i].primaryRole === roleList[j] &amp;&amp; equipmentSpace &gt;= this._NPCConfig[i].minSpace &amp;&amp; equipmentSpace &lt;= this._NPCConfig[i].maxSpace) {
				return this._NPCConfig[i].equipmentList;
			}
		}
	}
	// no match at all - return null
	return null;
}

//-------------------------------------------------------------------------------------------------------------
// adds the cargo space filler item for when the equipment requirements outstrip the base equipment space capacity
this.$addEquipmentSpaceItem = function $addEquipmentSpaceItem(ship) {
	if (!ship) return true;

	// don&#39;t add for NPC&#39;s
	if (ship.isPlayer === false) return true;
	// don&#39;t add during flight
	if (ship.alertCondition != 0) return true;

	var stn = system.mainStation;
	if (ship.dockedStation) stn = ship.dockedStation;
	var mkt = stn.market;

	// remove any existing equipment space items
	var remove = &quot;&quot;;
	for (var i = 1; i &lt;= 40; i++) {
		remove = &quot;EQ_EQUIPSPACE_&quot; + i;
		if (ship.equipmentStatus(remove) === &quot;EQUIPMENT_OK&quot;) {
			ship.removeEquipment(remove);
			break;
		}
	}

	var equipSpace = this.$equipmentSpaceTotal(ship);
	var cargoSpace = this.$cargoSpaceAvailable(ship);
	var used = this.$calcEquipmentSpace(ship);
	if (used &gt; equipSpace) {
		// allocate cargo space to equipment space
		var diff = parseInt(used - equipSpace);
		if (diff &gt; cargoSpace) {
			// put in the maximum anyway
			if (cargoSpace &gt; 0) ship.awardEquipment(&quot;EQ_EQUIPSPACE_&quot; + cargoSpace);
			return false;
		} else if (diff &gt; 0) {
			// add the new one
			var item = &quot;EQ_EQUIPSPACE_&quot; + diff;
			//if (this._debug) log(this.name, &quot;adding item &quot; + item);
			var result = false;
			var tries = 0;
			do {
				result = ship.awardEquipment(item);
				if (result === false) {
					// sell cargo until we fit in.
					if (ship.isPlayer) {
						var cargo = ship.manifest.list;
						for (var i = 0; i &lt; cargo.length; i++) {
							if (cargo[i].quantity &gt; 0 &amp;&amp; cargo[i].unit === &quot;t&quot;) {
								ship.manifest[cargo[i].commodity] -= 1;
								if (ship.isPlayer) {
									player.credits += (mkt[cargo[i].commodity].price / 10);
								}
								break;
							}
						}
					}
				}
				tries += 1;
			} while (result === false &amp;&amp; tries &lt; ship.cargoSpaceCapacity);

			this.$updateShipSpecs(ship);
			return result;
		}
	} else {
		this.$updateShipSpecs(ship);
		return true;
	}
}

//-------------------------------------------------------------------------------------------------------------
// returns calculated values for particular types of settings
this.$calculatedValue = function $calculatedValue(calcType, ship, shipspec, booster, weight, maxweight, damageFactor) {

	var loadData = false;
	var boostEq = null;

	if (!shipspec) {
		loadData = true;
		var shipspec = Ship.shipDataForKey(ship.dataKey);
		var weight = this.$calcEquipmentWeight(ship);
		var maxweight = this.$calcShipMaxWeight(ship.shipClassName, this.$getShipMass(ship));
		if (maxweight &lt; weight) maxweight = weight;
		var damageFactor = 1;
	}
	if (!booster) {
		boostEq = EquipmentInfo.infoForKey(this.$equipmentItemInUse(&quot;boosters&quot;, ship));
	} else {
		boostEq = booster;
	}

	var thrust = parseInt(shipspec[&quot;thrust&quot;]);
	if (isNaN(thrust)) thrust = 30;
	var speed = parseInt(shipspec[&quot;max_flight_speed&quot;]);
	if (isNaN(speed)) speed = 350;
	var pitch = parseFloat(shipspec[&quot;max_flight_pitch&quot;]);
	if (isNaN(pitch)) pitch = 1;
	var roll = parseFloat(shipspec[&quot;max_flight_roll&quot;]);
	if (isNaN(roll)) roll = 2;
	if (shipspec[&quot;max_flight_yaw&quot;]) {
		var yaw = parseFloat(shipspec[&quot;max_flight_yaw&quot;]);
	} else {
		var yaw = pitch;
	}
	var result = 0;
	var boost = 1;

	switch (calcType) {
		case &quot;thrust&quot;:
			var info = EquipmentInfo.infoForKey(this.$equipmentItemInUse(&quot;engines&quot;, ship));
			if (boostEq != null) boost = parseFloat(boostEq.scriptInfo.thrust_adjust);
			result = ((thrust * parseFloat(info.scriptInfo.thrust_adjust)) * boost * (1 - (weight / (maxweight * this._weightFactor)))) * damageFactor;
			break;
		case &quot;speed&quot;:
			var info = EquipmentInfo.infoForKey(this.$equipmentItemInUse(&quot;engines&quot;, ship));
			if (boostEq != null) boost = parseFloat(boostEq.scriptInfo.speed_adjust);
			result = ((speed * parseFloat(info.scriptInfo.speed_adjust)) * boost * (1 - (weight / (maxweight * this._weightFactor)))) * damageFactor;
			break;
		case &quot;pitch&quot;:
			var info = EquipmentInfo.infoForKey(this.$equipmentItemInUse(&quot;thrusters&quot;, ship));
			if (boostEq != null) boost = parseFloat(boostEq.scriptInfo.pitch_adjust);
			result = ((pitch * parseFloat(info.scriptInfo.pitch_adjust)) * boost * (1 - (weight / (maxweight * this._weightFactor)))) * damageFactor;
			break;
		case &quot;roll&quot;:
			var info = EquipmentInfo.infoForKey(this.$equipmentItemInUse(&quot;thrusters&quot;, ship));
			if (boostEq != null) boost = parseFloat(boostEq.scriptInfo.roll_adjust);
			result = ((roll * parseFloat(info.scriptInfo.roll_adjust)) * boost * (1 - (weight / (maxweight * this._weightFactor)))) * damageFactor;
			break;
		case &quot;yaw&quot;:
			var info = EquipmentInfo.infoForKey(this.$equipmentItemInUse(&quot;thrusters&quot;, ship));
			if (boostEq != null) boost = parseFloat(boostEq.scriptInfo.pitch_adjust);
			result = ((yaw * parseFloat(info.scriptInfo.yaw_adjust)) * boost * (1 - (weight / (maxweight * this._weightFactor)))) * damageFactor;
			break;
	}

	if (loadData) shipspec = null;

	return result;
}

//-------------------------------------------------------------------------------------------------------------
// adjust the ships performance based on equipment and weight
this.$updateShipSpecs = function $updateShipSpecs(ship) {

	if (!ship || ship.isValid === false) return;

	var shipspec = Ship.shipDataForKey(ship.dataKey);
	var weight = this.$calcEquipmentWeight(ship);
	var mass = this.$getShipMass(ship);
	var maxweight = this.$calcShipMaxWeight(ship.shipClassName, mass);
	if (maxweight &lt; weight) maxweight = weight;
	var check = &quot;&quot;;

	/*if (this._debug &amp;&amp; ship.isPlayer) {
		log(this.name, &quot;Pre settings for ship &quot; + ship + &quot;:&quot;);
		log(this.name, &quot;Max Thrust:           &quot; + ship.maxThrust);
		log(this.name, &quot;Max Speed:            &quot; + ship.maxSpeed);
		log(this.name, &quot;Hyperspace Spin Time: &quot; + ship.hyperspaceSpinTime);
		log(this.name, &quot;Pitch:                &quot; + ship.maxPitch);
		log(this.name, &quot;Roll:                 &quot; + ship.maxRoll);
		log(this.name, &quot;Yaw:                  &quot; + ship.maxYaw);
		log(this.name, &quot;Max Energy:           &quot; + ship.maxEnergy);
		if (ship.isPlayer) {
			log(this.name, &quot;Front Shield:         &quot; + ship.maxForwardShield);
			log(this.name, &quot;Aft Shield:           &quot; + ship.maxAftShield);
		}
		log(this.name, &quot;Heat Shield:          &quot; + ship.heatInsulation);
		log(this.name, &quot;Injector Burn Rate:   &quot; + ship.injectorBurnRate);
		log(this.name, &quot;Injector Speed Factor:&quot; + ship.injectorSpeedFactor);
	}*/

	// boosters (if installed)
	var bstr = this.$equipmentItemInUse(&quot;boosters&quot;, ship);
	ship.script._boosterHeatPoint = 0;
	if (ship.equipmentStatus(bstr) === &quot;EQUIPMENT_OK&quot;) {
		var boostEq = EquipmentInfo.infoForKey(bstr);
		if (boostEq != null) ship.script._boosterHeatPoint = boostEq.scriptInfo.heat_buildup;
	}

	// engine performance
	check = ship.equipmentStatus(this.$equipmentItemInUse(&quot;engines&quot;, ship));
	if (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
		var dam = 1;
		if (check === &quot;EQUIPMENT_DAMAGED&quot;) dam = 0.67;
		ship.maxSpeed = this.$calculatedValue(&quot;speed&quot;, ship, shipspec, boostEq, weight, maxweight, dam);
		ship.maxThrust = this.$calculatedValue(&quot;thrust&quot;, ship, shipspec, boostEq, weight, maxweight, dam);
		ship.thrust = ship.maxThrust;
	}

	// hyperspace performance
	if (this.$shipHasHyperspaceMotor(ship.dataKey) === true &amp;&amp; this._OXPHyperdrives === false) {
		check = ship.equipmentStatus(this.$equipmentItemInUse(&quot;hyperdrive&quot;, ship));
		if (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
			if (check === &quot;EQUIPMENT_OK&quot;) {
				var info = EquipmentInfo.infoForKey(this.$equipmentItemInUse(&quot;hyperdrive&quot;, ship));
				ship.hyperspaceSpinTime = parseInt(info.scriptInfo.spin_time);
			} else {
				ship.hyperspaceSpinTime = 50;
			}
		}
	}

	// thruster performance
	check = ship.equipmentStatus(this.$equipmentItemInUse(&quot;thrusters&quot;, ship));
	if (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
		var dam = 1;
		if (check === &quot;EQUIPMENT_DAMAGED&quot;) dam = 0.75;
		ship.maxPitch = this.$calculatedValue(&quot;pitch&quot;, ship, shipspec, boostEq, weight, maxweight, dam);
		ship.maxRoll = this.$calculatedValue(&quot;roll&quot;, ship, shipspec, boostEq, weight, maxweight, dam);
		ship.maxYaw = this.$calculatedValue(&quot;yaw&quot;, ship, shipspec, boostEq, weight, maxweight, dam);
	}


	// energy banks
	check = ship.equipmentStatus(this.$equipmentItemInUse(&quot;energy&quot;, ship));
	if (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
		var info = EquipmentInfo.infoForKey(this.$equipmentItemInUse(&quot;energy&quot;, ship));
		var initial = 200;
		if (typeof shipspec[&quot;max_energy&quot;] != &quot;undefined&quot;) initial = parseInt(shipspec[&quot;max_energy&quot;]);
		var checkbanks = Math.floor(initial / 64);
		if (checkbanks === 0) checkbanks = 1;
		if (checkbanks != parseInt(info.scriptInfo.energy_banks)) {
			initial = (parseInt(info.scriptInfo.energy_banks) * 64);
		}
		if (check === &quot;EQUIPMENT_DAMAGED&quot; &amp;&amp; ship.isPlayer) {
			if (this._energyRechargeRate_Stored === 0) this._energyRechargeRate_Stored = ship.energyRechargeRate;
			ship.energyRechargeRate = 0;
		}
		ship.maxEnergy = initial;
		ship.energy = ship.maxEnergy;
	}

	// shield settings
	this.$updateShieldValues(ship);

	// heat shield
	check = ship.equipmentStatus(this.$equipmentItemInUse(&quot;heatshields&quot;, ship));
	ship.script._heat_sink_factor = parseFloat(this._defaultHeatShieldHSFactor);
	/*
	// work out how fast cabin heat will rise
	// smaller ships will heat faster, larger ships will heat slower
	if (this._shipHeatRateExceptions[ship.shipClassName]) {
		ship.script._heat_rate = this._shipHeatRateExceptions[ship.shipClassName];
	} else {
		//ship.script._heat_rate = 1 + (((214737.6875 - mass) / (mass &gt; 214737 ? 50000 : 70000)) * 0.1);
		ship.script._heat_rate = 1 + (((250000 - mass) / (mass * 0.9)) * 0.15);
		//ship.script._heat_rate = 1 + ((1 - (mass / 500000)) / 1.2);

		if (this._debug &amp;&amp; ship.isPlayer) log(this.name, &quot;ship heat rate = &quot; + ship.script._heat_rate);
	}
	*/

	// set the default heat shield value first
	var shipdef = 1;
	if (typeof shipspec[&quot;heat_insulation&quot;] != &quot;undefined&quot;) shipdef = parseFloat(shipspec[&quot;heat_insulation&quot;]);
	ship.heatInsulation = shipdef;
	if (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
		if (check === &quot;EQUIPMENT_OK&quot;) {
			var info = EquipmentInfo.infoForKey(this.$equipmentItemInUse(&quot;heatshields&quot;, ship));
			ship.heatInsulation = shipdef + parseFloat(info.scriptInfo.oolite_heat_insulation_strength);
			ship.script._heat_sink_factor = parseFloat(info.scriptInfo.heat_sink_factor);
		}
	}

	// fuel injection
	check = ship.equipmentStatus(this.$equipmentItemInUse(&quot;fuelinjectors&quot;, ship));
	if (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
		var info = EquipmentInfo.infoForKey(this.$equipmentItemInUse(&quot;fuelinjectors&quot;, ship));
		var burn = 0.25;
		if (typeof shipspec[&quot;injector_burn_rate&quot;] != &quot;undefined&quot;) burn = shipspec[&quot;injector_burn_rate&quot;];
		ship.injectorBurnRate = parseFloat(burn) * parseFloat(info.scriptInfo.burn_rate);
		var factor = 7;
		if (typeof shipspec[&quot;injector_speed_factor&quot;] != &quot;undefined&quot;) factor = shipspec[&quot;injector_speed_factor&quot;];
		ship.injectorSpeedFactor = parseFloat(factor) * parseFloat(info.scriptInfo.speed_factor);
	}

	// fuel scoops
	check = ship.equipmentStatus(this.$equipmentItemInUse(&quot;fuelscoops&quot;, ship));
	if (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
		var info = EquipmentInfo.infoForKey(this.$equipmentItemInUse(&quot;fuelscoops&quot;, ship));
		ship.script._fuelScoopAccumulator = parseFloat(info.scriptInfo.accumulator_size);
	}

	/*if (this._debug &amp;&amp; ship.isPlayer) {
		log(this.name, &quot;Post settings:&quot;);
		log(this.name, &quot;Max Thrust:           &quot; + ship.maxThrust);
		log(this.name, &quot;Max Speed:            &quot; + ship.maxSpeed);
		log(this.name, &quot;Hyperspace Spin Time: &quot; + ship.hyperspaceSpinTime);
		log(this.name, &quot;Pitch:                &quot; + ship.maxPitch);
		log(this.name, &quot;Roll:                 &quot; + ship.maxRoll);
		log(this.name, &quot;Yaw:                  &quot; + ship.maxYaw);
		log(this.name, &quot;Max Energy:           &quot; + ship.maxEnergy);
		if (ship.isPlayer) {
			log(this.name, &quot;Front Shield:         &quot; + ship.maxForwardShield);
			log(this.name, &quot;Aft Shield:           &quot; + ship.maxAftShield);
		}
		log(this.name, &quot;Heat Shield:          &quot; + ship.heatInsulation);
		log(this.name, &quot;Injector Burn Rate:   &quot; + ship.injectorBurnRate);
		log(this.name, &quot;Injector Speed Factor:&quot; + ship.injectorSpeedFactor);
	}*/
}

//-------------------------------------------------------------------------------------------------------------
// due to their complexity, shield settings are performed in this separate routine
// this allows us to call it from multiple places
this.$updateShieldValues = function $updateShieldValues(ship) {

	var check = &quot;&quot;;

	// shields (only for the player ship)
	if (ship.isPlayer) {
		// force the naval grid to update
		if (ship.equipmentStatus(&quot;EQ_NAVAL_GRID&quot;) === &quot;EQUIPMENT_OK&quot; || ship.equipmentStatus(&quot;EQ_ENERGY_GRID&quot;) === &quot;EQUIPMENT_OK&quot;) {
			var ng = worldScripts[&quot;Naval Grid&quot;];
			if (ng) ng._ng_player_modifiers();
		}

		var ctrl = worldScripts[&quot;Oolite Equipment Control&quot;];
		// make sure the baselines have been set before we go any further.
		if (typeof ctrl.$baseline.maxForwardShield === &quot;undefined&quot;) ctrl.playerBoughtNewShip();

		var eq = this.$equipmentItemInUse(&quot;frontshields&quot;, ship);
		check = ship.equipmentStatus(eq);
		if (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
			var info = EquipmentInfo.infoForKey(eq);

			// need to apply shield booster and naval shield booster values
			if (eq === &quot;EQ_NO_FORWARD_SHIELD&quot;) {
				ship.maxForwardShield = 0;
			} else if (check === &quot;EQUIPMENT_DAMAGED&quot;) {
				//if (this._forwardShieldRechargeRate_Stored === 0) this._forwardShieldRechargeRate_Stored = ship.forwardShieldRechargeRate;
				ship.forwardShieldRechargeRate = -0.5;
			} else {
				// reset the shield values
				var base = ship.maxForwardShield;
				if (typeof ctrl.$baseline.maxForwardShield != &quot;undefined&quot;) base = ctrl.$baseline.maxForwardShield;
				ship.maxForwardShield = base + parseFloat(info.scriptInfo.oolite_shield_increase);
				ship.forwardShieldRechargeRate = 2;
				if (ship.equipmentStatus(&quot;EQ_SHIELD_BOOSTER&quot;) === &quot;EQUIPMENT_OK&quot;) {
					var boost = EquipmentInfo.infoForKey(&quot;EQ_SHIELD_BOOSTER&quot;);
					ship.maxForwardShield += parseFloat(boost.scriptInfo.oolite_shield_increase);
					ship.forwardShieldRechargeRate *= parseFloat(boost.scriptInfo.oolite_shield_recharge_multiplier);
				}
				if (ship.equipmentStatus(&quot;EQ_NAVAL_SHIELD_BOOSTER&quot;) === &quot;EQUIPMENT_OK&quot;) {
					var boost = EquipmentInfo.infoForKey(&quot;EQ_NAVAL_SHIELD_BOOSTER&quot;);
					ship.maxForwardShield += parseFloat(boost.scriptInfo.oolite_shield_increase);
					ship.forwardShieldRechargeRate *= parseFloat(boost.scriptInfo.oolite_shield_recharge_multiplier);
				}
			}
			if (ship.docked) ship.forwardShield = ship.maxForwardShield;
		}

		eq = this.$equipmentItemInUse(&quot;aftshields&quot;, ship);
		check = ship.equipmentStatus(eq);
		if (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
			var info = EquipmentInfo.infoForKey(eq);

			// need to apply shield booster and naval shield booster values
			if (eq === &quot;EQ_NO_AFT_SHIELD&quot;) {
				ship.maxAftShield = 0;
			} else if (check === &quot;EQUIPMENT_DAMAGED&quot;) {
				//if (this._aftshieldsRechargeRate_Stored === 0) this._aftshieldsRechargeRate_Stored = ship.aftShieldRechargeRate;
				ship.aftShieldRechargeRate = -0.5;
			} else {
				var base = ship.maxAftShield;
				if (typeof ctrl.$baseline.maxAftShield != &quot;undefined&quot;) base = ctrl.$baseline.maxAftShield;
				ship.aftShieldRechargeRate = 2;
				ship.maxAftShield = base + parseFloat(info.scriptInfo.oolite_shield_increase);
				if (ship.equipmentStatus(&quot;EQ_SHIELD_BOOSTER&quot;) === &quot;EQUIPMENT_OK&quot;) {
					var boost = EquipmentInfo.infoForKey(&quot;EQ_SHIELD_BOOSTER&quot;);
					ship.maxAftShield += parseFloat(boost.scriptInfo.oolite_shield_increase);
					ship.aftShieldRechargeRate *= parseFloat(boost.scriptInfo.oolite_shield_recharge_multiplier);
				}
				if (ship.equipmentStatus(&quot;EQ_NAVAL_SHIELD_BOOSTER&quot;) === &quot;EQUIPMENT_OK&quot;) {
					var boost = EquipmentInfo.infoForKey(&quot;EQ_NAVAL_SHIELD_BOOSTER&quot;);
					ship.maxAftShield += parseFloat(boost.scriptInfo.oolite_shield_increase);
					ship.aftShieldRechargeRate *= parseFloat(boost.scriptInfo.oolite_shield_recharge_multiplier);
				}
			}
			if (ship.docked) ship.aftShield = ship.maxAftShield;
		}
	} else {
		// NPC&#39;s only have shields if one of these OXP&#39;s is installed.
		if (worldScripts[&quot;customshields&quot;] || worldScripts[&quot;NPC-shields&quot;]) {
			// based on the way things are set up, we should be confident that customshields has set the right value by now.
			// we&#39;re going to redo the settings, based on the factor that equipment choices might have moved things up or down
			// with customshields, the recharge rate is already handled, and as ShipConfig doesn&#39;t have any special equipment that adjusts the recharge rate, we can leave that part alone.
			// start with the front shields
			var front_shield = 0;
			var eq = this.$equipmentItemInUse(&quot;frontshields&quot;, ship);
			check = ship.equipmentStatus(eq);
			if (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
				var info = EquipmentInfo.infoForKey(eq);

				// need to apply shield booster and naval shield booster values
				if (eq === &quot;EQ_NO_FORWARD_SHIELD&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
					front_shield = 0;
				} else {
					// reset the shield values
					var base = 128;
					front_shield = base + parseFloat(info.scriptInfo.oolite_shield_increase);
					if (ship.equipmentStatus(&quot;EQ_SHIELD_BOOSTER&quot;) === &quot;EQUIPMENT_OK&quot;) {
						var boost = EquipmentInfo.infoForKey(&quot;EQ_SHIELD_BOOSTER&quot;);
						front_shield += parseFloat(boost.scriptInfo.oolite_shield_increase);
					}
					if (ship.equipmentStatus(&quot;EQ_NAVAL_SHIELD_BOOSTER&quot;) === &quot;EQUIPMENT_OK&quot;) {
						var boost = EquipmentInfo.infoForKey(&quot;EQ_NAVAL_SHIELD_BOOSTER&quot;);
						front_shield += parseFloat(boost.scriptInfo.oolite_shield_increase);
					}
				}
			}
			// now the aft shields
			var aft_shield = 0;
			var eq = this.$equipmentItemInUse(&quot;aftshields&quot;, ship);
			check = ship.equipmentStatus(eq);
			if (check === &quot;EQUIPMENT_OK&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
				var info = EquipmentInfo.infoForKey(eq);

				// need to apply shield booster and naval shield booster values
				if (eq === &quot;EQ_NO_AFT_SHIELD&quot; || check === &quot;EQUIPMENT_DAMAGED&quot;) {
					aft_shield = 0;
				} else {
					// reset the shield values
					var base = 128;
					aft_shield = base + parseFloat(info.scriptInfo.oolite_shield_increase);
					if (ship.equipmentStatus(&quot;EQ_SHIELD_BOOSTER&quot;) === &quot;EQUIPMENT_OK&quot;) {
						var boost = EquipmentInfo.infoForKey(&quot;EQ_SHIELD_BOOSTER&quot;);
						aft_shield += parseFloat(boost.scriptInfo.oolite_shield_increase);
					}
					if (ship.equipmentStatus(&quot;EQ_NAVAL_SHIELD_BOOSTER&quot;) === &quot;EQUIPMENT_OK&quot;) {
						var boost = EquipmentInfo.infoForKey(&quot;EQ_NAVAL_SHIELD_BOOSTER&quot;);
						aft_shield += parseFloat(boost.scriptInfo.oolite_shield_increase);
					}
				}
			}
			// now we have the correct shield amount, apply it to the appropriate OXP
			if (worldScripts[&quot;customshields&quot;]) {
				ship.script.customshieldsmaxforwardshieldlevel = front_shield;
				ship.script.customshieldsmaxaftshieldlevel = aft_shield;
			}
			if (worldScripts[&quot;NPC-shields&quot;]) {
				// this OXP only has 1 shield value, so we&#39;ll ignore the aft shields in this instance
				ship.script.maxShieldStrength = front_shields;
				ship.script.shieldStrength = front_shields;
			}
		}
	}

}

//-------------------------------------------------------------------------------------------------------------
// returns the total amount of equipment space available for a ship of a particular mass
// a cobra mk3 should have about 20t of equipment space
this.$equipmentSpaceTotal = function $equipmentSpaceTotal(ship) {
	if (!ship) return 0;
	// cobra3 			214737.6875 or 219634.265625
	// moray starboat	51203.4375
	// adder			16045.4931640625
	// python			259688.28125
	// cobra1			52291.8359375
	// miner			12074.4453125
	// gecko			24669.99609375

	// check for an exception entry for this ship data key
	if (this._shipSpaceExceptions[ship.shipClassName] &amp;&amp; this._shipSpaceExceptions[ship.shipClassName] != &quot;&quot;) {
		// we&#39;ll trust this number to be correct
		space = parseInt(this._shipSpaceExceptions[ship.shipClassName]);
	} else {
		// do a calc
		var space = parseInt((this.$getShipMass(ship) / 429475.375) * 40);

		if (space &lt; 15) space = 15; // min of 15
		// do a check on cargo capacity
		if (space &lt; 20) {
			var cargo = this.$getCargoCapacity(ship)
			// if our calc is less than 20 but the cargo is greater than 35, then set the min to 20 and add an extra 1 of equip space for each 5 tons of cargo space above 35 tons
			if (cargo &gt; 35) space = 20 + parseInt((cargo - 35) / 5);
		}
		if (space &gt; 40) space = 40; // max of 40
	}
	var ext = this.$getEquipmentExtensions(ship);
	return (space + ext);
}

//-------------------------------------------------------------------------------------------------------------
// external routine to return the equipment space and cargo space for a ship key
// we&#39;ll create a temporary ship object and use that to get the details
// returns a dictionary with 3 elements: &quot;equipSpace&quot;, &quot;cargoSpace&quot;, and &quot;mass&quot;
this.$getEquipmentSpaceFromShipKey = function $getEquipmentSpaceFromShipKey(shipKey) {
	var result = {};
	// find a spot well away from any possible objects
	if (system.sun) {
		var temppos = system.sun.position.cross(system.mainPlanet.position).direction().multiply(4E9).subtract(system.mainPlanet.position);
	} else {
		var temppos = Vector3D(0, 0, 0);
	}
	// add a ship with the particular key
	var tempship = system.addShips(&quot;[&quot; + shipKey + &quot;]&quot;, 1, temppos, 0);
	if (tempship != null) {
		// force this ship to be &quot;dead&quot; in space - we don&#39;t want it to do anything disruptive!
		tempship[0].switchAI(&quot;oolite-nullAI.js&quot;);
		// now we have a ship, we can use the standard functions for calculating available space
		result[&quot;equipSpace&quot;] = this.$equipmentSpaceTotal(tempship[0]);
		result[&quot;cargoSpace&quot;] = this.$cargoSpaceAvailable(tempship[0]);
		result[&quot;mass&quot;] = this.$getShipMass(tempship[0]);
		// clean up our temp ship
		tempship[0].remove(true);
	} else {
		// this could happen if the ship is not allowed to be spawned in this system due to constraints in the shipdata.plist file for the ship
		result[&quot;equipSpace&quot;] = &quot;N/A&quot;;
		result[&quot;cargoSpace&quot;] = &quot;N/A&quot;;
		result[&quot;mass&quot;] = &quot;N/A&quot;;
	}
	return result;
}

//-------------------------------------------------------------------------------------------------------------
// returns the max permissible amount of cargo space that can be converted to equipment space
// attempting to avoid the issue of buying an anaconda and just putting max of everything in it.
this.$cargoSpaceAvailable = function $cargoSpaceAvailable(ship) {
	if (!ship) return 0;

	var reduction = this.$checkCargoReduction(ship);
	var maxCargo = this.$getCargoCapacity(ship);
	var curCargo = maxCargo - reduction;
	// if the ship doesn&#39;t have any cargo space to allocate, return 0
	if (curCargo === 0) return 0;

	var calc = parseInt(maxCargo * 0.75);
	if (calc &gt; curCargo) calc = curCargo;

	if (calc &gt; 40) {
		return 40;
	} else {
		// ships with small cargo holds can allocate it all
		if (calc &lt; 10) {
			return curCargo;
		} else {
			return calc;
		}
	}
}

//-------------------------------------------------------------------------------------------------------------
// returns the current cargo space conversion amount
this.$cargoEquipmentSpaceAmount = function $cargoEquipmentSpaceAmount(ship) {
	if (!ship) return 0;

	for (var i = 0; i &lt; this._filler.length; i++) {
		if (ship.equipmentStatus(this._filler[i]) === &quot;EQUIPMENT_OK&quot;) return (i + 1);
	}
	return 0;
}

//-------------------------------------------------------------------------------------------------------------
// returns the space current available for equipment (including available reused cargo space)
this.$availableEquipmentSpace = function $availableEquipmentSpace(ship) {
	var equipSpace = this.$equipmentSpaceTotal(ship);
	var cargoSpace = this.$cargoSpaceAvailable(ship); // + this.$cargoEquipmentSpaceAmount(p));
	var used = this.$calcEquipmentSpace(ship);
	return ((equipSpace + cargoSpace) - used);
}

//-------------------------------------------------------------------------------------------------------------
// get the original capacity for this ship
// this will be independant of any item that reduces the cargo bay (eg passenger berths)
this.$getCargoCapacity = function $getCargoCapacity(ship) {
	if (!ship) return 0;

	var shipData = Ship.shipDataForKey(ship.dataKey);
	if (!shipData) return 0;
	var cargoAvail = 0;
	if (shipData[&quot;max_cargo&quot;]) cargoAvail = parseInt(shipData[&quot;max_cargo&quot;]);
	if (ship.equipmentStatus(&quot;EQ_CARGO_BAY&quot;) === &quot;EQUIPMENT_OK&quot;) {
		var extra = 15;
		if (shipData[&quot;extra_cargo&quot;]) extra = parseInt(shipData[&quot;extra_cargo&quot;]);
		cargoAvail += extra;
	}
	return cargoAvail;
}

//-------------------------------------------------------------------------------------------------------------
// returns the total of equip items that that up cargo space
this.$checkCargoReduction = function $checkCargoReduction(ship) {
	var total = 0;
	var eq = ship.equipment;
	var mult = 0;
	// check that the equipment element is valid (it might not be after an ejection)
	if (!eq) return 0;
	for (var i = 0; i &lt; eq.length; i++) {
		var itm = eq[i];
		if (this._filler.indexOf(itm.equipmentKey) &gt;= 0) continue;
		mult = 1;
		if (itm.requiredCargoSpace &gt; 0) {
			if (itm.equipmentKey === &quot;EQ_PASSENGER_BERTH&quot;) mult = ship.passengerCapacity;
			total += itm.requiredCargoSpace * mult;
		}
	}
	return total;
}

//-------------------------------------------------------------------------------------------------------------
// returns the amount of space taken up by all ship equipment
this.$calcEquipmentSpace = function $calcEquipmentSpace(ship) {

	if (!ship) return 0;

	var equipSpace = this.$equipmentSpaceTotal(ship);
	//var cargoSpace = this.$cargoSpaceAvailable(ship);
	var used = 0;

	// cycle through the installed equipment
	var eq = ship.equipment;
	if (!eq) return 0;
	for (var i = 0; i &lt; eq.length; i++) {
		var e_item = eq[i];
		if (this._ignoreEquip.indexOf(e_item.equipmentKey) &gt;= 0) continue;
		if (!this._equipmentMatrix[e_item.equipmentKey]) {
			// don&#39;t know what this is, so try to work it out
			//var info = EquipmentInfo.infoForKey(e_item.equipmentKey);
			if (e_item.isVisible === true &amp;&amp; e_item.requiredCargoSpace === 0) {
				// if it&#39;s not taking up space already, assume 1t
				used += 1;
				if (this._debug) log(this.name, &quot;didn&#39;t find &quot; + e_item.equipmentKey + &quot; in matrix, using default&quot;);
			}
		} else {
			used += this._equipmentMatrix[e_item.equipmentKey][0];
		}
	}
	return used;
}

//-------------------------------------------------------------------------------------------------------------
// calculates a price factor for equipment, based on ship mass
this.$equipmentPriceFactor = function $equipmentPriceFactor(shipClass, shipMass, techlvl, sysID) {
	var factor = shipMass / 100000;
	if (factor &lt; 0.4) factor = 0.4;
	if (factor &gt; 3) factor = 3;
	// the cobra is the exception
	if (shipClass === &quot;Cobra Mark III&quot;) {
		factor = 1;
	}
	if (typeof techlvl == &quot;undefined&quot;) {
		// I&#39;ve taken out the station equivalent tech level, because it&#39;s being applied in other ways
		//if (player.ship.dockedStation &amp;&amp; player.ship.dockedStation.equivalentTechLevel &lt; 16) {
		//	techlvl = player.ship.dockedStation.equivalentTechLevel;
		//} else {
		techlvl = system.info.techlevel;
		//}
	}
	if (typeof sysID == &quot;undefined&quot;) sysID = system.ID;
	//if (this._debug) log(this.name, &quot;price factor (pre tl factor)= &quot; + factor);
	return (factor * this.$equipmentTechFactor(techlvl, sysID));
}

//-------------------------------------------------------------------------------------------------------------
// returns a calculated max weight for a shipclass
this.$calcShipMaxWeight = function $calcShipMaxWeight(shipClass, shipMass) {
	// cobra3 			214737.6875 or 219634.265625
	// anaconda			437686.875
	// moray starboat	51203.4375
	// adder			16045.4931640625
	// python			259688.28125
	// cobra1			52291.8359375
	// miner			12074.4453125
	// constrictor		28490.8984375
	// asp mk ii		75881.5625
	// ferdelance		65457.94921875
	// boa				181788.90625
	// Boa cc			215810.5
	// gecko			24669.99609375
	// krait			93291.40625
	// sidewinder		24966.326171875
	// transporter		12074.4453125
	// worm 			14597.208984375
	var mult = 1;
	if (this._shipPowerToWeight[shipClass]) {
		// get the preset value, if stored
		mult = this._shipPowerToWeight[shipClass];
	} else {
		// smaller ships have a greater power to weight ratio
		// add 1 point for every 15000 under 100000
		if (shipMass &lt; 100000) mult = mult + (1 * (100000 - shipMass) / 15000);
		// larger ships have a lower power to weight ratio
		// take off 0.1 point for every 50000 over 200000
		if (shipMass &gt; 200000) mult = mult - (0.1 * ((shipMass - 200000) / 50000));
	}
	var weight = ((shipMass * mult) / 700);
	return weight;
}

//-------------------------------------------------------------------------------------------------------------
// returns the weight (in whole t&#39;s) of all equipment and cargo on a ship
this.$calcEquipmentWeight = function $calcEquipmentWeight(ship) {

	if (!ship) return 0;

	var weight = 0;

	// any weapons?
	if (ship.aftWeapon &amp;&amp; ship.aftWeapon.equipmentKey != &quot;EQ_WEAPON_NONE&quot;) {
		weight += this.$weaponWeight(ship.aftWeapon.equipmentKey);
	}
	if (ship.forwardWeapon &amp;&amp; ship.forwardWeapon.equipmentKey != &quot;EQ_WEAPON_NONE&quot;) {
		weight += this.$weaponWeight(ship.forwardWeapon.equipmentKey);
	}
	if (ship.portWeapon &amp;&amp; ship.portWeapon.equipmentKey != &quot;EQ_WEAPON_NONE&quot;) {
		weight += this.$weaponWeight(ship.portWeapon.equipmentKey);
	}
	if (ship.starboardWeapon &amp;&amp; ship.starboardWeapon.equipmentKey != &quot;EQ_WEAPON_NONE&quot;) {
		weight += this.$weaponWeight(ship.starboardWeapon.equipmentKey);
	}

	// any missiles?
	if (ship.missileCapacity &gt; 0) {
		var noerr = false;
		// have to do this because attempting to access ship.missiles when no missiles are installed will generate an Objective-C error
		try {
			var miss = ship.missiles;
			noerr = true;
		} catch (err) {
			if (this._debug &amp;&amp; ship.isPlayer) log(this.name, &quot;!!ERROR: &quot; + err);
		}
		if (noerr) {
			for (var i = 0; i &lt; miss.length; i++) {
				if (this._ignoreEquip.indexOf(miss[i].equipmentKey) &gt;= 0) continue;
				if (!this._equipmentMatrix[miss[i].equipmentKey]) {
					weight += 1;
				} else {
					weight += this._equipmentMatrix[miss[i].equipmentKey][1];
				}
			}
		}
	}

	// cycle through the installed equipment
	var eq = ship.equipment;
	for (var i = 0; i &lt; eq.length; i++) {
		var e_item = eq[i];
		if (this._ignoreEquip.indexOf(e_item.equipmentKey) &gt;= 0) continue;
		if (!this._equipmentMatrix[e_item.equipmentKey]) {
			// don&#39;t know what this is, so try to work it out
			var info = EquipmentInfo.infoForKey(e_item.equipmentKey);
			// add it up if it&#39;s either (a) visible or (b) taking up space
			if (info.isVisible === true || info.requiredCargoSpace &gt; 0) {
				if (info.requiredCargoSpace === 0) {
					// if it&#39;s not taking up space already, assume 1t
					weight += 1;
				} else {
					weight += info.requiredCargoSpace;
					if (info.equipmentKey === &quot;EQ_PASSENGER_BERTH&quot;) weight *= ship.passengerCapacity;
				}
			}
		} else {
			weight += this._equipmentMatrix[e_item.equipmentKey][1];
		}
	}
	// special items:
	// LMSS weapons
	var lmss = worldScripts.LMSS_Core;
	if (lmss) {
		if (lmss._forwardAltKey != &quot;EQ_WEAPON_NONE&quot; &amp;&amp; lmss._forwardAltKey != &quot;&quot;) {
			weight += this.$weaponWeight(lmss._forwardAltKey);
		}
		if (lmss._aftAltKey != &quot;EQ_WEAPON_NONE&quot; &amp;&amp; lmss._aftAltKey != &quot;&quot;) {
			weight += this.$weaponWeight(lmss._aftAltKey);
		}
		if (lmss._portAltKey != &quot;EQ_WEAPON_NONE&quot; &amp;&amp; lmss._portAltKey != &quot;&quot;) {
			weight += this.$weaponWeight(lmss._portAltKey);
		}
		if (lmss._starboardAltKey != &quot;EQ_WEAPON_NONE&quot; &amp;&amp; lmss._starboardAltKey != &quot;&quot;) {
			weight += this.$weaponWeight(lmss._starboardAltKey);
		}
	}

	// add cargo weight
	if (this.$getCargoCapacity(ship) &gt; 0 &amp;&amp; ship.cargoList.length &gt; 0) {
		for (var i = 0; i &lt; ship.cargoList.length; i++) {
			var itm = ship.cargoList[i];
			switch (itm.unit) {
				case &quot;t&quot;:
					weight += itm.quantity;
					break;
				case &quot;kg&quot;:
					weight += (itm.quantity / 1000);
					break;
				case &quot;g&quot;:
					weight += (itm.quantity / 1000000);
					break;
			}
		}
	}

	if (ship.isPlayer) {
		var smuggling = worldScripts.Smugglers_Equipment;
		if (smuggling) {
			// add the weight of any cargo in the smuggling compartment
			var cargo = smuggling.$getSmugglingCargo();

			for (var i = 0; i &lt; cargo.length; i++) {
				switch (cargo[i].unit) {
					case &quot;t&quot;:
						weight += cargo[i].quantity;
						break;
					case &quot;kg&quot;:
						weight += (cargo[i].quantity / 1000);
						break;
					case &quot;g&quot;:
						weight += (cargo[i].quantity / 1000000);
						break;
				}
			}
		}
	}

	return weight;
}

//-------------------------------------------------------------------------------------------------------------
// returns the weight (or calculated weight) of a paricular weapon
this.$weaponWeight = function $weaponWeight(weaponKey) {
	if (weaponKey === &quot;EQ_WEAPON_NONE&quot;) return 0;
	if (!this._equipmentMatrix[weaponKey]) {
		var info = EquipmentInfo.infoForKey(weaponKey);
		// calc weight based on weapon range
		if (info &amp;&amp; info.weaponInfo) {
			if (info.weaponInfo.range &lt; 12000) {
				return 1;
			} else if (info.weaponInfo.range &lt; 20000) {
				return 3;
			} else {
				return 5;
			}
		} else {
			// weird... shouldn&#39;t really happen
			return 1;
		}
	} else {
		return this._equipmentMatrix[weaponKey][1];
	}
}

//-------------------------------------------------------------------------------------------------------------
// returns true if a HUD with allowBigGUI is enabled, otherwise false
this.$isBigGuiActive = function $isBigGuiActive() {
	if (oolite.compareVersion(&quot;1.83&quot;) &lt;= 0) {
		return player.ship.hudAllowsBigGui;
	} else {
		var bigGuiHUD = [&quot;XenonHUD.plist&quot;, &quot;coluber_hud_ch01-dock.plist&quot;]; // until there is a property we can check, I&#39;ll be listing HUD&#39;s that have the allow_big_gui property set here
		if (bigGuiHUD.indexOf(player.ship.hud) &gt;= 0) {
			return true;
		} else {
			return false;
		}
	}
}

//-------------------------------------------------------------------------------------------------------------
// appends space to currentText to the specified length in &#39;em&#39;
this.$padTextRight = function $padTextRight(currentText, desiredLength, leftSwitch) {
	if (currentText == null) currentText = &quot;&quot;;
	var hairSpace = String.fromCharCode(31);
	var ellip = &quot;&quot;;
	var currentLength = defaultFont.measureString(currentText.replace(/%%/g, &quot;%&quot;));
	var hairSpaceLength = defaultFont.measureString(hairSpace);
	// calculate number needed to fill remaining length
	var padsNeeded = Math.floor((desiredLength - currentLength) / hairSpaceLength);
	if (padsNeeded &lt; 1) {
		// text is too long for column, so start pulling characters off
		var tmp = currentText;
		do {
			tmp = tmp.substring(0, tmp.length - 2) + ellip;
			if (tmp === ellip) break;
		} while (defaultFont.measureString(tmp.replace(/%%/g, &quot;%&quot;)) &gt; desiredLength);
		currentLength = defaultFont.measureString(tmp.replace(/%%/g, &quot;%&quot;));
		padsNeeded = Math.floor((desiredLength - currentLength) / hairSpaceLength);
		currentText = tmp;
	}
	// quick way of generating a repeated string of that number
	if (!leftSwitch || leftSwitch === false) {
		return currentText + new Array(padsNeeded).join(hairSpace);
	} else {
		return new Array(padsNeeded).join(hairSpace) + currentText;
	}
}

//-------------------------------------------------------------------------------------------------------------
// appends space to currentText to the specified length in &#39;em&#39;
this.$padTextLeft = function $padTextLeft(currentText, desiredLength) {
	return this.$padTextRight(currentText, desiredLength, true);
}

//-------------------------------------------------------------------------------------------------------------
// adds any equipment space/weight values from script_info data
// this way we can just look in our array, rather than in two places
// this is only run once at startup
this.$addEquipmentDataFromScriptInfo = function $addEquipmentDataFromScriptInfo() {
	var eqlist = EquipmentInfo.allEquipment;
	for (var i = 0; i &lt; eqlist.length; i++) {
		var eq = eqlist[i];
		if (eq.isVisible &amp;&amp; eq.scriptInfo) {
			var space = -1;
			var weight = -1;
			if (eq.scriptInfo.equipment_space &amp;&amp; parseFloat(eq.scriptInfo.equipment_space) &gt;= 0) space = parseFloat(eq.scriptInfo.equipment_space);
			if (eq.scriptInfo.equipment_weight &amp;&amp; parseFloat(eq.scriptInfo.equipment_weight) &gt;= 0) weight = parseFloat(eq.scriptInfo.equipment_weight);
			// have we only been given a space setting? assume weight is the same
			if (space &gt;= 0 &amp;&amp; weight === -1) weight = space;
			// if the space or weight values are greater than zero, add the definition to the matrix
			if (space &gt; 0 || weight &gt; 0) this._equipmentMatrix[eq.equipmentKey] = [space, weight];
			// if the values are both zero, add it to the ignored list
			if (space === 0 &amp;&amp; weight === 0) this._ignoreEquip.push(eq.equipmentKey);
		}
		// look for any equipment items that are outside the bounds for general sale but could potentially be sold (as they take up space/weight)
		if (this._ignoreEquip.indexOf(eq.equipmentKey) === -1 &amp;&amp; eq.isVisible &amp;&amp; eq.techLevel &gt;= 15 &amp;&amp; eq.techLevel &lt; 100 &amp;&amp; eq.effectiveTechLevel &gt;= 15 &amp;&amp; eq.isAvailableToPlayer === true &amp;&amp; eq.isExternalStore === false) {
			var wt = 0;
			if (!this._equipmentMatrix[eq.equipmentKey]) {
				// don&#39;t know what this is, so try to work it out
				// add it up if it&#39;s either (a) visible or (b) taking up space
				if (eq.requiredCargoSpace &gt; 0) {
					wt = eq.requiredCargoSpace;
				} else {
					wt = 1;
				}
			} else {
				wt = this._equipmentMatrix[eq.equipmentKey][1];
			}
			if (wt &gt; 0) this._sellNegotiate.push(eq.equipmentKey);
		}
	}
}

//-------------------------------------------------------------------------------------------------------------
// adds script info data from ship data keys
// this way we can just look in our arrays, rather than in two places
// this is only run once at startup
this.$addShipDataFromScriptInfo = function $addShipDataFromScriptInfo() {
	var shipkeys = Ship.keys();
	for (var i = 0; i &lt; shipkeys.length; i++) {
		var shipspec = Ship.shipDataForKey(shipkeys[i]);
		if (shipspec[&quot;script_info&quot;]) {
			if (shipspec[&quot;script_info&quot;].equipment_space) {
				var space = parseInt(shipspec[&quot;script_info&quot;].equipment_space);
				this._shipSpaceExceptions[shipspec.name] = space;
			}
			if (shipspec[&quot;script_info&quot;].power_to_weight) {
				var ratio = parseFloat(shipspec[&quot;script_info&quot;].power_to_weight);
				this._shipPowerToWeight[shipspec.name] = ratio;
			}
			if (shipspec[&quot;script_info&quot;].role_translation) {
				var def = shipspec[&quot;script_info&quot;].role_translation;
				if (def.indexOf(&quot;|&quot;) &gt;= 0) {
					var pri = def.split(&quot;|&quot;)[0].trim();
					var trans = def.split(&quot;|&quot;)[1].trim();
					if (pri.length &gt; 0 &amp;&amp; trans.length &gt; 0) this._NPCEquivalents[pri] = trans;
				}
			}
		}
	}
}

//-------------------------------------------------------------------------------------------------------------
// player the buy/sell sound effects
this.$playSound = function $playSound(soundtype) {
	var mySound = new SoundSource;
	switch (soundtype) {
		case &quot;explosion&quot;:
			mySound.sound = &quot;[player-scrape-damage]&quot;;
			break;
		case &quot;buy&quot;:
			mySound.sound = &quot;[buy-commodity]&quot;;
			break;
		case &quot;sell&quot;:
			mySound.sound = &quot;[sell-commodity]&quot;;
			break;
		case &quot;deploy_heat_sink&quot;:
			mySound.sound = &quot;heat_sink_deployed.ogg&quot;;
			break;
		case &quot;booster_warning&quot;:
			if (this._disableBoosterSound === true) return;
			mySound.sound = &quot;booster_warning.ogg&quot;;
			break;
	}
	mySound.loop = false;
	mySound.play();
}

//-------------------------------------------------------------------------------------------------------------
// returns the standard maximum speed for a ship
this.$getShipSpecSpeed = function $getShipSpecSpeed(ship) {
	var spec = Ship.shipDataForKey(ship.dataKey);
	var specspeed = parseInt(spec[&quot;max_flight_speed&quot;]);
	return specspeed;
}

//-------------------------------------------------------------------------------------------------------------
// returns the ships mass, either from the exception list, or from the ship itself
this.$getShipMass = function $getShipMass(ship) {
	var mass = this._shipMassExceptions[ship.shipClassName];
	if (!mass) mass = ship.mass;
	return mass;
}

//-------------------------------------------------------------------------------------------------------------
// returns true if the ship data spec says this ship has a hyperspace motor
this.$shipHasHyperspaceMotor = function $shipHasHyperspaceMotor(shipDataKey) {
	var check = Ship.shipDataForKey(shipDataKey)[&quot;hyperspace_motor&quot;];
	if (typeof check === &quot;undefined&quot;) return true;
	return (this._trueValues.indexOf(check) != -1);
}

//-------------------------------------------------------------------------------------------------------------
// returns the number of heat sinks remaining
this.$countHeatSinks = function $countHeatSinks() {
	var hs = 0;
	var eq = player.ship.equipment;
	for (var i = 0; i &lt; eq.length; i++) {
		if (eq[i].equipmentKey === &quot;EQ_HEAT_SINK&quot;) hs += 1;
	}
	return hs;
}

//-------------------------------------------------------------------------------------------------------------
// routine to check the combat simulator worldscript, to see if it&#39;s running or not
this.$simulatorRunning = function $SimulatorRunning() {
	var w = worldScripts[&quot;Combat Simulator&quot;];
	if (w &amp;&amp; w.$checkFight &amp;&amp; w.$checkFight.isRunning) return true;
	return false;
}

//-------------------------------------------------------------------------------------------------------------
// gets the sum of all equipment space extensions installed
this.$getEquipmentExtensions = function $getEquipmentExtensions(ship) {
	var ext = 0;
	var eqlist = ship.equipment;
	if (eqlist) {
		for (var i = 0; i &lt; eqlist.length; i++) {
			var eq = eqlist[i];
			if (eq.scriptInfo.equipment_extension &amp;&amp; parseFloat(eq.scriptInfo.equipment_extension) &gt;= 0) ext += parseFloat(eq.scriptInfo.equipment_extension);
		}
	}
	return ext;
}

//-------------------------------------------------------------------------------------------------------------
// these routines all relate to circumventing issues with ship storage helper
//-------------------------------------------------------------------------------------------------------------
// routine to be called before a respray to set things up for a change of ship
this.$preResprayFunction = function $preResprayFunction() {
	this._startUp = true;
	this._resprayActive = true;
	// remove the equipment space item before respray, otherwise strange things seem to happen to the amount of available cargo space
	for (var i = 1; i &lt;= 40; i++) {
		var remove = &quot;EQ_EQUIPSPACE_&quot; + i;
		if (player.ship.equipmentStatus(remove) === &quot;EQUIPMENT_OK&quot;) {
			this._holdEquipSpace = remove;
			player.ship.removeEquipment(remove);
			break;
		}
	}
}

//-------------------------------------------------------------------------------------------------------------
this.$restoreEquipSpaceItem = function $restoreEquipSpaceItem() {
	if (this._holdEquipSpace != &quot;&quot;) player.ship.awardEquipment(this._holdEquipSpace);
	this._startUp = false;
}

//-------------------------------------------------------------------------------------------------------------
this.$removeEquipSpaceItem = function $removeEquipSpaceItem() {
	this._removing = true;
	if (this._holdEquipSpace != &quot;&quot;) player.ship.removeEquipment(this._holdEquipSpace);
	this._removing = false;
}

//-------------------------------------------------------------------------------------------------------------
// routine to be called after a respray to get things setup correctly again
this.$postResprayFunction = function $postResprayFunction() {
	this._current = {};
	var result = this.$installBaseEquipment(player.ship);
	this._startUp = false;
	this.equipmentAdded(&quot;&quot;);
	this._resprayActive = false;
}

//-------------------------------------------------------------------------------------------------------------
// ensures that hyperspace hangar doesn&#39;t store ships with the equipspace item
this.$updateHyperHangarShipImage = function $updateHyperHangarShipImage() {
	var hh = worldScripts.HyperspaceHangar;
	this._startUp = true;
	// remove the equipment space item before respray, otherwise strange things seem to happen to the amount of available cargo space
	for (var i = 1; i &lt;= 40; i++) {
		var remove = &quot;EQ_EQUIPSPACE_&quot; + i;
		if (player.ship.equipmentStatus(remove) === &quot;EQUIPMENT_OK&quot;) {
			this._holdEquipSpace = remove;
			player.ship.removeEquipment(remove);
			break;
		}
	}
	// put the updated storage data into the Hyperspace hangar variable
	hh._shipsStored[hh._shipTempKey] = worldScripts[&quot;Ship_Storage_Helper.js&quot;].storeCurrentShip();
	// put equipment space item back again
	this.$restoreEquipSpaceItem();
}

//-------------------------------------------------------------------------------------------------------------
// we&#39;re monkey patching combat sim so we can do a couple of steps in the right order
// essentially we need to remove the equipment space item before SSH stores the ship config, then put it back immediately after so the ship will work as normal
// then, just before the ship is restored we remove the equipment space item again, allow SSH to restore the ship and then add it back again.
this.$combatSim_startFight = function $combatSim_startFight() {
	worldScripts.ShipConfiguration_Core.$preResprayFunction();
	worldScripts[&quot;Ship_Storage_Helper.js&quot;].disableTCATPBNSFunc();
	this.$shipState = worldScripts[&quot;Ship_Storage_Helper.js&quot;].storeCurrentShip();
	worldScripts.ShipConfiguration_Core.$restoreEquipSpaceItem();
	this._setUpHandlers();
	this._setUpEnvironment();
	player.ship.removeEquipment(&quot;EQ_ESCAPE_POD&quot;);
	player.ship.launch();
}

//-------------------------------------------------------------------------------------------------------------
// returns the price factor for equipment based on the system&#39;s techlevel
this.$equipmentTechFactor = function $equipmentTechFactor(techlvl, sysID) {
	// prices would be higher in low tech worlds, cheaper in high-tech
	// range is high tech 14 (even 15) to low tech 0
	// prices should&#39;nt vary by too much - 0.7 - 1.3 should probably be the greatest range
	// we&#39;ll add a small variance to the price, so no two systems should have exactly the same prices
	// but the price will always be the same in that system

	var factor = (((16 - techlvl) / 16) * 0.6) + 0.7;
	var sysFactor = 0.5;
	// make sure we&#39;re not in interstellar space
	if (sysID &gt;= 0) {
		sysFactor = system.scrambledPseudoRandomNumber(sysID);
	}
	factor *= (1 + (sysFactor * 0.1 - 0.05));
	//if (this._debug) log(this.name, &quot;tech factor = &quot; + factor);
	return factor;
}</pre></td>
                </tr>
                <tr>
                    <td valign="top">Scripts/shipconfig_f3hud.js</td>
                    <td><pre>&quot;use strict&quot;;
this.name = &quot;ShipConfiguration_F3HUDControl&quot;;
this.author = &quot;phkb&quot;;
this.copyright = &quot;2018 phkb&quot;;
this.description = &quot;Handles the swapping in/out of specialised HUD for F3 screen&quot;;
this.licence = &quot;CC BY-NC-SA 3.0&quot;;

this._equipSpaceHUD = &quot;shipconfig_hud.plist&quot;;

//-------------------------------------------------------------------------------------------------------------
this.startUpComplete = function () {
    if (worldScripts.ShipConfiguration_Core._disabled) {
        delete this.guiScreenChanged;
        delete this.missionScreenEnded;
        delete this.playerBoughtEquipment;
        delete this.startUpComplete;
    }
    // make sure we&#39;re using the appropriate F3 HUD, one that matches the big gui setting of the current HUD.
    if (this._equipSpaceHUD.indexOf(&quot;shipconfig&quot;) &gt;= 0) {
        if (worldScripts.ShipConfiguration_Core.$isBigGuiActive() === true) {
            this._equipSpaceHUD = &quot;shipconfig_biggui_hud.plist&quot;;
        } else {
            this._equipSpaceHUD = &quot;shipconfig_hud.plist&quot;;
        }
        log(this.name, this._equipSpaceHUD);
    }
}

//-------------------------------------------------------------------------------------------------------------
this.guiScreenChanged = function (to, from) {
    var p = player.ship;
    if (!p.docked) return;
    if (worldScripts.ShipConfiguration_Core._disableF3HUD === true) return;
    if (guiScreen === &quot;GUI_SCREEN_EQUIP_SHIP&quot;) {
        //swap to special hud
        if (p.hud !== this._equipSpaceHUD) {
            this._restoreHUD = p.hud;
            this._restoreTargetSensitivity = p.reticleTargetSensitive;
            p.hud = this._equipSpaceHUD;
        }
        this.$updateEquipmentSpaceHUD();
    } else {
        if (from === &quot;GUI_SCREEN_EQUIP_SHIP&quot;) {
            if (p.hud === this._equipSpaceHUD) {
                if (this._restoreHUD) {
                    p.hud = this._restoreHUD;
                    p.reticleTargetSensitive = this._restoreTargetSensitivity;
                    delete this._restoreHUD;
                }
            }
            p.setCustomHUDDial(&quot;equipment_space&quot;, &quot;&quot;);
            p.setCustomHUDDial(&quot;cargo_space&quot;, &quot;&quot;);
        }
    }
}

//-------------------------------------------------------------------------------------------------------------
this.missionScreenEnded = function () {
    // make sure we&#39;re using the appropriate F3 HUD, one that matches the big gui setting of the current HUD.
    if (this._equipSpaceHUD.indexOf(&quot;shipconfig&quot;) &gt;= 0) {
        if (worldScripts.ShipConfiguration_Core.$isBigGuiActive() === true) {
            this._equipSpaceHUD = &quot;shipconfig_biggui_hud.plist&quot;;
        } else {
            this._equipSpaceHUD = &quot;shipconfig_hud.plist&quot;;
        }
    }
    this.guiScreenChanged();
}

//-------------------------------------------------------------------------------------------------------------
this.playerBoughtEquipment = function (equipmentKey) {
    var p = player.ship;
    if (!p.docked) return;
    var s = worldScripts.ShipConfiguration_Core;
    if (s._disableF3HUD === true) return;
    if (s._ignoreEquip.indexOf(equipmentKey) &gt;= 0) return;
    this.$updateEquipmentSpaceHUD();
}

//-------------------------------------------------------------------------------------------------------------
this.$updateEquipmentSpaceHUD = function $updateEquipmentSpaceHUD() {
    if (guiScreen === &quot;GUI_SCREEN_EQUIP_SHIP&quot;) {
        var pad = 14.2;
        var p = player.ship;
        var s = worldScripts.ShipConfiguration_Core;
        if (s._disableF3HUD === true) return;
        var used = s.$calcEquipmentSpace(p);
        var cargoUsed = s.$cargoEquipmentSpaceAmount(p);
        var maxCargo = s.$cargoSpaceAvailable(p);
        var maxSpace = Math.ceil(s.$equipmentSpaceTotal(p) + maxCargo);
        var spc = String.fromCharCode(31) + String.fromCharCode(31) + String.fromCharCode(31);
        var text = s.$padTextLeft(expandDescription(&quot;[sc-header-equipspace]&quot;) + &quot; &quot; + used.toFixed(1) + spc + &quot;t (&quot; + maxSpace.toFixed(0) + spc + &quot;t)&quot;, pad);
        p.setCustomHUDDial(&quot;equipment_space&quot;, text);
        text = s.$padTextLeft(expandDescription(&quot;[sc-header-cargo]&quot;) + &quot; &quot; + cargoUsed.toFixed(1) + spc + &quot;t (&quot; + maxCargo + spc + &quot;t)&quot;, pad);
        p.setCustomHUDDial(&quot;cargo_space&quot;, text);
    }
}</pre></td>
                </tr>
                <tr>
                    <td valign="top">Scripts/shipconfig_fuelscoops.js</td>
                    <td><pre>&quot;use strict&quot;;
this.name = &quot;ShipConfiguration_FuelScoops&quot;;
this.author = &quot;phkb&quot;;
this.copyright = &quot;2017 phkb&quot;;
this.description = &quot;Routines for fuel scoop control&quot;;
this.licence = &quot;CC BY-NC-SA 3.0&quot;;

this.shipScoopedFuel = function () {
    var p = player.ship;
    // this is only for player - NPC&#39;s don&#39;t seem to have an equivalent event at the moment
    var accum = p.script._fuelScoopAccumulator;
    // add the additional fuel &quot;accumulated&quot;
    p.fuel += accum;
    if (p.fuel &gt; 7) p.fuel = 7
}</pre></td>
                </tr>
                <tr>
                    <td valign="top">Scripts/shipconfig_heatsink.js</td>
                    <td><pre>&quot;use strict&quot;;
this.name = &quot;ShipConfiguration_HeatSink&quot;;
this.author = &quot;phkb&quot;;
this.copyright = &quot;2016 phkb&quot;;
this.description = &quot;Activation and control script for heat sink usage.&quot;;
this.licence = &quot;CC BY-NC-SA 3.0&quot;;

this._mode = 0; // current mode of heat sinks (0 = manual, 1 = auto)
this._warnPlayerOfHeat = true; // flag to indicate that player will be reminder of dangerous heat levels
this._controlMode = 0; // control mode: 0 = normal (ie primable equipment), 1 = passive
this._tempCheck = null; // timer to do automatic heat level checks for heat sink deployment
this._amountToDump = 0.5; // max percentage of heat to be dumped (reduced by ship mass)
this._menuColor = &quot;orangeColor&quot;; // color of general menu items
this._itemColor = &quot;yellowColor&quot;; // color of special menu items (eg exit menu items)
this._disabledColor = &quot;darkGrayColor&quot;; // color of disabled equipment items
this._lastChoice = &quot;&quot;; // last selection on the config screen
//this._hsTimer = null;					// timer to monitor items in the hsDeployed array to automatically explode deployed heat sinks
this._fcbID = 0; // frame callback ID for heat control
this._heatWarning = null; // timer for informing the player of critical heat levels
this._warning1 = false;
this._warning2 = false;
this._warning3 = false;
this._warningPoint1 = 0.70;
this._warningPoint2 = 0.80;
this._warningPoint3 = 0.90;

//-------------------------------------------------------------------------------------------------------------
this.activated = function () {
	var p = player.ship;
	if (p.equipmentStatus(&quot;EQ_HEAT_SINK_CONTROL&quot;) === &quot;EQUIPMENT_OK&quot; || p.equipmentStatus(&quot;EQ_HEAT_SINK_CONTROL_PASSIVE&quot;) === &quot;EQUIPMENT_OK&quot;) {
		// ok we&#39;re ready to dump
		var sc = worldScripts.ShipConfiguration_Core;
		// how much will we be dumping
		var dumpAmount = this._amountToDump * (1 - (sc.$getShipMass(p) / 500000));
		// ensure we will always have something to dump, even if it&#39;s only a little bit
		if (dumpAmount &lt; 0.1) dumpAmount = 0.1;
		// is this actually worth it?
		if ((p.temperature - dumpAmount) &lt; (0.234375 + (p.script._busOverload / 100))) {
			player.consoleMessage(&quot;Temperature not at sufficient level to warrant heat sink use.&quot;);
			return;
		}
		sc.$playSound(&quot;deploy_heat_sink&quot;);
		worldScripts.ShipConfiguration_HeatSink.$deployHeatSink(player.ship);
		var hs = p.equipmentStatus(&quot;EQ_HEAT_SINK&quot;, true)[&quot;EQUIPMENT_OK&quot;];
		// smaller ships will dump a larger percentage of heat
		//p.temperature -= dumpAmount;
		player.consoleMessage(&quot;Heat sink deployed - &quot; + hs + &quot; remaining&quot;);
	} else {
		player.consoleMessage(&quot;Heat sink control unit damaged - unable to deploy heat sink&quot;);
	}
}

//-------------------------------------------------------------------------------------------------------------
this.mode = function () {
	var p = player.ship;
	if (p.equipmentStatus(&quot;EQ_HEAT_SINK_CONTROL&quot;) === &quot;EQUIPMENT_OK&quot; || p.equipmentStatus(&quot;EQ_HEAT_SINK_CONTROL_PASSIVE&quot;) === &quot;EQUIPMENT_OK&quot;) {
		var hs = worldScripts.ShipConfiguration_HeatSink;
		if (hs._mode === 0) {
			hs._mode = 1;
			player.consoleMessage(&quot;Automatic heat sink deployment mode selected&quot;);
			hs._tempCheck = new Timer(hs, hs.$checkShipTemp, 3, 3);
		} else {
			hs._mode = 0;
			player.consoleMessage(&quot;Manual heat sink deployment mode selected&quot;);
			if (hs._tempCheck &amp;&amp; hs._tempCheck.isRunning) hs._tempCheck.stop();
		}
	} else {
		player.consoleMessage(&quot;Heat sink control unit damaged - unable to change mode&quot;);
	}
}

//-------------------------------------------------------------------------------------------------------------
this.startUpComplete = function () {
	var sc = worldScripts.ShipConfiguration_Core;
	if (sc._disabled) {
		delete this.shipWillDockWithStation;
		delete this.shipDied;
		delete this.shipLaunchedFromStation;
		delete this.playerWillSaveGame;
		delete this.equipmentRemoved;
		delete this.playerBoughtEquipment;
		delete this.startUpComplete;
		return;
	}

	if (missionVariables.ShipConfig_HeatSinkMode) this._mode = parseInt(missionVariables.ShipConfig_HeatSinkMode);
	if (missionVariables.ShipConfig_HeatSinkControl) this._controlMode = parseInt(missionVariables.ShipControl_HeatSinkControl);

	this.$checkOutOfSyncMode();

	this.$initInterface(player.ship.dockedStation);
}

//-------------------------------------------------------------------------------------------------------------
this.shipWillDockWithStation = function (station) {
	this.$stopTimers();
	this.$checkOutOfSyncMode();
}

//-------------------------------------------------------------------------------------------------------------
this.shipDied = function (whom, why) {
	this.$stopTimers();
}

//-------------------------------------------------------------------------------------------------------------
this.shipLaunchedFromStation = function (station) {
	var sc = worldScripts.ShipConfiguration_Core;
	if (sc._heatControl === true) {
		// if we&#39;re in active mode, start a timer to check the temp now
		if (this._mode === 1) this._tempCheck = new Timer(this, this.$checkShipTemp, 2, 2);
		// set up the frame callback for doing the heat transfer
		var ps = player.ship.script;
		ps.thirdPartyHeat = 0;
		ps._warningPoint1 = this._warningPoint1;
		ps._warningPoint2 = this._warningPoint2;
		ps._warningPoint3 = this._warningPoint3;
		ps._warning1 = false;
		ps._warning2 = false;
		ps._warning3 = false;
		if (this._fcbID === 0) {
			this._fcbID = addFrameCallback(function (delta) {
				if (delta === 0) return;
				var p = player.ship;
				var ps = p.script;
				if (!p || !ps) return;
				// temp is impacted by laser temp, use of injectors and use of cloak
				var scale = ps._heat_sink_factor;
				//var ship_rate = p.script._heat_rate;
				// apply the minimum temp based on the bus overload level, equip extensions installed, and other factors
				if (p.temperature &lt; (0.234375 + (ps._busOverload / 100) + (ps._equipExt / 100) + ps._equipmentClassHeat)) {
					p.temperature = 0.234375 + (ps._busOverload / 100) + (ps._equipExt / 100) + ps._equipmentClassHeat;
				}
				// add temp based on equipment activity, slowing the rate down from 0.5 to 1.0
				// special case - is system is going nova, don&#39;t make it too much harder
				var exch_rate = (p.temperature &gt; 0.5 ? (1.5 - p.temperature) : 1) * (system.sun &amp;&amp; system.sun.hasGoneNova ? 0.5 : 1);
				p.temperature += (((p.laserHeatLevelAft + p.laserHeatLevelForward + p.laserHeatLevelPort + p.laserHeatLevelStarboard +
					(p.isCloaked ? 0.8 : 0) +
					((p.injectorsEngaged || ps._ficcEngaged === true) ? ((p.injectorBurnRate / 0.25)) : 0) +
					(ps.thirdPartyHeat &amp;&amp; ps.thirdPartyHeat &gt; 0 ? ps.thirdPartyHeat : 0) // third party heat properties
				) * exch_rate) / 3) * (delta / (5 / scale));
			});
		}
		if (this._warnPlayerOfHeat === true) {
			// set up timer for heat warning sounds/notifications
			this._heatWarning = new Timer(this, this.$warnPlayerOfHeat, 2, 2);
		}
	}
}

//-------------------------------------------------------------------------------------------------------------
this.playerWillSaveGame = function () {
	missionVariables.ShipConfig_HeatSinkMode = this._mode;
	missionVariables.ShipConfig_HeatSinkControl = this._controlMode;
}

//-------------------------------------------------------------------------------------------------------------
this.equipmentRemoved = function (equipment) {
	if (equipment === &quot;EQ_HEAT_SINK&quot; &amp;&amp; player.ship.docked) this.$initInterface(player.ship.dockedStation);
}

//-------------------------------------------------------------------------------------------------------------
this.playerBoughtEquipment = function (equipment) {
	if (equipment === &quot;EQ_HEAT_SINK&quot;) this.$initInterface(player.ship.dockedStation);
}

//-------------------------------------------------------------------------------------------------------------
this.$stopTimers = function $stopTimers() {
	if (this._tempCheck &amp;&amp; this._tempCheck.isRunning) this._tempCheck.stop();
	this.$stopFCB();
	if (this._heatWarning &amp;&amp; this._heatWarning.isRunning) this._heatWarning.stop();
	var ps = player.ship.script;
	if (ps) {
		ps._warning1 = false;
		ps._warning2 = false;
		ps._warning3 = false;
	}
}

//-------------------------------------------------------------------------------------------------------------
this.$stopFCB = function $stopFCB() {
	if (this._fcbID != 0) {
		if (isValidFrameCallback(this._fcbID)) removeFrameCallback(this._fcbID);
		this._fcbID = 0;
	}
}

//-------------------------------------------------------------------------------------------------------------
this.$warnPlayerOfHeat = function $warnPlayerOfHeat() {
	var p = player.ship;
	var ps = p.script;
	if (!p || !ps) return;
	if (p.temperature &gt;= ps._warningPoint1 &amp;&amp; ps._warning1 === false) {
		worldScripts.ShipConfiguration_Core.$playSound(&quot;booster_warning&quot;);
		player.consoleMessage(&quot;Warning: Heat level critical.&quot;, 5);
		ps._warning1 = true;
		return;
	}
	if (p.temperature &lt; ps._warningPoint1 &amp;&amp; ps._warning1 === true) ps._warning1 = false;

	
	if (p.temperature &gt;= ps._warningPoint2 &amp;&amp; ps._warning2 === false) {
		worldScripts.ShipConfiguration_Core.$playSound(&quot;booster_warning&quot;);
		player.consoleMessage(&quot;Warning: Heat level critical.&quot;, 5);
		ps._warning2 = true;
		return;
	}
	if (p.temperature &lt; ps._warningPoint2 &amp;&amp; ps._warning2 === true) ps._warning2 = false;

	// for third warning, play sound repeatedly
	if (p.temperature &gt;= ps._warningPoint3) {
		worldScripts.ShipConfiguration_Core.$playSound(&quot;booster_warning&quot;);
		if (ps._warning3 === false) {
			player.consoleMessage(&quot;Warning: Heat damage imminent.&quot;, 5);
			ps._warning3 = true;
		}
		return;
	}
	if (p.temperature &lt; ps._warningPoint3 &amp;&amp; ps._warning3 === true) ps._warning3 = false;
}

//-------------------------------------------------------------------------------------------------------------
this.$checkShipTemp = function $checkShipTemp() {
	var p = player.ship;
	if (p.equipmentStatus(&quot;EQ_HEAT_SINK_CONTROL&quot;) != &quot;EQUIPMENT_OK&quot; &amp;&amp; p.equipmentStatus(&quot;EQ_HEAT_SINK_CONTROL_PASSIVE&quot;) != &quot;EQUIPMENT_OK&quot;) return;
	if (p.temperature &gt; 0.75) {
		this.activated();
	}
}

//-------------------------------------------------------------------------------------------------------------
this.$initInterface = function $initInterface(station) {
	if (player.ship.equipmentStatus(&quot;EQ_HEAT_SINK&quot;) === &quot;EQUIPMENT_OK&quot;) {
		station.setInterface(this.name, {
			title: &quot;Heat sink control&quot;,
			category: &quot;Ship Systems&quot;,
			summary: &quot;Provides access to the Heat Sink Control system.&quot;,
			callback: this.$heatSinkControl.bind(this)
		});
	} else {
		station.setInterface(this.name, null);
	}
}

//-------------------------------------------------------------------------------------------------------------
this.$heatSinkControl = function $heatSinkControl() {

	var curChoices = {};
	var text = &quot;&quot;;
	var def = &quot;&quot;;

	var col1 = 10;
	var damaged = false;

	var sc = worldScripts.ShipConfiguration_Core;
	var p = player.ship;
	var hs = sc.$countHeatSinks();

	text = sc.$padTextRight(&quot;Number of heat sinks:&quot;, col1) + hs + &quot;\n&quot;;
	var dmg = p.equipmentStatus(&quot;EQ_HEAT_SINK&quot;, true)[&quot;EQUIPMENT_DAMAGED&quot;];
	if (dmg &gt; 0) {
		text += sc.$padTextRight(&quot;Damged heat sinks:&quot;, col1) + dmg + &quot;\n&quot;;
	}
	text += &quot;\n&quot;;

	text += sc.$padTextRight(&quot;Heat sink mode:&quot;, col1) + (this._mode === 0 ? &quot;Manual&quot; : &quot;Automatic&quot;) + &quot;\n&quot;;
	text += sc.$padTextRight(&quot; &quot;, col1) + (this._mode === 0 ? &quot;- Heat sinks must be deployed manually.\n\n&quot; : &quot;- Heat sinks will deploy automatically when\n&quot;);
	if (this._mode === 1) text += sc.$padTextRight(&quot; &quot;, col1) + &quot;  the cabin temperature is critical.\n\n&quot;;

	text += sc.$padTextRight(&quot;Control mode:&quot;, col1) + (this._controlMode === 0 ? &quot;Active&quot; : &quot;Passive&quot;) + &quot;\n&quot;;
	text += sc.$padTextRight(&quot; &quot;, col1) + (this._controlMode === 0 ? &quot;- primable Heat Sink Control will be visible in flight.&quot; : &quot;- no primable equipment will be visible in flight.&quot;) + &quot;\n&quot;;
	if (player.ship.equipmentStatus(&quot;EQ_HEAT_SINK_CONTROL&quot;) === &quot;EQUIPMENT_DAMAGED&quot; || player.ship.equipmentStatus(&quot;EQ_HEAT_SINK_CONTROL_PASSIVE&quot;) === &quot;EQUIPMENT_DAMAGED&quot;) {
		text += &quot;\nWARNING: Heat Sink Control mechanism is damaged. No changes can be made.\n&quot;;
		damaged = true;
	}

	if (this._controlMode === 0 &amp;&amp; damaged === false) {
		curChoices[&quot;01_CHANGE_MODE&quot;] = {
			text: &quot;Change heat sink mode to &quot; + (this._mode === 0 ? &quot;Automatic&quot; : &quot;Manual&quot;),
			color: this._menuColor
		};
	} else {
		curChoices[&quot;01_CHANGE_MODE&quot;] = {
			text: &quot;Change heat sink mode to &quot; + (this._mode === 0 ? &quot;Automatic&quot; : &quot;Manual&quot;),
			color: this._disabledColor,
			unselectable: true
		};
	}
	if (damaged === false) {
		curChoices[&quot;02_CHANGE_CONTROL&quot;] = {
			text: &quot;Change control mode to &quot; + (this._controlMode === 0 ? &quot;Passive&quot; : &quot;Active&quot;),
			color: this._menuColor
		};
	} else {
		curChoices[&quot;02_CHANGE_CONTROL&quot;] = {
			text: &quot;Change control mode to &quot; + (this._controlMode === 0 ? &quot;Passive&quot; : &quot;Active&quot;),
			color: this._disabledColor,
			unselectable: true
		};
	}
	curChoices[&quot;99_EXIT&quot;] = {
		text: &quot;[sc-return]&quot;,
		color: this._itemColor
	};

	def = &quot;99_EXIT&quot;;
	if (this._lastChoice != &quot;&quot;) def = this._lastChoice;

	var opts = {
		screenID: &quot;oolite-shipconfig-heatsinks-map&quot;,
		title: &quot;Heat Sink Control&quot;,
		allowInterrupt: true,
		overlay: {
			name: &quot;shipconfig_heatsink.png&quot;,
			height: 546
		},
		exitScreen: &quot;GUI_SCREEN_INTERFACES&quot;,
		choices: curChoices,
		initialChoicesKey: def,
		message: text
	};

	mission.runScreen(opts, this.$heatSinkScreenHandler, this);
}

//-------------------------------------------------------------------------------------------------------------
this.$heatSinkScreenHandler = function $heatSinkScreenHandler(choice) {

	if (!choice) return;

	this._lastChoice = choice;

	if (choice === &quot;01_CHANGE_MODE&quot;) {
		if (this._mode === 0) {
			this._mode = 1;
		} else {
			this._mode = 0;
		}
	}
	if (choice === &quot;02_CHANGE_CONTROL&quot;) {
		if (this._controlMode === 0) {
			if (player.ship.equipmentStatus(&quot;EQ_HEAT_SINK_CONTROL&quot;) === &quot;EQUIPMENT_OK&quot;) {
				player.ship.removeEquipment(&quot;EQ_HEAT_SINK_CONTROL&quot;);
				player.ship.awardEquipment(&quot;EQ_HEAT_SINK_CONTROL_PASSIVE&quot;);
				this._controlMode = 1;
				this._mode = 1;
			}
		} else {
			if (player.ship.equipmentStatus(&quot;EQ_HEAT_SINK_CONTROL_PASSIVE&quot;) === &quot;EQUIPMENT_OK&quot;) {
				this._controlMode = 0;
				player.ship.removeEquipment(&quot;EQ_HEAT_SINK_CONTROL_PASSIVE&quot;);
				player.ship.awardEquipment(&quot;EQ_HEAT_SINK_CONTROL&quot;);
			}
		}
	}

	if (choice != &quot;99_EXIT&quot;) this.$heatSinkControl();
}

//-------------------------------------------------------------------------------------------------------------
// deploys a HS object from a ship
this.$deployHeatSink = function $deployHeatSink(ship) {
	var sc = worldScripts.ShipConfiguration_Core;
	var dumpAmount = this._amountToDump * (1 - (sc.$getShipMass(ship) / 500000));
	if (dumpAmount &lt; 0.1) dumpAmount = 0.1;
	// create a heat sink object that appears briefly on the scanner
	// not using .spawn as there is a chance that won&#39;t create an object
	// system.addShips(&quot;heatsink&quot;, 1, ship.position.add(ship.vectorUp.multiply((ship.boundingBox.y + 5) * -1)), 0)[0]; // p.spawn(&quot;heatsink&quot;, 1); 
	// new method
	ship.ejectSpecificItem(&quot;heatsink&quot;);
	// smaller ships will dump a larger percentage of heat
	ship.removeEquipment(&quot;EQ_HEAT_SINK&quot;);
	ship.temperature -= dumpAmount;
}

//-------------------------------------------------------------------------------------------------------------
// check for out of sync equipment control mode
this.$checkOutOfSyncMode = function $checkOutOfSyncMode() {
	var p = player.ship;
	if (this._controlMode == 0) {
		if (p.equipmentStatus(&quot;EQ_HEAT_SINK_CONTROL_PASSIVE&quot;) != &quot;EQUIPMENT_UNAVAILABLE&quot;) this._controlMode = 1;
	} else {
		if (p.equipmentStatus(&quot;EQ_HEAT_SINK_CONTROL&quot;) != &quot;EQUIPMENT_UNAVAILABLE&quot;) this._controlMode = 0;
	}
}</pre></td>
                </tr>
                <tr>
                    <td valign="top">Scripts/shipconfig_npc.js</td>
                    <td><pre>&quot;use strict&quot;;
this.name = &quot;ShipConfiguration_NPCShips&quot;;
this.author = &quot;phkb&quot;;
this.copyright = &quot;2016 phkb&quot;;
this.description = &quot;Routines for applying ShipConfiguration details to NPC ships.&quot;;
this.licence = &quot;CC BY-NC-SA 3.0&quot;;

this._useExclusions = true; // flag to control which method will be used to apply config: includeRoles or excludeRoles
//this._disable_NShields_compatibility = true;

// includeRoles only used when &quot;this._useExclusions === false&quot;. All ships with these primaryRoles will get config applied. No other ships will.
this._includeRoles = [&quot;trader&quot;, &quot;trader-courier&quot;, &quot;trader-smuggler&quot;, &quot;shuttle&quot;, &quot;scavenger&quot;, &quot;miner&quot;,
	&quot;pirate&quot;, &quot;pirate-light-fighter&quot;, &quot;pirate-medium-fighter&quot;, &quot;pirate-heavy-fighter&quot;, &quot;pirate-interceptor&quot;,
	&quot;pirate-light-freighter&quot;, &quot;pirate-medium-freighter&quot;, &quot;pirate-heavy-freighter&quot;,
	&quot;pirate-light-fighter&quot;, &quot;pirate-medium-fighter&quot;, &quot;pirate-heavy-fighter&quot;,
	&quot;hunter&quot;, &quot;hunter-medium&quot;, &quot;hunter-heavy&quot;, &quot;assassin-light&quot;, &quot;assassin-medium&quot;, &quot;assassin-heavy&quot;,
	&quot;escort&quot;, &quot;escort-light&quot;, &quot;escort-medium&quot;, &quot;escort-heavy&quot;, &quot;wingman&quot;, &quot;police&quot;, &quot;police-station-patrol&quot;, &quot;police-witchpoint-patrol&quot;
];

// excludeRoles only used when &quot;this._useExclusions === true&quot;. Ships with these primaryRoles won&#39;t get configuration. All other ships will.
// however, only those ships with data defined in core._NPCConfig will have a specific configuration. If no config is found, ships will be given default equipment.
this._excludeRoles = [&quot;RSsatellite&quot;];

/* note the following roles/ship types are already excluded:
	Thargoids
	Stations
	Cargo
	Missiles/Mines/Weapons
	Subentities
	Visual Effects
	Ships with no pilot
	Rocks

	To exclude a particular ship, include the following in the &quot;script_info&quot; section of the shipdata.plist entry for the ship:
		&quot;no_sc_config&quot; = &quot;yes&quot;;
*/
this._trueValues = [&quot;yes&quot;, &quot;1&quot;, &quot;true&quot;, 1, true];

//-------------------------------------------------------------------------------------------------------------
this.startUpComplete = function () {
	if (worldScripts.ShipConfiguration_Core._disabled) {
		delete this.shipSpawned;
		delete this.startUpComplete;
		return;
	}
}

//-------------------------------------------------------------------------------------------------------------
this.shipSpawned = function (ship) {
	if (ship.isStation === true) return;
	if (ship.isThargoid === true) return;
	if (ship.isPiloted === false) return;
	if (ship.isCargo === true) return;
	if (ship.isRock === true) return;
	if (ship.isWeapon === true) return;
	if (ship.isMissile === true) return;
	if (ship.isMine === true) return;
	if (ship.isSubEntity === true) return;
	if (ship.isBeacon === true) return;
	if (ship.isVisualEffect === true) return;
	if (ship.scanClass == &quot;CLASS_NO_DRAW&quot;) return;
	if (ship.scanClass == &quot;CLASS_ROCK&quot;) return;
	if ((this._useExclusions === false &amp;&amp; this.$indexInList(ship.primaryRole, this._includeRole) &gt;= 0) ||
		(this._useExclusions === true &amp;&amp; this.$indexInList(ship.primaryRole, this._excludeRoles) === -1)) {
		if (!ship.scriptInfo.no_sc_config || this.$indexInList(ship.scriptInfo.no_sc_config, this._trueValues) === -1) {
			var conf = worldScripts.ShipConfiguration_Core;
			if (conf._applyToNPC === true) {
				// add base equipment
				conf.$installBaseEquipment(ship);
				// adjust performance
				conf.$updateShipSpecs(ship);

				ship.script._debugShipConfig = false;

				// make sure existing scripts are kept in monkey patch locations
				// check if NShields are installed
				if (worldScripts.NShields &amp;&amp; worldScripts.NShields.$shipHasShields(ship)) {
					// add our shipTaking damage script to NShield&#39;s array
					if (!ship.script.NShields_damageHandlers) ship.script.NShields_damageHandlers = []; //N-Shields alteration: set up handler array if it doesn&#39;t yet
					ship.script.NShields_damageHandlers.push(this.$npc_shipTakingDamage); //and push the shipconfig handler onto it
				} else {
					// otherwise do a standard monkey patch
					if (ship.script.shipTakingDamage) ship.script.$sc_hold_shipTakingDamage = ship.script.shipTakingDamage;
					// attach our new scripts
					ship.script.shipTakingDamage = this.$npc_shipTakingDamage;
				}

				// attach our new scripts
				if (ship.script.shipRemoved) ship.script.$sc_hold_shipRemoved = ship.script.shipRemoved;
				ship.script.shipRemoved = this.$npc_shipRemoved;
				if (ship.script.shipDied) ship.script.$sc_hold_shipDied = ship.script.shipDied;
				ship.script.shipDied = this.$npc_shipDied;
				if (ship.script.shilWillEnterWormhole) ship.script.$sc_hold_shipWillEnterWormhole = ship.script.shipWillEnterWormhole;
				ship.script.shipWillEnterWormhole = this.$npc_shipWillEnterWormhole;

				ship.script.$sc_stopTimer = this.$sc_stopTimer;
				if (conf._heatControl === true) {
					ship.script.$npc_checkTemp = this.$npc_checkTemp;
					ship.script.$initialise = this.$initialiseTimer;
				}
				ship.script.$damageDirection = worldScripts.ShipConfiguration_Armour.$damageDirection;

				ship.script._frontArmourType = conf.$equipmentItemInUse(&quot;frontarmour&quot;, ship);
				if (ship.script._frontArmourType != &quot;&quot;) {
					var info = EquipmentInfo.infoForKey(ship.script._frontArmourType);
					ship.script._armourFront = 100;
					ship.script._frontDamagePoint = info.scriptInfo.damage_point;
					ship.script._frontArmourStrength = info.scriptInfo.armour_strength;
				}
				ship.script._aftArmourType = conf.$equipmentItemInUse(&quot;aftarmour&quot;, ship);
				if (ship.script._aftArmourType != &quot;&quot;) {
					var info = EquipmentInfo.infoForKey(ship.script._aftArmourType);
					ship.script._armourAft = 100;
					ship.script._aftDamagePoint = info.scriptInfo.damage_point;
					ship.script._aftArmourStrength = info.scriptInfo.armour_strength;
				}

				// add special routines to ship so they can be executed by NPC equipment damage
				if (worldScripts.NPC_Equipment_Damage) {
					ship.script.$equipmentDamaged_Event = conf.$equipmentDamaged_Event;
					ship.script.$awaitEquipmentDamaged = conf.$awaitEquipmentDamaged;
					ship.script.$checkRemainingEnergy = conf.$checkRemainingEnergy;
					ship.script._damagedItems = []; // list of damaged items that required config adjustment
					ship.script._checkForDamage = null; // timer used to call &quot;$awaitEquipmentDamaged&quot; to check the &quot;damagedItems&quot; array
				}

				ship.script.$initialise();
			}
		}
	}
}

//-------------------------------------------------------------------------------------------------------------
// sets up the timer to apply heat transfer to NPC&#39;s
this.$initialiseTimer = function $initialiseTimer() {
	// set up the timer with a random interval between 0.5 and 1.5 so we don&#39;t get lots of ships updating at the same time
	var freq = parseInt((Math.random() + 0.5) * 100) / 100;
	this.ship.script.$sc_stopTimer();
	this.ship.script._tempCheck = new Timer(this, this.ship.script.$npc_checkTemp, 2 + freq, freq);
}

//-------------------------------------------------------------------------------------------------------------
// stops all the timers
this.$sc_stopTimer = function $sc_stopTimer() {
	if (this.ship.script._tempCheck &amp;&amp; this.ship.script._tempCheck.isRunning) {
		this.ship.script._tempCheck.stop();
	}
	delete this.ship.script._tempCheck;

	if (this.ship.script._energyTimer &amp;&amp; this.ship.script._energyTimer.isRunning) {
		this.ship.script._energyTimer.stop();
	}
	delete this.ship.script._energyTimer;

	if (this.ship.script._checkForDamage &amp;&amp; this.ship.script._checkForDamage.isRunning) {
		this.ship.script._checkForDamage.stop();
	}
	delete this.ship.script._checkForDamage;
}

//-------------------------------------------------------------------------------------------------------------
// routine to apply temp transfer
this.$npc_checkTemp = function $npc_checkTemp() {
	if (this.ship.isValid === false) {
		this.ship.script.$sc_stopTimer();
		return;
	}

	var injectorsEngaged = false;
	if (this.ship.maxSpeed &gt; 0 &amp;&amp; this.ship.speed &gt; this.ship.maxSpeed) injectorsEngaged = true;

	var curr = this.ship.temperature;

	// adjust the ship&#39;s temp, based on what it&#39;s doing at the moment
	// work out the factor, based on the tempcheck interval and heatsink factor
	// that means, if we ever adjust the timer interval, we won&#39;t have to also change the factor calc
	// we&#39;re also not making the factor as strong as for the player, as the player has real shields and NPC&#39;s don&#39;t
	var factor = (this.ship.script._tempCheck.interval / (5 / parseFloat(this.ship.script._heat_sink_factor))) * 0.5;
	var exch_rate = (this.ship.temperature &gt; 0.5 ? (1.5 - this.ship.temperature) : 1);
	this.ship.temperature += (((this.ship.laserHeatLevelAft + this.ship.laserHeatLevelForward + this.ship.laserHeatLevelPort + this.ship.laserHeatLevelStarboard +
		(this.ship.isCloaked ? 0.8 : 0) +
		(injectorsEngaged ? (this.ship.injectorBurnRate / 0.25) : 0)) * exch_rate) / 3) * factor;

	//if (this.ship.script._debugShipConfig &amp;&amp; curr != this.ship.temperature) {
	//	log(this.name, &quot;Use Orig temp &quot; + curr + &quot;, New temp &quot; + this.ship.temperature + &quot; applied to &quot; + this.ship);
	//}
	if (this.ship.temperature &gt; 0.75 &amp;&amp; this.ship.equipmentStatus(&quot;EQ_HEAT_SINK&quot;) !== &quot;EQUIPMENT_OK&quot;) {
		// better turn off that cloak, son
		if (this.ship.isCloaked) this.ship.isCloaked = false;
	}
	// NPC&#39;s have to operate with auto-deployment of heat-sinks
	if (this.ship.temperature &gt; 0.75 &amp;&amp; this.ship.equipmentStatus(&quot;EQ_HEAT_SINK&quot;) === &quot;EQUIPMENT_OK&quot;) {
		worldScripts.ShipConfiguration_HeatSink.$deployHeatSink(this.ship);
	}
}

//-------------------------------------------------------------------------------------------------------------
this.$npc_shipTakingDamage = function $npc_shipTakingDamage(amount, whom, type) {
	// run monkey patch, if present
	if (this.ship.script.$sc_hold_shipTakingDamage) this.ship.script.$sc_hold_shipTakingDamage(amount, whom, type);

	var thisship = this.ship;
	var scr = thisship.script;

	var fsh = 0;
	var ash = 0;
	// check for NPC shields
	if (worldScripts[&quot;NPC-shields&quot;]) {
		fsh += scr.shieldStrength;
		ash += scr.shieldStrength;
	}
	// check for customshields
	if (worldScripts.customshields) {
		fsh += scr.customshieldsforwardshieldlevel;
		ash += scr.customshieldsaftshieldlevel;
	}

	if (whom) scr._lastDamageDirection = scr.$damageDirection(thisship, whom);

	// pass energy damage onto the unshielded ship as a heat increase
	var sc = worldScripts.ShipConfiguration_Core;
	if (type === &quot;energy damage&quot; &amp;&amp; sc._heatControl === true &amp;&amp; amount &gt; 0 &amp;&amp; ((scr._lastDamageDirection === true &amp;&amp; fsh === 0) || (scr._lastDamageDirection === false &amp;&amp; ash === 0))) {
		var curr = thisship.temperature;
		// npc&#39;s already dont have shields, so we&#39;re decreasing the ratio of energy that is passed through, as compared with the player.
		var amt = amount / ((thisship.maxEnergy * thisship.heatInsulation) * 2);
		thisship.temperature += Math.pow((1.1 - thisship.temperature), 4) * amt;

		//if (scr._debugShipConfig &amp;&amp; curr != thisship.temperature) {
		//	log(this.name, &quot;Hit Orig temp &quot; + curr + &quot;, New temp &quot; + thisship.temperature + &quot; applied to &quot; + thisship);
		//}
	}

	// don&#39;t go any further if we don&#39;t have ShipConfig armour installed
	if (scr._frontArmourType === &quot;&quot; &amp;&amp; scr._aftArmourType === &quot;&quot;) return;

	if (whom) {
		// record where the last damage came from. True = front, false = aft
		if (scr._lastDamageDirection === true) {
			scr._lastDamageDirectionArmour = scr._armourFront;
			//if (scr._debugShipConfig &amp;&amp; fsh &gt; 0) log(this.name, amount + &quot; hit (absorbed by front shield &quot; + fsh + &quot;) from &quot; + (this._lastDamageDirection === true ? &quot;front&quot; : &quot;aft&quot;) + &quot;, ship = &quot; + thisship);
			if (fsh &gt; 0) return; // if we have shields and they&#39;re still in place, we don&#39;t need to do anything
		} else {
			scr._lastDamageDirectionArmour = scr._armourAft;
			//if (scr._debugShipConfig &amp;&amp; ash &gt; 0) log(this.name, amount + &quot; hit (absorbed by front shield &quot; + ash + &quot;) from &quot; + (this._lastDamageDirection === true ? &quot;front&quot; : &quot;aft&quot;) + &quot;, ship = &quot; + thisship);
			if (ash &gt; 0) return; // if we have shields and they&#39;re still in place, we don&#39;t need to do anything
		}
		//if (scr._debugShipConfig) log(this.name, amount + &quot; hit from &quot; + (this._lastDamageDirection === true ? &quot;front&quot; : &quot;aft&quot;) + &quot;, ship = &quot; + thisship);

		if (amount &amp;&amp; amount &gt; 0 &amp;&amp; type === &quot;energy damage&quot;) { // if we have energy damage
			var shield = 0;
			if (scr._lastDamageDirection === true) {
				shield = scr._frontArmourStrength * (scr._armourFront / 100);
			} else {
				shield = scr._aftArmourStrength * (scr._armourAft / 100);
			}

			//if (scr._debugShipConfig) log(this.name, &quot;amount = &quot; + amount + &quot;, front = &quot; + scr._armourFront + &quot;, aft = &quot; + scr._armourAft + &quot;, shield = &quot; + shield + &quot;, energy = &quot; + thisship.energy + &quot;, maxEnergy = &quot; + thisship.maxEnergy + &quot;, ship = &quot; + thisship);

			if (amount &lt; shield &amp;&amp; shield &gt; 0) {
				if ((thisship.energy + amount) &lt; thisship.maxEnergy) {
					thisship.energy += amount;
				} else {
					thisship.energy = thisship.maxEnergy;
				}

				if (scr._lastDamageDirection === true) {
					scr._armourFront -= Math.floor(100 * (amount / scr._frontArmourStrength));
					//if (scr._armourFront &lt; 100) {
					//	if (scr._debugShipConfig) log(this.name, &quot;Forward armour down to &quot; + scr._armourFront + &quot;%, ship = &quot; + thisship);
					//}
				} else {
					scr._armourAft -= Math.floor(100 * (amount / scr._aftArmourStrength));
					//if (scr._armourAft &lt; 100) {
					//	if (scr._debugShipConfig) log(this.name, &quot;Aft armour down to &quot; + scr._armourAft + &quot;%, ship = &quot; + thisship);
					//}
				}
			} else {
				if (shield &gt; 0) thisship.energy += shield;
				if (scr._lastDamageDirection === true) {
					scr._armourFront = 0;
				} else {
					scr._armourAft = 0;
				}
			}
		}
		// check to see if the armour has been completely destroyed
		if (amount &amp;&amp; amount &gt; 0 &amp;&amp; thisship.equipmentStatus(scr._frontArmourType) === &quot;EQUIPMENT_OK&quot; &amp;&amp; scr._armourFront &lt;= 0) { // if the armour is destroyed by damage
			thisship.removeEquipment(scr._frontArmourType);
			scr._frontArmourType = &quot;&quot;;
		}
		if (amount &amp;&amp; amount &gt; 0 &amp;&amp; thisship.equipmentStatus(scr._aftArmourType) === &quot;EQUIPMENT_OK&quot; &amp;&amp; scr._armourAft &lt;= 0) { // if the armour is destroyed by damage
			thisship.removeEquipment(scr._aftArmourType);
			scr._aftArmourType = &quot;&quot;;
		}
	}
}

//-------------------------------------------------------------------------------------------------------------
// may not be neccesary if the ent destroyed function runs in all cases.
this.$npc_shipRemoved = function $npc_shipRemoved(suppressDeathEvent) {
	// run monkey patch, if present
	if (this.ship.script.$sc_hold_shipRemoved) this.ship.script.$sc_hold_shipRemoved(suppressDeathEvent);
	//if (this.ship.script._debugShipConfig) log(this.name, &quot;*** shipRemoved for &quot; + this.ship);
	this.ship.script.$sc_stopTimer();
}

//-------------------------------------------------------------------------------------------------------------
this.$npc_shipDied = function $npc_shipDied(whom, why) {
	if (this.ship.script.$sc_hold_shipDied) this.ship.script.$sc_hold_shipDied(whom, why);
	this.ship.script.$sc_stopTimer();
}

//-------------------------------------------------------------------------------------------------------------
this.$npc_shipWillEnterWormhole = function $npc_shipWillEnterWormhole() {
	if (this.ship.script.$sc_hold_shipWillEnterWormhole) this.ship.script.$sc_hold_shipWillEnterWormhole();
	this.ship.script.$sc_stopTimer();
}

//-------------------------------------------------------------------------------------------------------------
// by cag for speed improvements instead of using &quot;indexOf&quot;
this.$indexInList = function $indexInList(item, list) { // for arrays only
	var k = list.length;
	while (k--) {
		if (list[k] === item) return k;
	}
	return -1;
}</pre></td>
                </tr>
                <tr>
                    <td valign="top">Scripts/shipconfig_scfix.js</td>
                    <td><pre>&quot;use strict&quot;;
this.name = &quot;ShipConfiguration_ShieldCyclerFix&quot;;
this.author = &quot;phkb&quot;;
this.copyright = &quot;2016 phkb&quot;;
this.licence = &quot;CC BY-NC-SA 3.0&quot;;

//-------------------------------------------------------------------------------------------------------------
this.startUpComplete = function () {
	var sc = worldScripts[&quot;Shield Cycler&quot;];
	if (sc &amp;&amp; (sc.version == &quot;1.12&quot; || sc.version == &quot;1.12.1&quot;)) {
		// there&#39;s a really small bug in Shield Cycler 1.12 and 1.12.1
		// patch these versions of shield cycler to fix it
		sc._sc_stop = this.$scFix_sc_stop;
	}
}

//-------------------------------------------------------------------------------------------------------------
this.$scFix_sc_stop = function $scFix_sc_stop(device) {
	/*	device is a string to indicate which devices handled by SC oxp need to be stopped
		currently has 2 possible values : 
		&quot;ALL&quot; : disable all devices
		&quot;SC&quot; : disables just the shieldcycler
		In future versions there will be more options

		returns
		-3 if SC was disabled
		-2 if device was stopped already
		-1 device string invalid
		0 if stopping was succesfull
		NOTE : no messages to player or logfile, imo this is the responsibility of the calling oxp
		NOTE : calling worldScripts[&quot;Shield Cycler&quot;]._sc_stop(&quot;SC&quot;) DOES NOT disable the entire oxp.
	*/
	var success = -3;
	if (this._sc_error == 0) {
		switch (device) {
			case &quot;ALL&quot;:
				if (this._sc_settings.general.disabled) {
					success = -2;
				} else {
					this._sc_settings.general.disabled = true;
					this._sc_update_oxpconfig_vars();
					success = 0;
				};
				break;
			case &quot;SC&quot;:
				if (this._sc_settings.general.sc_disabled) {
					success = -2;
				} else {
					this._sc_settings.general.sc_disabled = true;
					this._sc_update_oxpconfig_vars;
					success = 0;
				};
				break;
			default:
				success = -1; // bug was here. this originally read &quot;succes = -1;&quot;
				break;
		};
	};
	return success;
};</pre></td>
                </tr>
                <tr>
                    <td valign="top">Scripts/shipconfig_sellnegotiate.js</td>
                    <td><pre>&quot;use strict&quot;;
this.name = &quot;ShipConfiguration_SellNegotiate&quot;;
this.author = &quot;phkb&quot;;
this.copyright = &quot;2016 phkb&quot;;
this.description = &quot;Handles the process of selling the rare equipment items (eg cloaking device)&quot;;
this.licence = &quot;CC BY-NC-SA 3.0&quot;;

this._value = 0;
this._offer = 0;
this._currentMessage = &quot;&quot;;
this._extra = &quot;&quot;;
this._acceptValues = [&quot;y&quot;, &quot;yes&quot;, &quot;accept&quot;, &quot;sell&quot;];
this._returnValues = [&quot;n&quot;, &quot;no&quot;, &quot;return&quot;, &quot;no sale&quot;, &quot;go back&quot;, &quot;back&quot;, &quot;cancel&quot;, &quot;cancel sale&quot;];
this._equipmentKey = &quot;&quot;;
this._tries = {};

//-------------------------------------------------------------------------------------------------------------
this.startUpComplete = function () {
	if (worldScripts.ShipConfiguration_Core._disabled) {
		delete this.playerWillSaveGame;
		delete this.shipWillEnterWitchspace;
		delete this.startUpComplete;
		return;
	}
	if (missionVariables.ShipConfig_SellNegotiateTries) {
		// load in any try information
		this._tries = JSON.parse(missionVariables.ShipConfig_SellNegotiateTries);
		delete missionVariables.ShipConfig_SellNegotiateTries;
	}
}

//-------------------------------------------------------------------------------------------------------------
this.playerWillSaveGame = function () {
	// save the tries dictionary so the player can&#39;t get save, reload and try again
	missionVariables.ShipConfig_SellNegotiateTries = JSON.stringify(this._tries);
}

//-------------------------------------------------------------------------------------------------------------
this.shipWillEnterWitchspace = function (cause, destination) {
	// reset the tries dictionary
	this._tries = {};
}

//-------------------------------------------------------------------------------------------------------------
this.$displayInitialScreen = function $displayInitialScreen(equipmentKey, baseCost) {
	// work out the maximum value of this item, based on economy and techlevel factors
	this._value = (baseCost +
			((7 - system.economy) / 7) * (baseCost * 0.4) // economy-based factor - higher economy means better price
			+
			(system.techLevel / 14) * (baseCost * 0.8)) // techlevel based factor - higher techlevel means better price
		*
		((system.scrambledPseudoRandomNumber(baseCost) * 0.5) + 0.5); // multiply by a random value between 0.5 and 1, so occasionally item will be offered at less than base cost

	this._offer = baseCost * (system.scrambledPseudoRandomNumber(baseCost) * 0.8);
	if (this._offer &lt; 100 &amp;&amp; this._offer &gt; 10) this._offer = parseInt(this._offer / 10) * 10;
	if (this._offer &lt; 1000 &amp;&amp; this._offer &gt; 99) this._offer = parseInt(this._offer / 100) * 100;
	if (this._offer &gt; 1000) this._offer = parseInt(this._offer / 1000) * 1000;

	// get the initial message to display to the player
	this._currentMessage = expandDescription(&quot;[sc_sellnegotiate_initial]&quot;, {
		guess: formatCredits(this._offer, false, true)
	});
	this._extra = &quot;type &#39;Y&#39; to accept the offered amount, &quot;;

	// special notice for the cloaking device - you can&#39;t buy it again later if you sell it now
	if (equipmentKey === &quot;EQ_CLOAKING_DEVICE&quot;) this._currentMessage += &quot;\n\n(Note: If you sell the cloaking device you will not be able to purchase it again.)&quot;;
	// store the equipment key for use later
	this._equipmentKey = equipmentKey;

	// has the player already tried to negotiate a price
	var tries = 0;
	if (this._tries[this._equipmentKey + &quot;_&quot; + player.ship.dockedStation.name]) tries = this._tries[this._equipmentKey + &quot;_&quot; + player.ship.dockedStation.name];
	if (tries &gt;= 3) {
		// if the player has already tried too many times, go straight to the no deal screen
		this.$noDeal();
	} else {
		this.$showScreen();
	}
}

//-------------------------------------------------------------------------------------------------------------
this.$showScreen = function $showScreen() {
	var opts = {
		screenID: &quot;oolite-shipconfig-sellnegotiate-map&quot;,
		title: &quot;Sell Equipment&quot;,
		allowInterrupt: false,
		overlay: {
			name: &quot;shipconfig_chat.png&quot;,
			height: 546
		},
		exitScreen: &quot;GUI_SCREEN_INTERFACES&quot;,
		message: this._currentMessage + expandDescription(&quot;[sc_sellnegotiate_additional]&quot;, {
			extra_info: (this._offer != 0 ? this._extra : &quot;&quot;)
		}),
		textEntry: true
	};
	mission.runScreen(opts, this.$getEstimate, this);
}

//-------------------------------------------------------------------------------------------------------------
this.$getEstimate = function $getEstimate(param) {
	if (param == null) {
		this.$goBack();
		return;
	}
	if (parseInt(param) &gt;= 1 &amp;&amp; parseInt(param) &lt;= 9999999) {
		this._offer = 0;
		// is the estimate inside or outside the calculated value
		if (parseInt(param) &gt; (this._value * 1.1)) {
			// check to see how many times we&#39;ve tried to negotiate a price on this station for this piece of equipment.
			var tries = 0;
			if (this._tries[this._equipmentKey + &quot;_&quot; + player.ship.dockedStation.name]) tries = this._tries[this._equipmentKey + &quot;_&quot; + player.ship.dockedStation.name];
			tries += 1;
			this._tries[this._equipmentKey + &quot;_&quot; + player.ship.dockedStation.name] = tries;
			// if we&#39;re tried too many times, give the &quot;No Deal&quot; message
			if (tries &gt;= 3) {
				this.$noDeal();
			} else {
				// otherwise, tell the player their estimate was unreasonable
				this._currentMessage = expandDescription(&quot;[sc_sellnegotiate_unreasonable]&quot;);
				this.$showScreen();
			}
		} else {
			// OK, it&#39;s a deal.
			player.credits += parseInt(param);
			player.ship.removeEquipment(this._equipmentKey);
			worldScripts.ShipConfiguration_Core.$playSound(&quot;sell&quot;);

			mission.runScreen({
				screenID: &quot;oolite-shipconfig-sellnegotiate-map&quot;,
				title: &quot;Sell Equipment&quot;,
				overlay: {
					name: &quot;shipconfig_chat.png&quot;,
					height: 546
				},
				message: expandDescription(&quot;[sc_sellnegotiate_complete]&quot;),
				allowInterrupt: false,
			}, this.$saleComplete, this);
		}
	} else {
		// check to see if the entered text was one of the &quot;return&quot; values
		if (param === &quot;&quot; || this._returnValues.indexOf(param.toLowerCase()) &gt;= 0) {
			this.$goBack();
			return;
		}
		if (this._acceptValues.indexOf(param.toLowerCase()) &gt;= 0 &amp;&amp; this._offer != 0) {
			// OK, it&#39;s a deal.
			player.credits += this._offer;
			player.ship.removeEquipment(this._equipmentKey);
			worldScripts.ShipConfiguration_Core.$playSound(&quot;sell&quot;);

			mission.runScreen({
				screenID: &quot;oolite-shipconfig-sellnegotiate-map&quot;,
				title: &quot;Sell Equipment&quot;,
				overlay: {
					name: &quot;shipconfig_chat.png&quot;,
					height: 546
				},
				message: expandDescription(&quot;[sc_sellnegotiate_complete]&quot;),
				allowInterrupt: false,
			}, this.$saleComplete, this);

			return;
		}
		// otherwise show the &quot;I don&#39;t understand&quot; message
		this._offer = 0;
		this._currentMessage = expandDescription(&quot;[sc_sellnegotiate_syntax]&quot;);
		this.$showScreen();
	}
}

//-------------------------------------------------------------------------------------------------------------
this.$saleComplete = function $saleComplete(choice) {
	this.$goBack();
}

//-------------------------------------------------------------------------------------------------------------
this.$goBack = function $goBack() {
	worldScripts.ShipConfiguration_Core.$sellEquipment();
}

//-------------------------------------------------------------------------------------------------------------
this.$noDeal = function $noDeal() {
	mission.runScreen({
		screenID: &quot;oolite-shipconfig-sellnegotiate-map&quot;,
		title: &quot;Sell Equipment&quot;,
		overlay: {
			name: &quot;shipconfig_chat.png&quot;,
			height: 546
		},
		message: expandDescription(&quot;[sc_sellnegotiate_nodeal]&quot;),
		allowInterrupt: false,
	}, this.$saleComplete, this);
}</pre></td>
                </tr>
                <tr>
                    <td valign="top">Scripts/shipconfig_witchdriveheat.js</td>
                    <td><pre>&quot;use strict&quot;;
this.name = &quot;ShipConfiguration_WitchdriveHeat&quot;;
this.author = &quot;phkb&quot;;
this.copyright = &quot;2016 phkb&quot;;
this.description = &quot;Process of adding cabin heat when building up to a witchspace jump&quot;;
this.licence = &quot;CC BY-NC-SA 3.0&quot;;

this._disabled = false; // set to true to disable witchdrive heat buildup
this._heatDelta = 0.0; // amount of heat to add - set when turning on heat
this._heatMonitor = null;
this._misJumpSet = false;

//-------------------------------------------------------------------------------------------------------------
this.startUpComplete = function () {
	if (this._disabled === true) {
		delete this.playerStartedJumpCountdown;
		delete this.playerCancelledJumpCountdown;
		delete this.playerJumpFailed;
		delete this.playerStartedAutoPilot;
		delete this.shipWillExitWitchspace;
		delete this.startUpComplete;
		return;
	}
}

//-------------------------------------------------------------------------------------------------------------
this.playerStartedJumpCountdown = function (type, seconds) {
	this.$turnOnHeat();
}

//-------------------------------------------------------------------------------------------------------------
this.playerCancelledJumpCountdown = function () {
	this.$turnOffHeat();
}

//-------------------------------------------------------------------------------------------------------------
this.playerStartedAutoPilot = function() {
	this.$turnOffHeat();
}

//-------------------------------------------------------------------------------------------------------------
this.playerJumpFailed = function (reason) {
	this.$turnOffHeat();
}

//-------------------------------------------------------------------------------------------------------------
this.shipWillExitWitchspace = function () {
	this.$turnOffHeat();
}

//-------------------------------------------------------------------------------------------------------------
this.shipDied = function (whom, why) {
	if (this._heatMonitor &amp;&amp; this._heatMonitor.isRunning) this._heatMonitor.stop();
}

//-------------------------------------------------------------------------------------------------------------
this.$turnOffHeat = function $turnOffHeat() {
	var ps = player.ship.script;
	ps.thirdPartyHeat -= this._heatDelta;
	this._heatDelta = 0;
	if (ps.thirdPartyHeat &lt; 0) ps.thirdPartyHeat = 0;
	if (this._heatMonitor &amp;&amp; this._heatMonitor.isRunning === true) this._heatMonitor.stop();
	if (this._misJumpSet) {
		player.ship.scriptedMisjump = false;
		this._misJumpSet = false;
	}
}

//-------------------------------------------------------------------------------------------------------------
this.$turnOnHeat = function $turnOnHeat() {
	if (system.sun &amp;&amp; system.sun.hasGonaNova) {
		this._heatDelta = 0.2;
	} else {
		switch (player.ship.hyperspaceSpinType) {
			case 30:
				this._heatDelta = 0.87;
				break;
			case 10:
				this._heatDelta = 0.91;
				break;
			case 5:
				this._heatDelta = 0.92;
				break;
			default:
				this._heatDelta = 0.9;
				break;
		}
	}
	player.ship.script.thirdPartyHeat += this._heatDelta;
	if (this._heatMonitor &amp;&amp; this._heatMonitor.isRunning === true) this._heatMonitor.stop();
	this._heatMonitor = new Timer(this, this.$checkHeat.bind(this), 1, 1);
}

//-------------------------------------------------------------------------------------------------------------
this.$checkHeat = function $checkHeat() {
	var p = player.ship;
	var ps = p.script;
	if (system.sun &amp;&amp; system.sun.hasGoneNova &amp;&amp; this._heatDelta != 0.2) {
		ps.thirdPartyHeat -= this._heatDelta;
		if (ps.thirdPartyHeat &lt; 0) ps.thirdPartyHeat = 0;
		this._heatDelta = 0.2;
		ps.thirdPartyHeat += this._heatDelta;
	}
	var heat = p.temperature;
	if (heat &gt; 0.65) {
		// increase the chance of a misjump the higher the temp
		if (Math.random() &lt; (0.35 - (1 - heat)) &amp;&amp; p.scriptedMisjump === false) {
			p.scriptedMisjump = true;
			this._misJumpSet = true;
		}
	}
}</pre></td>
                </tr>
            </table>
        </a>
    </body>
</html>
