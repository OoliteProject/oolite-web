<html>
    <head>
        <title>Expansion Commies</title>
        <link rel="stylesheet" href="../style.css">
    </head>
    <body>
        <table border="0" width="100%">
            <tr>
                <td>Back to <a href='../index.html'>Index</a></td>
                <td align="right"><small>Page generated: Oct 11, 2023, 3:16:48 PM</small></td>
            </tr>
        </table>

        <h1>Expansion Commies</h1>

        <h2>Content</h2>
        <ul>
          
          <li><a href="#manifest">Manifest</a></li>
          <li><a href="#documentation">Documentation</a></li>
          <li><a href="#equipment">0 Equipment</a></li>
          <li><a href="#ships">36 Ships</a></li>
          <li><a href="#models">0 Models</a></li>
          <li><a href="#scripts">7 Scripts</a></li>
        </ul>


        <a name="manifest">
        <h2>Manifest</h2>
            <table border="1">
                <tr>
                    <th></th>
                    <th>from Expansion Manager's OXP list</th>
                    <th>from Expansion Manifest</th>
                </tr>
                <tr>
                    <td>Description</td>
                    <td>Adds Astro Mines, Factories, Production Units, Commuters &amp; special police ships to Communist systems.</td>
                    <td>Adds Astro Mines, Factories, Production Units, Commuters &amp; special police ships to Communist systems.</td>
                </tr>
                <tr>
                    <td>Identifier</td>
                    <td>oolite.oxp.DrNil.Commies</td>
                    <td>oolite.oxp.DrNil.Commies</td>
                </tr>
                <tr>
                    <td>Title</td>
                    <td>Commies</td>
                    <td>Commies</td>
                </tr>
                <tr>
                    <td>Category</td>
                    <td>Systems</td>
                    <td>Systems</td>
                </tr>
                <tr>
                    <td>Author</td>
                    <td>Amaranth, Dr. Nil, Eric Walch, Norby, phkb, GearsNSuch</td>
                    <td>Amaranth, Dr. Nil, Eric Walch, Norby, phkb, GearsNSuch</td>
                </tr>
                <tr>
                    <td>Version</td>
                    <td>2.19</td>
                    <td>2.19</td>
                </tr>
                <tr>
                    <td>Tags</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Required Oolite Version</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Maximum Oolite Version</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Required Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Optional Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Conflict Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Information URL</td>
                    <td><a target="_blank" href="http://wiki.alioth.net/index.php/Commies">http://wiki.alioth.net/index.php/Commies</a></td>
                    <td><a target="_blank" href="">n/a</a></td>
                </tr>
                <tr>
                    <td>Download URL</td>
                    <td><a target="_blank" href="https://wiki.alioth.net/img_auth.php/d/dd/Commies_2.19.oxz">https://wiki.alioth.net/img_auth.php/d/dd/Commies_2.19.oxz</a></td>
                    <td><a target="_blank" href="">n/a</a></td>
                </tr>
                <tr>
                    <td>License</td>
                    <td>CC BY-NC-SA 3.0</td>
                    <td>CC BY-NC-SA 3.0</td>
                </tr>
                <tr>
                    <td>File Size</td>
                    <td>n/a</td>
                </tr>
                <tr>
                    <td>Upload date</td>
                    <td>1693710644</td>
                </tr>
            </table>
                </a>

        <a name="documentation">
        <h2>Documentation</h2>
        <p>Also read <a href='http://wiki.alioth.net/index.php/Commies'>http://wiki.alioth.net/index.php/Commies</a></p>
        <h3>README.txt</h3>
        <pre>Commies for Giles William&#39;s Oolite

by Dr. Nil
2.19 August 2023
Cleaned up shipdata.plist. Added a new texture + normal map for the Astromine Penal Colony while we await GearsNSuch&#39;s updated model and textures. Added normal map to the Manta Ray carrier. Added extra shipyard.plist entry for player version of the Military Stingray. 

2.18 August 2019
Added improved graphics and updated shipdata.plist and shiplibrary.plist. Also removed some deprecated files from the Config folder. The models and textures for the Astromine Convict Pod, the Workers&#39; Commuter, The Commissar Limousine, and the Ray (and derivatives) have been replaced with new, from-scratch graphics created by GearsNSuch with Blender (blender.org) and GIMP (gimp.org). Shipdata.plist has been updated and cleaned up to incorporate these graphical changes and add names to the different models of spacecraft. A shiplibrary.plist file has been added as well, with descriptions drawn from original material and the Oolite Wiki (wiki.alioth.net). All models and textures are licensed under the CC BY-NC-SA 3 license.

2.17
Fixed populator issues that were (a) preventing Commissar Limousines from being spawned, and (b) preventing Giant Ray&#39;s from being spawned in Intergalactic space. Also made it possible to save the game at Astro Factories and Collective SLAPU stations.

2.16 March 2017
Fixed semicolon problems in Mac, thanks to hoqllnq.

2.15 January 2017
Added code to utilize Station Validator, if installed.
Added improved texture files, courtesy of Keeper.

2.14 November 2016
Updated scripts and config for current version of Oolite (1.82 and onwards)

2.13 April 2016
Edited the quotes out of the name of Sun Ray to avoid the computer pronouncing them audibly when it&#39;s passing on the radio chatter.

2.12 April 2012
This amended readme refers to Amaranth&#39;s additional textures for Commies OXP. I have not modified the models and scripting in any way and this remains the work of Dr Nil.

I have created the textures from a number of sources

Initial texture design and ideas are based on Dr Nil&#39;s original, combined with textures found via a google image search.

The exceptions to this are the escape pod (incorporating photos I took of the Soyuz capsule in the Polish Military Museum, Warsaw) and parts of the docking bay, based on photos of mine of derelict buildings.
_____

This work is licensed under the Creative Commons Attribution-Noncommercial-Share Alike 3.0 Unported License. To view a copy of this license, visit http://creativecommons.org/licenses/by-nc-sa/3.0/ or send a letter to Creative Commons, 171 Second Street, Suite 300, San Francisco, California, 94105, USA.
_____

Read Captain Hesperus&#39; descriptions of commie systems and ships here: http://wiki.alioth.net/index.php/Powers_and_Organisations#Communist_States


* * * * *

2.11 mei 2010

Added reflection and illumination maps for some of the stations.

2.10 April 2010

Corrected the role for the ecm-proof-missiles. Has always been wrong resulting in launching plain missiles for some of the ships.

2.09 October 2009

Centered the stations so the are now centered in the players target-reticule.
Changed the addition distance for solar stations from a general distance into a value relative to the sun radius. Stations no longer explode because of being added to close near big suns. With smaller suns the distance is even closer to the sun now.

2.08 September 2009

Translated the main script into Java Script. (When used with Oolite 1.65 it will fall back on the old script)
Corrected an very old type flasher definition. (Still worked before but would be skipped with Oolite 1.73)
Launching workcoms now head for a commies station instead of docking at the same station (Oolite 1.72-) or &quot;wormholing&quot; away (Oolite 1.73+)
Removed comguardAI: Was wrong and unused.
Updated some AI based on Oolite 1.55 trader AI to that of 1.65 trader AI (Better avoidance of obstacles)
Removed a bug were ships without fuel-scoop scanned for debris. Although the AI never intended to scoop them, scanForRandomLoot never finds anything when there are no scoops.
Fixed bug with fuel_injection of comlim (typo)

2.07 March 2008

Corrected a typo in an AI spotted by Ahruman


2.06 Jan 2008

A bug in the shipdata squashed by honorary commissar Kaks


2.05 November 2007

Some more propaganda posters.


2.04 April 2007

4 new propaganda posters.

2.03 April 2007

Fixed an issue with the units for Gold, Platinum and Gems at some of the stations.

2.0 February 2007

New model for the Astromines.
Fixed commodities for SLAP-Us, CZGFs and Astromines.
4 new propaganda posters.


1.85 Jan 2007

A new ship for the Commissar Limousine (Party Liner): The Sturgeon. The Comissar Limousines now use Military Rays for escorts.


1.8 Dec 2006

Added Neuropol Info Service (AD-X screens from YOUR_AD_HERE.oxp fitted with communist messages) as Navigational Buoy in Rich Industrial commie systems.

Credits:
Propaganda Poster 1: johnsmith
Propaganda Poster 2: HueijRevisited


1.7 Dec 2006

Made the script a lot more compact and did a minor change in shipdata.plist


1.6 Nov 2006

Updated model for the CZGF + a  little detail work on some other models and textures.


1.5 Nov 2006

Giant Ray gunships for communist military added. (Used ballturrets and some AI from Behemoth.oxp).
Stopped Factories from appearing in interplanetary space.


1.4 Nov 2006

Added Astromine Penal Colonies.


1.31 Nov 2006

Increased Energy Recharge Rate of factories by 50% and gave them shieldEnhancement to stop them from exploding too often in systems with large suns. Also the script now decides the appearance of Commissar Limousines and Worker&#39;s Commuters one by one instead of in pairs.


1.3 Nov 2006

An additional factory model: Solar Laboratory and Production Unit (SLAP-U) and textures for the Worker&#39;s Commuter in less worn states.


1.2 Nov 2006

Added the new Collective Zero G Factory which appears in communist systems with tech level 7 or above and sell tech 10 equipment at affordable prices - look for F on your advanced space compass to find it.

Updated the script and AI for the political police.


1.1 Nov 2006

If you already installed 1.0 delete the following folders before installing:
Commie_vipers.oxp
Political Police.oxp
Worker&#39;s Commuter.oxp
Commissar Limousine.oxp

The Commies now come in a single folder: Commies.oxp

This version gives local communist police the new tough Ray MK-I crafts with built in scoops and there&#39;s a new model for the Worker&#39;s Commuter.


1.0 Oct 2006

Some ships scripted to appear in communist systems:

People&#39;s Vipers - Communist system now require Gal-Cop to have a certain percentage of local police in their ranks, to limit outside interference.

Political Police - Don&#39;t know what to think? Well you better not. These guys will tell you what to think. Criminals whose escape pods get scooped by these guys can look forward to decades in the Astromines.

Commissar Limousine and escorts - The hard working nomenclature likes to travel in style with lots of comfort and protection.

Workers&#39; Commuter - These systems are the working critter&#39;s paradises and the governments provide the worker&#39;s with public transportation (only slightly used).

Stuff used for these cut and paste plus a little scripting OXPs:

Oolite by Giles Willams - Vipers and Political Police
Executive Spaceways OXP by Ramirez - Commissar Limousine and escorts
mPak OXP by Murgh - Workers&#39; Commuter


***** Known crashing problems ******

Some combination of graphics card drivers and ships are crashing Oolite in shader mode, even when no shaders are used at all. When having crashes in shader mode but no crashes when turned off, it is a good sign you should update your drivers. In commies it is the &quot;Collective ZGF&quot; station that can crash some systems. When in doubt if it might affect your computer you should launch Oolite, press &quot;N&quot; and wait for the Collective ZGF station appearing. When it shows up without crashing your system is okay.

A nVidia GeForce 7950GT 512Mb PCI-E graphics card, with the 64-bit drivers version 178.13 is known to crash with commies and other oxps while driver version 191.07 works okay. It seems that turning &quot;Threading Optimisation&quot; off will also help for computers with these cards.

Solution would be to remove this oxp but than you might get other oxp&#39;s containing problem objects. So better update your drivers or leave &quot;Threading Optimisation&quot; off for Oolite in combination with this old GPU.
</pre>
        </a>

        <a name="equipment">          
        <h2>Equipment</h2>
            This expansion declares no equipment. 
        </a>

        <a name="ships">    
        <h2>Ships</h2>
            <table>
                <tr>
                    <th>Name</th>
                </tr>
                <tr>
                    <td><a href="../ships/astromine.html">Astromine Penal Colony</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/astromine-defender.html">Astromine Defender Ray</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/comfactory.html">Collective Zero-G Factory</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/comgrc.html">Manta Ray Carrier</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/comgrc_dock.html">GRC Dock</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/comlim.html">Sturgeon Commissar Limousine</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/comlimesc.html">Commissar Escape Capsule</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/commilray.html">Military Stingray</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/commilray-player.html">commilray-player</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/comminer.html">Convict Miner Minnow</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/comminer-escapee.html">Convict Miner Minnow (Escaping)</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/comminer2.html">Convict Miner Ray</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/comturret.html">Turret</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/comviper.html">People&#39;s Police Ray</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/comyah-nbuoy.html">Navigation Buoy</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/comyah01.html">comyah01</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/comyah02.html">comyah02</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/comyah03.html">comyah03</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/comyah04.html">comyah04</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/comyah05.html">comyah05</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/comyah06.html">comyah06</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/comyah07.html">comyah07</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/comyah08.html">comyah08</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/comyah09.html">comyah09</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/comyah10.html">comyah10</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/comyah11.html">comyah11</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/comyah12.html">comyah12</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/politicop.html">Thought Police Ray</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/slapu.html">Collective SLAPU</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/slapu-defender.html">Military Stingray</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/slapu-dock.html">slapu-dock</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/sunray.html">Sunray</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/sunray-player.html">sunray-player</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/workcom.html">Orca Worker&#39;s Commuter</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/workcom_0.html">workcom_0</a></td>
                </tr>
                <tr>
                    <td><a href="../ships/workcom_1.html">workcom_1</a></td>
                </tr>
            </table>
        </a>

        <a name="models">    
        <h2>Models</h2>
            This expansion declares no models. 
        </a>

        <a name="scripts">    
        <h2>Scripts</h2>
            <table>
                <tr>
                    <th>Path</th>
                </tr>
                <tr>
                    <td valign="top">Scripts/astromine_market.js</td>
                    <td><pre>&quot;use strict&quot;;
this.name = &quot;czgf_market&quot;;
this.author = &quot;spara&quot;;
this.copyright = &quot;2014 spara&quot;;
this.license     = &quot;CC BY-NC-SA 4.0&quot;;

this.$originalDefs = {
      &quot;food&quot; : [0, 0, 0, 0, 0, 0, 0, 0, 0],
      &quot;textiles&quot; : [0, 0, 0, 0, 0, 0, 0, 0, 0],
      &quot;radioactives&quot; : [0, 0, 40, 2, 3, 8, 1, 3, 0],
      &quot;slaves&quot; : [0, 0, 24, 2, 4, 7, 1, 4, 0],
      &quot;liquor_wines&quot; : [0, 0, 0, 0, 0, 0, 0, 0, 0],
      &quot;luxuries&quot; : [0, 0, 0, 0, 0, 0, 0, 0, 0],
      &quot;narcotics&quot; : [0, 0, 0, 0, 0, 0, 0, 0, 0],
      &quot;computers&quot; : [0, 0, 0, 0, 0, 0, 0, 0, 0],
      &quot;machinery&quot; : [0, 0, 0, 0, 0, 0, 0, 0, 0],
      &quot;alloys&quot; : [0, 0, 0, 0, 0, 0, 0, 0, 0],
      &quot;firearms&quot; : [0, 0, 0, 0, 0, 0, 0, 0, 0],
      &quot;furs&quot; : [0, 0, 0, 0, 0, 0, 0, 0, 0],
      &quot;minerals&quot; : [0, 0, 17, 2, 2, 24, 1, 3, 0],
      &quot;gold&quot; : [0, 0, 90, 2, 4, 15, 1, 4, 1],
      &quot;platinum&quot; : [0, 0, 180, 2, 4, 10, 1, 3, 1],
      &quot;gem_stones&quot; : [0, 0, 40, 2, 4, 8, 1, 5, 2],
      &quot;alien_items&quot; : [0, 0, 0, 0, 0, 0, 0, 0, 0]
};

this.updateLocalCommodityDefinition = function(goodDefinition) {
	var commodity = goodDefinition.key;
	var oldDefs = this.$originalDefs[commodity];
	//old style definition found for the good. calculate it the old way
	if (oldDefs) {
		var market_base_price = oldDefs[2];
		var market_eco_adjust_price = oldDefs[3];
		var market_eco_adjust_quantity = oldDefs[4];
		var market_base_quantity = oldDefs[5];
		var market_mask_price = oldDefs[6];
		var market_mask_quantity = oldDefs[7];
		var market_rnd = Math.floor(Math.random() * 256);

		var economy = system.economy;

		var price = (market_base_price + (market_rnd &amp; market_mask_price) + (economy * market_eco_adjust_price)) &amp; 255;
		price *= 0.4;

		var quantity = (market_base_quantity + (market_rnd &amp; market_mask_quantity) - (economy * market_eco_adjust_quantity)) &amp; 255;
		if (quantity &gt; 127) quantity = 0;
		quantity &amp;= 63;

		goodDefinition.price = price * 10;
		goodDefinition.quantity = quantity;
	}
	//no definition found. nullify the goods.
	else {
		goodDefinition.price = 0;
		goodDefinition.quantity = 0;
	}
	return goodDefinition;
};
</pre></td>
                </tr>
                <tr>
                    <td valign="top">Scripts/comlimesc.js</td>
                    <td><pre>&quot;use strict&quot;;
this.name      = &quot;comlimesc&quot;; 
this.author    = &quot;eric walch&quot;; 
this.copyright = &quot;� 2008 eric walch.&quot;; 
this.description = &quot;Code for a comlim escape pod&quot;; 
this.version   = &quot;1.00&quot;;

/* The original legacy code couldn&#39;t check who killed the pod but always blamed the player for its death */

this.shipDied = function (who)
{
    if (who &amp;&amp; who.isPlayer)
    {
        this.ship.commsMessage(expandDescription(&quot;[commissarharakiri]&quot;));
        player.bounty |= 200;
    }
};</pre></td>
                </tr>
                <tr>
                    <td valign="top">Scripts/commies.js</td>
                    <td><pre>&quot;use strict&quot;;
this.name      = &quot;communist_population&quot;; 
this.author    = &quot;eric walch&quot;; 
this.copyright = &quot;� 2009 Dr Nil.&quot;; 
this.description = &quot;Code for a communist_population&quot;; 

this._shipSpawnOverride = false;
this._sourceGov = -1;
this._destGov = -1;
this._debug = false;

this.startUpComplete = function() {
    // remove the original interstellar space populator from commies (which doesn&#39;t work anyway)
    delete worldScripts.communist_population.shipWillExitWitchspace;
}

this.shipWillEnterWitchspace = function (cause) {
    this._sourceGov = system.info.government;
    this._destGov = System.infoForSystem(galaxyNumber, player.ship.nextSystem).government;
}

this.interstellarSpaceWillPopulate = function() {
    if (this._sourceGov === 4 || this._destGov === 4) {
        if (Math.random() &gt; 0.80) {
			system.setPopulator(&quot;commies_comgrc_1&quot;, {
				location: &quot;WITCHPOINT&quot;,
				callback: function(pos) {
                    system.addShips(&quot;comgrc&quot;, 1, pos);
                }}
			);
            //system.legacy_addShips(&quot;comgrc&quot;, 1);
            //system.addShips(&quot;comgrc-defender&quot;, 2);
            //system.legacy_addShips(&quot;comgrc-defender&quot;, 2);
        }
        if (Math.random() &gt; 0.90) {
			system.setPopulator(&quot;commies_comgrc_2&quot;, {
				location: &quot;WITCHPOINT&quot;,
				callback: function(pos) {
                    system.addShips(&quot;comgrc&quot;, 1, pos);
                }}
			);
            //system.legacy_addShips(&quot;comgrc&quot;, 1);
            //system.addShips(&quot;comgrc-defender&quot;, 3);
            //system.legacy_addShips(&quot;comgrc-defender&quot;, 3);
        }
    }
}

/*this.shipWillExitWitchspace = function () {
    if (system.info.government === 4) {
        if (system.isInterstellarSpace) this.witchspacePopulator()
    }
}*/

this.systemWillPopulate = function () {
    if (system.info.government !== 4) return;

	// get the witchpoint position for later calculations that replace the deprecated function &quot;legacy_addSystemShips&quot;
	// which works on the WP - Main Station lane. However, that lane isn&#39;t directly accessible via the &quot;fromCoordinateSystem&quot; functions
	// so we have to create our own lane
	var wpPos = null;
	var wp = system.shipsWithPrimaryRole(&quot;buoy-witchpoint&quot;)[0];
	if (!wp || wp.length === 0) {
		wpPos = new Vector3D(0, 0, 0);
	} else {
		wpPos = wp.position;
	}
	
    for (var i = 0; i &lt; 4; i++) {
		if (Math.random() &gt; 0.50) {
			var posCom = Vector3D.interpolate(wpPos, system.mainStation.position, 0.55 + i * 0.12);
			system.setPopulator(&quot;commies_workcom_&quot; + i, {
				location: &quot;COORDINATES&quot;,
				coordinates: posCom,
				callback: function(pos) {
					var wc = system.addShips(&quot;workcom&quot;, 1, pos, 0);
					if ((!wc || wc.length === 0) &amp;&amp; worldScripts.communist_population._debug === true) log(&quot;commies.populator&quot;, &quot;OOPS! No worker&#39;s commuters spawned (1)&quot;);
				}}
			);
			//system.legacy_addSystemShips(&quot;workcom&quot;, 1, 0.55+i*0.12)
		}
	};
    if (system.techLevel &gt; 6 &amp;&amp; Math.random() &gt; 0.75) {
		var pos1 = Vector3D(0, 0.45, 2.6).fromCoordinateSystem(&quot;sps&quot;);
		system.setPopulator(&quot;commies_workcom_a&quot;, {
			location: &quot;COORDINATES&quot;,
			coordinates: pos1,
			callback: function(pos) {
				var wc = system.addShips(&quot;workcom&quot;, 1, pos, 0);
				if ((!wc || wc.length === 0) &amp;&amp; worldScripts.communist_population._debug === true) log(&quot;commies.populator&quot;, &quot;OOPS! No worker&#39;s commuters spawned (a)&quot;);
			}}
		);
		//system.legacy_addShipsAt(&quot;workcom&quot;, 1, &quot;sps&quot;, [0, 0.45, 2.6]);
	}
    for (var i = 0; i &lt; 2; i++) {
		if (Math.random() &gt; 0.75) {
			var posLiner = Vector3D.interpolate(wpPos, system.mainStation.position, 0.3 + i * 0.05);
			system.setPopulator(&quot;commies_comliner_&quot; + i, {
				location: &quot;COORDINATES&quot;,
				coordinates: posLiner,
				callback: function(pos) {
					var lin = system.addShips(&quot;comlim&quot;, 1, pos, 0);
					if (!lin || lin.length === 0) log(&quot;commies.populator&quot;, &quot;OOPS! No com liners spawned (1)&quot;);
				}}
			);
			//system.legacy_addSystemShips(&quot;comlim&quot;, 1, 0.3+i*0.05)
		}
	};
    if (system.techLevel &gt; 6 &amp;&amp; Math.random() &gt; 0.90) {
		var pos2 = Vector3D(0, 0.6, 2.8).fromCoordinateSystem(&quot;sps&quot;);
		system.setPopulator(&quot;commies_comlin_a&quot;, {
			location: &quot;COORDINATES&quot;,
			coordinates: pos2,
			callback: function(pos) {
				var lin = system.addShips(&quot;comlim&quot;, 1, pos, 0);
				if ((!lin || lin.length === 0) &amp;&amp; worldScripts.communist_population._debug === true) log(&quot;commies.populator&quot;, &quot;OOPS! No com liners spawned (a)&quot;);
			}}
		);
		//system.legacy_addShipsAt(&quot;comlim&quot;, 1, &quot;sps&quot;, [0, 0.6, 2.8]);
	}
    if (Math.random() &gt; 0.75) {
		var posViper = Vector3D.interpolate(wpPos, system.mainStation.position, 0.47);
		system.setPopulator(&quot;commies_comviper&quot;, {
			location: &quot;COORDINATES&quot;,
			coordinates: posViper,
			callback: function(pos) {
				var vp = system.addShips(&quot;comviper&quot;, 5, pos, 0);
				if ((!vp || vp.length === 0) &amp;&amp; worldScripts.communist_population._debug === true) log(&quot;commies.populator&quot;, &quot;OOPS! No com vipers spawned&quot;);
			}}
		);
		//system.legacy_addSystemShips(&quot;comviper&quot;, 5, 0.47);
	}
    if (Math.random() &gt; 0.10) {
		var posPol = Vector3D.interpolate(wpPos, system.mainStation.position, 0.48);
		system.setPopulator(&quot;commies_politicop&quot;, {
			location: &quot;COORDINATES&quot;,
			coordinates: posPol,
			callback: function(pos) {
				var pc = system.addShips(&quot;politicop&quot;, 1, pos, 0);
				if ((!pc || pc.length === 0) &amp;&amp; worldScripts.communist_population._debug === true) log(&quot;commies.populator&quot;, &quot;OOPS! No politicops spawned (1)&quot;);
			}}
		);
		//system.legacy_addSystemShips(&quot;politicop&quot;, 1, 0.48);
	}
    if (system.techLevel &gt; 6 &amp;&amp; Math.random() &gt; 0.95) {
		var posPol2 = Vector3D(0, 0.45, 2.7).fromCoordinateSystem(&quot;sps&quot;);
		system.setPopulator(&quot;commies_politicop_a&quot;, {
			location: &quot;COORDINATES&quot;,
			coordinates: posPol2,
			callback: function(pos) {
				var pc = system.addShips(&quot;politicop&quot;, 1, pos, 0)[0];
				if ((!pc || pc.length === 0) &amp;&amp; worldScripts.communist_population._debug === true) log(&quot;commies.populator&quot;, &quot;OOPS! No politicops spawned&quot;);
			}}
		);
		//system.legacy_addShipsAt(&quot;politicop&quot;, 1, &quot;sps&quot;, [0, 0.45, 2.7]);
	}
    if (system.techLevel &gt; 6 &amp;&amp; system.techLevel &lt; 10) {
		if (!worldScripts.station_validator || worldScripts.station_validator.$deaths(&quot;comczgf&quot;).length === 0) {
			var posFct = Vector3D(0, 0.40, 2.6).fromCoordinateSystem(&quot;sps&quot;);
			system.setPopulator(&quot;commies_comczgf&quot;, {
				location: &quot;COORDINATES&quot;,
				coordinates: posFct,
				deterministic: true,
				callback: function(pos) {
					var fct = system.addShips(&quot;comczgf&quot;, 1, pos, 0)[0];
					if ((!fct || fct.length === 0) &amp;&amp; worldScripts.communist_population._debug === true) log(&quot;commies.populator&quot;, &quot;OOPS! No factories spawned&quot;);
				}}
			);
		}
		//system.legacy_addShipsAt(&quot;comczgf&quot;, 1, &quot;sps&quot;, [0, 0.40, 2.6]);
	}
    if (system.techLevel &gt; 9) {
		if (!worldScripts.station_validator || worldScripts.station_validator.$deaths(&quot;comslapu&quot;).length === 0) {
			var posSlapu = Vector3D(0, 0.40, 2.6).fromCoordinateSystem(&quot;sps&quot;);
			system.setPopulator(&quot;commies_slapu&quot;, {
				location: &quot;COORDINATES&quot;,
				coordinates: posSlapu,
				deterministic: true,
				callback: function(pos) {
					var sla = system.addShips(&quot;comslapu&quot;, 1, pos, 0)[0];
					if ((!sla || sla.length === 0) &amp;&amp; worldScripts.communist_population._debug === true) log(&quot;commies.populator&quot;, &quot;OOPS! No slapu&#39;s spawned&quot;);
				}}
			);
		}
		//system.legacy_addShipsAt(&quot;comslapu&quot;, 1, &quot;sps&quot;, [0, 0.40, 2.6]);
	}
	// note: astromines are not spawned directly, but are set up to be the Rock Hermits in the system.
}

/*this.witchspacePopulator = function() {
    if (Math.random() &gt; 0.80)  {
		system.addShips(&quot;comgrc&quot;, 1);
        //system.legacy_addShips(&quot;comgrc&quot;, 1);
		system.addShips(&quot;comgrc-defender&quot;, 2);
        //system.legacy_addShips(&quot;comgrc-defender&quot;, 2);
    }
    if (Math.random() &gt; 0.90) {
		system.addShips(&quot;comgrc&quot;, 1);
        //system.legacy_addShips(&quot;comgrc&quot;, 1);
		system.addShips(&quot;comgrc-defender&quot;, 3);
        //system.legacy_addShips(&quot;comgrc-defender&quot;, 3);
    }
}*/

</pre></td>
                </tr>
                <tr>
                    <td valign="top">Scripts/commies_conditions.js</td>
                    <td><pre>&quot;use strict&quot;;
this.name        = &quot;Commies_Conditions&quot;;
this.author      = &quot;phkb&quot;;
this.copyright   = &quot;2016 phkb&quot;;
this.description = &quot;Condition script for ships and equipment.&quot;;
this.licence     = &quot;CC BY-NC-SA 3.0&quot;;

this.allowSpawnShip = function(shipKey) {
	if (system.info.government === 4 || worldScripts.communist_population._shipSpawnOverride === true) return true;
	return false;
}</pre></td>
                </tr>
                <tr>
                    <td valign="top">Scripts/czgf_market.js</td>
                    <td><pre>&quot;use strict&quot;;
this.name = &quot;czgf_market&quot;;
this.author = &quot;spara&quot;;
this.copyright = &quot;2014 spara&quot;;
this.license     = &quot;CC BY-NC-SA 4.0&quot;;

this.$originalDefs = {
      &quot;food&quot; : [0, 0, 0, 0, 0, 0, 0, 0, 0],
      &quot;textiles&quot; : [0, 0, 0, 0, 0, 0, 0, 0, 0],
      &quot;radioactives&quot; : [0, 0, 62, 2, 2, 6, 1, 2, 0],
      &quot;slaves&quot; : [0, 0, 0, 0, 0, 0, 0, 0, 0],
      &quot;liquor_wines&quot; : [0, 0, 0, 0, 0, 0, 0, 0, 0],
      &quot;luxuries&quot; : [0, 0, 0, 0, 0, 0, 0, 0, 0],
      &quot;narcotics&quot; : [0, 0, 0, 0, 0, 0, 0, 0, 0],
      &quot;computers&quot; : [0, 0, 0, 0, 0, 0, 0, 0, 0],
      &quot;machinery&quot; : [0, 0, 81, 2, 2, 15, 1, 3, 0],
      &quot;alloys&quot; : [0, 0, 60, 2, 2, 20, 1, 2, 0],
      &quot;firearms&quot; : [0, 0, 75, 2, 3, 14, 1, 4, 0],
      &quot;furs&quot; : [0, 0, 0, 0, 0, 0, 0, 0, 0],
      &quot;minerals&quot; : [0, 0, 0, 0, 0, 0, 0, 0, 0],
      &quot;gold&quot; : [0, 0, 0, 0, 0, 0, 0, 0, 1],
      &quot;platinum&quot; : [0, 0, 0, 0, 0, 0, 0, 0, 1],
      &quot;gem_stones&quot; : [0, 0, 34, 2, 2, 0, 1, 0, 2],
      &quot;alien_items&quot; : [0, 0, 0, 0, 0, 0, 0, 0, 0]
};

this.updateLocalCommodityDefinition = function(goodDefinition) {
	var commodity = goodDefinition.key;
	var oldDefs = this.$originalDefs[commodity];
	//old style definition found for the good. calculate it the old way
	if (oldDefs) {
		var market_base_price = oldDefs[2];
		var market_eco_adjust_price = oldDefs[3];
		var market_eco_adjust_quantity = oldDefs[4];
		var market_base_quantity = oldDefs[5];
		var market_mask_price = oldDefs[6];
		var market_mask_quantity = oldDefs[7];
		var market_rnd = Math.floor(Math.random() * 256);

		var economy = system.economy;

		var price = (market_base_price + (market_rnd &amp; market_mask_price) + (economy * market_eco_adjust_price)) &amp; 255;
		price *= 0.4;

		var quantity = (market_base_quantity + (market_rnd &amp; market_mask_quantity) - (economy * market_eco_adjust_quantity)) &amp; 255;
		if (quantity &gt; 127) quantity = 0;
		quantity &amp;= 63;

		goodDefinition.price = price * 10;
		goodDefinition.quantity = quantity;
	}
	//no definition found. nullify the goods.
	else {
		goodDefinition.price = 0;
		goodDefinition.quantity = 0;
	}
	return goodDefinition;
};
</pre></td>
                </tr>
                <tr>
                    <td valign="top">Scripts/slapu_market.js</td>
                    <td><pre>&quot;use strict&quot;;
this.name = &quot;slapu_market&quot;;
this.author = &quot;spara&quot;;
this.copyright = &quot;2014 spara&quot;;
this.license     = &quot;CC BY-NC-SA 4.0&quot;;

this.$originalDefs = {
      &quot;food&quot; : [0, 0, 10, 2, 2, 12, 1, 2, 0],
      &quot;textiles&quot; : [0, 0, 0, 0, 0, 0, 0, 0, 0],
      &quot;radioactives&quot; : [0, 0, 60, 2, 2, 6, 1, 2, 0],
      &quot;slaves&quot; : [0, 0, 0, 0, 0, 0, 0, 0, 0],
      &quot;liquor_wines&quot; : [0, 0, 70, 2, 2, 4, 1, 2, 0],
      &quot;luxuries&quot; : [0, 0, 0, 0, 0, 0, 0, 0, 0],
      &quot;narcotics&quot; : [0, 0, 80, 2, 2, 8, 1, 2, 0],
      &quot;computers&quot; : [0, 0, 125, 2, 2, 10, 1, 2, 0],
      &quot;machinery&quot; : [0, 0, 0, 0, 0, 0, 0, 0, 0],
      &quot;alloys&quot; : [0, 0, 0, 0, 0, 0, 0, 0, 0],
      &quot;firearms&quot; : [0, 0, 0, 0, 0, 0, 0, 0, 0],
      &quot;furs&quot; : [0, 0, 0, 0, 0, 0, 0, 0, 0],
      &quot;minerals&quot; : [0, 0, 0, 0, 0, 0, 0, 0, 0],
      &quot;gold&quot; : [0, 0, 0, 0, 0, 0, 0, 0, 1],
      &quot;platinum&quot; : [0, 0, 0, 0, 0, 0, 0, 0, 1],
      &quot;gem_stones&quot; : [0, 0, 34, 2, 2, 0, 1, 0, 2],
      &quot;alien_items&quot; : [0, 0, 80, -4, -4, 0, 1, 0, 0]
};

this.updateLocalCommodityDefinition = function(goodDefinition) {
	var commodity = goodDefinition.key;
	var oldDefs = this.$originalDefs[commodity];
	//old style definition found for the good. calculate it the old way
	if (oldDefs) {
		var market_base_price = oldDefs[2];
		var market_eco_adjust_price = oldDefs[3];
		var market_eco_adjust_quantity = oldDefs[4];
		var market_base_quantity = oldDefs[5];
		var market_mask_price = oldDefs[6];
		var market_mask_quantity = oldDefs[7];
		var market_rnd = Math.floor(Math.random() * 256);

		var economy = system.economy;

		var price = (market_base_price + (market_rnd &amp; market_mask_price) + (economy * market_eco_adjust_price)) &amp; 255;
		price *= 0.4;

		var quantity = (market_base_quantity + (market_rnd &amp; market_mask_quantity) - (economy * market_eco_adjust_quantity)) &amp; 255;
		if (quantity &gt; 127) quantity = 0;
		quantity &amp;= 63;

		goodDefinition.price = price * 10;
		goodDefinition.quantity = quantity;
	}
	//no definition found. nullify the goods.
	else {
		goodDefinition.price = 0;
		goodDefinition.quantity = 0;
	}
	return goodDefinition;
};
</pre></td>
                </tr>
                <tr>
                    <td valign="top">Scripts/workcom.js</td>
                    <td><pre>&quot;use strict&quot;;
this.name      = &quot;workcom&quot;; 
this.author    = &quot;eric walch&quot;; 
this.copyright = &quot;� 2008 eric walch.&quot;; 
this.description = &quot;Code for a workcom&quot;; 
this.version   = &quot;1.00&quot;;

this.shipLaunchedFromStation = function ()
{
    // keep ship in system
	if (this.ship.primaryRole === &quot;trader&quot;) 
    {
        this.comfactory = system.shipsWithPrimaryRole(&quot;comczgf&quot;)[0];
        if (!this.comfactory) this.comfactory = system.shipsWithPrimaryRole(&quot;comslapu&quot;)[0];
        if (!this.comfactory) this.comfactory = system.shipsWithRole(&quot;astromine&quot;)[0];
        if (!this.comfactory) this.ship.switchAI(&quot;route2sunskimAI.plist&quot;)
        else this.ship.switchAI(&quot;workcomAI.plist&quot;)
    }
}

this.findComfactory = function ()
{
    if (this.comfactory &amp;&amp; this.comfactory.isValid) this.ship.target = this.comfactory
    else this.ship.target = system.mainStation
}

</pre></td>
                </tr>
            </table>
        </a>
    </body>
</html>
