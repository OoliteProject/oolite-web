<html>
    <head>
        <title>Expansion QTHI AntiZap</title>
        <link rel="stylesheet" href="../style.css">
    </head>
    <body>
        <table border="0" width="100%">
            <tr>
                <td>Back to <a href='../index.html'>Index</a></td>
                <td align="right"><small>Page generated: Oct 11, 2023, 3:16:49 PM</small></td>
            </tr>
        </table>

        <h1>Expansion QTHI AntiZap</h1>

        <h2>Content</h2>
        <ul>
          <li><a href="#warnings">Warnings</a></li>
          <li><a href="#manifest">Manifest</a></li>
          <li><a href="#documentation">Documentation</a></li>
          <li><a href="#equipment">2 Equipment</a></li>
          <li><a href="#ships">0 Ships</a></li>
          <li><a href="#models">0 Models</a></li>
          <li><a href="#scripts">2 Scripts</a></li>
        </ul>

          <a name="warnings">
            <h2>Warnings</h2>
            <ol>
                <li>Tags mismatch between OXP Manifest and Expansion Manager at character position 0002 (RIGHT SQUARE BRACKET vs LATIN SMALL LETTER E)(&#39;[]&#39; vs &#39;[equipment]&#39;)</li>
            </ol>
          </a>

        <a name="manifest">
        <h2>Manifest</h2>
            <table border="1">
                <tr>
                    <th></th>
                    <th>from Expansion Manager's OXP list</th>
                    <th>from Expansion Manifest</th>
                </tr>
                <tr>
                    <td>Description</td>
                    <td>QTHI AntiZap devices are powerful anti-weapons which install in your shield generators. They come with a certain risk, though.</td>
                    <td>QTHI AntiZap devices are powerful anti-weapons which install in your shield generators. They come with a certain risk, though.</td>
                </tr>
                <tr>
                    <td>Identifier</td>
                    <td>oolite.oxp.QCS.QTHI_AntiZap</td>
                    <td>oolite.oxp.QCS.QTHI_AntiZap</td>
                </tr>
                <tr>
                    <td>Title</td>
                    <td>QTHI AntiZap</td>
                    <td>QTHI AntiZap</td>
                </tr>
                <tr>
                    <td>Category</td>
                    <td>Equipment</td>
                    <td>Equipment</td>
                </tr>
                <tr>
                    <td>Author</td>
                    <td>QCS</td>
                    <td>QCS</td>
                </tr>
                <tr>
                    <td>Version</td>
                    <td>0.1</td>
                    <td>0.1</td>
                </tr>
                <tr>
                    <td>Tags</td>
                    <td></td>
                    <td>equipment</td>
                </tr>
                <tr>
                    <td>Required Oolite Version</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Maximum Oolite Version</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Required Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Optional Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Conflict Expansions</td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td>Information URL</td>
                    <td><a target="_blank" href="http://wiki.alioth.net/index.php/QTHI_AntiZap">http://wiki.alioth.net/index.php/QTHI_AntiZap</a></td>
                    <td><a target="_blank" href="">n/a</a></td>
                </tr>
                <tr>
                    <td>Download URL</td>
                    <td><a target="_blank" href="https://wiki.alioth.net/img_auth.php/5/57/QTHI_AntiZap_0.1.oxz">https://wiki.alioth.net/img_auth.php/5/57/QTHI_AntiZap_0.1.oxz</a></td>
                    <td><a target="_blank" href="">n/a</a></td>
                </tr>
                <tr>
                    <td>License</td>
                    <td>Creative Commons Attribution - Non-Commercial - Share Alike 4.0 license</td>
                    <td>Creative Commons Attribution - Non-Commercial - Share Alike 4.0 license</td>
                </tr>
                <tr>
                    <td>File Size</td>
                    <td>n/a</td>
                </tr>
                <tr>
                    <td>Upload date</td>
                    <td>1610873302</td>
                </tr>
            </table>
                </a>

        <a name="documentation">
        <h2>Documentation</h2>
        <p>Also read <a href='http://wiki.alioth.net/index.php/QTHI%20AntiZap'>http://wiki.alioth.net/index.php/QTHI%20AntiZap</a></p>
        </a>

        <a name="equipment">          
        <h2>Equipment</h2>
            <table>
                <tr>
                    <th>Name</th>
                    <th>Visible</th>
                    <th>Cost [deci-credits]</th>
                    <th>Tech-Level</th>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_QTHI_AntiZap.html">QTHI AntiZap</a></td>
                    <td>yes</td>
                    <td align="right">10</td>
                    <td align="center">2+</td>
                </tr>
                <tr>
                    <td><a href="../equipment/EQ_QTHI_AntiZap_Sell.html">Sell QTHI AntiZap</a></td>
                    <td>yes</td>
                    <td align="right">0</td>
                    <td align="center">2+</td>
                </tr>
            </table>
        </a>

        <a name="ships">    
        <h2>Ships</h2>
            This expansion declares no ships. This may be related to warnings.
        </a>

        <a name="models">    
        <h2>Models</h2>
            This expansion declares no models. This may be related to warnings.
        </a>

        <a name="scripts">    
        <h2>Scripts</h2>
            <table>
                <tr>
                    <th>Path</th>
                </tr>
                <tr>
                    <td valign="top">Config/script.js</td>
                    <td><pre>this.name = &quot;QTHI AntiZap&quot;;
this.author = &quot;QCS&quot;;
this.copyright = &quot;(C) 2017 QCS.&quot;;
this.licence = &quot;CC-NC-by-SA 4.0&quot;;
this.description = &quot;Worldscript for QTHI AntiZap by QCS.&quot;;
this.version = &quot;0.1&quot;;

&quot;use strict&quot;;

this.mode = 2;
this.activated = false;
this.armed = true;
this.ships = [];

this.shipLaunchedFromStation = function (station) {
	this.shipExitedWormhole();
};

this.shipExitedWormhole = function () {
	if (player.ship.equipmentStatus(&quot;EQ_QTHI_AntiZap&quot;) === &quot;EQUIPMENT_OK&quot;) {
		this.activated = true;
		this.console();
		if (!this.shipsTimer) {
			this.shipsTimer = new Timer(this, this.evaluateShips, 0.25, 0.25);
		}
		this.shipsTimer.start();

	}
};

this.shipWillDockWithStation = function (station) {
	this.shipsTimer.stop();
};

this.toggleActive = function () {
	this.activated = !this.activated;
	this.console();
};

this.console = function () {
	if (this.activated) {
		player.consoleMessage(&quot;QTHI AntiZap active&quot;);
	} else {
		player.consoleMessage(&quot;QTHI AntiZap inactive.&quot;);
	}

	return;

	/*	if (this.activated) {
		switch (this.mode) {
		case 1:
			player.consoleMessage(&quot;QTHI AntiZap active, mode: light zap.&quot;);
			break;
		case 2:
			player.consoleMessage(&quot;QTHI AntiZap active, mode: medium zap.&quot;);
			break;
		case 3:
			player.consoleMessage(&quot;QTHI AntiZap active, mode: strong zap.&quot;);
			break;
		}
	} else {
		player.consoleMessage(&quot;QTHI AntiZap inactive.&quot;);
	}
*/
};

this.playerBoughtEquipment = function (equipmentKey) {
	if (equipmentKey === &quot;EQ_QTHI_AntiZap_Sell&quot;) {
		player.ship.removeEquipment(&quot;EQ_QTHI_AntiZap&quot;);
		player.ship.removeEquipment(&quot;EQ_QTHI_AntiZap_Sell&quot;);
		player.credits += 100;
	}
};

this.shipTakingDamage = function (amount, whom, type) {
	if (player.ship.equipmentStatus(&quot;EQ_QTHI_AntiZap&quot;) !== &quot;EQUIPMENT_OK&quot;) {
		return;
	}

	if (this.mode === 0) {
		return;
	}
	if (!this.armed) {
		return;
	}
	if (whom.currentWeapon.equipmentKey === &quot;EQ_WEAPON_NONE&quot;) {
		this.slog(&quot;skipped attack from &quot; + whom + &quot; due to NONE weapon&quot;);
		return;
	}
	if (player.ship.energy &lt; 32) {
		this.slog(&quot;skipped attack from &quot; + whom + &quot; due to LOW energy&quot;);
		return;
	}
	if (player.ship.temperature &gt; 0.85) {
		this.slog(&quot;skipped attack from &quot; + whom + &quot; due to HIGH temperature&quot;);
		return;
	}
	if (amount &gt; 0) {
		this.slog(&quot;skipped attack from &quot; + whom + &quot; due to shield down&quot;);
		return;
	}
	//TODO check which shield, return if shield is 0;
	// - shield must be operating 
	// - maybe only check if damage is 0 - if not, shield is down

	switch (this.mode) {
	case 1:
		whom.energy -= 10;
		whom.temperature += 0.1;
		player.ship.energy -= 3;
		break;
	case 2:
		whom.energy -= 15;
		whom.temperature += 0.3;
		player.ship.energy -= 5;
		if (Math.random() &lt; 0.2) {
			whom.commsMessage(&quot;Help! My systems went totally haywire!&quot;);
		}
		whom.performStop();
//		whom.performTumble();
		this.ships[clock.absoluteSeconds + 5] = whom;
		break;
	case 3:
		whom.energy -= 20;
		whom.temperature += 0.25;
		whom.performTumble();
		player.ship.energy -= 10;
		break;
	}
	player.consoleMessage(&quot;QTHI AntiZap zapped enemy!&quot;, 6);
};

this.slog = function (s) {
	log(this.name, s);
};

this.evaluateShips = function () {
//	slog(&quot;evaluateShips&quot;);
	for (var s in this.ships) {
//		slog(&quot;Ship: &quot; + s + &quot;: &quot; + this.ships[s]);
		if (clock.absoluteSeconds &gt;= s) {
			this.ships[s].broadcastDistressMessage();
			delete this.ships[s];
		} else {
//			this.ships[s].performTumble();
			this.ships[s].performStop();
		}		
	}
};
</pre></td>
                </tr>
                <tr>
                    <td valign="top">Scripts/EQ_QTHI_AntiZap.js</td>
                    <td><pre>this.author      = &quot;QCS&quot;; 
this.copyright   = &quot;ï¿½ 2017 QCS.&quot;; 
this.licence = &quot;CC-BY-SA 4.0&quot;;
this.version     = &quot;0.1&quot;; 
this.name = &quot;QTHI AntiZap EQ&quot;;
this.author = &quot;QCS&quot;;
this.copyright = &quot;(C) 2017 QCS.&quot;;
this.licence = &quot;CC-NC-by-SA 4.0&quot;;
this.description = &quot;Equipment script for AntiZap&quot;;
this.version = &quot;0.1&quot;;

this.activated = function () {
	worldScripts[&quot;QTHI AntiZap&quot;].toggleActive();
}

this.mode = function () {
	//for now, do nothing
	return;
	
	var mode = worldScripts[&quot;QTHI AntiZap&quot;]._mode;
	mode++;
	if (mode &gt; 3) {
		mode = 1;
	}
	ws._mode = mode;
	ws.console();
}
</pre></td>
                </tr>
            </table>
        </a>
    </body>
</html>
